{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 807.983671568058, "node_ip": "10.138.0.2", "timesteps_total": 48629, "iterations_since_restore": 1, "episode_reward_mean": 807.983671568058, "custom_metrics": {"cost1_max": 273.2594144852894, "cost1_mean": 273.2594144852894, "system_level_velocity_mean": 10.361034584448657, "outflow_rate_max": 755.2798571428573, "cost1_min": 273.2594144852894, "system_level_velocity_max": 10.361034584448657, "system_level_velocity_min": 10.361034584448657, "outflow_rate_min": 755.2798571428573, "cost2_max": -72.90369824893371, "cost2_mean": -72.90369824893371, "outflow_rate_mean": 755.2798571428573, "cost2_min": -72.90369824893371}, "training_iteration": 1, "episodes_total": 1, "episode_len_mean": 700.0, "timestamp": 1557205125, "time_total_s": 50.85303783416748, "pid": 32008, "info": {"num_steps_trained": 48629, "num_steps_sampled": 48629, "load_time_ms": 60.96, "grad_time_ms": 10136.431, "sample_time_ms": 39409.591, "update_time_ms": 1109.671, "default": {"vf_explained_var": 0.8846829533576965, "vf_loss": 2.657128095626831, "entropy": 1.4214932918548584, "cur_lr": 0.0005000000237487257, "total_loss": 2.656667947769165, "kl": 0.0017012603348121047, "policy_loss": -0.0008002638933248818, "cur_kl_coeff": 0.20000003278255463}}, "time_this_iter_s": 50.85303783416748, "timesteps_since_restore": 48629, "time_since_restore": 50.85303783416748, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 48629, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66b13438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66b133c8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66b13400>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_04-58-45", "hostname": "flow-main", "episodes_this_iter": 1, "episode_reward_min": 807.983671568058}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 932.6074968507563, "node_ip": "10.138.0.2", "timesteps_total": 93759, "iterations_since_restore": 2, "episode_reward_mean": 715.7116777247461, "custom_metrics": {"cost1_max": 290.00681151272113, "cost1_mean": 231.19206828372938, "system_level_velocity_mean": 8.744042540390172, "outflow_rate_max": 852.7610167226032, "cost1_min": 157.3272658147772, "system_level_velocity_max": 10.898537290032042, "system_level_velocity_min": 5.954292024357354, "outflow_rate_min": 245.29517764618802, "cost2_max": -43.03706074682091, "cost2_mean": -64.22977550647299, "outflow_rate_mean": 560.2546108384488, "cost2_min": -86.03031050580671}, "training_iteration": 2, "episodes_total": 20, "episode_len_mean": 700.0, "timestamp": 1557205151, "time_total_s": 76.46390843391418, "pid": 32008, "info": {"num_steps_trained": 93759, "num_steps_sampled": 93759, "load_time_ms": 37.311, "grad_time_ms": 8994.171, "sample_time_ms": 28533.12, "update_time_ms": 558.705, "default": {"vf_explained_var": 0.9726456999778748, "vf_loss": 1.4494922161102295, "entropy": 1.4144173860549927, "cur_lr": 0.0005000000237487257, "total_loss": 1.4481821060180664, "kl": 0.00404277304187417, "policy_loss": -0.001714394660666585, "cur_kl_coeff": 0.10000001639127731}}, "time_this_iter_s": 25.610870599746704, "timesteps_since_restore": 93759, "time_since_restore": 76.46390843391418, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 45130, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e898>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e8d0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_04-59-11", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 470.58016340878385}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 932.6074968507563, "node_ip": "10.138.0.2", "timesteps_total": 137068, "iterations_since_restore": 3, "episode_reward_mean": 678.5032332568653, "custom_metrics": {"cost1_max": 291.04633337338066, "cost1_mean": 227.23118156017713, "system_level_velocity_mean": 8.624950692330358, "outflow_rate_max": 852.7610167226032, "cost1_min": 157.3272658147772, "system_level_velocity_max": 10.936427483380973, "system_level_velocity_min": 5.954292024357354, "outflow_rate_min": 245.29517764618802, "cost2_max": -33.08853380121058, "cost2_mean": -59.543225756949106, "outflow_rate_mean": 576.9488137170414, "cost2_min": -86.03031050580671}, "training_iteration": 3, "episodes_total": 38, "episode_len_mean": 700.0, "timestamp": 1557205178, "time_total_s": 103.58538007736206, "pid": 32008, "info": {"num_steps_trained": 137068, "num_steps_sampled": 137068, "load_time_ms": 29.701, "grad_time_ms": 8702.728, "sample_time_ms": 25323.584, "update_time_ms": 374.622, "default": {"vf_explained_var": 0.9726464748382568, "vf_loss": 1.4629909992218018, "entropy": 1.4063230752944946, "cur_lr": 0.0005000000237487257, "total_loss": 1.460996389389038, "kl": 0.007406807504594326, "policy_loss": -0.0023650075308978558, "cur_kl_coeff": 0.050000011920928955}}, "time_this_iter_s": 27.121471643447876, "timesteps_since_restore": 137068, "time_since_restore": 103.58538007736206, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43309, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa8d0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa908>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_04-59-38", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 457.7615617704883}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 932.6074968507563, "node_ip": "10.138.0.2", "timesteps_total": 180327, "iterations_since_restore": 4, "episode_reward_mean": 680.0884091563449, "custom_metrics": {"cost1_max": 291.04633337338066, "cost1_mean": 226.89109841392946, "system_level_velocity_mean": 8.611446384049124, "outflow_rate_max": 852.7610167226032, "cost1_min": 157.3272658147772, "system_level_velocity_max": 10.936427483380973, "system_level_velocity_min": 5.954292024357354, "outflow_rate_min": 245.29517764618802, "cost2_max": -33.08853380121058, "cost2_mean": -59.32232449818315, "outflow_rate_mean": 576.9948224906893, "cost2_min": -86.03031050580671}, "training_iteration": 4, "episodes_total": 40, "episode_len_mean": 700.0, "timestamp": 1557205202, "time_total_s": 127.53665494918823, "pid": 32008, "info": {"num_steps_trained": 180327, "num_steps_sampled": 180327, "load_time_ms": 25.405, "grad_time_ms": 8766.748, "sample_time_ms": 22717.427, "update_time_ms": 283.076, "default": {"vf_explained_var": 0.9812611937522888, "vf_loss": 1.3761292695999146, "entropy": 1.3948476314544678, "cur_lr": 0.0005000000237487257, "total_loss": 1.3686039447784424, "kl": 0.015173869207501411, "policy_loss": -0.008283965289592743, "cur_kl_coeff": 0.05000000819563866}}, "time_this_iter_s": 23.951274871826172, "timesteps_since_restore": 180327, "time_since_restore": 127.53665494918823, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43259, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a76a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7668>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7780>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-00-02", "hostname": "flow-main", "episodes_this_iter": 2, "episode_reward_min": 457.7615617704883}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 948.6231525100538, "node_ip": "10.138.0.2", "timesteps_total": 223096, "iterations_since_restore": 5, "episode_reward_mean": 676.8269813519172, "custom_metrics": {"cost1_max": 291.04633337338066, "cost1_mean": 224.2376895527026, "system_level_velocity_mean": 8.74913526654913, "outflow_rate_max": 852.7610167226032, "cost1_min": 78.17896019145186, "system_level_velocity_max": 17.547308716716586, "system_level_velocity_min": 5.954292024357354, "outflow_rate_min": 245.29517764618802, "cost2_max": -22.140343010057762, "cost2_mean": -54.612351854780655, "outflow_rate_mean": 597.4456363771217, "cost2_min": -86.03031050580671}, "training_iteration": 5, "episodes_total": 61, "episode_len_mean": 690.4918032786885, "timestamp": 1557205227, "time_total_s": 153.21116995811462, "pid": 32008, "info": {"num_steps_trained": 223096, "num_steps_sampled": 223096, "load_time_ms": 22.804, "grad_time_ms": 8958.809, "sample_time_ms": 21344.276, "update_time_ms": 227.745, "default": {"vf_explained_var": 0.9462966322898865, "vf_loss": 5.099253177642822, "entropy": 1.3815735578536987, "cur_lr": 0.0005000000237487257, "total_loss": 5.094480514526367, "kl": 0.011209064163267612, "policy_loss": -0.00533272884786129, "cur_kl_coeff": 0.050000011920928955}}, "time_this_iter_s": 25.67451500892639, "timesteps_since_restore": 223096, "time_since_restore": 153.21116995811462, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42769, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7080>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7438>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-00-27", "hostname": "flow-main", "episodes_this_iter": 21, "episode_reward_min": 173.71784162036488}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1238.2344011180633, "node_ip": "10.138.0.2", "timesteps_total": 267907, "iterations_since_restore": 6, "episode_reward_mean": 753.9037573231095, "custom_metrics": {"cost1_max": 294.092909644978, "cost1_mean": 234.9659241569365, "system_level_velocity_mean": 9.056097409738964, "outflow_rate_max": 966.8085159074429, "cost1_min": 78.17896019145186, "system_level_velocity_max": 17.547308716716586, "system_level_velocity_min": 5.954292024357354, "outflow_rate_min": 245.29517764618802, "cost2_max": -22.140343010057762, "cost2_mean": -53.74736921101744, "outflow_rate_mean": 654.4764404803404, "cost2_min": -86.03031050580671}, "training_iteration": 6, "episodes_total": 80, "episode_len_mean": 692.75, "timestamp": 1557205253, "time_total_s": 178.7776312828064, "pid": 32008, "info": {"num_steps_trained": 267907, "num_steps_sampled": 267907, "load_time_ms": 21.24, "grad_time_ms": 9194.236, "sample_time_ms": 20300.913, "update_time_ms": 190.792, "default": {"vf_explained_var": 0.8558881282806396, "vf_loss": 9.272924423217773, "entropy": 1.3682016134262085, "cur_lr": 0.0005000000237487257, "total_loss": 9.271203994750977, "kl": 0.007711110636591911, "policy_loss": -0.002105024643242359, "cur_kl_coeff": 0.050000011920928955}}, "time_this_iter_s": 25.566461324691772, "timesteps_since_restore": 267907, "time_since_restore": 178.7776312828064, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44811, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aaa90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa240>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aacc0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-00-53", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 173.71784162036488}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1291.5653629498306, "node_ip": "10.138.0.2", "timesteps_total": 312187, "iterations_since_restore": 7, "episode_reward_mean": 816.1787595176446, "custom_metrics": {"cost1_max": 332.97536842408283, "cost1_mean": 243.95356981507697, "system_level_velocity_mean": 9.340617949173515, "outflow_rate_max": 1040.9045635542122, "cost1_min": 78.17896019145186, "system_level_velocity_max": 17.547308716716586, "system_level_velocity_min": 5.954292024357354, "outflow_rate_min": 245.29517764618802, "cost2_max": -22.140343010057762, "cost2_mean": -56.95786343330059, "outflow_rate_mean": 693.4631282292011, "cost2_min": -102.43494740463751}, "training_iteration": 7, "episodes_total": 93, "episode_len_mean": 693.763440860215, "timestamp": 1557205279, "time_total_s": 204.61170983314514, "pid": 32008, "info": {"num_steps_trained": 312187, "num_steps_sampled": 312187, "load_time_ms": 19.999, "grad_time_ms": 9279.826, "sample_time_ms": 19676.876, "update_time_ms": 164.84, "default": {"vf_explained_var": 0.9209886789321899, "vf_loss": 6.140407562255859, "entropy": 1.36811363697052, "cur_lr": 0.0005000000237487257, "total_loss": 6.139430522918701, "kl": 0.006323189474642277, "policy_loss": -0.001292811706662178, "cur_kl_coeff": 0.050000011920928955}}, "time_this_iter_s": 25.834078550338745, "timesteps_since_restore": 312187, "time_since_restore": 204.61170983314514, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44280, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa5f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa438>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa898>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-01-19", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 173.71784162036488}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1418.5388723014921, "node_ip": "10.138.0.2", "timesteps_total": 358209, "iterations_since_restore": 8, "episode_reward_mean": 905.7859724270244, "custom_metrics": {"cost1_max": 339.920315719351, "cost1_mean": 257.3181229270614, "system_level_velocity_mean": 9.786296233750205, "outflow_rate_max": 1072.8248577391519, "cost1_min": 78.17896019145186, "system_level_velocity_max": 17.547308716716586, "system_level_velocity_min": 6.404707110803147, "outflow_rate_min": 383.0678044692737, "cost2_max": -22.140343010057762, "cost2_mean": -60.63011846743562, "outflow_rate_mean": 755.186732884718, "cost2_min": -107.02746581806878}, "training_iteration": 8, "episodes_total": 110, "episode_len_mean": 694.2, "timestamp": 1557205306, "time_total_s": 232.05166363716125, "pid": 32008, "info": {"num_steps_trained": 358209, "num_steps_sampled": 358209, "load_time_ms": 19.123, "grad_time_ms": 9325.244, "sample_time_ms": 19428.441, "update_time_ms": 145.349, "default": {"vf_explained_var": 0.9392829537391663, "vf_loss": 5.212278842926025, "entropy": 1.3610018491744995, "cur_lr": 0.0005000000237487257, "total_loss": 5.210901260375977, "kl": 0.006575067527592182, "policy_loss": -0.001706446404568851, "cur_kl_coeff": 0.050000011920928955}}, "time_this_iter_s": 27.439953804016113, "timesteps_since_restore": 358209, "time_since_restore": 232.05166363716125, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 46022, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aaef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7dd8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aaa20>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-01-46", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 173.71784162036488}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1418.5388723014921, "node_ip": "10.138.0.2", "timesteps_total": 405191, "iterations_since_restore": 9, "episode_reward_mean": 958.0110209395326, "custom_metrics": {"cost1_max": 339.920315719351, "cost1_mean": 264.5700159216758, "system_level_velocity_mean": 10.03215801290916, "outflow_rate_max": 1072.8248577391519, "cost1_min": 78.17896019145186, "system_level_velocity_max": 17.547308716716586, "system_level_velocity_min": 6.404707110803147, "outflow_rate_min": 383.0678044692737, "cost2_max": -22.140343010057762, "cost2_mean": -61.571031140241956, "outflow_rate_mean": 795.6409214547217, "cost2_min": -107.87610364799514}, "training_iteration": 9, "episodes_total": 120, "episode_len_mean": 694.2, "timestamp": 1557205331, "time_total_s": 257.0011668205261, "pid": 32008, "info": {"num_steps_trained": 405191, "num_steps_sampled": 405191, "load_time_ms": 18.742, "grad_time_ms": 9329.911, "sample_time_ms": 18989.046, "update_time_ms": 130.007, "default": {"vf_explained_var": 0.9635081887245178, "vf_loss": 3.3430097103118896, "entropy": 1.3557841777801514, "cur_lr": 0.0005000000237487257, "total_loss": 3.342120409011841, "kl": 0.006546371150761843, "policy_loss": -0.0012168179964646697, "cur_kl_coeff": 0.050000011920928955}}, "time_this_iter_s": 24.949503183364868, "timesteps_since_restore": 405191, "time_since_restore": 257.0011668205261, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 46982, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66af9ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e940>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689ed68>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-02-11", "hostname": "flow-main", "episodes_this_iter": 10, "episode_reward_min": 173.71784162036488}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1418.5388723014921, "node_ip": "10.138.0.2", "timesteps_total": 450294, "iterations_since_restore": 10, "episode_reward_mean": 1042.6642641629983, "custom_metrics": {"cost1_max": 339.920315719351, "cost1_mean": 275.36421862195755, "system_level_velocity_mean": 10.392865374230714, "outflow_rate_max": 1072.8248577391519, "cost1_min": 78.17896019145186, "system_level_velocity_max": 17.547308716716586, "system_level_velocity_min": 6.64618469021276, "outflow_rate_min": 402.63985588993233, "cost2_max": -22.140343010057762, "cost2_mean": -63.09406652957402, "outflow_rate_mean": 840.9748240711093, "cost2_min": -107.87610364799514}, "training_iteration": 10, "episodes_total": 133, "episode_len_mean": 694.2, "timestamp": 1557205358, "time_total_s": 283.2205777168274, "pid": 32008, "info": {"num_steps_trained": 450294, "num_steps_sampled": 450294, "load_time_ms": 18.191, "grad_time_ms": 9320.682, "sample_time_ms": 18776.793, "update_time_ms": 117.714, "default": {"vf_explained_var": 0.9556494355201721, "vf_loss": 5.164039134979248, "entropy": 1.347398281097412, "cur_lr": 0.0005000000237487257, "total_loss": 5.163696765899658, "kl": 0.005487521179020405, "policy_loss": -0.0006164915394037962, "cur_kl_coeff": 0.05000000819563866}}, "time_this_iter_s": 26.21941089630127, "timesteps_since_restore": 450294, "time_since_restore": 283.2205777168274, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 45103, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aada0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa198>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-02-38", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 173.71784162036488}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1418.5388723014921, "node_ip": "10.138.0.2", "timesteps_total": 497212, "iterations_since_restore": 11, "episode_reward_mean": 1146.1807497584484, "custom_metrics": {"cost1_max": 346.42967918489114, "cost1_mean": 290.30590810300043, "system_level_velocity_mean": 10.928393667736394, "outflow_rate_max": 1072.8248577391519, "cost1_min": 28.780664226624328, "system_level_velocity_max": 19.555431365667637, "system_level_velocity_min": 6.64618469021276, "outflow_rate_min": 329.6337234057179, "cost2_max": -11.406649310085433, "cost2_mean": -67.0503078330888, "outflow_rate_mean": 900.5909532253139, "cost2_min": -107.87610364799514}, "training_iteration": 11, "episodes_total": 153, "episode_len_mean": 693.43, "timestamp": 1557205385, "time_total_s": 310.3292484283447, "pid": 32008, "info": {"num_steps_trained": 497212, "num_steps_sampled": 497212, "load_time_ms": 13.484, "grad_time_ms": 9315.446, "sample_time_ms": 16528.392, "update_time_ms": 7.485, "default": {"vf_explained_var": 0.943422257900238, "vf_loss": 6.56764030456543, "entropy": 1.3478738069534302, "cur_lr": 0.0005000000237487257, "total_loss": 6.566412448883057, "kl": 0.005523328669369221, "policy_loss": -0.0015033757081255317, "cur_kl_coeff": 0.05000000819563866}}, "time_this_iter_s": 27.108670711517334, "timesteps_since_restore": 497212, "time_since_restore": 310.3292484283447, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 46918, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aae10>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa208>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-03-05", "hostname": "flow-main", "episodes_this_iter": 20, "episode_reward_min": 57.388507802895646}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1418.5388723014921, "node_ip": "10.138.0.2", "timesteps_total": 545969, "iterations_since_restore": 12, "episode_reward_mean": 1189.9053963626322, "custom_metrics": {"cost1_max": 346.42967918489114, "cost1_mean": 296.861712709921, "system_level_velocity_mean": 11.152887224310007, "outflow_rate_max": 1072.8248577391519, "cost1_min": 28.780664226624328, "system_level_velocity_max": 19.555431365667637, "system_level_velocity_min": 8.73365731358954, "outflow_rate_min": 329.6337234057179, "cost2_max": -11.406649310085433, "cost2_mean": -69.02240315125867, "outflow_rate_mean": 922.6312630850705, "cost2_min": -107.87610364799514}, "training_iteration": 12, "episodes_total": 161, "episode_len_mean": 693.43, "timestamp": 1557205411, "time_total_s": 336.6282784938812, "pid": 32008, "info": {"num_steps_trained": 545969, "num_steps_sampled": 545969, "load_time_ms": 13.711, "grad_time_ms": 9642.287, "sample_time_ms": 16269.455, "update_time_ms": 7.293, "default": {"vf_explained_var": 0.9798553586006165, "vf_loss": 2.729041814804077, "entropy": 1.3577039241790771, "cur_lr": 0.0005000000237487257, "total_loss": 2.727512836456299, "kl": 0.006271352060139179, "policy_loss": -0.0018428495386615396, "cur_kl_coeff": 0.05000000819563866}}, "time_this_iter_s": 26.2990300655365, "timesteps_since_restore": 545969, "time_since_restore": 336.6282784938812, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 48757, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a78d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7198>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7f60>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-03-31", "hostname": "flow-main", "episodes_this_iter": 8, "episode_reward_min": 57.388507802895646}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1418.5388723014921, "node_ip": "10.138.0.2", "timesteps_total": 594219, "iterations_since_restore": 13, "episode_reward_mean": 1215.3666712722597, "custom_metrics": {"cost1_max": 346.42967918489114, "cost1_mean": 300.1925916980926, "system_level_velocity_mean": 11.270959459664601, "outflow_rate_max": 1072.8248577391519, "cost1_min": 28.780664226624328, "system_level_velocity_max": 19.555431365667637, "system_level_velocity_min": 8.794953208918326, "outflow_rate_min": 329.6337234057179, "cost2_max": -11.406649310085433, "cost2_mean": -70.63813690129614, "outflow_rate_mean": 928.887647070502, "cost2_min": -107.87610364799514}, "training_iteration": 13, "episodes_total": 175, "episode_len_mean": 693.43, "timestamp": 1557205439, "time_total_s": 364.3271713256836, "pid": 32008, "info": {"num_steps_trained": 594219, "num_steps_sampled": 594219, "load_time_ms": 13.923, "grad_time_ms": 9973.944, "sample_time_ms": 15993.373, "update_time_ms": 7.259, "default": {"vf_explained_var": 0.9646909236907959, "vf_loss": 5.640652179718018, "entropy": 1.3554737567901611, "cur_lr": 0.0005000000237487257, "total_loss": 5.638953685760498, "kl": 0.0070573072880506516, "policy_loss": -0.002051793271675706, "cur_kl_coeff": 0.05000000819563866}}, "time_this_iter_s": 27.698892831802368, "timesteps_since_restore": 594219, "time_since_restore": 364.3271713256836, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 48250, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4320>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4a90>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-03-59", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 57.388507802895646}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1418.5388723014921, "node_ip": "10.138.0.2", "timesteps_total": 640307, "iterations_since_restore": 14, "episode_reward_mean": 1226.943848915039, "custom_metrics": {"cost1_max": 346.42967918489114, "cost1_mean": 299.61118115990814, "system_level_velocity_mean": 11.252128819376198, "outflow_rate_max": 1072.8248577391519, "cost1_min": 28.780664226624328, "system_level_velocity_max": 19.555431365667637, "system_level_velocity_min": 8.65829417085536, "outflow_rate_min": 329.6337234057179, "cost2_max": -11.406649310085433, "cost2_mean": -71.79775018892256, "outflow_rate_mean": 919.2469401481894, "cost2_min": -108.98625685188074}, "training_iteration": 14, "episodes_total": 193, "episode_len_mean": 693.43, "timestamp": 1557205465, "time_total_s": 390.9373617172241, "pid": 32008, "info": {"num_steps_trained": 640307, "num_steps_sampled": 640307, "load_time_ms": 14.428, "grad_time_ms": 10261.592, "sample_time_ms": 15966.57, "update_time_ms": 7.712, "default": {"vf_explained_var": 0.9753990173339844, "vf_loss": 4.7251458168029785, "entropy": 1.348725438117981, "cur_lr": 0.0005000000237487257, "total_loss": 4.724530220031738, "kl": 0.005680857691913843, "policy_loss": -0.0009000684367492795, "cur_kl_coeff": 0.05000000447034836}}, "time_this_iter_s": 26.610190391540527, "timesteps_since_restore": 640307, "time_since_restore": 390.9373617172241, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 46088, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aac18>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa128>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-04-25", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 57.388507802895646}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1418.5388723014921, "node_ip": "10.138.0.2", "timesteps_total": 690355, "iterations_since_restore": 15, "episode_reward_mean": 1228.7489997694265, "custom_metrics": {"cost1_max": 352.48947696572213, "cost1_mean": 300.63308833213796, "system_level_velocity_mean": 11.296144652312366, "outflow_rate_max": 1097.8316612093788, "cost1_min": 28.780664226624328, "system_level_velocity_max": 19.555431365667637, "system_level_velocity_min": 8.65829417085536, "outflow_rate_min": 329.6337234057179, "cost2_max": -11.406649310085433, "cost2_mean": -71.75435574826597, "outflow_rate_mean": 917.2190805186526, "cost2_min": -108.98625685188074}, "training_iteration": 15, "episodes_total": 202, "episode_len_mean": 693.43, "timestamp": 1557205493, "time_total_s": 418.06270718574524, "pid": 32008, "info": {"num_steps_trained": 690355, "num_steps_sampled": 690355, "load_time_ms": 14.612, "grad_time_ms": 10495.887, "sample_time_ms": 15873.529, "update_time_ms": 8.018, "default": {"vf_explained_var": 0.9757554531097412, "vf_loss": 3.4817330837249756, "entropy": 1.3366295099258423, "cur_lr": 0.0005000000237487257, "total_loss": 3.480102300643921, "kl": 0.007492963224649429, "policy_loss": -0.0020055922213941813, "cur_kl_coeff": 0.05000000819563866}}, "time_this_iter_s": 27.125345468521118, "timesteps_since_restore": 690355, "time_since_restore": 418.06270718574524, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 50048, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4048>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4fd0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-04-53", "hostname": "flow-main", "episodes_this_iter": 9, "episode_reward_min": 57.388507802895646}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1385.0389125303634, "node_ip": "10.138.0.2", "timesteps_total": 738260, "iterations_since_restore": 16, "episode_reward_mean": 1211.783378705668, "custom_metrics": {"cost1_max": 352.48947696572213, "cost1_mean": 297.59893342159563, "system_level_velocity_mean": 11.197243240913705, "outflow_rate_max": 1097.8316612093788, "cost1_min": 28.780664226624328, "system_level_velocity_max": 19.555431365667637, "system_level_velocity_min": 8.65829417085536, "outflow_rate_min": 329.6337234057179, "cost2_max": -11.406649310085433, "cost2_mean": -71.99486199843086, "outflow_rate_mean": 896.7468694805518, "cost2_min": -108.98625685188074}, "training_iteration": 16, "episodes_total": 216, "episode_len_mean": 693.43, "timestamp": 1557205521, "time_total_s": 446.9567949771881, "pid": 32008, "info": {"num_steps_trained": 738260, "num_steps_sampled": 738260, "load_time_ms": 14.788, "grad_time_ms": 10741.028, "sample_time_ms": 15960.41, "update_time_ms": 8.183, "default": {"vf_explained_var": 0.9834387302398682, "vf_loss": 3.611050605773926, "entropy": 1.331006407737732, "cur_lr": 0.0005000000237487257, "total_loss": 3.6092450618743896, "kl": 0.006031757220625877, "policy_loss": -0.002106503816321492, "cur_kl_coeff": 0.05000000819563866}}, "time_this_iter_s": 28.89408779144287, "timesteps_since_restore": 738260, "time_since_restore": 446.9567949771881, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 47905, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66b13f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7588>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7048>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-05-21", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 57.388507802895646}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1375.766831918132, "node_ip": "10.138.0.2", "timesteps_total": 787498, "iterations_since_restore": 17, "episode_reward_mean": 1193.753619328626, "custom_metrics": {"cost1_max": 352.48947696572213, "cost1_mean": 293.7602520595943, "system_level_velocity_mean": 11.075059704711816, "outflow_rate_max": 1097.8316612093788, "cost1_min": 28.780664226624328, "system_level_velocity_max": 19.555431365667637, "system_level_velocity_min": 8.65829417085536, "outflow_rate_min": 329.6337234057179, "cost2_max": -11.406649310085433, "cost2_mean": -73.72905062719298, "outflow_rate_mean": 870.6496000016427, "cost2_min": -108.98625685188074}, "training_iteration": 17, "episodes_total": 233, "episode_len_mean": 693.43, "timestamp": 1557205549, "time_total_s": 474.9275047779083, "pid": 32008, "info": {"num_steps_trained": 787498, "num_steps_sampled": 787498, "load_time_ms": 14.768, "grad_time_ms": 10948.643, "sample_time_ms": 15966.876, "update_time_ms": 7.939, "default": {"vf_explained_var": 0.9851493835449219, "vf_loss": 2.9212310314178467, "entropy": 1.3254607915878296, "cur_lr": 0.0005000000237487257, "total_loss": 2.9198334217071533, "kl": 0.008044685237109661, "policy_loss": -0.0017993212677538395, "cur_kl_coeff": 0.05000000819563866}}, "time_this_iter_s": 27.970709800720215, "timesteps_since_restore": 787498, "time_since_restore": 474.9275047779083, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 49238, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa128>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aac88>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-05-49", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 57.388507802895646}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1375.766831918132, "node_ip": "10.138.0.2", "timesteps_total": 837803, "iterations_since_restore": 18, "episode_reward_mean": 1206.3588979611632, "custom_metrics": {"cost1_max": 352.48947696572213, "cost1_mean": 295.8584631255946, "system_level_velocity_mean": 10.978639017329368, "outflow_rate_max": 1097.8316612093788, "cost1_min": 232.05628724238073, "system_level_velocity_max": 12.990427154753416, "system_level_velocity_min": 8.65829417085536, "outflow_rate_min": 548.8599661311661, "cost2_max": -46.69731347062064, "cost2_mean": -75.4571233829505, "outflow_rate_mean": 876.0470317938511, "cost2_min": -108.98625685188074}, "training_iteration": 18, "episodes_total": 242, "episode_len_mean": 700.0, "timestamp": 1557205577, "time_total_s": 502.23532366752625, "pid": 32008, "info": {"num_steps_trained": 837803, "num_steps_sampled": 837803, "load_time_ms": 14.758, "grad_time_ms": 11298.787, "sample_time_ms": 15603.483, "update_time_ms": 7.637, "default": {"vf_explained_var": 0.9801512360572815, "vf_loss": 3.75612211227417, "entropy": 1.3267955780029297, "cur_lr": 0.0005000000237487257, "total_loss": 3.7551231384277344, "kl": 0.007376592140644789, "policy_loss": -0.0013678868999704719, "cur_kl_coeff": 0.05000000447034836}}, "time_this_iter_s": 27.30781888961792, "timesteps_since_restore": 837803, "time_since_restore": 502.23532366752625, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 50305, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4a90>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4048>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-06-17", "hostname": "flow-main", "episodes_this_iter": 9, "episode_reward_min": 964.7554746071897}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1375.766831918132, "node_ip": "10.138.0.2", "timesteps_total": 884370, "iterations_since_restore": 19, "episode_reward_mean": 1207.9586988735057, "custom_metrics": {"cost1_max": 355.1319943991754, "cost1_mean": 297.20094043446227, "system_level_velocity_mean": 11.061300983121715, "outflow_rate_max": 1097.8316612093788, "cost1_min": 232.05628724238073, "system_level_velocity_max": 13.229616737909998, "system_level_velocity_min": 8.65829417085536, "outflow_rate_min": 548.8599661311661, "cost2_max": -46.69731347062064, "cost2_mean": -77.56552942346035, "outflow_rate_mean": 874.753983129331, "cost2_min": -108.98625685188074}, "training_iteration": 19, "episodes_total": 256, "episode_len_mean": 700.0, "timestamp": 1557205603, "time_total_s": 528.8521459102631, "pid": 32008, "info": {"num_steps_trained": 884370, "num_steps_sampled": 884370, "load_time_ms": 14.395, "grad_time_ms": 11547.678, "sample_time_ms": 15518.921, "update_time_ms": 7.569, "default": {"vf_explained_var": 0.9780493974685669, "vf_loss": 5.091838359832764, "entropy": 1.3287010192871094, "cur_lr": 0.0005000000237487257, "total_loss": 5.090147972106934, "kl": 0.006405188236385584, "policy_loss": -0.0020102744456380606, "cur_kl_coeff": 0.05000000819563866}}, "time_this_iter_s": 26.616822242736816, "timesteps_since_restore": 884370, "time_since_restore": 528.8521459102631, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 46567, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b48d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4a20>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4c50>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-06-43", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 964.7554746071897}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1400.653906937433, "node_ip": "10.138.0.2", "timesteps_total": 930965, "iterations_since_restore": 20, "episode_reward_mean": 1205.9215980998629, "custom_metrics": {"cost1_max": 362.30288409357996, "cost1_mean": 298.3045836614676, "system_level_velocity_mean": 11.306219906270048, "outflow_rate_max": 1100.5947673069197, "cost1_min": 34.53682659443245, "system_level_velocity_max": 19.591567765074203, "system_level_velocity_min": 8.65829417085536, "outflow_rate_min": 324.8763846761304, "cost2_max": -18.60896612178377, "cost2_mean": -83.49737197327157, "outflow_rate_mean": 883.8032231281337, "cost2_min": -124.02180848230293}, "training_iteration": 20, "episodes_total": 275, "episode_len_mean": 693.5, "timestamp": 1557205631, "time_total_s": 556.5561900138855, "pid": 32008, "info": {"num_steps_trained": 930965, "num_steps_sampled": 930965, "load_time_ms": 14.763, "grad_time_ms": 11799.983, "sample_time_ms": 15414.322, "update_time_ms": 7.536, "default": {"vf_explained_var": 0.9514005184173584, "vf_loss": 8.9055757522583, "entropy": 1.3198816776275635, "cur_lr": 0.0005000000237487257, "total_loss": 8.903465270996094, "kl": 0.008977752178907394, "policy_loss": -0.002559593878686428, "cur_kl_coeff": 0.05000000819563866}}, "time_this_iter_s": 27.704044103622437, "timesteps_since_restore": 930965, "time_since_restore": 556.5561900138855, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 46595, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4400>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b41d0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-07-11", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 69.86965811246624}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1400.653906937433, "node_ip": "10.138.0.2", "timesteps_total": 978677, "iterations_since_restore": 21, "episode_reward_mean": 1210.9926658267866, "custom_metrics": {"cost1_max": 362.30288409357996, "cost1_mean": 301.28115232821176, "system_level_velocity_mean": 11.415516588359901, "outflow_rate_max": 1100.5947673069197, "cost1_min": 34.53682659443245, "system_level_velocity_max": 19.591567765074203, "system_level_velocity_min": 9.082953158093197, "outflow_rate_min": 324.8763846761304, "cost2_max": -18.60896612178377, "cost2_mean": -84.56898008012124, "outflow_rate_mean": 891.6277589708211, "cost2_min": -124.02180848230293}, "training_iteration": 21, "episodes_total": 282, "episode_len_mean": 693.5, "timestamp": 1557205658, "time_total_s": 583.7605135440826, "pid": 32008, "info": {"num_steps_trained": 978677, "num_steps_sampled": 978677, "load_time_ms": 15.255, "grad_time_ms": 11999.122, "sample_time_ms": 15222.449, "update_time_ms": 7.503, "default": {"vf_explained_var": 0.9794374108314514, "vf_loss": 3.4493253231048584, "entropy": 1.3083443641662598, "cur_lr": 0.0005000000237487257, "total_loss": 3.4471869468688965, "kl": 0.008568926714360714, "policy_loss": -0.0025671261828392744, "cur_kl_coeff": 0.05000000447034836}}, "time_this_iter_s": 27.204323530197144, "timesteps_since_restore": 978677, "time_since_restore": 583.7605135440826, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 47712, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7438>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7e80>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-07-38", "hostname": "flow-main", "episodes_this_iter": 7, "episode_reward_min": 69.86965811246624}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1400.653906937433, "node_ip": "10.138.0.2", "timesteps_total": 1026177, "iterations_since_restore": 22, "episode_reward_mean": 1202.917157776209, "custom_metrics": {"cost1_max": 362.30288409357996, "cost1_mean": 300.9680990122817, "system_level_velocity_mean": 11.575719995214838, "outflow_rate_max": 1100.5947673069197, "cost1_min": 34.11810009835759, "system_level_velocity_max": 19.591567765074203, "system_level_velocity_min": 9.082953158093197, "outflow_rate_min": 324.8763846761304, "cost2_max": -14.941498927031288, "cost2_mean": -83.51999651744987, "outflow_rate_mean": 897.0666218703686, "cost2_min": -124.02180848230293}, "training_iteration": 22, "episodes_total": 298, "episode_len_mean": 687.0, "timestamp": 1557205685, "time_total_s": 610.3455395698547, "pid": 32008, "info": {"num_steps_trained": 1026177, "num_steps_sampled": 1026177, "load_time_ms": 15.193, "grad_time_ms": 12088.058, "sample_time_ms": 15161.599, "update_time_ms": 8.023, "default": {"vf_explained_var": 0.9534025192260742, "vf_loss": 8.811728477478027, "entropy": 1.2911632061004639, "cur_lr": 0.0005000000237487257, "total_loss": 8.810452461242676, "kl": 0.009120769798755646, "policy_loss": -0.0017331222770735621, "cur_kl_coeff": 0.05000000819563866}}, "time_this_iter_s": 26.585026025772095, "timesteps_since_restore": 1026177, "time_since_restore": 610.3455395698547, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 47500, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4cc0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4d30>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-08-05", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 63.629773007366154}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1400.653906937433, "node_ip": "10.138.0.2", "timesteps_total": 1070476, "iterations_since_restore": 23, "episode_reward_mean": 1218.4860283026542, "custom_metrics": {"cost1_max": 362.30288409357996, "cost1_mean": 304.036194514956, "system_level_velocity_mean": 11.67983409923541, "outflow_rate_max": 1100.5947673069197, "cost1_min": 34.11810009835759, "system_level_velocity_max": 19.591567765074203, "system_level_velocity_min": 9.082953158093197, "outflow_rate_min": 324.8763846761304, "cost2_max": -14.941498927031288, "cost2_mean": -85.36594344832503, "outflow_rate_mean": 914.4586054300482, "cost2_min": -124.02180848230293}, "training_iteration": 23, "episodes_total": 314, "episode_len_mean": 687.0, "timestamp": 1557205711, "time_total_s": 636.4432682991028, "pid": 32008, "info": {"num_steps_trained": 1070476, "num_steps_sampled": 1070476, "load_time_ms": 14.954, "grad_time_ms": 12054.804, "sample_time_ms": 15033.627, "update_time_ms": 8.254, "default": {"vf_explained_var": 0.9755356907844543, "vf_loss": 5.425457000732422, "entropy": 1.2769804000854492, "cur_lr": 0.0005000000237487257, "total_loss": 5.424388885498047, "kl": 0.007723124232143164, "policy_loss": -0.0014540889533236623, "cur_kl_coeff": 0.05000000819563866}}, "time_this_iter_s": 26.097728729248047, "timesteps_since_restore": 1070476, "time_since_restore": 636.4432682991028, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44299, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa9e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa6d8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa710>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-08-31", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 63.629773007366154}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1416.1652660415864, "node_ip": "10.138.0.2", "timesteps_total": 1118977, "iterations_since_restore": 24, "episode_reward_mean": 1221.1377010653935, "custom_metrics": {"cost1_max": 362.30288409357996, "cost1_mean": 306.3566243531358, "system_level_velocity_mean": 11.752729794024221, "outflow_rate_max": 1100.5947673069197, "cost1_min": 34.11810009835759, "system_level_velocity_max": 19.591567765074203, "system_level_velocity_min": 9.553903881130486, "outflow_rate_min": 324.8763846761304, "cost2_max": -14.941498927031288, "cost2_mean": -86.57542682629413, "outflow_rate_mean": 925.0401452654537, "cost2_min": -124.02180848230293}, "training_iteration": 24, "episodes_total": 325, "episode_len_mean": 687.0, "timestamp": 1557205739, "time_total_s": 664.2465660572052, "pid": 32008, "info": {"num_steps_trained": 1118977, "num_steps_sampled": 1118977, "load_time_ms": 14.993, "grad_time_ms": 12092.418, "sample_time_ms": 15114.582, "update_time_ms": 7.865, "default": {"vf_explained_var": 0.9773325324058533, "vf_loss": 3.6012485027313232, "entropy": 1.2699360847473145, "cur_lr": 0.0005000000237487257, "total_loss": 3.6000564098358154, "kl": 0.008804797194898129, "policy_loss": -0.0016323135932907462, "cur_kl_coeff": 0.05000000447034836}}, "time_this_iter_s": 27.803297758102417, "timesteps_since_restore": 1118977, "time_since_restore": 664.2465660572052, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 48501, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b42e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4908>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4400>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-08-59", "hostname": "flow-main", "episodes_this_iter": 11, "episode_reward_min": 63.629773007366154}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1421.648012053072, "node_ip": "10.138.0.2", "timesteps_total": 1163198, "iterations_since_restore": 25, "episode_reward_mean": 1238.025191164848, "custom_metrics": {"cost1_max": 362.30288409357996, "cost1_mean": 309.31962936543454, "system_level_velocity_mean": 11.846088152586425, "outflow_rate_max": 1100.5947673069197, "cost1_min": 34.11810009835759, "system_level_velocity_max": 19.591567765074203, "system_level_velocity_min": 9.966374504255466, "outflow_rate_min": 324.8763846761304, "cost2_max": -14.941498927031288, "cost2_mean": -87.92778822841075, "outflow_rate_mean": 944.1652086273497, "cost2_min": -124.02180848230293}, "training_iteration": 25, "episodes_total": 340, "episode_len_mean": 687.0, "timestamp": 1557205765, "time_total_s": 690.6831939220428, "pid": 32008, "info": {"num_steps_trained": 1163198, "num_steps_sampled": 1163198, "load_time_ms": 15.308, "grad_time_ms": 11923.415, "sample_time_ms": 15215.228, "update_time_ms": 7.86, "default": {"vf_explained_var": 0.9830225110054016, "vf_loss": 4.191463470458984, "entropy": 1.2671352624893188, "cur_lr": 0.0005000000237487257, "total_loss": 4.189298629760742, "kl": 0.009064012207090855, "policy_loss": -0.002617803169414401, "cur_kl_coeff": 0.050000011920928955}}, "time_this_iter_s": 26.436627864837646, "timesteps_since_restore": 1163198, "time_since_restore": 690.6831939220428, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44221, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7978>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a72b0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-09-25", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 63.629773007366154}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1478.3874480951708, "node_ip": "10.138.0.2", "timesteps_total": 1207990, "iterations_since_restore": 26, "episode_reward_mean": 1253.522633571881, "custom_metrics": {"cost1_max": 381.0344309987384, "cost1_mean": 314.99194241221625, "system_level_velocity_mean": 12.021034041180394, "outflow_rate_max": 1100.5947673069197, "cost1_min": 34.11810009835759, "system_level_velocity_max": 19.591567765074203, "system_level_velocity_min": 10.135621655848574, "outflow_rate_min": 324.8763846761304, "cost2_max": -14.941498927031288, "cost2_mean": -86.0706341315612, "outflow_rate_mean": 963.3405188453912, "cost2_min": -124.02180848230293}, "training_iteration": 26, "episodes_total": 359, "episode_len_mean": 687.0, "timestamp": 1557205792, "time_total_s": 716.7872710227966, "pid": 32008, "info": {"num_steps_trained": 1207990, "num_steps_sampled": 1207990, "load_time_ms": 15.303, "grad_time_ms": 11636.501, "sample_time_ms": 15223.947, "update_time_ms": 7.87, "default": {"vf_explained_var": 0.9632430076599121, "vf_loss": 7.521993637084961, "entropy": 1.2742904424667358, "cur_lr": 0.0005000000237487257, "total_loss": 7.520562171936035, "kl": 0.01028494443744421, "policy_loss": -0.0019448446109890938, "cur_kl_coeff": 0.050000011920928955}}, "time_this_iter_s": 26.104077100753784, "timesteps_since_restore": 1207990, "time_since_restore": 716.7872710227966, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44792, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4cc0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b47f0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-09-52", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 63.629773007366154}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1538.9136616016083, "node_ip": "10.138.0.2", "timesteps_total": 1254247, "iterations_since_restore": 27, "episode_reward_mean": 1262.3792366981697, "custom_metrics": {"cost1_max": 381.0344309987384, "cost1_mean": 317.58712652503147, "system_level_velocity_mean": 12.107343004709337, "outflow_rate_max": 1163.6352400111964, "cost1_min": 34.11810009835759, "system_level_velocity_max": 19.591567765074203, "system_level_velocity_min": 10.135621655848574, "outflow_rate_min": 324.8763846761304, "cost2_max": -14.941498927031288, "cost2_mean": -83.84546266562761, "outflow_rate_mean": 969.0559320958164, "cost2_min": -124.02180848230293}, "training_iteration": 27, "episodes_total": 368, "episode_len_mean": 687.0, "timestamp": 1557205818, "time_total_s": 743.3701019287109, "pid": 32008, "info": {"num_steps_trained": 1254247, "num_steps_sampled": 1254247, "load_time_ms": 15.751, "grad_time_ms": 11483.58, "sample_time_ms": 15235.296, "update_time_ms": 8.03, "default": {"vf_explained_var": 0.9747668504714966, "vf_loss": 4.346541881561279, "entropy": 1.2606046199798584, "cur_lr": 0.0005000000237487257, "total_loss": 4.344627857208252, "kl": 0.008949087001383305, "policy_loss": -0.0023617784027010202, "cur_kl_coeff": 0.05000000819563866}}, "time_this_iter_s": 26.582830905914307, "timesteps_since_restore": 1254247, "time_since_restore": 743.3701019287109, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 46257, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9d68>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9da0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-10-18", "hostname": "flow-main", "episodes_this_iter": 9, "episode_reward_min": 63.629773007366154}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1538.9136616016083, "node_ip": "10.138.0.2", "timesteps_total": 1298670, "iterations_since_restore": 28, "episode_reward_mean": 1274.2651085108077, "custom_metrics": {"cost1_max": 381.0344309987384, "cost1_mean": 322.2628499402661, "system_level_velocity_mean": 12.280625212086234, "outflow_rate_max": 1163.6352400111964, "cost1_min": 29.239166648811683, "system_level_velocity_max": 19.93365419310587, "system_level_velocity_min": 10.135621655848574, "outflow_rate_min": 326.3279975793562, "cost2_max": -13.675383819819183, "cost2_mean": -80.13804777016865, "outflow_rate_mean": 984.7573859639726, "cost2_min": -112.41306243780568}, "training_iteration": 28, "episodes_total": 383, "episode_len_mean": 686.93, "timestamp": 1557205845, "time_total_s": 770.5907635688782, "pid": 32008, "info": {"num_steps_trained": 1298670, "num_steps_sampled": 1298670, "load_time_ms": 16.131, "grad_time_ms": 11135.968, "sample_time_ms": 15573.539, "update_time_ms": 8.372, "default": {"vf_explained_var": 0.959247350692749, "vf_loss": 8.537687301635742, "entropy": 1.2435585260391235, "cur_lr": 0.0005000000237487257, "total_loss": 8.536064147949219, "kl": 0.00904365535825491, "policy_loss": -0.0020752022974193096, "cur_kl_coeff": 0.05000000819563866}}, "time_this_iter_s": 27.220661640167236, "timesteps_since_restore": 1298670, "time_since_restore": 770.5907635688782, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44423, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b47b8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7f60>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-10-45", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 57.87065593584483}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1538.9136616016083, "node_ip": "10.138.0.2", "timesteps_total": 1343804, "iterations_since_restore": 29, "episode_reward_mean": 1300.2984186400533, "custom_metrics": {"cost1_max": 388.8699957913654, "cost1_mean": 330.98202310422414, "system_level_velocity_mean": 12.433639882017857, "outflow_rate_max": 1163.6352400111964, "cost1_min": 29.239166648811683, "system_level_velocity_max": 19.93365419310587, "system_level_velocity_min": 10.135621655848574, "outflow_rate_min": 329.6337234057179, "cost2_max": -13.675383819819183, "cost2_mean": -78.87516717715775, "outflow_rate_mean": 1011.3869419440147, "cost2_min": -112.41306243780568}, "training_iteration": 29, "episodes_total": 399, "episode_len_mean": 693.43, "timestamp": 1557205872, "time_total_s": 797.3334968090057, "pid": 32008, "info": {"num_steps_trained": 1343804, "num_steps_sampled": 1343804, "load_time_ms": 16.762, "grad_time_ms": 10979.309, "sample_time_ms": 15744.121, "update_time_ms": 8.42, "default": {"vf_explained_var": 0.9472945928573608, "vf_loss": 9.18509578704834, "entropy": 1.2414721250534058, "cur_lr": 0.0005000000237487257, "total_loss": 9.184203147888184, "kl": 0.008508658967912197, "policy_loss": -0.0013188316952437162, "cur_kl_coeff": 0.05000000819563866}}, "time_this_iter_s": 26.742733240127563, "timesteps_since_restore": 1343804, "time_since_restore": 797.3334968090057, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 45134, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c10f0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9e48>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-11-12", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 57.87065593584483}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1538.9136616016083, "node_ip": "10.138.0.2", "timesteps_total": 1387850, "iterations_since_restore": 30, "episode_reward_mean": 1306.1840944084934, "custom_metrics": {"cost1_max": 388.8699957913654, "cost1_mean": 332.6684557951848, "system_level_velocity_mean": 12.503693929343234, "outflow_rate_max": 1163.6352400111964, "cost1_min": 29.239166648811683, "system_level_velocity_max": 19.93365419310587, "system_level_velocity_min": 10.135621655848574, "outflow_rate_min": 329.6337234057179, "cost2_max": -13.675383819819183, "cost2_mean": -77.05912444304235, "outflow_rate_mean": 1018.0268352291448, "cost2_min": -112.41306243780568}, "training_iteration": 30, "episodes_total": 409, "episode_len_mean": 693.43, "timestamp": 1557205897, "time_total_s": 822.4582371711731, "pid": 32008, "info": {"num_steps_trained": 1387850, "num_steps_sampled": 1387850, "load_time_ms": 16.776, "grad_time_ms": 10740.575, "sample_time_ms": 15724.662, "update_time_ms": 8.704, "default": {"vf_explained_var": 0.9728063344955444, "vf_loss": 6.068574905395508, "entropy": 1.2261912822723389, "cur_lr": 0.0005000000237487257, "total_loss": 6.066687107086182, "kl": 0.011744765564799309, "policy_loss": -0.002475597197189927, "cur_kl_coeff": 0.05000000819563866}}, "time_this_iter_s": 25.12474036216736, "timesteps_since_restore": 1387850, "time_since_restore": 822.4582371711731, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44046, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9e80>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9d68>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-11-37", "hostname": "flow-main", "episodes_this_iter": 10, "episode_reward_min": 57.87065593584483}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1538.9136616016083, "node_ip": "10.138.0.2", "timesteps_total": 1428173, "iterations_since_restore": 31, "episode_reward_mean": 1307.7903934257051, "custom_metrics": {"cost1_max": 402.46456692195414, "cost1_mean": 340.03610251877035, "system_level_velocity_mean": 12.953669681769115, "outflow_rate_max": 1186.341367845713, "cost1_min": 29.239166648811683, "system_level_velocity_max": 19.93365419310587, "system_level_velocity_min": 10.28530844580744, "outflow_rate_min": 329.6337234057179, "cost2_max": -13.675383819819183, "cost2_mean": -70.63820924736662, "outflow_rate_mean": 1035.5437656151146, "cost2_min": -108.40410963407338}, "training_iteration": 31, "episodes_total": 430, "episode_len_mean": 688.1, "timestamp": 1557205922, "time_total_s": 847.5166656970978, "pid": 32008, "info": {"num_steps_trained": 1428173, "num_steps_sampled": 1428173, "load_time_ms": 16.18, "grad_time_ms": 10406.716, "sample_time_ms": 15846.528, "update_time_ms": 8.798, "default": {"vf_explained_var": 0.95425945520401, "vf_loss": 12.636865615844727, "entropy": 1.2169545888900757, "cur_lr": 0.0005000000237487257, "total_loss": 12.634602546691895, "kl": 0.01170498039573431, "policy_loss": -0.002848359290510416, "cur_kl_coeff": 0.05000000447034836}}, "time_this_iter_s": 25.058428525924683, "timesteps_since_restore": 1428173, "time_since_restore": 847.5166656970978, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 40323, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9b38>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9940>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-12-02", "hostname": "flow-main", "episodes_this_iter": 21, "episode_reward_min": 57.87065593584483}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1538.9136616016083, "node_ip": "10.138.0.2", "timesteps_total": 1472948, "iterations_since_restore": 32, "episode_reward_mean": 1303.2504478228113, "custom_metrics": {"cost1_max": 414.43240167995543, "cost1_mean": 345.24992852984406, "system_level_velocity_mean": 13.317894722485065, "outflow_rate_max": 1199.791292695922, "cost1_min": 29.239166648811683, "system_level_velocity_max": 19.93365419310587, "system_level_velocity_min": 10.862341920067843, "outflow_rate_min": 329.6337234057179, "cost2_max": -13.675383819819183, "cost2_mean": -66.0943001890495, "outflow_rate_mean": 1049.0055980827944, "cost2_min": -98.73409366054213}, "training_iteration": 32, "episodes_total": 448, "episode_len_mean": 682.66, "timestamp": 1557205950, "time_total_s": 875.5119867324829, "pid": 32008, "info": {"num_steps_trained": 1472948, "num_steps_sampled": 1472948, "load_time_ms": 16.085, "grad_time_ms": 10212.291, "sample_time_ms": 16182.784, "update_time_ms": 8.512, "default": {"vf_explained_var": 0.9406852126121521, "vf_loss": 12.031111717224121, "entropy": 1.229337453842163, "cur_lr": 0.0005000000237487257, "total_loss": 12.02945327758789, "kl": 0.00983965490013361, "policy_loss": -0.0021495434921234846, "cur_kl_coeff": 0.050000011920928955}}, "time_this_iter_s": 27.995321035385132, "timesteps_since_restore": 1472948, "time_since_restore": 875.5119867324829, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44775, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b49b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4588>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4240>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-12-30", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 57.87065593584483}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1538.9136616016083, "node_ip": "10.138.0.2", "timesteps_total": 1515367, "iterations_since_restore": 33, "episode_reward_mean": 1304.9299774547885, "custom_metrics": {"cost1_max": 416.40448069982733, "cost1_mean": 347.41758674431685, "system_level_velocity_mean": 13.404273353549897, "outflow_rate_max": 1245.2157886779885, "cost1_min": 29.239166648811683, "system_level_velocity_max": 19.93365419310587, "system_level_velocity_min": 10.862341920067843, "outflow_rate_min": 329.6337234057179, "cost2_max": -13.675383819819183, "cost2_mean": -64.58721390645113, "outflow_rate_mean": 1055.3071693597094, "cost2_min": -96.50823655159647}, "training_iteration": 33, "episodes_total": 456, "episode_len_mean": 682.66, "timestamp": 1557205975, "time_total_s": 900.5023398399353, "pid": 32008, "info": {"num_steps_trained": 1515367, "num_steps_sampled": 1515367, "load_time_ms": 16.049, "grad_time_ms": 10019.95, "sample_time_ms": 16266.894, "update_time_ms": 8.441, "default": {"vf_explained_var": 0.969131588935852, "vf_loss": 5.349214553833008, "entropy": 1.1921626329421997, "cur_lr": 0.0005000000237487257, "total_loss": 5.346680641174316, "kl": 0.010611607693135738, "policy_loss": -0.0030640217009931803, "cur_kl_coeff": 0.05000000819563866}}, "time_this_iter_s": 24.990353107452393, "timesteps_since_restore": 1515367, "time_since_restore": 900.5023398399353, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42419, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1dd8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b49e8>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-12-55", "hostname": "flow-main", "episodes_this_iter": 8, "episode_reward_min": 57.87065593584483}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1504.4328473329642, "node_ip": "10.138.0.2", "timesteps_total": 1558836, "iterations_since_restore": 34, "episode_reward_mean": 1305.8114814839623, "custom_metrics": {"cost1_max": 416.40448069982733, "cost1_mean": 352.7211325607718, "system_level_velocity_mean": 13.614893467744416, "outflow_rate_max": 1245.2157886779885, "cost1_min": 29.239166648811683, "system_level_velocity_max": 19.93365419310587, "system_level_velocity_min": 10.862341920067843, "outflow_rate_min": 329.6337234057179, "cost2_max": -13.675383819819183, "cost2_mean": -61.01666950752698, "outflow_rate_mean": 1071.8372356409518, "cost2_min": -81.70742870818057}, "training_iteration": 34, "episodes_total": 475, "episode_len_mean": 682.66, "timestamp": 1557206002, "time_total_s": 927.0591421127319, "pid": 32008, "info": {"num_steps_trained": 1558836, "num_steps_sampled": 1558836, "load_time_ms": 15.689, "grad_time_ms": 9712.672, "sample_time_ms": 16453.636, "update_time_ms": 8.466, "default": {"vf_explained_var": 0.9404950141906738, "vf_loss": 13.572386741638184, "entropy": 1.2097057104110718, "cur_lr": 0.0005000000237487257, "total_loss": 13.570792198181152, "kl": 0.007877052761614323, "policy_loss": -0.001989558804780245, "cur_kl_coeff": 0.05000000819563866}}, "time_this_iter_s": 26.55680227279663, "timesteps_since_restore": 1558836, "time_since_restore": 927.0591421127319, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43469, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b44a8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4898>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-13-22", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 57.87065593584483}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1534.3392116488026, "node_ip": "10.138.0.2", "timesteps_total": 1602570, "iterations_since_restore": 35, "episode_reward_mean": 1325.1098425653543, "custom_metrics": {"cost1_max": 416.40448069982733, "cost1_mean": 357.9023717633183, "system_level_velocity_mean": 13.633638624394187, "outflow_rate_max": 1287.4639094322342, "cost1_min": 103.96128671943865, "system_level_velocity_max": 18.279903529504967, "system_level_velocity_min": 10.862341920067843, "outflow_rate_min": 437.47536734080916, "cost2_max": -25.12217680060441, "cost2_mean": -60.82519164108911, "outflow_rate_mean": 1086.4050616531008, "cost2_min": -81.70742870818057}, "training_iteration": 35, "episodes_total": 489, "episode_len_mean": 689.23, "timestamp": 1557206027, "time_total_s": 952.2893009185791, "pid": 32008, "info": {"num_steps_trained": 1602570, "num_steps_sampled": 1602570, "load_time_ms": 15.242, "grad_time_ms": 9617.459, "sample_time_ms": 16429.386, "update_time_ms": 8.27, "default": {"vf_explained_var": 0.9504256844520569, "vf_loss": 11.80882740020752, "entropy": 1.237399935722351, "cur_lr": 0.0005000000237487257, "total_loss": 11.806205749511719, "kl": 0.013258514925837517, "policy_loss": -0.003283933736383915, "cur_kl_coeff": 0.05000000819563866}}, "time_this_iter_s": 25.230158805847168, "timesteps_since_restore": 1602570, "time_since_restore": 952.2893009185791, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43734, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd0b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdb70>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd0f0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-13-47", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 297.9150400505794}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1534.3392116488026, "node_ip": "10.138.0.2", "timesteps_total": 1644798, "iterations_since_restore": 36, "episode_reward_mean": 1315.7323726309091, "custom_metrics": {"cost1_max": 424.96562972721284, "cost1_mean": 361.88438258110904, "system_level_velocity_mean": 13.80688070568242, "outflow_rate_max": 1287.4639094322342, "cost1_min": 103.96128671943865, "system_level_velocity_max": 18.279903529504967, "system_level_velocity_min": 11.22784650535238, "outflow_rate_min": 437.47536734080916, "cost2_max": -25.12217680060441, "cost2_mean": -61.00943039170294, "outflow_rate_mean": 1096.4623848402025, "cost2_min": -81.70742870818057}, "training_iteration": 36, "episodes_total": 505, "episode_len_mean": 689.23, "timestamp": 1557206052, "time_total_s": 977.2813267707825, "pid": 32008, "info": {"num_steps_trained": 1644798, "num_steps_sampled": 1644798, "load_time_ms": 15.279, "grad_time_ms": 9483.854, "sample_time_ms": 16452.931, "update_time_ms": 8.273, "default": {"vf_explained_var": 0.9491028189659119, "vf_loss": 12.472392082214355, "entropy": 1.219671607017517, "cur_lr": 0.0005000000237487257, "total_loss": 12.468928337097168, "kl": 0.01069801114499569, "policy_loss": -0.003999733366072178, "cur_kl_coeff": 0.05000000074505806}}, "time_this_iter_s": 24.99202585220337, "timesteps_since_restore": 1644798, "time_since_restore": 977.2813267707825, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42228, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd7b8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd2e8>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-14-12", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 297.9150400505794}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1534.3392116488026, "node_ip": "10.138.0.2", "timesteps_total": 1687243, "iterations_since_restore": 37, "episode_reward_mean": 1303.506525100017, "custom_metrics": {"cost1_max": 478.66392894974007, "cost1_mean": 363.71895552110016, "system_level_velocity_mean": 14.098375066267252, "outflow_rate_max": 1331.1304590222633, "cost1_min": 30.790858421037846, "system_level_velocity_max": 19.93222657171282, "system_level_velocity_min": 11.442097611406332, "outflow_rate_min": 328.8236585015129, "cost2_max": -15.662300157218846, "cost2_mean": -60.96180820274827, "outflow_rate_mean": 1103.7149534594496, "cost2_min": -86.44706608601957}, "training_iteration": 37, "episodes_total": 524, "episode_len_mean": 682.68, "timestamp": 1557206079, "time_total_s": 1003.8445475101471, "pid": 32008, "info": {"num_steps_trained": 1687243, "num_steps_sampled": 1687243, "load_time_ms": 15.049, "grad_time_ms": 9366.679, "sample_time_ms": 16570.342, "update_time_ms": 8.12, "default": {"vf_explained_var": 0.9334254860877991, "vf_loss": 17.96249771118164, "entropy": 1.2400262355804443, "cur_lr": 0.0005000000237487257, "total_loss": 17.960002899169922, "kl": 0.01219487376511097, "policy_loss": -0.0031057498417794704, "cur_kl_coeff": 0.05000000819563866}}, "time_this_iter_s": 26.563220739364624, "timesteps_since_restore": 1687243, "time_since_restore": 1003.8445475101471, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42445, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1d68>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c19b0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-14-39", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 62.80251362028618}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1534.3392116488026, "node_ip": "10.138.0.2", "timesteps_total": 1731536, "iterations_since_restore": 38, "episode_reward_mean": 1314.3785692054691, "custom_metrics": {"cost1_max": 478.66392894974007, "cost1_mean": 369.772904708485, "system_level_velocity_mean": 14.200333311940913, "outflow_rate_max": 1331.1304590222633, "cost1_min": 30.790858421037846, "system_level_velocity_max": 19.93222657171282, "system_level_velocity_min": 11.442097611406332, "outflow_rate_min": 328.8236585015129, "cost2_max": -15.662300157218846, "cost2_mean": -62.006918194633414, "outflow_rate_mean": 1118.362185798265, "cost2_min": -86.44706608601957}, "training_iteration": 38, "episodes_total": 535, "episode_len_mean": 688.01, "timestamp": 1557206105, "time_total_s": 1029.4831938743591, "pid": 32008, "info": {"num_steps_trained": 1731536, "num_steps_sampled": 1731536, "load_time_ms": 15.002, "grad_time_ms": 9270.032, "sample_time_ms": 16509.278, "update_time_ms": 7.792, "default": {"vf_explained_var": 0.9767369627952576, "vf_loss": 7.117528915405273, "entropy": 1.2438668012619019, "cur_lr": 0.0005000000237487257, "total_loss": 7.114925384521484, "kl": 0.011872346512973309, "policy_loss": -0.003196989418938756, "cur_kl_coeff": 0.05000000819563866}}, "time_this_iter_s": 25.638646364212036, "timesteps_since_restore": 1731536, "time_since_restore": 1029.4831938743591, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44293, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cda20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd320>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdda0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-15-05", "hostname": "flow-main", "episodes_this_iter": 11, "episode_reward_min": 62.80251362028618}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1534.3392116488026, "node_ip": "10.138.0.2", "timesteps_total": 1774696, "iterations_since_restore": 39, "episode_reward_mean": 1313.0972074910323, "custom_metrics": {"cost1_max": 478.66392894974007, "cost1_mean": 369.0103792480723, "system_level_velocity_mean": 14.245670385700272, "outflow_rate_max": 1354.5763279248276, "cost1_min": 30.790858421037846, "system_level_velocity_max": 19.93222657171282, "system_level_velocity_min": 11.442097611406332, "outflow_rate_min": 326.3279975793562, "cost2_max": -15.662300157218846, "cost2_mean": -64.84716206117594, "outflow_rate_mean": 1119.5443513137884, "cost2_min": -98.67329282366256}, "training_iteration": 39, "episodes_total": 552, "episode_len_mean": 686.95, "timestamp": 1557206130, "time_total_s": 1055.08371591568, "pid": 32008, "info": {"num_steps_trained": 1774696, "num_steps_sampled": 1774696, "load_time_ms": 14.519, "grad_time_ms": 9102.498, "sample_time_ms": 16564.053, "update_time_ms": 7.79, "default": {"vf_explained_var": 0.9619096517562866, "vf_loss": 11.190802574157715, "entropy": 1.1880171298980713, "cur_lr": 0.0005000000237487257, "total_loss": 11.188538551330566, "kl": 0.010743836872279644, "policy_loss": -0.002801344031468034, "cur_kl_coeff": 0.05000000819563866}}, "time_this_iter_s": 25.6005220413208, "timesteps_since_restore": 1774696, "time_since_restore": 1055.08371591568, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43160, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c10f0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1be0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-15-30", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 62.80251362028618}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1534.3392116488026, "node_ip": "10.138.0.2", "timesteps_total": 1817974, "iterations_since_restore": 40, "episode_reward_mean": 1309.9881426082916, "custom_metrics": {"cost1_max": 478.66392894974007, "cost1_mean": 370.7939125664364, "system_level_velocity_mean": 14.331608614650447, "outflow_rate_max": 1354.5763279248276, "cost1_min": 30.790858421037846, "system_level_velocity_max": 19.93222657171282, "system_level_velocity_min": 11.442097611406332, "outflow_rate_min": 326.3279975793562, "cost2_max": -15.662300157218846, "cost2_mean": -66.09929847882451, "outflow_rate_mean": 1122.142225343502, "cost2_min": -98.67329282366256}, "training_iteration": 40, "episodes_total": 567, "episode_len_mean": 686.95, "timestamp": 1557206156, "time_total_s": 1080.6648864746094, "pid": 32008, "info": {"num_steps_trained": 1817974, "num_steps_sampled": 1817974, "load_time_ms": 14.248, "grad_time_ms": 9070.428, "sample_time_ms": 16644.893, "update_time_ms": 7.456, "default": {"vf_explained_var": 0.9710471034049988, "vf_loss": 8.019641876220703, "entropy": 1.1860944032669067, "cur_lr": 0.0005000000237487257, "total_loss": 8.016904830932617, "kl": 0.010434653609991074, "policy_loss": -0.0032583256252110004, "cur_kl_coeff": 0.050000011920928955}}, "time_this_iter_s": 25.581170558929443, "timesteps_since_restore": 1817974, "time_since_restore": 1080.6648864746094, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43278, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd3c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd908>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdc18>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-15-56", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 62.80251362028618}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1501.137679282232, "node_ip": "10.138.0.2", "timesteps_total": 1861847, "iterations_since_restore": 41, "episode_reward_mean": 1288.4272206551786, "custom_metrics": {"cost1_max": 478.66392894974007, "cost1_mean": 365.7787412834787, "system_level_velocity_mean": 14.459336282062514, "outflow_rate_max": 1354.5763279248276, "cost1_min": 30.790858421037846, "system_level_velocity_max": 19.93222657171282, "system_level_velocity_min": 11.442097611406332, "outflow_rate_min": 326.3279975793562, "cost2_max": -15.662300157218846, "cost2_mean": -66.06721069464102, "outflow_rate_mean": 1108.7097602611057, "cost2_min": -98.67329282366256}, "training_iteration": 41, "episodes_total": 585, "episode_len_mean": 675.75, "timestamp": 1557206182, "time_total_s": 1106.6767101287842, "pid": 32008, "info": {"num_steps_trained": 1861847, "num_steps_sampled": 1861847, "load_time_ms": 14.466, "grad_time_ms": 9127.685, "sample_time_ms": 16682.909, "update_time_ms": 7.257, "default": {"vf_explained_var": 0.9466782808303833, "vf_loss": 13.496837615966797, "entropy": 1.1951050758361816, "cur_lr": 0.0005000000237487257, "total_loss": 13.493496894836426, "kl": 0.013478231616318226, "policy_loss": -0.004014026839286089, "cur_kl_coeff": 0.050000011920928955}}, "time_this_iter_s": 26.011823654174805, "timesteps_since_restore": 1861847, "time_since_restore": 1106.6767101287842, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43873, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1208>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1d30>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-16-22", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 62.80251362028618}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1501.137679282232, "node_ip": "10.138.0.2", "timesteps_total": 1905423, "iterations_since_restore": 42, "episode_reward_mean": 1294.670592521552, "custom_metrics": {"cost1_max": 478.66392894974007, "cost1_mean": 365.8859904361582, "system_level_velocity_mean": 14.473195001768813, "outflow_rate_max": 1354.5763279248276, "cost1_min": 30.790858421037846, "system_level_velocity_max": 19.93222657171282, "system_level_velocity_min": 11.442097611406332, "outflow_rate_min": 326.3279975793562, "cost2_max": -15.662300157218846, "cost2_mean": -67.2731568580751, "outflow_rate_mean": 1105.2197706960405, "cost2_min": -98.67329282366256}, "training_iteration": 42, "episodes_total": 600, "episode_len_mean": 675.75, "timestamp": 1557206208, "time_total_s": 1132.5686914920807, "pid": 32008, "info": {"num_steps_trained": 1905423, "num_steps_sampled": 1905423, "load_time_ms": 14.776, "grad_time_ms": 9051.19, "sample_time_ms": 16550.294, "update_time_ms": 7.062, "default": {"vf_explained_var": 0.9820746183395386, "vf_loss": 5.15853214263916, "entropy": 1.204167127609253, "cur_lr": 0.0005000000237487257, "total_loss": 5.154641151428223, "kl": 0.011581601575016975, "policy_loss": -0.004470122046768665, "cur_kl_coeff": 0.050000011920928955}}, "time_this_iter_s": 25.89198136329651, "timesteps_since_restore": 1905423, "time_since_restore": 1132.5686914920807, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43576, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66af93c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9c50>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9e10>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-16-48", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 62.80251362028618}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1494.860439381976, "node_ip": "10.138.0.2", "timesteps_total": 1949766, "iterations_since_restore": 43, "episode_reward_mean": 1309.6089044671235, "custom_metrics": {"cost1_max": 478.66392894974007, "cost1_mean": 366.86963676056007, "system_level_velocity_mean": 14.308712734543782, "outflow_rate_max": 1354.5763279248276, "cost1_min": 34.29039707967749, "system_level_velocity_max": 19.400728762150052, "system_level_velocity_min": 11.442097611406332, "outflow_rate_min": 326.3279975793562, "cost2_max": -18.549060259052048, "cost2_mean": -66.66387311911387, "outflow_rate_mean": 1106.024103823994, "cost2_min": -98.67329282366256}, "training_iteration": 43, "episodes_total": 612, "episode_len_mean": 682.3, "timestamp": 1557206234, "time_total_s": 1158.6839528083801, "pid": 32008, "info": {"num_steps_trained": 1949766, "num_steps_sampled": 1949766, "load_time_ms": 14.944, "grad_time_ms": 9075.616, "sample_time_ms": 16638.052, "update_time_ms": 6.891, "default": {"vf_explained_var": 0.9703751802444458, "vf_loss": 7.376202583312988, "entropy": 1.1765191555023193, "cur_lr": 0.0005000000237487257, "total_loss": 7.373154640197754, "kl": 0.012719600461423397, "policy_loss": -0.0036828021984547377, "cur_kl_coeff": 0.05000000819563866}}, "time_this_iter_s": 26.11526131629944, "timesteps_since_restore": 1949766, "time_since_restore": 1158.6839528083801, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44343, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd978>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7208>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-17-14", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 72.19739196407247}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1494.860439381976, "node_ip": "10.138.0.2", "timesteps_total": 1992967, "iterations_since_restore": 44, "episode_reward_mean": 1301.5967391693716, "custom_metrics": {"cost1_max": 444.9313663886728, "cost1_mean": 363.0328423010378, "system_level_velocity_mean": 14.292225044438224, "outflow_rate_max": 1354.5763279248276, "cost1_min": 34.29039707967749, "system_level_velocity_max": 19.400728762150052, "system_level_velocity_min": 11.504432078562061, "outflow_rate_min": 326.3279975793562, "cost2_max": -18.549060259052048, "cost2_mean": -64.52734814090287, "outflow_rate_mean": 1096.1846357188635, "cost2_min": -98.67329282366256}, "training_iteration": 44, "episodes_total": 628, "episode_len_mean": 676.8, "timestamp": 1557206260, "time_total_s": 1184.3210356235504, "pid": 32008, "info": {"num_steps_trained": 1992967, "num_steps_sampled": 1992967, "load_time_ms": 14.889, "grad_time_ms": 9124.719, "sample_time_ms": 16497.395, "update_time_ms": 6.656, "default": {"vf_explained_var": 0.9523048400878906, "vf_loss": 12.314343452453613, "entropy": 1.184804916381836, "cur_lr": 0.0005000000237487257, "total_loss": 12.311015129089355, "kl": 0.012049686163663864, "policy_loss": -0.003928245976567268, "cur_kl_coeff": 0.05000000819563866}}, "time_this_iter_s": 25.637082815170288, "timesteps_since_restore": 1992967, "time_since_restore": 1184.3210356235504, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43201, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b49e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b47f0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4dd8>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-17-40", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 72.19739196407247}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1494.860439381976, "node_ip": "10.138.0.2", "timesteps_total": 2034899, "iterations_since_restore": 45, "episode_reward_mean": 1287.042526077883, "custom_metrics": {"cost1_max": 428.76860453077165, "cost1_mean": 358.6121489180085, "system_level_velocity_mean": 14.282397529382862, "outflow_rate_max": 1293.901605392605, "cost1_min": 33.494081189146165, "system_level_velocity_max": 19.400728762150052, "system_level_velocity_min": 12.042440910874102, "outflow_rate_min": 326.3279975793562, "cost2_max": -15.571901010994097, "cost2_mean": -60.00801973164561, "outflow_rate_mean": 1084.9235176413322, "cost2_min": -90.57206456673919}, "training_iteration": 45, "episodes_total": 646, "episode_len_mean": 670.3, "timestamp": 1557206284, "time_total_s": 1208.460829257965, "pid": 32008, "info": {"num_steps_trained": 2034899, "num_steps_sampled": 2034899, "load_time_ms": 15.042, "grad_time_ms": 9159.314, "sample_time_ms": 16354.638, "update_time_ms": 6.545, "default": {"vf_explained_var": 0.9368926286697388, "vf_loss": 14.961447715759277, "entropy": 1.1465259790420532, "cur_lr": 0.0005000000237487257, "total_loss": 14.959309577941895, "kl": 0.012998707592487335, "policy_loss": -0.002787365112453699, "cur_kl_coeff": 0.05000000819563866}}, "time_this_iter_s": 24.139793634414673, "timesteps_since_restore": 2034899, "time_since_restore": 1208.460829257965, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 41932, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd208>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdf28>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-18-04", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 68.26206527253544}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1494.860439381976, "node_ip": "10.138.0.2", "timesteps_total": 2076515, "iterations_since_restore": 46, "episode_reward_mean": 1293.6212090174677, "custom_metrics": {"cost1_max": 440.52442958514996, "cost1_mean": 359.3881631721122, "system_level_velocity_mean": 14.148547861839031, "outflow_rate_max": 1248.8721590706493, "cost1_min": 33.494081189146165, "system_level_velocity_max": 19.114515658633657, "system_level_velocity_min": 12.042440910874102, "outflow_rate_min": 326.3279975793562, "cost2_max": -15.571901010994097, "cost2_mean": -56.94010771829653, "outflow_rate_mean": 1085.335936172934, "cost2_min": -90.57206456673919}, "training_iteration": 46, "episodes_total": 663, "episode_len_mean": 676.8, "timestamp": 1557206309, "time_total_s": 1233.7902867794037, "pid": 32008, "info": {"num_steps_trained": 2076515, "num_steps_sampled": 2076515, "load_time_ms": 15.189, "grad_time_ms": 9250.708, "sample_time_ms": 16294.558, "update_time_ms": 6.575, "default": {"vf_explained_var": 0.9385826587677002, "vf_loss": 16.681095123291016, "entropy": 1.1557133197784424, "cur_lr": 0.0005000000237487257, "total_loss": 16.67830467224121, "kl": 0.012534108012914658, "policy_loss": -0.003418373642489314, "cur_kl_coeff": 0.050000011920928955}}, "time_this_iter_s": 25.3294575214386, "timesteps_since_restore": 2076515, "time_since_restore": 1233.7902867794037, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 41616, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa5c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa9e8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa748>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-18-29", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 68.26206527253544}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1487.047940200823, "node_ip": "10.138.0.2", "timesteps_total": 2119022, "iterations_since_restore": 47, "episode_reward_mean": 1311.251387121877, "custom_metrics": {"cost1_max": 440.52442958514996, "cost1_mean": 365.574071735389, "system_level_velocity_mean": 14.081505703540053, "outflow_rate_max": 1248.8721590706493, "cost1_min": 33.494081189146165, "system_level_velocity_max": 19.114515658633657, "system_level_velocity_min": 12.042440910874102, "outflow_rate_min": 326.3279975793562, "cost2_max": -15.571901010994097, "cost2_mean": -54.5760685471469, "outflow_rate_mean": 1096.2281576240414, "cost2_min": -90.57206456673919}, "training_iteration": 47, "episodes_total": 679, "episode_len_mean": 688.0, "timestamp": 1557206334, "time_total_s": 1259.163733959198, "pid": 32008, "info": {"num_steps_trained": 2119022, "num_steps_sampled": 2119022, "load_time_ms": 15.459, "grad_time_ms": 9334.867, "sample_time_ms": 16091.488, "update_time_ms": 6.664, "default": {"vf_explained_var": 0.9689819812774658, "vf_loss": 8.547223091125488, "entropy": 1.156057596206665, "cur_lr": 0.0005000000237487257, "total_loss": 8.543466567993164, "kl": 0.01398051530122757, "policy_loss": -0.004455273970961571, "cur_kl_coeff": 0.05000000819563866}}, "time_this_iter_s": 25.37344717979431, "timesteps_since_restore": 2119022, "time_since_restore": 1259.163733959198, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42507, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdcf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd048>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdda0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-18-54", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 68.26206527253544}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1487.047940200823, "node_ip": "10.138.0.2", "timesteps_total": 2162023, "iterations_since_restore": 48, "episode_reward_mean": 1295.9093361271446, "custom_metrics": {"cost1_max": 440.52442958514996, "cost1_mean": 363.34257090537335, "system_level_velocity_mean": 14.153172526349731, "outflow_rate_max": 1248.8721590706493, "cost1_min": 33.494081189146165, "system_level_velocity_max": 19.114515658633657, "system_level_velocity_min": 11.978290267852499, "outflow_rate_min": 326.3279975793562, "cost2_max": -15.571901010994097, "cost2_mean": -51.720672804163115, "outflow_rate_mean": 1092.4477047044327, "cost2_min": -81.50432876391379}, "training_iteration": 48, "episodes_total": 694, "episode_len_mean": 682.49, "timestamp": 1557206360, "time_total_s": 1284.3297185897827, "pid": 32008, "info": {"num_steps_trained": 2162023, "num_steps_sampled": 2162023, "load_time_ms": 15.241, "grad_time_ms": 9460.43, "sample_time_ms": 15916.919, "update_time_ms": 6.881, "default": {"vf_explained_var": 0.9692956805229187, "vf_loss": 8.998921394348145, "entropy": 1.1596593856811523, "cur_lr": 0.0005000000237487257, "total_loss": 8.997164726257324, "kl": 0.012813452631235123, "policy_loss": -0.0023985642474144697, "cur_kl_coeff": 0.050000011920928955}}, "time_this_iter_s": 25.165984630584717, "timesteps_since_restore": 2162023, "time_since_restore": 1284.3297185897827, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43001, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689eda0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7b70>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-19-20", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 68.26206527253544}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1487.047940200823, "node_ip": "10.138.0.2", "timesteps_total": 2205402, "iterations_since_restore": 49, "episode_reward_mean": 1294.6129985229818, "custom_metrics": {"cost1_max": 440.52442958514996, "cost1_mean": 366.1330574395242, "system_level_velocity_mean": 14.250056256673133, "outflow_rate_max": 1273.086201502338, "cost1_min": 33.494081189146165, "system_level_velocity_max": 19.114515658633657, "system_level_velocity_min": 11.978290267852499, "outflow_rate_min": 326.3279975793562, "cost2_max": -15.571901010994097, "cost2_mean": -49.4211389187734, "outflow_rate_mean": 1100.047139085519, "cost2_min": -69.45400169855529}, "training_iteration": 49, "episodes_total": 708, "episode_len_mean": 682.49, "timestamp": 1557206385, "time_total_s": 1309.9329671859741, "pid": 32008, "info": {"num_steps_trained": 2205402, "num_steps_sampled": 2205402, "load_time_ms": 16.105, "grad_time_ms": 9619.985, "sample_time_ms": 15755.619, "update_time_ms": 6.922, "default": {"vf_explained_var": 0.9711103439331055, "vf_loss": 7.7681169509887695, "entropy": 1.161166787147522, "cur_lr": 0.0005000000237487257, "total_loss": 7.764098167419434, "kl": 0.013880030252039433, "policy_loss": -0.004713200032711029, "cur_kl_coeff": 0.050000011920928955}}, "time_this_iter_s": 25.603248596191406, "timesteps_since_restore": 2205402, "time_since_restore": 1309.9329671859741, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43379, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1e10>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1fd0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-19-45", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 68.26206527253544}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1487.047940200823, "node_ip": "10.138.0.2", "timesteps_total": 2248303, "iterations_since_restore": 50, "episode_reward_mean": 1300.5970345185196, "custom_metrics": {"cost1_max": 440.52442958514996, "cost1_mean": 367.58205600025724, "system_level_velocity_mean": 14.15349996590141, "outflow_rate_max": 1273.086201502338, "cost1_min": 33.494081189146165, "system_level_velocity_max": 19.114515658633657, "system_level_velocity_min": 11.978290267852499, "outflow_rate_min": 326.3279975793562, "cost2_max": -15.571901010994097, "cost2_mean": -48.58164560521794, "outflow_rate_mean": 1103.5466574694751, "cost2_min": -69.45400169855529}, "training_iteration": 50, "episodes_total": 723, "episode_len_mean": 687.99, "timestamp": 1557206410, "time_total_s": 1334.3638722896576, "pid": 32008, "info": {"num_steps_trained": 2248303, "num_steps_sampled": 2248303, "load_time_ms": 15.954, "grad_time_ms": 9727.893, "sample_time_ms": 15529.962, "update_time_ms": 7.264, "default": {"vf_explained_var": 0.9717414379119873, "vf_loss": 8.668935775756836, "entropy": 1.1642204523086548, "cur_lr": 0.0005000000237487257, "total_loss": 8.666366577148438, "kl": 0.011035138741135597, "policy_loss": -0.0031208370346575975, "cur_kl_coeff": 0.050000011920928955}}, "time_this_iter_s": 24.43090510368347, "timesteps_since_restore": 2248303, "time_since_restore": 1334.3638722896576, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42901, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9320>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b97f0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-20-10", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 68.26206527253544}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1487.047940200823, "node_ip": "10.138.0.2", "timesteps_total": 2290444, "iterations_since_restore": 51, "episode_reward_mean": 1300.3082345604466, "custom_metrics": {"cost1_max": 440.52442958514996, "cost1_mean": 366.2181082885182, "system_level_velocity_mean": 14.095653558666784, "outflow_rate_max": 1273.086201502338, "cost1_min": 33.494081189146165, "system_level_velocity_max": 19.114515658633657, "system_level_velocity_min": 11.451109250663636, "outflow_rate_min": 326.3279975793562, "cost2_max": -15.571901010994097, "cost2_mean": -48.49297034226333, "outflow_rate_mean": 1098.0519227279706, "cost2_min": -67.27386899041402}, "training_iteration": 51, "episodes_total": 741, "episode_len_mean": 687.99, "timestamp": 1557206435, "time_total_s": 1359.987919807434, "pid": 32008, "info": {"num_steps_trained": 2290444, "num_steps_sampled": 2290444, "load_time_ms": 15.844, "grad_time_ms": 9828.137, "sample_time_ms": 15389.922, "update_time_ms": 7.386, "default": {"vf_explained_var": 0.9736515283584595, "vf_loss": 8.344841003417969, "entropy": 1.186322569847107, "cur_lr": 0.0005000000237487257, "total_loss": 8.341025352478027, "kl": 0.012017326429486275, "policy_loss": -0.004415757488459349, "cur_kl_coeff": 0.05000000074505806}}, "time_this_iter_s": 25.62404751777649, "timesteps_since_restore": 2290444, "time_since_restore": 1359.987919807434, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42141, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689ecc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e198>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e470>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-20-35", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 68.26206527253544}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1487.047940200823, "node_ip": "10.138.0.2", "timesteps_total": 2332593, "iterations_since_restore": 52, "episode_reward_mean": 1300.8933929351133, "custom_metrics": {"cost1_max": 444.52279623922556, "cost1_mean": 367.121577694528, "system_level_velocity_mean": 14.101930161850941, "outflow_rate_max": 1273.086201502338, "cost1_min": 78.6791062131931, "system_level_velocity_max": 18.994039550668635, "system_level_velocity_min": 11.451109250663636, "outflow_rate_min": 419.95673982262525, "cost2_max": -28.808140997840617, "cost2_mean": -49.19228168801818, "outflow_rate_mean": 1098.0283988680553, "cost2_min": -67.54269660405035}, "training_iteration": 52, "episodes_total": 756, "episode_len_mean": 688.63, "timestamp": 1557206462, "time_total_s": 1386.8463099002838, "pid": 32008, "info": {"num_steps_trained": 2332593, "num_steps_sampled": 2332593, "load_time_ms": 14.955, "grad_time_ms": 9998.954, "sample_time_ms": 15315.199, "update_time_ms": 7.671, "default": {"vf_explained_var": 0.9776458144187927, "vf_loss": 6.622696399688721, "entropy": 1.1845749616622925, "cur_lr": 0.0005000000237487257, "total_loss": 6.619270324707031, "kl": 0.013819107785820961, "policy_loss": -0.004117503296583891, "cur_kl_coeff": 0.05000000074505806}}, "time_this_iter_s": 26.85839009284973, "timesteps_since_restore": 2332593, "time_since_restore": 1386.8463099002838, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42149, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b92b0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9278>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-21-02", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 178.41083873371838}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1465.285322576773, "node_ip": "10.138.0.2", "timesteps_total": 2375961, "iterations_since_restore": 53, "episode_reward_mean": 1285.077890289972, "custom_metrics": {"cost1_max": 444.52279623922556, "cost1_mean": 363.45410313135426, "system_level_velocity_mean": 14.091071211314407, "outflow_rate_max": 1273.086201502338, "cost1_min": 78.6791062131931, "system_level_velocity_max": 18.994039550668635, "system_level_velocity_min": 11.451109250663636, "outflow_rate_min": 419.95673982262525, "cost2_max": -28.808140997840617, "cost2_mean": -48.89878201159832, "outflow_rate_mean": 1088.9701184278922, "cost2_min": -67.54269660405035}, "training_iteration": 53, "episodes_total": 772, "episode_len_mean": 683.54, "timestamp": 1557206488, "time_total_s": 1412.534951210022, "pid": 32008, "info": {"num_steps_trained": 2375961, "num_steps_sampled": 2375961, "load_time_ms": 14.664, "grad_time_ms": 10027.493, "sample_time_ms": 15242.364, "update_time_ms": 7.791, "default": {"vf_explained_var": 0.9699061512947083, "vf_loss": 8.41890811920166, "entropy": 1.184162974357605, "cur_lr": 0.0005000000237487257, "total_loss": 8.41413402557373, "kl": 0.014441177248954773, "policy_loss": -0.005495678633451462, "cur_kl_coeff": 0.050000011920928955}}, "time_this_iter_s": 25.68864130973816, "timesteps_since_restore": 2375961, "time_since_restore": 1412.534951210022, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43368, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd4e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd550>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd080>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-21-28", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 178.41083873371838}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1465.285322576773, "node_ip": "10.138.0.2", "timesteps_total": 2418320, "iterations_since_restore": 54, "episode_reward_mean": 1267.355828184531, "custom_metrics": {"cost1_max": 444.52279623922556, "cost1_mean": 359.054407532983, "system_level_velocity_mean": 14.09461066312231, "outflow_rate_max": 1273.086201502338, "cost1_min": 33.408033386124636, "system_level_velocity_max": 18.994039550668635, "system_level_velocity_min": 11.451109250663636, "outflow_rate_min": 324.8763846761304, "cost2_max": -14.000374870880293, "cost2_mean": -48.16346633528094, "outflow_rate_mean": 1079.587274786744, "cost2_min": -67.54269660405035}, "training_iteration": 54, "episodes_total": 786, "episode_len_mean": 677.04, "timestamp": 1557206514, "time_total_s": 1438.0029511451721, "pid": 32008, "info": {"num_steps_trained": 2418320, "num_steps_sampled": 2418320, "load_time_ms": 14.543, "grad_time_ms": 10052.097, "sample_time_ms": 15198.606, "update_time_ms": 7.956, "default": {"vf_explained_var": 0.9587461352348328, "vf_loss": 10.529837608337402, "entropy": 1.1669384241104126, "cur_lr": 0.0005000000237487257, "total_loss": 10.525716781616211, "kl": 0.014247315935790539, "policy_loss": -0.004833174869418144, "cur_kl_coeff": 0.050000011920928955}}, "time_this_iter_s": 25.467999935150146, "timesteps_since_restore": 2418320, "time_since_restore": 1438.0029511451721, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42359, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cda58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd2e8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd748>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-21-54", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 62.42404089912453}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1488.5349788321726, "node_ip": "10.138.0.2", "timesteps_total": 2460383, "iterations_since_restore": 55, "episode_reward_mean": 1255.3993103649254, "custom_metrics": {"cost1_max": 444.52279623922556, "cost1_mean": 356.66908928683654, "system_level_velocity_mean": 14.148576641761084, "outflow_rate_max": 1225.9126893454036, "cost1_min": 33.408033386124636, "system_level_velocity_max": 19.468545331527043, "system_level_velocity_min": 11.451109250663636, "outflow_rate_min": 324.63297590175443, "cost2_max": -14.000374870880293, "cost2_mean": -46.74180787236326, "outflow_rate_mean": 1073.3816828572503, "cost2_min": -67.54269660405035}, "training_iteration": 55, "episodes_total": 804, "episode_len_mean": 671.83, "timestamp": 1557206539, "time_total_s": 1463.695948600769, "pid": 32008, "info": {"num_steps_trained": 2460383, "num_steps_sampled": 2460383, "load_time_ms": 14.537, "grad_time_ms": 10022.604, "sample_time_ms": 15383.482, "update_time_ms": 8.096, "default": {"vf_explained_var": 0.9442551732063293, "vf_loss": 14.488738059997559, "entropy": 1.1432769298553467, "cur_lr": 0.0005000000237487257, "total_loss": 14.48668384552002, "kl": 0.018508268520236015, "policy_loss": -0.002980094635859132, "cur_kl_coeff": 0.05000000447034836}}, "time_this_iter_s": 25.692997455596924, "timesteps_since_restore": 2460383, "time_since_restore": 1463.695948600769, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42063, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd2b0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd400>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-22-19", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 62.42404089912453}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1527.7718565306834, "node_ip": "10.138.0.2", "timesteps_total": 2503079, "iterations_since_restore": 56, "episode_reward_mean": 1262.4052539094916, "custom_metrics": {"cost1_max": 444.52279623922556, "cost1_mean": 358.673477834117, "system_level_velocity_mean": 14.242157223640566, "outflow_rate_max": 1236.1974861296478, "cost1_min": 33.408033386124636, "system_level_velocity_max": 19.468545331527043, "system_level_velocity_min": 11.451109250663636, "outflow_rate_min": 324.63297590175443, "cost2_max": -14.000374870880293, "cost2_mean": -46.67705058709982, "outflow_rate_mean": 1075.7641701345792, "cost2_min": -67.54269660405035}, "training_iteration": 56, "episodes_total": 821, "episode_len_mean": 671.83, "timestamp": 1557206566, "time_total_s": 1490.2387466430664, "pid": 32008, "info": {"num_steps_trained": 2503079, "num_steps_sampled": 2503079, "load_time_ms": 14.207, "grad_time_ms": 10106.27, "sample_time_ms": 15422.015, "update_time_ms": 8.04, "default": {"vf_explained_var": 0.9514023661613464, "vf_loss": 14.44814682006836, "entropy": 1.182174801826477, "cur_lr": 0.0005000000237487257, "total_loss": 14.443411827087402, "kl": 0.013935203664004803, "policy_loss": -0.005431506782770157, "cur_kl_coeff": 0.05000000447034836}}, "time_this_iter_s": 26.542798042297363, "timesteps_since_restore": 2503079, "time_since_restore": 1490.2387466430664, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42696, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d10f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d18d0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d11d0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-22-46", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 62.42404089912453}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1527.7718565306834, "node_ip": "10.138.0.2", "timesteps_total": 2546043, "iterations_since_restore": 57, "episode_reward_mean": 1262.8918281092106, "custom_metrics": {"cost1_max": 444.52279623922556, "cost1_mean": 359.76116439416745, "system_level_velocity_mean": 14.311703242236435, "outflow_rate_max": 1236.1974861296478, "cost1_min": 33.408033386124636, "system_level_velocity_max": 19.468545331527043, "system_level_velocity_min": 12.230880391312322, "outflow_rate_min": 324.63297590175443, "cost2_max": -14.000374870880293, "cost2_mean": -47.28092062453592, "outflow_rate_mean": 1075.1730802428217, "cost2_min": -69.58279818815025}, "training_iteration": 57, "episodes_total": 836, "episode_len_mean": 671.83, "timestamp": 1557206592, "time_total_s": 1516.11425614357, "pid": 32008, "info": {"num_steps_trained": 2546043, "num_steps_sampled": 2546043, "load_time_ms": 13.97, "grad_time_ms": 10012.81, "sample_time_ms": 15566.129, "update_time_ms": 7.976, "default": {"vf_explained_var": 0.966103732585907, "vf_loss": 10.19259262084961, "entropy": 1.1672179698944092, "cur_lr": 0.0005000000237487257, "total_loss": 10.188807487487793, "kl": 0.013703176751732826, "policy_loss": -0.004470926709473133, "cur_kl_coeff": 0.050000011920928955}}, "time_this_iter_s": 25.87550950050354, "timesteps_since_restore": 2546043, "time_since_restore": 1516.11425614357, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42964, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1128>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1fd0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-23-12", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 62.42404089912453}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1527.7718565306834, "node_ip": "10.138.0.2", "timesteps_total": 2588303, "iterations_since_restore": 58, "episode_reward_mean": 1271.8601417134194, "custom_metrics": {"cost1_max": 455.23882438415563, "cost1_mean": 363.1813855020048, "system_level_velocity_mean": 14.29471170397121, "outflow_rate_max": 1236.1974861296478, "cost1_min": 33.408033386124636, "system_level_velocity_max": 19.468545331527043, "system_level_velocity_min": 12.175110688023283, "outflow_rate_min": 324.63297590175443, "cost2_max": -14.000374870880293, "cost2_mean": -48.031853571342445, "outflow_rate_mean": 1080.7654650543536, "cost2_min": -69.58279818815025}, "training_iteration": 58, "episodes_total": 851, "episode_len_mean": 677.69, "timestamp": 1557206617, "time_total_s": 1541.7837760448456, "pid": 32008, "info": {"num_steps_trained": 2588303, "num_steps_sampled": 2588303, "load_time_ms": 14.027, "grad_time_ms": 9929.114, "sample_time_ms": 15701.923, "update_time_ms": 7.849, "default": {"vf_explained_var": 0.982214629650116, "vf_loss": 5.805016040802002, "entropy": 1.134470820426941, "cur_lr": 0.0005000000237487257, "total_loss": 5.800810813903809, "kl": 0.013992448337376118, "policy_loss": -0.004904577974230051, "cur_kl_coeff": 0.050000011920928955}}, "time_this_iter_s": 25.669519901275635, "timesteps_since_restore": 2588303, "time_since_restore": 1541.7837760448456, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42260, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1048>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1240>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-23-37", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 62.42404089912453}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1527.7718565306834, "node_ip": "10.138.0.2", "timesteps_total": 2633125, "iterations_since_restore": 59, "episode_reward_mean": 1270.5790245759097, "custom_metrics": {"cost1_max": 455.23882438415563, "cost1_mean": 361.4701696882678, "system_level_velocity_mean": 14.416281667761009, "outflow_rate_max": 1236.1974861296478, "cost1_min": 33.408033386124636, "system_level_velocity_max": 19.468545331527043, "system_level_velocity_min": 12.175110688023283, "outflow_rate_min": 324.63297590175443, "cost2_max": -14.000374870880293, "cost2_mean": -50.592186440202596, "outflow_rate_mean": 1077.590753385803, "cost2_min": -96.46782721533168}, "training_iteration": 59, "episodes_total": 867, "episode_len_mean": 671.19, "timestamp": 1557206644, "time_total_s": 1568.10893034935, "pid": 32008, "info": {"num_steps_trained": 2633125, "num_steps_sampled": 2633125, "load_time_ms": 13.452, "grad_time_ms": 9868.658, "sample_time_ms": 15835.219, "update_time_ms": 7.848, "default": {"vf_explained_var": 0.9716525077819824, "vf_loss": 8.266584396362305, "entropy": 1.1526060104370117, "cur_lr": 0.0005000000237487257, "total_loss": 8.263256072998047, "kl": 0.017845841124653816, "policy_loss": -0.004220371134579182, "cur_kl_coeff": 0.050000011920928955}}, "time_this_iter_s": 26.325154304504395, "timesteps_since_restore": 2633125, "time_since_restore": 1568.10893034935, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44822, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cda90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd5f8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cde80>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-24-04", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 62.42404089912453}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1527.7718565306834, "node_ip": "10.138.0.2", "timesteps_total": 2676859, "iterations_since_restore": 60, "episode_reward_mean": 1295.0198719217954, "custom_metrics": {"cost1_max": 455.23882438415563, "cost1_mean": 366.8335980637739, "system_level_velocity_mean": 14.299426903790948, "outflow_rate_max": 1236.1974861296478, "cost1_min": 33.614555550260924, "system_level_velocity_max": 19.468545331527043, "system_level_velocity_min": 12.14168048719657, "outflow_rate_min": 324.63297590175443, "cost2_max": -19.204103047600167, "cost2_mean": -53.194391848008024, "outflow_rate_mean": 1088.0162005072928, "cost2_min": -96.46782721533168}, "training_iteration": 60, "episodes_total": 879, "episode_len_mean": 682.78, "timestamp": 1557206669, "time_total_s": 1593.7266702651978, "pid": 32008, "info": {"num_steps_trained": 2676859, "num_steps_sampled": 2676859, "load_time_ms": 13.482, "grad_time_ms": 9858.789, "sample_time_ms": 15965.556, "update_time_ms": 7.498, "default": {"vf_explained_var": 0.9823115468025208, "vf_loss": 4.909936904907227, "entropy": 1.129550576210022, "cur_lr": 0.0005000000237487257, "total_loss": 4.906811714172363, "kl": 0.014038007706403732, "policy_loss": -0.0038273718673735857, "cur_kl_coeff": 0.05000000819563866}}, "time_this_iter_s": 25.61773991584778, "timesteps_since_restore": 2676859, "time_since_restore": 1593.7266702651978, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43734, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d19e8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d18d0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-24-29", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 67.76181392252573}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1527.7718565306834, "node_ip": "10.138.0.2", "timesteps_total": 2719121, "iterations_since_restore": 61, "episode_reward_mean": 1286.8312384873093, "custom_metrics": {"cost1_max": 455.23882438415563, "cost1_mean": 362.0531526375881, "system_level_velocity_mean": 14.332457899815365, "outflow_rate_max": 1236.1974861296478, "cost1_min": 30.629411364347852, "system_level_velocity_max": 19.468545331527043, "system_level_velocity_min": 11.783772595375888, "outflow_rate_min": 322.4486505387986, "cost2_max": -12.780275339531954, "cost2_mean": -55.005970564445306, "outflow_rate_mean": 1076.5024631550011, "cost2_min": -96.46782721533168}, "training_iteration": 61, "episodes_total": 900, "episode_len_mean": 674.87, "timestamp": 1557206695, "time_total_s": 1619.5863056182861, "pid": 32008, "info": {"num_steps_trained": 2719121, "num_steps_sampled": 2719121, "load_time_ms": 13.993, "grad_time_ms": 9743.082, "sample_time_ms": 16102.923, "update_time_ms": 7.737, "default": {"vf_explained_var": 0.9528704285621643, "vf_loss": 16.459993362426758, "entropy": 1.1475073099136353, "cur_lr": 0.0005000000237487257, "total_loss": 16.45403289794922, "kl": 0.02090965211391449, "policy_loss": -0.007005641702562571, "cur_kl_coeff": 0.050000011920928955}}, "time_this_iter_s": 25.85963535308838, "timesteps_since_restore": 2719121, "time_since_restore": 1619.5863056182861, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42262, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd550>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd1d0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-24-55", "hostname": "flow-main", "episodes_this_iter": 21, "episode_reward_min": 56.95761579759695}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1487.6813687940873, "node_ip": "10.138.0.2", "timesteps_total": 2760887, "iterations_since_restore": 62, "episode_reward_mean": 1304.1589192584609, "custom_metrics": {"cost1_max": 455.23882438415563, "cost1_mean": 366.736364546445, "system_level_velocity_mean": 14.317662590090656, "outflow_rate_max": 1269.2472285201975, "cost1_min": 30.629411364347852, "system_level_velocity_max": 18.98202797310215, "system_level_velocity_min": 11.783772595375888, "outflow_rate_min": 322.4486505387986, "cost2_max": -12.780275339531954, "cost2_mean": -55.12814869547256, "outflow_rate_mean": 1089.1015859720885, "cost2_min": -96.46782721533168}, "training_iteration": 62, "episodes_total": 916, "episode_len_mean": 681.34, "timestamp": 1557206720, "time_total_s": 1644.6996355056763, "pid": 32008, "info": {"num_steps_trained": 2760887, "num_steps_sampled": 2760887, "load_time_ms": 14.565, "grad_time_ms": 9545.114, "sample_time_ms": 16125.291, "update_time_ms": 7.599, "default": {"vf_explained_var": 0.943550705909729, "vf_loss": 15.642496109008789, "entropy": 1.1049368381500244, "cur_lr": 0.0005000000237487257, "total_loss": 15.639309883117676, "kl": 0.014272204600274563, "policy_loss": -0.004255866166204214, "cur_kl_coeff": 0.07499998807907104}}, "time_this_iter_s": 25.113329887390137, "timesteps_since_restore": 2760887, "time_since_restore": 1644.6996355056763, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 41766, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d13c8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1b00>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-25-20", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 56.95761579759695}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1487.6813687940873, "node_ip": "10.138.0.2", "timesteps_total": 2804109, "iterations_since_restore": 63, "episode_reward_mean": 1253.4305875871112, "custom_metrics": {"cost1_max": 455.23882438415563, "cost1_mean": 353.65640131736086, "system_level_velocity_mean": 14.398766586143502, "outflow_rate_max": 1269.2472285201975, "cost1_min": 30.629411364347852, "system_level_velocity_max": 19.028910784718263, "system_level_velocity_min": 11.783772595375888, "outflow_rate_min": 313.37907889324333, "cost2_max": -10.238254578153779, "cost2_mean": -52.9508805186629, "outflow_rate_mean": 1059.1974390157538, "cost2_min": -96.46782721533168}, "training_iteration": 63, "episodes_total": 933, "episode_len_mean": 659.28, "timestamp": 1557206746, "time_total_s": 1670.5235340595245, "pid": 32008, "info": {"num_steps_trained": 2804109, "num_steps_sampled": 2804109, "load_time_ms": 14.884, "grad_time_ms": 9514.653, "sample_time_ms": 16171.296, "update_time_ms": 7.52, "default": {"vf_explained_var": 0.9295840859413147, "vf_loss": 19.57354736328125, "entropy": 1.159600019454956, "cur_lr": 0.0005000000237487257, "total_loss": 19.568361282348633, "kl": 0.01772177219390869, "policy_loss": -0.0065172333270311356, "cur_kl_coeff": 0.07499999552965164}}, "time_this_iter_s": 25.823898553848267, "timesteps_since_restore": 2804109, "time_since_restore": 1670.5235340595245, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43222, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b92b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4c88>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e908>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-25-46", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 56.95761579759695}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1485.6028380225098, "node_ip": "10.138.0.2", "timesteps_total": 2846901, "iterations_since_restore": 64, "episode_reward_mean": 1255.6015374903275, "custom_metrics": {"cost1_max": 445.534142738575, "cost1_mean": 352.9349985530717, "system_level_velocity_mean": 14.34746513454274, "outflow_rate_max": 1269.2472285201975, "cost1_min": 30.629411364347852, "system_level_velocity_max": 19.028910784718263, "system_level_velocity_min": 11.783772595375888, "outflow_rate_min": 313.37907889324333, "cost2_max": -10.238254578153779, "cost2_mean": -51.10067057677225, "outflow_rate_mean": 1059.565347118356, "cost2_min": -96.46782721533168}, "training_iteration": 64, "episodes_total": 949, "episode_len_mean": 659.28, "timestamp": 1557206774, "time_total_s": 1697.9291441440582, "pid": 32008, "info": {"num_steps_trained": 2846901, "num_steps_sampled": 2846901, "load_time_ms": 14.981, "grad_time_ms": 9588.593, "sample_time_ms": 16293.606, "update_time_ms": 7.302, "default": {"vf_explained_var": 0.9571397304534912, "vf_loss": 11.871533393859863, "entropy": 1.1560349464416504, "cur_lr": 0.0005000000237487257, "total_loss": 11.86733341217041, "kl": 0.013995061628520489, "policy_loss": -0.005250211805105209, "cur_kl_coeff": 0.07499998807907104}}, "time_this_iter_s": 27.40561008453369, "timesteps_since_restore": 2846901, "time_since_restore": 1697.9291441440582, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42792, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1a20>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1860>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-26-14", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 56.95761579759695}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1485.6028380225098, "node_ip": "10.138.0.2", "timesteps_total": 2889717, "iterations_since_restore": 65, "episode_reward_mean": 1269.2727974022187, "custom_metrics": {"cost1_max": 451.53282465192626, "cost1_mean": 356.37468037949986, "system_level_velocity_mean": 14.287583095896629, "outflow_rate_max": 1272.6583222762686, "cost1_min": 30.629411364347852, "system_level_velocity_max": 19.028910784718263, "system_level_velocity_min": 11.783772595375888, "outflow_rate_min": 313.37907889324333, "cost2_max": -10.238254578153779, "cost2_mean": -49.60908074242369, "outflow_rate_mean": 1069.637537417037, "cost2_min": -91.66701934552191}, "training_iteration": 65, "episodes_total": 963, "episode_len_mean": 665.78, "timestamp": 1557206799, "time_total_s": 1722.709333896637, "pid": 32008, "info": {"num_steps_trained": 2889717, "num_steps_sampled": 2889717, "load_time_ms": 14.458, "grad_time_ms": 9579.355, "sample_time_ms": 16211.473, "update_time_ms": 7.341, "default": {"vf_explained_var": 0.9622218012809753, "vf_loss": 11.054651260375977, "entropy": 1.1374155282974243, "cur_lr": 0.0005000000237487257, "total_loss": 11.051877975463867, "kl": 0.01220609713345766, "policy_loss": -0.003688659518957138, "cur_kl_coeff": 0.07499998807907104}}, "time_this_iter_s": 24.780189752578735, "timesteps_since_restore": 2889717, "time_since_restore": 1722.709333896637, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42816, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9198>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9eb8>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-26-39", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 56.95761579759695}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1497.2239412841338, "node_ip": "10.138.0.2", "timesteps_total": 2931489, "iterations_since_restore": 66, "episode_reward_mean": 1267.5904571094632, "custom_metrics": {"cost1_max": 457.3262811590125, "cost1_mean": 354.9926101804143, "system_level_velocity_mean": 14.367377000123893, "outflow_rate_max": 1272.6583222762686, "cost1_min": 30.629411364347852, "system_level_velocity_max": 19.028910784718263, "system_level_velocity_min": 11.783772595375888, "outflow_rate_min": 313.37907889324333, "cost2_max": -10.238254578153779, "cost2_mean": -47.137448615589264, "outflow_rate_mean": 1067.6690314239916, "cost2_min": -80.22417410306664}, "training_iteration": 66, "episodes_total": 981, "episode_len_mean": 660.87, "timestamp": 1557206824, "time_total_s": 1748.0805897712708, "pid": 32008, "info": {"num_steps_trained": 2931489, "num_steps_sampled": 2931489, "load_time_ms": 14.495, "grad_time_ms": 9450.988, "sample_time_ms": 16220.505, "update_time_ms": 7.438, "default": {"vf_explained_var": 0.9548876881599426, "vf_loss": 14.61520767211914, "entropy": 1.1348111629486084, "cur_lr": 0.0005000000237487257, "total_loss": 14.611221313476562, "kl": 0.015592016279697418, "policy_loss": -0.005155681166797876, "cur_kl_coeff": 0.07499998807907104}}, "time_this_iter_s": 25.37125587463379, "timesteps_since_restore": 2931489, "time_since_restore": 1748.0805897712708, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 41772, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d14e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1978>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1ef0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-27-04", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 56.95761579759695}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1497.2239412841338, "node_ip": "10.138.0.2", "timesteps_total": 2974626, "iterations_since_restore": 67, "episode_reward_mean": 1282.6574400642107, "custom_metrics": {"cost1_max": 457.3262811590125, "cost1_mean": 362.3626273069209, "system_level_velocity_mean": 14.318150435957682, "outflow_rate_max": 1272.6583222762686, "cost1_min": 34.78071250643584, "system_level_velocity_max": 19.028910784718263, "system_level_velocity_min": 11.791316223704706, "outflow_rate_min": 313.37907889324333, "cost2_max": -10.238254578153779, "cost2_mean": -46.29783447362866, "outflow_rate_mean": 1086.1812568824012, "cost2_min": -80.22417410306664}, "training_iteration": 67, "episodes_total": 997, "episode_len_mean": 673.03, "timestamp": 1557206850, "time_total_s": 1774.1874606609344, "pid": 32008, "info": {"num_steps_trained": 2974626, "num_steps_sampled": 2974626, "load_time_ms": 14.477, "grad_time_ms": 9496.633, "sample_time_ms": 16197.97, "update_time_ms": 7.489, "default": {"vf_explained_var": 0.947824239730835, "vf_loss": 14.542820930480957, "entropy": 1.1421912908554077, "cur_lr": 0.0005000000237487257, "total_loss": 14.538756370544434, "kl": 0.014206566847860813, "policy_loss": -0.005131182726472616, "cur_kl_coeff": 0.07499999552965164}}, "time_this_iter_s": 26.106870889663696, "timesteps_since_restore": 2974626, "time_since_restore": 1774.1874606609344, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43137, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a78d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7ef0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7080>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-27-30", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 71.96482285235265}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1497.2239412841338, "node_ip": "10.138.0.2", "timesteps_total": 3016656, "iterations_since_restore": 68, "episode_reward_mean": 1268.8361870834435, "custom_metrics": {"cost1_max": 457.3262811590125, "cost1_mean": 359.32618466229, "system_level_velocity_mean": 14.394180029800623, "outflow_rate_max": 1272.6583222762686, "cost1_min": 34.119763197076686, "system_level_velocity_max": 19.22385636861625, "system_level_velocity_min": 11.84064819749003, "outflow_rate_min": 313.37907889324333, "cost2_max": -10.238254578153779, "cost2_mean": -46.83052211657439, "outflow_rate_mean": 1076.4944055662722, "cost2_min": -69.71696065662793}, "training_iteration": 68, "episodes_total": 1013, "episode_len_mean": 666.53, "timestamp": 1557206876, "time_total_s": 1799.6491906642914, "pid": 32008, "info": {"num_steps_trained": 3016656, "num_steps_sampled": 3016656, "load_time_ms": 14.627, "grad_time_ms": 9487.615, "sample_time_ms": 16186.599, "update_time_ms": 7.627, "default": {"vf_explained_var": 0.9709741473197937, "vf_loss": 9.36240291595459, "entropy": 1.1460258960723877, "cur_lr": 0.0005000000237487257, "total_loss": 9.358133316040039, "kl": 0.01552673988044262, "policy_loss": -0.005434427410364151, "cur_kl_coeff": 0.07499999552965164}}, "time_this_iter_s": 25.461730003356934, "timesteps_since_restore": 3016656, "time_since_restore": 1799.6491906642914, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42030, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d15f8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1cf8>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-27-56", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 63.58036614823447}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1497.2239412841338, "node_ip": "10.138.0.2", "timesteps_total": 3059388, "iterations_since_restore": 69, "episode_reward_mean": 1291.4618846043877, "custom_metrics": {"cost1_max": 457.3262811590125, "cost1_mean": 364.0674461163047, "system_level_velocity_mean": 14.293235828514263, "outflow_rate_max": 1272.6583222762686, "cost1_min": 34.119763197076686, "system_level_velocity_max": 19.22385636861625, "system_level_velocity_min": 11.973268274917093, "outflow_rate_min": 313.37907889324333, "cost2_max": -10.238254578153779, "cost2_mean": -48.30103813606927, "outflow_rate_mean": 1089.5131332123483, "cost2_min": -69.71696065662793}, "training_iteration": 69, "episodes_total": 1028, "episode_len_mean": 677.14, "timestamp": 1557206902, "time_total_s": 1825.7452540397644, "pid": 32008, "info": {"num_steps_trained": 3059388, "num_steps_sampled": 3059388, "load_time_ms": 14.45, "grad_time_ms": 9452.256, "sample_time_ms": 16199.029, "update_time_ms": 7.65, "default": {"vf_explained_var": 0.9628761410713196, "vf_loss": 10.705059051513672, "entropy": 1.1457993984222412, "cur_lr": 0.0005000000237487257, "total_loss": 10.700662612915039, "kl": 0.01603841409087181, "policy_loss": -0.0055990745313465595, "cur_kl_coeff": 0.07499999552965164}}, "time_this_iter_s": 26.096063375473022, "timesteps_since_restore": 3059388, "time_since_restore": 1825.7452540397644, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42732, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd8d0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cde10>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-28-22", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 63.58036614823447}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1497.2239412841338, "node_ip": "10.138.0.2", "timesteps_total": 3101606, "iterations_since_restore": 70, "episode_reward_mean": 1294.4186697789307, "custom_metrics": {"cost1_max": 457.3262811590125, "cost1_mean": 366.7951427935512, "system_level_velocity_mean": 14.351574930750463, "outflow_rate_max": 1272.6583222762686, "cost1_min": 34.119763197076686, "system_level_velocity_max": 19.29923771207393, "system_level_velocity_min": 11.973268274917093, "outflow_rate_min": 326.3279975793562, "cost2_max": -15.21689981668596, "cost2_mean": -49.434595339371974, "outflow_rate_mean": 1098.8600600665245, "cost2_min": -69.71696065662793}, "training_iteration": 70, "episodes_total": 1043, "episode_len_mean": 679.16, "timestamp": 1557206927, "time_total_s": 1850.9518687725067, "pid": 32008, "info": {"num_steps_trained": 3101606, "num_steps_sampled": 3101606, "load_time_ms": 14.42, "grad_time_ms": 9339.01, "sample_time_ms": 16271.092, "update_time_ms": 7.866, "default": {"vf_explained_var": 0.9473212957382202, "vf_loss": 15.78027629852295, "entropy": 1.1367491483688354, "cur_lr": 0.0005000000237487257, "total_loss": 15.776201248168945, "kl": 0.01686828024685383, "policy_loss": -0.005341832991689444, "cur_kl_coeff": 0.07499999552965164}}, "time_this_iter_s": 25.20661473274231, "timesteps_since_restore": 3101606, "time_since_restore": 1850.9518687725067, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42218, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d10f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1400>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1ef0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-28-47", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 63.58036614823447}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1536.6502795296715, "node_ip": "10.138.0.2", "timesteps_total": 3144094, "iterations_since_restore": 71, "episode_reward_mean": 1303.2870898870592, "custom_metrics": {"cost1_max": 457.3262811590125, "cost1_mean": 368.2115758952768, "system_level_velocity_mean": 14.41604629335011, "outflow_rate_max": 1272.6583222762686, "cost1_min": 34.119763197076686, "system_level_velocity_max": 19.29923771207393, "system_level_velocity_min": 11.973268274917093, "outflow_rate_min": 326.3279975793562, "cost2_max": -15.21689981668596, "cost2_mean": -49.78341107298307, "outflow_rate_mean": 1103.7885185998412, "cost2_min": -69.71696065662793}, "training_iteration": 71, "episodes_total": 1058, "episode_len_mean": 679.16, "timestamp": 1557206952, "time_total_s": 1876.0984408855438, "pid": 32008, "info": {"num_steps_trained": 3144094, "num_steps_sampled": 3144094, "load_time_ms": 14.051, "grad_time_ms": 9340.102, "sample_time_ms": 16200.262, "update_time_ms": 7.756, "default": {"vf_explained_var": 0.9671624302864075, "vf_loss": 9.672293663024902, "entropy": 1.1280125379562378, "cur_lr": 0.0005000000237487257, "total_loss": 9.666155815124512, "kl": 0.01634281687438488, "policy_loss": -0.007363341748714447, "cur_kl_coeff": 0.07499998807907104}}, "time_this_iter_s": 25.14657211303711, "timesteps_since_restore": 3144094, "time_since_restore": 1876.0984408855438, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42488, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd4a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd208>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdf60>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-29-12", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 63.58036614823447}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1536.6502795296715, "node_ip": "10.138.0.2", "timesteps_total": 3185873, "iterations_since_restore": 72, "episode_reward_mean": 1302.1423150024702, "custom_metrics": {"cost1_max": 424.1251869703102, "cost1_mean": 369.4108381204473, "system_level_velocity_mean": 14.477800733305314, "outflow_rate_max": 1270.3584928155392, "cost1_min": 34.119763197076686, "system_level_velocity_max": 19.29923771207393, "system_level_velocity_min": 11.869316743320066, "outflow_rate_min": 326.3279975793562, "cost2_max": -15.21689981668596, "cost2_mean": -49.63604561672531, "outflow_rate_mean": 1104.8652942598299, "cost2_min": -67.0412070232446}, "training_iteration": 72, "episodes_total": 1076, "episode_len_mean": 679.16, "timestamp": 1557206978, "time_total_s": 1901.506474494934, "pid": 32008, "info": {"num_steps_trained": 3185873, "num_steps_sampled": 3185873, "load_time_ms": 13.995, "grad_time_ms": 9261.2, "sample_time_ms": 16310.082, "update_time_ms": 7.701, "default": {"vf_explained_var": 0.9620049595832825, "vf_loss": 12.946688652038574, "entropy": 1.1599799394607544, "cur_lr": 0.0005000000237487257, "total_loss": 12.942876815795898, "kl": 0.015112373977899551, "policy_loss": -0.004944115877151489, "cur_kl_coeff": 0.07499998807907104}}, "time_this_iter_s": 25.40803360939026, "timesteps_since_restore": 3185873, "time_since_restore": 1901.506474494934, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 41779, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1a58>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1160>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-29-38", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 63.58036614823447}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1536.6502795296715, "node_ip": "10.138.0.2", "timesteps_total": 3227458, "iterations_since_restore": 73, "episode_reward_mean": 1307.948171639728, "custom_metrics": {"cost1_max": 435.52986930147705, "cost1_mean": 371.9854605102135, "system_level_velocity_mean": 14.586492933733982, "outflow_rate_max": 1284.1241483973492, "cost1_min": 34.119763197076686, "system_level_velocity_max": 19.29923771207393, "system_level_velocity_min": 11.869316743320066, "outflow_rate_min": 326.3279975793562, "cost2_max": -15.21689981668596, "cost2_mean": -50.46269022425826, "outflow_rate_mean": 1112.183844736396, "cost2_min": -67.0412070232446}, "training_iteration": 73, "episodes_total": 1093, "episode_len_mean": 679.0, "timestamp": 1557207003, "time_total_s": 1926.6682887077332, "pid": 32008, "info": {"num_steps_trained": 3227458, "num_steps_sampled": 3227458, "load_time_ms": 13.861, "grad_time_ms": 9125.459, "sample_time_ms": 16377.02, "update_time_ms": 7.971, "default": {"vf_explained_var": 0.9453727602958679, "vf_loss": 16.61285972595215, "entropy": 1.1589715480804443, "cur_lr": 0.0005000000237487257, "total_loss": 16.61053466796875, "kl": 0.016643891111016273, "policy_loss": -0.0035735222045332193, "cur_kl_coeff": 0.07499998807907104}}, "time_this_iter_s": 25.161814212799072, "timesteps_since_restore": 3227458, "time_since_restore": 1926.6682887077332, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 41585, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd4e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd8d0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd940>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-30-03", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 63.58036614823447}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1536.6502795296715, "node_ip": "10.138.0.2", "timesteps_total": 3269560, "iterations_since_restore": 74, "episode_reward_mean": 1312.6499973987086, "custom_metrics": {"cost1_max": 435.52986930147705, "cost1_mean": 372.3354576215666, "system_level_velocity_mean": 14.606196764370964, "outflow_rate_max": 1285.5443833393758, "cost1_min": 29.211218578147946, "system_level_velocity_max": 19.863557623773136, "system_level_velocity_min": 11.869316743320066, "outflow_rate_min": 329.6337234057179, "cost2_max": -14.970170147250071, "cost2_mean": -50.003320022230966, "outflow_rate_mean": 1115.2731288413838, "cost2_min": -65.02504185380126}, "training_iteration": 74, "episodes_total": 1111, "episode_len_mean": 678.93, "timestamp": 1557207027, "time_total_s": 1951.2030456066132, "pid": 32008, "info": {"num_steps_trained": 3269560, "num_steps_sampled": 3269560, "load_time_ms": 13.744, "grad_time_ms": 8869.254, "sample_time_ms": 16347.332, "update_time_ms": 7.99, "default": {"vf_explained_var": 0.9464097619056702, "vf_loss": 16.785043716430664, "entropy": 1.178438425064087, "cur_lr": 0.0005000000237487257, "total_loss": 16.78072166442871, "kl": 0.015278015285730362, "policy_loss": -0.0054689254611730576, "cur_kl_coeff": 0.07499999552965164}}, "time_this_iter_s": 24.534756898880005, "timesteps_since_restore": 3269560, "time_since_restore": 1951.2030456066132, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42102, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7b70>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7080>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-30-27", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 56.827146557960994}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1536.6502795296715, "node_ip": "10.138.0.2", "timesteps_total": 3312577, "iterations_since_restore": 75, "episode_reward_mean": 1314.6434614513198, "custom_metrics": {"cost1_max": 435.52986930147705, "cost1_mean": 373.1705851626677, "system_level_velocity_mean": 14.641730296907742, "outflow_rate_max": 1285.5443833393758, "cost1_min": 29.211218578147946, "system_level_velocity_max": 19.863557623773136, "system_level_velocity_min": 11.869316743320066, "outflow_rate_min": 329.6337234057179, "cost2_max": -14.970170147250071, "cost2_mean": -49.36422954468954, "outflow_rate_mean": 1116.1753607275266, "cost2_min": -65.02504185380126}, "training_iteration": 75, "episodes_total": 1124, "episode_len_mean": 678.93, "timestamp": 1557207054, "time_total_s": 1977.4783804416656, "pid": 32008, "info": {"num_steps_trained": 3312577, "num_steps_sampled": 3312577, "load_time_ms": 14.096, "grad_time_ms": 8750.656, "sample_time_ms": 16615.948, "update_time_ms": 7.931, "default": {"vf_explained_var": 0.9702535271644592, "vf_loss": 7.749767303466797, "entropy": 1.1749169826507568, "cur_lr": 0.0005000000237487257, "total_loss": 7.7456135749816895, "kl": 0.015442411415278912, "policy_loss": -0.005311931017786264, "cur_kl_coeff": 0.07499998807907104}}, "time_this_iter_s": 26.27533483505249, "timesteps_since_restore": 3312577, "time_since_restore": 1977.4783804416656, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43017, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d13c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1be0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1a58>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-30-54", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 56.827146557960994}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1536.6502795296715, "node_ip": "10.138.0.2", "timesteps_total": 3357224, "iterations_since_restore": 76, "episode_reward_mean": 1328.8700208311084, "custom_metrics": {"cost1_max": 435.52986930147705, "cost1_mean": 374.91101989928626, "system_level_velocity_mean": 14.542005229334254, "outflow_rate_max": 1285.5443833393758, "cost1_min": 29.211218578147946, "system_level_velocity_max": 19.863557623773136, "system_level_velocity_min": 11.869316743320066, "outflow_rate_min": 329.6337234057179, "cost2_max": -14.970170147250071, "cost2_mean": -48.64354667624792, "outflow_rate_mean": 1120.9270329870874, "cost2_min": -65.02504185380126}, "training_iteration": 76, "episodes_total": 1136, "episode_len_mean": 684.4, "timestamp": 1557207081, "time_total_s": 2004.4194037914276, "pid": 32008, "info": {"num_steps_trained": 3357224, "num_steps_sampled": 3357224, "load_time_ms": 14.449, "grad_time_ms": 8830.938, "sample_time_ms": 16693.883, "update_time_ms": 7.751, "default": {"vf_explained_var": 0.9712175130844116, "vf_loss": 8.56332778930664, "entropy": 1.1890827417373657, "cur_lr": 0.0005000000237487257, "total_loss": 8.558391571044922, "kl": 0.01486191712319851, "policy_loss": -0.006051070522516966, "cur_kl_coeff": 0.07499998807907104}}, "time_this_iter_s": 26.941023349761963, "timesteps_since_restore": 3357224, "time_since_restore": 2004.4194037914276, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44647, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b49b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4390>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4080>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-31-21", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 56.827146557960994}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1565.020780353478, "node_ip": "10.138.0.2", "timesteps_total": 3399619, "iterations_since_restore": 77, "episode_reward_mean": 1334.7801926253721, "custom_metrics": {"cost1_max": 435.52986930147705, "cost1_mean": 375.29518142127216, "system_level_velocity_mean": 14.44170714027925, "outflow_rate_max": 1285.5443833393758, "cost1_min": 29.211218578147946, "system_level_velocity_max": 19.863557623773136, "system_level_velocity_min": 11.785625417723868, "outflow_rate_min": 329.6337234057179, "cost2_max": -14.970170147250071, "cost2_mean": -49.463707588937744, "outflow_rate_mean": 1121.5777465924066, "cost2_min": -65.9521567688988}, "training_iteration": 77, "episodes_total": 1152, "episode_len_mean": 688.36, "timestamp": 1557207106, "time_total_s": 2029.4474515914917, "pid": 32008, "info": {"num_steps_trained": 3399619, "num_steps_sampled": 3399619, "load_time_ms": 14.352, "grad_time_ms": 8769.157, "sample_time_ms": 16647.488, "update_time_ms": 7.73, "default": {"vf_explained_var": 0.9753234386444092, "vf_loss": 8.919986724853516, "entropy": 1.1845808029174805, "cur_lr": 0.0005000000237487257, "total_loss": 8.914738655090332, "kl": 0.01599046029150486, "policy_loss": -0.006447730120271444, "cur_kl_coeff": 0.07499998807907104}}, "time_this_iter_s": 25.028047800064087, "timesteps_since_restore": 3399619, "time_since_restore": 2029.4474515914917, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42395, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd6a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd1d0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdda0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-31-46", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 56.827146557960994}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1565.020780353478, "node_ip": "10.138.0.2", "timesteps_total": 3440467, "iterations_since_restore": 78, "episode_reward_mean": 1339.345853781106, "custom_metrics": {"cost1_max": 435.52986930147705, "cost1_mean": 375.45197363456623, "system_level_velocity_mean": 14.437066787455105, "outflow_rate_max": 1285.5443833393758, "cost1_min": 29.211218578147946, "system_level_velocity_max": 19.863557623773136, "system_level_velocity_min": 11.785625417723868, "outflow_rate_min": 329.6337234057179, "cost2_max": -14.970170147250071, "cost2_mean": -50.81582338243245, "outflow_rate_mean": 1122.405312761893, "cost2_min": -70.86707456220957}, "training_iteration": 78, "episodes_total": 1170, "episode_len_mean": 688.36, "timestamp": 1557207130, "time_total_s": 2054.0494618415833, "pid": 32008, "info": {"num_steps_trained": 3440467, "num_steps_sampled": 3440467, "load_time_ms": 14.015, "grad_time_ms": 8731.744, "sample_time_ms": 16598.919, "update_time_ms": 7.665, "default": {"vf_explained_var": 0.9754087924957275, "vf_loss": 9.018630027770996, "entropy": 1.2053316831588745, "cur_lr": 0.0005000000237487257, "total_loss": 9.012216567993164, "kl": 0.01657678559422493, "policy_loss": -0.007656850852072239, "cur_kl_coeff": 0.07499998807907104}}, "time_this_iter_s": 24.602010250091553, "timesteps_since_restore": 3440467, "time_since_restore": 2054.0494618415833, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 40848, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd128>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd278>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-32-10", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 56.827146557960994}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1611.333689193069, "node_ip": "10.138.0.2", "timesteps_total": 3483897, "iterations_since_restore": 79, "episode_reward_mean": 1341.7103949424936, "custom_metrics": {"cost1_max": 428.9705675906455, "cost1_mean": 372.7384469395964, "system_level_velocity_mean": 14.347142416446948, "outflow_rate_max": 1285.5443833393758, "cost1_min": 29.211218578147946, "system_level_velocity_max": 19.863557623773136, "system_level_velocity_min": 11.785625417723868, "outflow_rate_min": 329.6337234057179, "cost2_max": -14.970170147250071, "cost2_mean": -53.21958411919303, "outflow_rate_mean": 1115.813072518373, "cost2_min": -86.60220162058786}, "training_iteration": 79, "episodes_total": 1186, "episode_len_mean": 687.51, "timestamp": 1557207156, "time_total_s": 2079.800978899002, "pid": 32008, "info": {"num_steps_trained": 3483897, "num_steps_sampled": 3483897, "load_time_ms": 14.184, "grad_time_ms": 8714.112, "sample_time_ms": 16583.685, "update_time_ms": 7.564, "default": {"vf_explained_var": 0.9637541174888611, "vf_loss": 10.415026664733887, "entropy": 1.2386810779571533, "cur_lr": 0.0005000000237487257, "total_loss": 10.411108016967773, "kl": 0.016616661101579666, "policy_loss": -0.005164188798516989, "cur_kl_coeff": 0.07499999552965164}}, "time_this_iter_s": 25.751517057418823, "timesteps_since_restore": 3483897, "time_since_restore": 2079.800978899002, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43430, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1208>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1ef0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-32-36", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 56.827146557960994}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1611.333689193069, "node_ip": "10.138.0.2", "timesteps_total": 3528802, "iterations_since_restore": 80, "episode_reward_mean": 1340.973962043286, "custom_metrics": {"cost1_max": 429.17274588773716, "cost1_mean": 371.8741064166527, "system_level_velocity_mean": 14.317233172676884, "outflow_rate_max": 1285.5443833393758, "cost1_min": 29.211218578147946, "system_level_velocity_max": 19.863557623773136, "system_level_velocity_min": 11.785625417723868, "outflow_rate_min": 329.6337234057179, "cost2_max": -14.970170147250071, "cost2_mean": -55.51246473349502, "outflow_rate_mean": 1112.8200502141171, "cost2_min": -92.02225836742156}, "training_iteration": 80, "episodes_total": 1197, "episode_len_mean": 687.51, "timestamp": 1557207182, "time_total_s": 2106.229353904724, "pid": 32008, "info": {"num_steps_trained": 3528802, "num_steps_sampled": 3528802, "load_time_ms": 14.644, "grad_time_ms": 8770.925, "sample_time_ms": 16648.182, "update_time_ms": 7.439, "default": {"vf_explained_var": 0.979378342628479, "vf_loss": 6.507650852203369, "entropy": 1.208314061164856, "cur_lr": 0.0005000000237487257, "total_loss": 6.502450942993164, "kl": 0.017108922824263573, "policy_loss": -0.006482368800789118, "cur_kl_coeff": 0.07499998807907104}}, "time_this_iter_s": 26.428375005722046, "timesteps_since_restore": 3528802, "time_since_restore": 2106.229353904724, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44905, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdfd0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e5f8>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-33-02", "hostname": "flow-main", "episodes_this_iter": 11, "episode_reward_min": 56.827146557960994}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1617.3947831821397, "node_ip": "10.138.0.2", "timesteps_total": 3572855, "iterations_since_restore": 81, "episode_reward_mean": 1371.3203239591362, "custom_metrics": {"cost1_max": 429.17274588773716, "cost1_mean": 375.92542428893603, "system_level_velocity_mean": 14.268275137082247, "outflow_rate_max": 1328.5722950068032, "cost1_min": 75.40011522123905, "system_level_velocity_max": 18.886584752933796, "system_level_velocity_min": 11.785625417723868, "outflow_rate_min": 391.5426059998767, "cost2_max": -27.4102596556156, "cost2_mean": -60.36397204630806, "outflow_rate_mean": 1123.5121416156614, "cost2_min": -95.23007286144872}, "training_iteration": 81, "episodes_total": 1213, "episode_len_mean": 694.08, "timestamp": 1557207207, "time_total_s": 2131.0750539302826, "pid": 32008, "info": {"num_steps_trained": 3572855, "num_steps_sampled": 3572855, "load_time_ms": 14.801, "grad_time_ms": 8886.816, "sample_time_ms": 16501.89, "update_time_ms": 7.193, "default": {"vf_explained_var": 0.9729939103126526, "vf_loss": 10.421189308166504, "entropy": 1.2105292081832886, "cur_lr": 0.0005000000237487257, "total_loss": 10.41579818725586, "kl": 0.015638509765267372, "policy_loss": -0.0065645999275147915, "cur_kl_coeff": 0.07499999552965164}}, "time_this_iter_s": 24.84570002555847, "timesteps_since_restore": 3572855, "time_since_restore": 2131.0750539302826, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44053, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d16d8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1710>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-33-27", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 175.44535636078643}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1617.3947831821397, "node_ip": "10.138.0.2", "timesteps_total": 3615942, "iterations_since_restore": 82, "episode_reward_mean": 1362.187295307064, "custom_metrics": {"cost1_max": 464.81867584712114, "cost1_mean": 372.7507343410848, "system_level_velocity_mean": 14.456613730571403, "outflow_rate_max": 1328.5722950068032, "cost1_min": 75.40011522123905, "system_level_velocity_max": 19.51283435795009, "system_level_velocity_min": 11.785625417723868, "outflow_rate_min": 391.5426059998767, "cost2_max": -27.4102596556156, "cost2_mean": -66.32273711053345, "outflow_rate_mean": 1116.139589922779, "cost2_min": -107.23712041536436}, "training_iteration": 82, "episodes_total": 1231, "episode_len_mean": 683.49, "timestamp": 1557207232, "time_total_s": 2156.159403562546, "pid": 32008, "info": {"num_steps_trained": 3615942, "num_steps_sampled": 3615942, "load_time_ms": 14.897, "grad_time_ms": 9084.188, "sample_time_ms": 16271.515, "update_time_ms": 7.299, "default": {"vf_explained_var": 0.9716386198997498, "vf_loss": 12.117925643920898, "entropy": 1.1940094232559204, "cur_lr": 0.0005000000237487257, "total_loss": 12.113264083862305, "kl": 0.01749536208808422, "policy_loss": -0.005973027087748051, "cur_kl_coeff": 0.07499998807907104}}, "time_this_iter_s": 25.084349632263184, "timesteps_since_restore": 3615942, "time_since_restore": 2156.159403562546, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43087, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdba8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdb38>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-33-52", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 175.44535636078643}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1617.3947831821397, "node_ip": "10.138.0.2", "timesteps_total": 3660542, "iterations_since_restore": 83, "episode_reward_mean": 1357.8162779206862, "custom_metrics": {"cost1_max": 464.81867584712114, "cost1_mean": 372.7228345326415, "system_level_velocity_mean": 14.6094601462659, "outflow_rate_max": 1328.5722950068032, "cost1_min": 75.40011522123905, "system_level_velocity_max": 19.51283435795009, "system_level_velocity_min": 11.785625417723868, "outflow_rate_min": 391.5426059998767, "cost2_max": -27.4102596556156, "cost2_mean": -71.3295324209191, "outflow_rate_mean": 1112.5571248738393, "cost2_min": -107.23712041536436}, "training_iteration": 83, "episodes_total": 1247, "episode_len_mean": 678.5, "timestamp": 1557207259, "time_total_s": 2182.1802639961243, "pid": 32008, "info": {"num_steps_trained": 3660542, "num_steps_sampled": 3660542, "load_time_ms": 14.825, "grad_time_ms": 9339.782, "sample_time_ms": 16104.359, "update_time_ms": 7.045, "default": {"vf_explained_var": 0.973267138004303, "vf_loss": 9.262009620666504, "entropy": 1.1838781833648682, "cur_lr": 0.0005000000237487257, "total_loss": 9.257603645324707, "kl": 0.017885830253362656, "policy_loss": -0.005747043993324041, "cur_kl_coeff": 0.07499998807907104}}, "time_this_iter_s": 26.02086043357849, "timesteps_since_restore": 3660542, "time_since_restore": 2182.1802639961243, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44600, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cddd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1cc0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd518>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-34-19", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 175.44535636078643}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1617.3947831821397, "node_ip": "10.138.0.2", "timesteps_total": 3705442, "iterations_since_restore": 84, "episode_reward_mean": 1347.55166834509, "custom_metrics": {"cost1_max": 464.81867584712114, "cost1_mean": 368.73863929311824, "system_level_velocity_mean": 14.627630161040907, "outflow_rate_max": 1328.5722950068032, "cost1_min": 34.77652161035934, "system_level_velocity_max": 19.51283435795009, "system_level_velocity_min": 11.885610502395943, "outflow_rate_min": 313.37907889324333, "cost2_max": -10.036733698696198, "cost2_mean": -72.53950679709605, "outflow_rate_mean": 1104.1062870916037, "cost2_min": -107.23712041536436}, "training_iteration": 84, "episodes_total": 1260, "episode_len_mean": 672.01, "timestamp": 1557207285, "time_total_s": 2208.719691514969, "pid": 32008, "info": {"num_steps_trained": 3705442, "num_steps_sampled": 3705442, "load_time_ms": 14.924, "grad_time_ms": 9590.056, "sample_time_ms": 16053.526, "update_time_ms": 7.098, "default": {"vf_explained_var": 0.9714196920394897, "vf_loss": 8.814875602722168, "entropy": 1.179702639579773, "cur_lr": 0.0005000000237487257, "total_loss": 8.809371948242188, "kl": 0.020321816205978394, "policy_loss": -0.007028172258287668, "cur_kl_coeff": 0.07499998807907104}}, "time_this_iter_s": 26.539427518844604, "timesteps_since_restore": 3705442, "time_since_restore": 2208.719691514969, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44900, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b40f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b94a8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7208>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-34-45", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 65.78608946290193}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1617.3947831821397, "node_ip": "10.138.0.2", "timesteps_total": 3747570, "iterations_since_restore": 85, "episode_reward_mean": 1334.655594253783, "custom_metrics": {"cost1_max": 464.81867584712114, "cost1_mean": 364.0705730634596, "system_level_velocity_mean": 14.577559221902291, "outflow_rate_max": 1328.5722950068032, "cost1_min": 34.77652161035934, "system_level_velocity_max": 19.51283435795009, "system_level_velocity_min": 11.885610502395943, "outflow_rate_min": 313.37907889324333, "cost2_max": -10.036733698696198, "cost2_mean": -71.5591292880194, "outflow_rate_mean": 1091.81777558507, "cost2_min": -107.23712041536436}, "training_iteration": 85, "episodes_total": 1276, "episode_len_mean": 667.08, "timestamp": 1557207310, "time_total_s": 2233.3770978450775, "pid": 32008, "info": {"num_steps_trained": 3747570, "num_steps_sampled": 3747570, "load_time_ms": 15.006, "grad_time_ms": 9807.681, "sample_time_ms": 15673.88, "update_time_ms": 7.014, "default": {"vf_explained_var": 0.9734460711479187, "vf_loss": 9.359959602355957, "entropy": 1.1814727783203125, "cur_lr": 0.0005000000237487257, "total_loss": 9.35512924194336, "kl": 0.0172872357070446, "policy_loss": -0.006774496752768755, "cur_kl_coeff": 0.11250000447034836}}, "time_this_iter_s": 24.657406330108643, "timesteps_since_restore": 3747570, "time_since_restore": 2233.3770978450775, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42128, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1390>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1198>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-35-10", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 65.78608946290193}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1617.3947831821397, "node_ip": "10.138.0.2", "timesteps_total": 3790141, "iterations_since_restore": 86, "episode_reward_mean": 1331.482185161453, "custom_metrics": {"cost1_max": 464.81867584712114, "cost1_mean": 365.33729958451795, "system_level_velocity_mean": 14.610165300336432, "outflow_rate_max": 1328.5722950068032, "cost1_min": 34.77652161035934, "system_level_velocity_max": 19.51283435795009, "system_level_velocity_min": 11.711459960013423, "outflow_rate_min": 313.37907889324333, "cost2_max": -10.036733698696198, "cost2_mean": -68.58526732528125, "outflow_rate_mean": 1092.8411543396642, "cost2_min": -107.23712041536436}, "training_iteration": 86, "episodes_total": 1295, "episode_len_mean": 667.45, "timestamp": 1557207335, "time_total_s": 2258.7892541885376, "pid": 32008, "info": {"num_steps_trained": 3790141, "num_steps_sampled": 3790141, "load_time_ms": 14.943, "grad_time_ms": 9905.13, "sample_time_ms": 15423.492, "update_time_ms": 7.018, "default": {"vf_explained_var": 0.9521106481552124, "vf_loss": 15.41260051727295, "entropy": 1.2041033506393433, "cur_lr": 0.0005000000237487257, "total_loss": 15.40889835357666, "kl": 0.01714123785495758, "policy_loss": -0.005630380939692259, "cur_kl_coeff": 0.11249999701976776}}, "time_this_iter_s": 25.412156343460083, "timesteps_since_restore": 3790141, "time_since_restore": 2258.7892541885376, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42571, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1978>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1630>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-35-35", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 65.78608946290193}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1601.4380560081331, "node_ip": "10.138.0.2", "timesteps_total": 3832328, "iterations_since_restore": 87, "episode_reward_mean": 1299.0593574236589, "custom_metrics": {"cost1_max": 464.81867584712114, "cost1_mean": 357.6647525285973, "system_level_velocity_mean": 14.60400063923819, "outflow_rate_max": 1288.9758971333051, "cost1_min": 34.77652161035934, "system_level_velocity_max": 19.51283435795009, "system_level_velocity_min": 11.711459960013423, "outflow_rate_min": 313.37907889324333, "cost2_max": -10.036733698696198, "cost2_mean": -65.37539129499869, "outflow_rate_mean": 1074.721788515874, "cost2_min": -107.23712041536436}, "training_iteration": 87, "episodes_total": 1310, "episode_len_mean": 656.62, "timestamp": 1557207361, "time_total_s": 2284.5932817459106, "pid": 32008, "info": {"num_steps_trained": 3832328, "num_steps_sampled": 3832328, "load_time_ms": 15.053, "grad_time_ms": 10077.232, "sample_time_ms": 15328.216, "update_time_ms": 7.115, "default": {"vf_explained_var": 0.9553324580192566, "vf_loss": 14.56014347076416, "entropy": 1.1542749404907227, "cur_lr": 0.0005000000237487257, "total_loss": 14.555194854736328, "kl": 0.017120424658060074, "policy_loss": -0.0068752337247133255, "cur_kl_coeff": 0.11250000447034836}}, "time_this_iter_s": 25.804027557373047, "timesteps_since_restore": 3832328, "time_since_restore": 2284.5932817459106, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42187, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd2b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd748>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd9e8>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-36-01", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 65.78608946290193}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1552.2286783573375, "node_ip": "10.138.0.2", "timesteps_total": 3875926, "iterations_since_restore": 88, "episode_reward_mean": 1270.5735635297788, "custom_metrics": {"cost1_max": 439.26836876249126, "cost1_mean": 353.3984441989754, "system_level_velocity_mean": 14.655477482333804, "outflow_rate_max": 1308.7446749208011, "cost1_min": 34.77652161035934, "system_level_velocity_max": 19.51283435795009, "system_level_velocity_min": 11.711459960013423, "outflow_rate_min": 313.37907889324333, "cost2_max": -10.036733698696198, "cost2_mean": -59.57320298046996, "outflow_rate_mean": 1067.9057910998326, "cost2_min": -102.02553793105436}, "training_iteration": 88, "episodes_total": 1327, "episode_len_mean": 646.97, "timestamp": 1557207388, "time_total_s": 2311.366921186447, "pid": 32008, "info": {"num_steps_trained": 3875926, "num_steps_sampled": 3875926, "load_time_ms": 15.121, "grad_time_ms": 10386.721, "sample_time_ms": 15234.021, "update_time_ms": 7.275, "default": {"vf_explained_var": 0.9285157918930054, "vf_loss": 23.181392669677734, "entropy": 1.1568700075149536, "cur_lr": 0.0005000000237487257, "total_loss": 23.17819595336914, "kl": 0.015179650858044624, "policy_loss": -0.004903804045170546, "cur_kl_coeff": 0.11249999701976776}}, "time_this_iter_s": 26.7736394405365, "timesteps_since_restore": 3875926, "time_since_restore": 2311.366921186447, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43598, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a78d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7f28>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7a58>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-36-28", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 65.78608946290193}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1552.2286783573375, "node_ip": "10.138.0.2", "timesteps_total": 3919876, "iterations_since_restore": 89, "episode_reward_mean": 1286.6674160410464, "custom_metrics": {"cost1_max": 439.26836876249126, "cost1_mean": 352.9828516964662, "system_level_velocity_mean": 14.345428054347728, "outflow_rate_max": 1308.7446749208011, "cost1_min": 34.77652161035934, "system_level_velocity_max": 18.875397874183506, "system_level_velocity_min": 10.914604002154238, "outflow_rate_min": 313.37907889324333, "cost2_max": -10.036733698696198, "cost2_mean": -56.61809946888528, "outflow_rate_mean": 1067.6959265032817, "cost2_min": -102.02553793105436}, "training_iteration": 89, "episodes_total": 1342, "episode_len_mean": 657.03, "timestamp": 1557207414, "time_total_s": 2337.9040553569794, "pid": 32008, "info": {"num_steps_trained": 3919876, "num_steps_sampled": 3919876, "load_time_ms": 14.958, "grad_time_ms": 10569.438, "sample_time_ms": 15128.523, "update_time_ms": 7.599, "default": {"vf_explained_var": 0.9654021263122559, "vf_loss": 12.347517013549805, "entropy": 1.1626465320587158, "cur_lr": 0.0005000000237487257, "total_loss": 12.342564582824707, "kl": 0.017017032951116562, "policy_loss": -0.006869127042591572, "cur_kl_coeff": 0.11250000447034836}}, "time_this_iter_s": 26.537134170532227, "timesteps_since_restore": 3919876, "time_since_restore": 2337.9040553569794, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43950, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf9b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfef0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfcc0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-36-54", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 65.78608946290193}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1552.2286783573375, "node_ip": "10.138.0.2", "timesteps_total": 3963183, "iterations_since_restore": 90, "episode_reward_mean": 1301.4822740397717, "custom_metrics": {"cost1_max": 439.26836876249126, "cost1_mean": 353.74898551910906, "system_level_velocity_mean": 14.188663528744364, "outflow_rate_max": 1308.7446749208011, "cost1_min": 82.86185528703946, "system_level_velocity_max": 18.875397874183506, "system_level_velocity_min": 10.914604002154238, "outflow_rate_min": 389.0683495199543, "cost2_max": -20.84206540843922, "cost2_mean": -52.873581826100505, "outflow_rate_mean": 1072.0564410188495, "cost2_min": -79.82692696271822}, "training_iteration": 90, "episodes_total": 1356, "episode_len_mean": 663.52, "timestamp": 1557207440, "time_total_s": 2363.7756259441376, "pid": 32008, "info": {"num_steps_trained": 3963183, "num_steps_sampled": 3963183, "load_time_ms": 14.586, "grad_time_ms": 10642.869, "sample_time_ms": 14999.669, "update_time_ms": 7.66, "default": {"vf_explained_var": 0.9543765783309937, "vf_loss": 13.87216854095459, "entropy": 1.1312462091445923, "cur_lr": 0.0005000000237487257, "total_loss": 13.867313385009766, "kl": 0.017549872398376465, "policy_loss": -0.006829946767538786, "cur_kl_coeff": 0.11250000447034836}}, "time_this_iter_s": 25.871570587158203, "timesteps_since_restore": 3963183, "time_since_restore": 2363.7756259441376, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43307, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1898>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1908>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-37-20", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 206.8232921657538}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1552.2286783573375, "node_ip": "10.138.0.2", "timesteps_total": 4005788, "iterations_since_restore": 91, "episode_reward_mean": 1308.8311002928237, "custom_metrics": {"cost1_max": 424.04440789753255, "cost1_mean": 357.15733920195845, "system_level_velocity_mean": 14.18818296518375, "outflow_rate_max": 1308.7446749208011, "cost1_min": 82.86185528703946, "system_level_velocity_max": 18.875397874183506, "system_level_velocity_min": 10.914604002154238, "outflow_rate_min": 389.0683495199543, "cost2_max": -20.84206540843922, "cost2_mean": -49.95279015105235, "outflow_rate_mean": 1080.6722931301554, "cost2_min": -78.8085804540626}, "training_iteration": 91, "episodes_total": 1372, "episode_len_mean": 668.45, "timestamp": 1557207466, "time_total_s": 2389.0844502449036, "pid": 32008, "info": {"num_steps_trained": 4005788, "num_steps_sampled": 4005788, "load_time_ms": 14.375, "grad_time_ms": 10583.962, "sample_time_ms": 15103.736, "update_time_ms": 7.752, "default": {"vf_explained_var": 0.9637219309806824, "vf_loss": 12.35473918914795, "entropy": 1.1120219230651855, "cur_lr": 0.0005000000237487257, "total_loss": 12.352230072021484, "kl": 0.014869550243020058, "policy_loss": -0.0041808998212218285, "cur_kl_coeff": 0.11249999701976776}}, "time_this_iter_s": 25.30882430076599, "timesteps_since_restore": 4005788, "time_since_restore": 2389.0844502449036, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42605, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf8d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa358>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa978>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-37-46", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 206.8232921657538}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1552.2286783573375, "node_ip": "10.138.0.2", "timesteps_total": 4048893, "iterations_since_restore": 92, "episode_reward_mean": 1312.6138040474589, "custom_metrics": {"cost1_max": 424.04440789753255, "cost1_mean": 357.76536358179976, "system_level_velocity_mean": 14.203754215831234, "outflow_rate_max": 1308.7446749208011, "cost1_min": 82.86185528703946, "system_level_velocity_max": 18.676254055179882, "system_level_velocity_min": 10.914604002154238, "outflow_rate_min": 389.0683495199543, "cost2_max": -22.757401490828272, "cost2_mean": -47.9007038047653, "outflow_rate_mean": 1085.5360507706891, "cost2_min": -78.8085804540626}, "training_iteration": 92, "episodes_total": 1390, "episode_len_mean": 668.02, "timestamp": 1557207491, "time_total_s": 2414.681960582733, "pid": 32008, "info": {"num_steps_trained": 4048893, "num_steps_sampled": 4048893, "load_time_ms": 14.225, "grad_time_ms": 10560.664, "sample_time_ms": 15177.792, "update_time_ms": 7.75, "default": {"vf_explained_var": 0.9437577128410339, "vf_loss": 17.718936920166016, "entropy": 1.1219209432601929, "cur_lr": 0.0005000000237487257, "total_loss": 17.715015411376953, "kl": 0.016231097280979156, "policy_loss": -0.005747824441641569, "cur_kl_coeff": 0.11249999701976776}}, "time_this_iter_s": 25.59751033782959, "timesteps_since_restore": 4048893, "time_since_restore": 2414.681960582733, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43105, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf9e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf940>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf860>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-38-11", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 206.8232921657538}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1552.2286783573375, "node_ip": "10.138.0.2", "timesteps_total": 4091664, "iterations_since_restore": 93, "episode_reward_mean": 1327.665708933126, "custom_metrics": {"cost1_max": 417.94998615743145, "cost1_mean": 362.0965930033458, "system_level_velocity_mean": 14.082748518389598, "outflow_rate_max": 1308.7446749208011, "cost1_min": 101.47739997027668, "system_level_velocity_max": 18.676254055179882, "system_level_velocity_min": 10.914604002154238, "outflow_rate_min": 461.98605631455956, "cost2_max": -22.757401490828272, "cost2_mean": -47.589388222373074, "outflow_rate_mean": 1097.5738821977454, "cost2_min": -78.8085804540626}, "training_iteration": 93, "episodes_total": 1406, "episode_len_mean": 678.85, "timestamp": 1557207517, "time_total_s": 2440.0727331638336, "pid": 32008, "info": {"num_steps_trained": 4091664, "num_steps_sampled": 4091664, "load_time_ms": 14.258, "grad_time_ms": 10478.218, "sample_time_ms": 15194.611, "update_time_ms": 7.943, "default": {"vf_explained_var": 0.9615416526794434, "vf_loss": 12.607989311218262, "entropy": 1.1344680786132812, "cur_lr": 0.0005000000237487257, "total_loss": 12.603477478027344, "kl": 0.015254857018589973, "policy_loss": -0.006227299105376005, "cur_kl_coeff": 0.11250000447034836}}, "time_this_iter_s": 25.390772581100464, "timesteps_since_restore": 4091664, "time_since_restore": 2440.0727331638336, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42771, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf3c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfef0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf4e0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-38-37", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 254.25131892038019}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1552.2286783573375, "node_ip": "10.138.0.2", "timesteps_total": 4132675, "iterations_since_restore": 94, "episode_reward_mean": 1324.298939352886, "custom_metrics": {"cost1_max": 427.5486274603194, "cost1_mean": 360.51168836038397, "system_level_velocity_mean": 14.021189066672807, "outflow_rate_max": 1252.6890744081788, "cost1_min": 29.177301143398886, "system_level_velocity_max": 19.663573300961705, "system_level_velocity_min": 10.914604002154238, "outflow_rate_min": 329.6337234057179, "cost2_max": -11.497689749998237, "cost2_mean": -46.50890905935908, "outflow_rate_mean": 1087.9434622042772, "cost2_min": -78.8085804540626}, "training_iteration": 94, "episodes_total": 1422, "episode_len_mean": 680.1, "timestamp": 1557207542, "time_total_s": 2465.034398317337, "pid": 32008, "info": {"num_steps_trained": 4132675, "num_steps_sampled": 4132675, "load_time_ms": 13.956, "grad_time_ms": 10396.336, "sample_time_ms": 15118.912, "update_time_ms": 7.998, "default": {"vf_explained_var": 0.9642990827560425, "vf_loss": 11.974322319030762, "entropy": 1.1442242860794067, "cur_lr": 0.0005000000237487257, "total_loss": 11.96825122833252, "kl": 0.016898520290851593, "policy_loss": -0.007973043248057365, "cur_kl_coeff": 0.11249999701976776}}, "time_this_iter_s": 24.961665153503418, "timesteps_since_restore": 4132675, "time_since_restore": 2465.034398317337, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 41011, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bff98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf4a8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf7b8>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-39-02", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 57.440910400074316}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1505.8445799967785, "node_ip": "10.138.0.2", "timesteps_total": 4175707, "iterations_since_restore": 95, "episode_reward_mean": 1319.5698110429175, "custom_metrics": {"cost1_max": 427.5486274603194, "cost1_mean": 362.0510772944948, "system_level_velocity_mean": 14.080294541602616, "outflow_rate_max": 1273.2943421266111, "cost1_min": 29.066451425817114, "system_level_velocity_max": 19.663573300961705, "system_level_velocity_min": 10.914604002154238, "outflow_rate_min": 329.6337234057179, "cost2_max": -11.497689749998237, "cost2_mean": -44.547610314391534, "outflow_rate_mean": 1094.942214506305, "cost2_min": -76.35702408297844}, "training_iteration": 95, "episodes_total": 1436, "episode_len_mean": 680.88, "timestamp": 1557207567, "time_total_s": 2490.2885522842407, "pid": 32008, "info": {"num_steps_trained": 4175707, "num_steps_sampled": 4175707, "load_time_ms": 14.306, "grad_time_ms": 10371.541, "sample_time_ms": 15202.259, "update_time_ms": 8.293, "default": {"vf_explained_var": 0.9544599652290344, "vf_loss": 14.761214256286621, "entropy": 1.1149049997329712, "cur_lr": 0.0005000000237487257, "total_loss": 14.7558012008667, "kl": 0.01808580942451954, "policy_loss": -0.007447963580489159, "cur_kl_coeff": 0.11249999701976776}}, "time_this_iter_s": 25.254153966903687, "timesteps_since_restore": 4175707, "time_since_restore": 2490.2885522842407, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43032, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c19e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd9e8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1dd8>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-39-27", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 57.440910400074316}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1505.8445799967785, "node_ip": "10.138.0.2", "timesteps_total": 4219548, "iterations_since_restore": 96, "episode_reward_mean": 1292.700057121232, "custom_metrics": {"cost1_max": 432.41749003368193, "cost1_mean": 360.30894683498775, "system_level_velocity_mean": 14.30989690961329, "outflow_rate_max": 1284.1789386272792, "cost1_min": 29.066451425817114, "system_level_velocity_max": 19.663573300961705, "system_level_velocity_min": 11.647913200147405, "outflow_rate_min": 325.95804891954316, "cost2_max": -10.100632341768165, "cost2_mean": -44.61237020058556, "outflow_rate_mean": 1090.6828608945536, "cost2_min": -63.10507610457123}, "training_iteration": 96, "episodes_total": 1453, "episode_len_mean": 669.98, "timestamp": 1557207593, "time_total_s": 2516.1189279556274, "pid": 32008, "info": {"num_steps_trained": 4219548, "num_steps_sampled": 4219548, "load_time_ms": 13.731, "grad_time_ms": 10291.266, "sample_time_ms": 15326.289, "update_time_ms": 8.356, "default": {"vf_explained_var": 0.9462905526161194, "vf_loss": 17.911333084106445, "entropy": 1.1346546411514282, "cur_lr": 0.0005000000237487257, "total_loss": 17.907093048095703, "kl": 0.017778761684894562, "policy_loss": -0.006240521091967821, "cur_kl_coeff": 0.11249999701976776}}, "time_this_iter_s": 25.83037567138672, "timesteps_since_restore": 4219548, "time_since_restore": 2516.1189279556274, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43841, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b94a8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf320>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-39-53", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 57.440910400074316}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1507.4833240068604, "node_ip": "10.138.0.2", "timesteps_total": 4262624, "iterations_since_restore": 97, "episode_reward_mean": 1293.998524391802, "custom_metrics": {"cost1_max": 432.41749003368193, "cost1_mean": 359.75104444747006, "system_level_velocity_mean": 14.28639544889306, "outflow_rate_max": 1303.811497682183, "cost1_min": 29.066451425817114, "system_level_velocity_max": 19.663573300961705, "system_level_velocity_min": 11.484812906609625, "outflow_rate_min": 325.95804891954316, "cost2_max": -10.100632341768165, "cost2_mean": -46.38639234559541, "outflow_rate_mean": 1090.0306609293482, "cost2_min": -70.71452273682459}, "training_iteration": 97, "episodes_total": 1472, "episode_len_mean": 669.98, "timestamp": 1557207619, "time_total_s": 2542.022886276245, "pid": 32008, "info": {"num_steps_trained": 4262624, "num_steps_sampled": 4262624, "load_time_ms": 13.553, "grad_time_ms": 10214.434, "sample_time_ms": 15413.799, "update_time_ms": 8.566, "default": {"vf_explained_var": 0.9642770886421204, "vf_loss": 13.0238676071167, "entropy": 1.166275978088379, "cur_lr": 0.0005000000237487257, "total_loss": 13.017372131347656, "kl": 0.017245028167963028, "policy_loss": -0.008434893563389778, "cur_kl_coeff": 0.11249999701976776}}, "time_this_iter_s": 25.903958320617676, "timesteps_since_restore": 4262624, "time_since_restore": 2542.022886276245, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43076, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfb38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfd68>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bffd0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-40-19", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 57.440910400074316}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1560.6611194379811, "node_ip": "10.138.0.2", "timesteps_total": 4305322, "iterations_since_restore": 98, "episode_reward_mean": 1273.5405164155156, "custom_metrics": {"cost1_max": 432.41749003368193, "cost1_mean": 353.5629101112209, "system_level_velocity_mean": 14.355219872326982, "outflow_rate_max": 1303.811497682183, "cost1_min": 29.066451425817114, "system_level_velocity_max": 19.92006705622778, "system_level_velocity_min": 11.484812906609625, "outflow_rate_min": 325.95804891954316, "cost2_max": -10.100632341768165, "cost2_mean": -48.22401219456584, "outflow_rate_mean": 1074.754331429299, "cost2_min": -70.71452273682459}, "training_iteration": 98, "episodes_total": 1487, "episode_len_mean": 658.57, "timestamp": 1557207645, "time_total_s": 2568.1169595718384, "pid": 32008, "info": {"num_steps_trained": 4305322, "num_steps_sampled": 4305322, "load_time_ms": 13.901, "grad_time_ms": 9917.824, "sample_time_ms": 15644.642, "update_time_ms": 8.388, "default": {"vf_explained_var": 0.9465634226799011, "vf_loss": 18.374561309814453, "entropy": 1.154908299446106, "cur_lr": 0.0005000000237487257, "total_loss": 18.36832618713379, "kl": 0.019364986568689346, "policy_loss": -0.008414646610617638, "cur_kl_coeff": 0.11250000447034836}}, "time_this_iter_s": 26.09407329559326, "timesteps_since_restore": 4305322, "time_since_restore": 2568.1169595718384, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42698, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf128>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf860>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-40-45", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 53.8731125411884}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1560.6611194379811, "node_ip": "10.138.0.2", "timesteps_total": 4349552, "iterations_since_restore": 99, "episode_reward_mean": 1272.6596450130244, "custom_metrics": {"cost1_max": 432.41749003368193, "cost1_mean": 350.77007678265954, "system_level_velocity_mean": 14.326985534253874, "outflow_rate_max": 1303.811497682183, "cost1_min": 29.066451425817114, "system_level_velocity_max": 19.92006705622778, "system_level_velocity_min": 11.484812906609625, "outflow_rate_min": 325.95804891954316, "cost2_max": -10.100632341768165, "cost2_mean": -49.492266716268816, "outflow_rate_mean": 1068.159180401441, "cost2_min": -73.5370098721627}, "training_iteration": 99, "episodes_total": 1500, "episode_len_mean": 655.08, "timestamp": 1557207671, "time_total_s": 2593.8092391490936, "pid": 32008, "info": {"num_steps_trained": 4349552, "num_steps_sampled": 4349552, "load_time_ms": 14.051, "grad_time_ms": 9800.658, "sample_time_ms": 15678.292, "update_time_ms": 7.967, "default": {"vf_explained_var": 0.949861466884613, "vf_loss": 14.449581146240234, "entropy": 1.1406989097595215, "cur_lr": 0.0005000000237487257, "total_loss": 14.446382522583008, "kl": 0.014651276171207428, "policy_loss": -0.004848337732255459, "cur_kl_coeff": 0.11249999701976776}}, "time_this_iter_s": 25.69227957725525, "timesteps_since_restore": 4349552, "time_since_restore": 2593.8092391490936, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44230, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf4e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4cc0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf3c8>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-41-11", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 53.8731125411884}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1560.6611194379811, "node_ip": "10.138.0.2", "timesteps_total": 4391823, "iterations_since_restore": 100, "episode_reward_mean": 1273.7046703675228, "custom_metrics": {"cost1_max": 434.34579494422553, "cost1_mean": 349.7088506520954, "system_level_velocity_mean": 14.417227256396895, "outflow_rate_max": 1303.811497682183, "cost1_min": 29.066451425817114, "system_level_velocity_max": 19.92006705622778, "system_level_velocity_min": 11.484812906609625, "outflow_rate_min": 325.95804891954316, "cost2_max": -10.100632341768165, "cost2_mean": -51.37077570619096, "outflow_rate_mean": 1066.3285821723036, "cost2_min": -80.29134024399349}, "training_iteration": 100, "episodes_total": 1517, "episode_len_mean": 649.68, "timestamp": 1557207696, "time_total_s": 2619.209961414337, "pid": 32008, "info": {"num_steps_trained": 4391823, "num_steps_sampled": 4391823, "load_time_ms": 14.225, "grad_time_ms": 9817.316, "sample_time_ms": 15614.803, "update_time_ms": 7.816, "default": {"vf_explained_var": 0.950404942035675, "vf_loss": 15.710437774658203, "entropy": 1.1418784856796265, "cur_lr": 0.0005000000237487257, "total_loss": 15.706429481506348, "kl": 0.016373353078961372, "policy_loss": -0.005851565860211849, "cur_kl_coeff": 0.11249999701976776}}, "time_this_iter_s": 25.40072226524353, "timesteps_since_restore": 4391823, "time_since_restore": 2619.209961414337, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42271, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf2b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf358>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf0b8>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-41-36", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 53.8731125411884}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1560.6611194379811, "node_ip": "10.138.0.2", "timesteps_total": 4433740, "iterations_since_restore": 101, "episode_reward_mean": 1300.755821567768, "custom_metrics": {"cost1_max": 434.34579494422553, "cost1_mean": 354.5151221184561, "system_level_velocity_mean": 14.361532305699034, "outflow_rate_max": 1303.811497682183, "cost1_min": 29.271456111055866, "system_level_velocity_max": 19.92006705622778, "system_level_velocity_min": 11.484812906609625, "outflow_rate_min": 325.95804891954316, "cost2_max": -10.100632341768165, "cost2_mean": -55.725247635714574, "outflow_rate_mean": 1075.10390063618, "cost2_min": -83.93234354985997}, "training_iteration": 101, "episodes_total": 1536, "episode_len_mean": 657.21, "timestamp": 1557207722, "time_total_s": 2645.151207923889, "pid": 32008, "info": {"num_steps_trained": 4433740, "num_steps_sampled": 4433740, "load_time_ms": 14.269, "grad_time_ms": 9788.216, "sample_time_ms": 15708.967, "update_time_ms": 8.18, "default": {"vf_explained_var": 0.9622377157211304, "vf_loss": 14.740150451660156, "entropy": 1.1712197065353394, "cur_lr": 0.0005000000237487257, "total_loss": 14.736319541931152, "kl": 0.017033077776432037, "policy_loss": -0.005748470313847065, "cur_kl_coeff": 0.11250000447034836}}, "time_this_iter_s": 25.941246509552002, "timesteps_since_restore": 4433740, "time_since_restore": 2645.151207923889, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 41917, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d15f8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1f60>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-42-02", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 53.8731125411884}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1560.6611194379811, "node_ip": "10.138.0.2", "timesteps_total": 4475641, "iterations_since_restore": 102, "episode_reward_mean": 1325.2918433629272, "custom_metrics": {"cost1_max": 451.33177414337854, "cost1_mean": 362.072979774023, "system_level_velocity_mean": 14.356949061661041, "outflow_rate_max": 1312.2470832674267, "cost1_min": 29.271456111055866, "system_level_velocity_max": 19.92006705622778, "system_level_velocity_min": 11.484812906609625, "outflow_rate_min": 329.6337234057179, "cost2_max": -14.5557196566905, "cost2_mean": -59.406655558803095, "outflow_rate_mean": 1092.0130454210416, "cost2_min": -106.41544089901728}, "training_iteration": 102, "episodes_total": 1551, "episode_len_mean": 668.11, "timestamp": 1557207747, "time_total_s": 2670.502006292343, "pid": 32008, "info": {"num_steps_trained": 4475641, "num_steps_sampled": 4475641, "load_time_ms": 13.734, "grad_time_ms": 9767.492, "sample_time_ms": 15705.832, "update_time_ms": 8.143, "default": {"vf_explained_var": 0.9716907739639282, "vf_loss": 11.69080924987793, "entropy": 1.166453242301941, "cur_lr": 0.0005000000237487257, "total_loss": 11.68679141998291, "kl": 0.020658472552895546, "policy_loss": -0.006340954452753067, "cur_kl_coeff": 0.11250000447034836}}, "time_this_iter_s": 25.35079836845398, "timesteps_since_restore": 4475641, "time_since_restore": 2670.502006292343, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 41901, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf6d8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfc18>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-42-27", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 53.8731125411884}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1560.6611194379811, "node_ip": "10.138.0.2", "timesteps_total": 4520505, "iterations_since_restore": 103, "episode_reward_mean": 1313.2814944033403, "custom_metrics": {"cost1_max": 451.33177414337854, "cost1_mean": 358.91343191940393, "system_level_velocity_mean": 14.458468961504309, "outflow_rate_max": 1312.2470832674267, "cost1_min": 29.271456111055866, "system_level_velocity_max": 19.92006705622778, "system_level_velocity_min": 12.133968731431054, "outflow_rate_min": 329.6337234057179, "cost2_max": -14.5557196566905, "cost2_mean": -61.62667208729635, "outflow_rate_mean": 1087.7762421864832, "cost2_min": -106.41544089901728}, "training_iteration": 103, "episodes_total": 1565, "episode_len_mean": 659.32, "timestamp": 1557207773, "time_total_s": 2696.3648552894592, "pid": 32008, "info": {"num_steps_trained": 4520505, "num_steps_sampled": 4520505, "load_time_ms": 14.144, "grad_time_ms": 9829.389, "sample_time_ms": 15692.487, "update_time_ms": 7.958, "default": {"vf_explained_var": 0.9654725790023804, "vf_loss": 12.970747947692871, "entropy": 1.2003973722457886, "cur_lr": 0.0005000000237487257, "total_loss": 12.966863632202148, "kl": 0.015444938093423843, "policy_loss": -0.006490602623671293, "cur_kl_coeff": 0.16875001788139343}}, "time_this_iter_s": 25.86284899711609, "timesteps_since_restore": 4520505, "time_since_restore": 2696.3648552894592, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44864, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1da0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1a90>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-42-53", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 53.8731125411884}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1560.6611194379811, "node_ip": "10.138.0.2", "timesteps_total": 4563769, "iterations_since_restore": 104, "episode_reward_mean": 1321.552505755665, "custom_metrics": {"cost1_max": 451.33177414337854, "cost1_mean": 361.5491728284984, "system_level_velocity_mean": 14.433642817282726, "outflow_rate_max": 1312.2470832674267, "cost1_min": 29.271456111055866, "system_level_velocity_max": 19.92006705622778, "system_level_velocity_min": 12.17582442846314, "outflow_rate_min": 329.6337234057179, "cost2_max": -14.5557196566905, "cost2_mean": -66.58710523031999, "outflow_rate_mean": 1093.279757855423, "cost2_min": -107.12055906929757}, "training_iteration": 104, "episodes_total": 1580, "episode_len_mean": 664.16, "timestamp": 1557207798, "time_total_s": 2721.4182226657867, "pid": 32008, "info": {"num_steps_trained": 4563769, "num_steps_sampled": 4563769, "load_time_ms": 14.656, "grad_time_ms": 9873.583, "sample_time_ms": 15656.021, "update_time_ms": 7.889, "default": {"vf_explained_var": 0.9813884496688843, "vf_loss": 7.475588798522949, "entropy": 1.1937224864959717, "cur_lr": 0.0005000000237487257, "total_loss": 7.470829010009766, "kl": 0.014581844210624695, "policy_loss": -0.0072210850194096565, "cur_kl_coeff": 0.16875001788139343}}, "time_this_iter_s": 25.053367376327515, "timesteps_since_restore": 4563769, "time_since_restore": 2721.4182226657867, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43264, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4c50>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b45f8>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-43-18", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 53.8731125411884}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1543.178105289536, "node_ip": "10.138.0.2", "timesteps_total": 4606177, "iterations_since_restore": 105, "episode_reward_mean": 1327.9032732931162, "custom_metrics": {"cost1_max": 451.33177414337854, "cost1_mean": 363.2504761217364, "system_level_velocity_mean": 14.46954941699445, "outflow_rate_max": 1312.2470832674267, "cost1_min": 71.71516886501182, "system_level_velocity_max": 18.23941177314338, "system_level_velocity_min": 12.076663879037435, "outflow_rate_min": 374.0027011689314, "cost2_max": -15.281476428358136, "cost2_mean": -69.19080396565249, "outflow_rate_mean": 1099.573768812067, "cost2_min": -107.12055906929757}, "training_iteration": 105, "episodes_total": 1598, "episode_len_mean": 664.73, "timestamp": 1557207824, "time_total_s": 2746.8797664642334, "pid": 32008, "info": {"num_steps_trained": 4606177, "num_steps_sampled": 4606177, "load_time_ms": 14.385, "grad_time_ms": 9862.845, "sample_time_ms": 15687.859, "update_time_ms": 7.864, "default": {"vf_explained_var": 0.9544011354446411, "vf_loss": 18.535490036010742, "entropy": 1.1933817863464355, "cur_lr": 0.0005000000237487257, "total_loss": 18.531017303466797, "kl": 0.016038445755839348, "policy_loss": -0.0071791126392781734, "cur_kl_coeff": 0.16875003278255463}}, "time_this_iter_s": 25.461543798446655, "timesteps_since_restore": 4606177, "time_since_restore": 2746.8797664642334, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42408, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bff98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfc18>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf6d8>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-43-44", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 189.3707063157244}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1574.7917509398167, "node_ip": "10.138.0.2", "timesteps_total": 4651342, "iterations_since_restore": 106, "episode_reward_mean": 1330.239630800936, "custom_metrics": {"cost1_max": 451.33177414337854, "cost1_mean": 363.87918938097386, "system_level_velocity_mean": 14.48199172495169, "outflow_rate_max": 1312.2470832674267, "cost1_min": 71.71516886501182, "system_level_velocity_max": 18.23941177314338, "system_level_velocity_min": 11.66273711094385, "outflow_rate_min": 374.0027011689314, "cost2_max": -15.281476428358136, "cost2_mean": -71.10914492578436, "outflow_rate_mean": 1103.6166798971544, "cost2_min": -107.12055906929757}, "training_iteration": 106, "episodes_total": 1611, "episode_len_mean": 664.73, "timestamp": 1557207850, "time_total_s": 2773.3331739902496, "pid": 32008, "info": {"num_steps_trained": 4651342, "num_steps_sampled": 4651342, "load_time_ms": 14.998, "grad_time_ms": 9933.845, "sample_time_ms": 15677.751, "update_time_ms": 7.935, "default": {"vf_explained_var": 0.9623917937278748, "vf_loss": 11.769002914428711, "entropy": 1.2019374370574951, "cur_lr": 0.0005000000237487257, "total_loss": 11.765176773071289, "kl": 0.014838931150734425, "policy_loss": -0.006331374868750572, "cur_kl_coeff": 0.16875003278255463}}, "time_this_iter_s": 26.453407526016235, "timesteps_since_restore": 4651342, "time_since_restore": 2773.3331739902496, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 45165, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9c50>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9d68>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-44-10", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 189.3707063157244}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1574.7917509398167, "node_ip": "10.138.0.2", "timesteps_total": 4695175, "iterations_since_restore": 107, "episode_reward_mean": 1315.987839095414, "custom_metrics": {"cost1_max": 451.33177414337854, "cost1_mean": 360.45630258898206, "system_level_velocity_mean": 14.39467394480186, "outflow_rate_max": 1312.2470832674267, "cost1_min": 29.665089834264865, "system_level_velocity_max": 19.338561506633326, "system_level_velocity_min": 11.66273711094385, "outflow_rate_min": 322.7240781658874, "cost2_max": -10.563416964268631, "cost2_mean": -74.70868463507163, "outflow_rate_mean": 1097.4726631819888, "cost2_min": -111.48516747322168}, "training_iteration": 107, "episodes_total": 1626, "episode_len_mean": 663.77, "timestamp": 1557207877, "time_total_s": 2799.64102435112, "pid": 32008, "info": {"num_steps_trained": 4695175, "num_steps_sampled": 4695175, "load_time_ms": 15.232, "grad_time_ms": 10004.616, "sample_time_ms": 15646.957, "update_time_ms": 7.671, "default": {"vf_explained_var": 0.9697995781898499, "vf_loss": 12.275901794433594, "entropy": 1.2267080545425415, "cur_lr": 0.0005000000237487257, "total_loss": 12.270804405212402, "kl": 0.014784863218665123, "policy_loss": -0.0075919306837022305, "cur_kl_coeff": 0.16875003278255463}}, "time_this_iter_s": 26.30785036087036, "timesteps_since_restore": 4695175, "time_since_restore": 2799.64102435112, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43833, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bff98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf6d8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfc18>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-44-37", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 58.60612333458849}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1574.7917509398167, "node_ip": "10.138.0.2", "timesteps_total": 4738736, "iterations_since_restore": 108, "episode_reward_mean": 1314.7811323628787, "custom_metrics": {"cost1_max": 490.86744129161997, "cost1_mean": 357.84460395990465, "system_level_velocity_mean": 14.280034427085777, "outflow_rate_max": 1341.0682110661269, "cost1_min": 29.665089834264865, "system_level_velocity_max": 19.338561506633326, "system_level_velocity_min": 11.37149669683552, "outflow_rate_min": 322.7240781658874, "cost2_max": -10.563416964268631, "cost2_mean": -79.02478456488316, "outflow_rate_mean": 1092.8411692666562, "cost2_min": -115.1343374221848}, "training_iteration": 108, "episodes_total": 1643, "episode_len_mean": 663.77, "timestamp": 1557207902, "time_total_s": 2824.6101293563843, "pid": 32008, "info": {"num_steps_trained": 4738736, "num_steps_sampled": 4738736, "load_time_ms": 15.078, "grad_time_ms": 10207.412, "sample_time_ms": 15330.839, "update_time_ms": 7.657, "default": {"vf_explained_var": 0.974838137626648, "vf_loss": 9.282140731811523, "entropy": 1.225075602531433, "cur_lr": 0.0005000000237487257, "total_loss": 9.27652645111084, "kl": 0.015884999185800552, "policy_loss": -0.00829559750854969, "cur_kl_coeff": 0.16875001788139343}}, "time_this_iter_s": 24.969105005264282, "timesteps_since_restore": 4738736, "time_since_restore": 2824.6101293563843, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43561, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b46a0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4400>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-45-02", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 58.60612333458849}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1608.347129282141, "node_ip": "10.138.0.2", "timesteps_total": 4783459, "iterations_since_restore": 109, "episode_reward_mean": 1328.633724081358, "custom_metrics": {"cost1_max": 490.86744129161997, "cost1_mean": 358.8329066877928, "system_level_velocity_mean": 14.188118931592516, "outflow_rate_max": 1341.0682110661269, "cost1_min": 29.665089834264865, "system_level_velocity_max": 19.338561506633326, "system_level_velocity_min": 11.37149669683552, "outflow_rate_min": 322.7240781658874, "cost2_max": -10.563416964268631, "cost2_mean": -81.97668747726992, "outflow_rate_mean": 1094.6127420135197, "cost2_min": -115.1343374221848}, "training_iteration": 109, "episodes_total": 1657, "episode_len_mean": 668.64, "timestamp": 1557207928, "time_total_s": 2851.2321786880493, "pid": 32008, "info": {"num_steps_trained": 4783459, "num_steps_sampled": 4783459, "load_time_ms": 14.672, "grad_time_ms": 10286.641, "sample_time_ms": 15344.656, "update_time_ms": 7.938, "default": {"vf_explained_var": 0.9819390177726746, "vf_loss": 6.535627841949463, "entropy": 1.2623727321624756, "cur_lr": 0.0005000000237487257, "total_loss": 6.531041622161865, "kl": 0.01349662709981203, "policy_loss": -0.0068636671639978886, "cur_kl_coeff": 0.16875003278255463}}, "time_this_iter_s": 26.62204933166504, "timesteps_since_restore": 4783459, "time_since_restore": 2851.2321786880493, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44723, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d15f8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1a90>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-45-28", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 58.60612333458849}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1608.347129282141, "node_ip": "10.138.0.2", "timesteps_total": 4829176, "iterations_since_restore": 110, "episode_reward_mean": 1304.0521434567593, "custom_metrics": {"cost1_max": 490.86744129161997, "cost1_mean": 353.4591569864417, "system_level_velocity_mean": 14.254918904476883, "outflow_rate_max": 1341.0682110661269, "cost1_min": 29.665089834264865, "system_level_velocity_max": 19.338561506633326, "system_level_velocity_min": 11.37149669683552, "outflow_rate_min": 315.33696978526723, "cost2_max": -10.563416964268631, "cost2_mean": -81.93907434859977, "outflow_rate_mean": 1080.3264729054308, "cost2_min": -115.1343374221848}, "training_iteration": 110, "episodes_total": 1671, "episode_len_mean": 659.56, "timestamp": 1557207955, "time_total_s": 2878.2289764881134, "pid": 32008, "info": {"num_steps_trained": 4829176, "num_steps_sampled": 4829176, "load_time_ms": 14.935, "grad_time_ms": 10303.696, "sample_time_ms": 15485.926, "update_time_ms": 8.011, "default": {"vf_explained_var": 0.9728029370307922, "vf_loss": 10.043882369995117, "entropy": 1.2656348943710327, "cur_lr": 0.0005000000237487257, "total_loss": 10.039718627929688, "kl": 0.013814819045364857, "policy_loss": -0.006494442466646433, "cur_kl_coeff": 0.16875003278255463}}, "time_this_iter_s": 26.996797800064087, "timesteps_since_restore": 4829176, "time_since_restore": 2878.2289764881134, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 45717, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfbe0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf518>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf828>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-45-55", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 58.60612333458849}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1608.347129282141, "node_ip": "10.138.0.2", "timesteps_total": 4873861, "iterations_since_restore": 111, "episode_reward_mean": 1313.0478852883361, "custom_metrics": {"cost1_max": 490.86744129161997, "cost1_mean": 355.0929099916225, "system_level_velocity_mean": 14.213737935819236, "outflow_rate_max": 1341.0682110661269, "cost1_min": 29.665089834264865, "system_level_velocity_max": 19.338561506633326, "system_level_velocity_min": 11.37149669683552, "outflow_rate_min": 315.33696978526723, "cost2_max": -10.563416964268631, "cost2_mean": -84.7974866756191, "outflow_rate_mean": 1083.1822450515203, "cost2_min": -119.98873256187862}, "training_iteration": 111, "episodes_total": 1687, "episode_len_mean": 663.73, "timestamp": 1557207981, "time_total_s": 2904.3133568763733, "pid": 32008, "info": {"num_steps_trained": 4873861, "num_steps_sampled": 4873861, "load_time_ms": 15.015, "grad_time_ms": 10396.415, "sample_time_ms": 15406.847, "update_time_ms": 7.758, "default": {"vf_explained_var": 0.9824771285057068, "vf_loss": 6.750818252563477, "entropy": 1.2337863445281982, "cur_lr": 0.0005000000237487257, "total_loss": 6.746273994445801, "kl": 0.014611368998885155, "policy_loss": -0.007009419612586498, "cur_kl_coeff": 0.16875003278255463}}, "time_this_iter_s": 26.084380388259888, "timesteps_since_restore": 4873861, "time_since_restore": 2904.3133568763733, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44685, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4c18>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b45f8>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-46-21", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 58.60612333458849}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1608.347129282141, "node_ip": "10.138.0.2", "timesteps_total": 4916300, "iterations_since_restore": 112, "episode_reward_mean": 1324.700187820998, "custom_metrics": {"cost1_max": 490.86744129161997, "cost1_mean": 359.00438413287884, "system_level_velocity_mean": 14.077197539883993, "outflow_rate_max": 1341.0682110661269, "cost1_min": 29.665089834264865, "system_level_velocity_max": 19.338561506633326, "system_level_velocity_min": 11.37149669683552, "outflow_rate_min": 315.33696978526723, "cost2_max": -10.563416964268631, "cost2_mean": -89.11380198309524, "outflow_rate_mean": 1095.3780436051668, "cost2_min": -119.98873256187862}, "training_iteration": 112, "episodes_total": 1703, "episode_len_mean": 675.03, "timestamp": 1557208008, "time_total_s": 2930.7367131710052, "pid": 32008, "info": {"num_steps_trained": 4916300, "num_steps_sampled": 4916300, "load_time_ms": 15.915, "grad_time_ms": 10498.365, "sample_time_ms": 15410.871, "update_time_ms": 7.757, "default": {"vf_explained_var": 0.9663264751434326, "vf_loss": 12.321366310119629, "entropy": 1.250800609588623, "cur_lr": 0.0005000000237487257, "total_loss": 12.31605052947998, "kl": 0.015852827578783035, "policy_loss": -0.007990757003426552, "cur_kl_coeff": 0.16875003278255463}}, "time_this_iter_s": 26.423356294631958, "timesteps_since_restore": 4916300, "time_since_restore": 2930.7367131710052, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42439, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdcf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa080>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa4e0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-46-48", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 58.60612333458849}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1608.347129282141, "node_ip": "10.138.0.2", "timesteps_total": 4959947, "iterations_since_restore": 113, "episode_reward_mean": 1336.8643296494292, "custom_metrics": {"cost1_max": 490.86744129161997, "cost1_mean": 362.3052338008342, "system_level_velocity_mean": 14.025770439996464, "outflow_rate_max": 1341.0682110661269, "cost1_min": 33.32498905370987, "system_level_velocity_max": 19.128401457947607, "system_level_velocity_min": 11.37149669683552, "outflow_rate_min": 315.33696978526723, "cost2_max": -14.75022959289934, "cost2_mean": -91.00375486040203, "outflow_rate_mean": 1103.1138802888827, "cost2_min": -120.11497825863182}, "training_iteration": 113, "episodes_total": 1719, "episode_len_mean": 681.59, "timestamp": 1557208033, "time_total_s": 2956.061392068863, "pid": 32008, "info": {"num_steps_trained": 4959947, "num_steps_sampled": 4959947, "load_time_ms": 16.114, "grad_time_ms": 10484.578, "sample_time_ms": 15371.654, "update_time_ms": 7.941, "default": {"vf_explained_var": 0.9774909615516663, "vf_loss": 7.7307515144348145, "entropy": 1.2374951839447021, "cur_lr": 0.0005000000237487257, "total_loss": 7.725297451019287, "kl": 0.014182090759277344, "policy_loss": -0.007847636006772518, "cur_kl_coeff": 0.16875001788139343}}, "time_this_iter_s": 25.324678897857666, "timesteps_since_restore": 4959947, "time_since_restore": 2956.061392068863, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43647, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4748>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4780>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-47-13", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 61.99574735259179}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1608.347129282141, "node_ip": "10.138.0.2", "timesteps_total": 5005738, "iterations_since_restore": 114, "episode_reward_mean": 1347.8904656935413, "custom_metrics": {"cost1_max": 490.86744129161997, "cost1_mean": 364.8255875125613, "system_level_velocity_mean": 14.07079854327857, "outflow_rate_max": 1341.0682110661269, "cost1_min": 33.32498905370987, "system_level_velocity_max": 19.128401457947607, "system_level_velocity_min": 11.957164198241466, "outflow_rate_min": 315.33696978526723, "cost2_max": -14.75022959289934, "cost2_mean": -92.38188758342334, "outflow_rate_mean": 1109.0090158888859, "cost2_min": -120.11497825863182}, "training_iteration": 114, "episodes_total": 1734, "episode_len_mean": 683.49, "timestamp": 1557208060, "time_total_s": 2983.1856384277344, "pid": 32008, "info": {"num_steps_trained": 5005738, "num_steps_sampled": 5005738, "load_time_ms": 15.948, "grad_time_ms": 10509.695, "sample_time_ms": 15553.972, "update_time_ms": 7.923, "default": {"vf_explained_var": 0.9769248366355896, "vf_loss": 8.409239768981934, "entropy": 1.2457455396652222, "cur_lr": 0.0005000000237487257, "total_loss": 8.405689239501953, "kl": 0.014759589917957783, "policy_loss": -0.006040719337761402, "cur_kl_coeff": 0.16875003278255463}}, "time_this_iter_s": 27.12424635887146, "timesteps_since_restore": 5005738, "time_since_restore": 2983.1856384277344, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 45791, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4c18>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a72b0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-47-40", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 61.99574735259179}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1608.347129282141, "node_ip": "10.138.0.2", "timesteps_total": 5050465, "iterations_since_restore": 115, "episode_reward_mean": 1345.9170339314255, "custom_metrics": {"cost1_max": 463.1597267834502, "cost1_mean": 363.4148576671598, "system_level_velocity_mean": 14.028878555762633, "outflow_rate_max": 1330.211867629802, "cost1_min": 33.32498905370987, "system_level_velocity_max": 19.128401457947607, "system_level_velocity_min": 11.957164198241466, "outflow_rate_min": 315.33696978526723, "cost2_max": -14.75022959289934, "cost2_mean": -93.479125409166, "outflow_rate_mean": 1105.1305395442832, "cost2_min": -120.11497825863182}, "training_iteration": 115, "episodes_total": 1744, "episode_len_mean": 683.49, "timestamp": 1557208087, "time_total_s": 3009.271476984024, "pid": 32008, "info": {"num_steps_trained": 5050465, "num_steps_sampled": 5050465, "load_time_ms": 16.091, "grad_time_ms": 10518.17, "sample_time_ms": 15608.536, "update_time_ms": 7.581, "default": {"vf_explained_var": 0.9880362153053284, "vf_loss": 3.808277130126953, "entropy": 1.2194563150405884, "cur_lr": 0.0005000000237487257, "total_loss": 3.8027734756469727, "kl": 0.015834923833608627, "policy_loss": -0.008176038041710854, "cur_kl_coeff": 0.16875003278255463}}, "time_this_iter_s": 26.085838556289673, "timesteps_since_restore": 5050465, "time_since_restore": 3009.271476984024, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44727, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cebe0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ceb70>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce0f0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-48-07", "hostname": "flow-main", "episodes_this_iter": 10, "episode_reward_min": 61.99574735259179}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1610.209748823037, "node_ip": "10.138.0.2", "timesteps_total": 5093151, "iterations_since_restore": 116, "episode_reward_mean": 1338.4730970106111, "custom_metrics": {"cost1_max": 463.1597267834502, "cost1_mean": 362.8514865320518, "system_level_velocity_mean": 14.100404504951884, "outflow_rate_max": 1302.274125679732, "cost1_min": 33.32498905370987, "system_level_velocity_max": 19.128401457947607, "system_level_velocity_min": 11.937138331733703, "outflow_rate_min": 315.33696978526723, "cost2_max": -14.75022959289934, "cost2_mean": -92.32736408383047, "outflow_rate_mean": 1105.6786072592395, "cost2_min": -120.11497825863182}, "training_iteration": 116, "episodes_total": 1762, "episode_len_mean": 680.19, "timestamp": 1557208112, "time_total_s": 3034.271926879883, "pid": 32008, "info": {"num_steps_trained": 5093151, "num_steps_sampled": 5093151, "load_time_ms": 15.753, "grad_time_ms": 10474.09, "sample_time_ms": 15507.927, "update_time_ms": 7.424, "default": {"vf_explained_var": 0.9607994556427002, "vf_loss": 16.08934783935547, "entropy": 1.2181016206741333, "cur_lr": 0.0005000000237487257, "total_loss": 16.084312438964844, "kl": 0.01523392740637064, "policy_loss": -0.007607166655361652, "cur_kl_coeff": 0.16875001788139343}}, "time_this_iter_s": 25.000449895858765, "timesteps_since_restore": 5093151, "time_since_restore": 3034.271926879883, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42686, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cddd8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd748>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-48-32", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 61.99574735259179}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1623.2248586052478, "node_ip": "10.138.0.2", "timesteps_total": 5135371, "iterations_since_restore": 117, "episode_reward_mean": 1365.845137818919, "custom_metrics": {"cost1_max": 463.1597267834502, "cost1_mean": 369.0016215296726, "system_level_velocity_mean": 14.12590407134364, "outflow_rate_max": 1302.274125679732, "cost1_min": 80.23785106752746, "system_level_velocity_max": 19.641661220915278, "system_level_velocity_min": 11.843056849524936, "outflow_rate_min": 419.22127463342616, "cost2_max": -22.887466772550404, "cost2_mean": -91.94639010799641, "outflow_rate_mean": 1127.4428211073566, "cost2_min": -120.11497825863182}, "training_iteration": 117, "episodes_total": 1780, "episode_len_mean": 687.32, "timestamp": 1557208136, "time_total_s": 3058.5284032821655, "pid": 32008, "info": {"num_steps_trained": 5135371, "num_steps_sampled": 5135371, "load_time_ms": 15.589, "grad_time_ms": 10462.65, "sample_time_ms": 15314.058, "update_time_ms": 7.375, "default": {"vf_explained_var": 0.9600362777709961, "vf_loss": 15.382524490356445, "entropy": 1.2240797281265259, "cur_lr": 0.0005000000237487257, "total_loss": 15.377305030822754, "kl": 0.015612213872373104, "policy_loss": -0.007855096831917763, "cur_kl_coeff": 0.16875001788139343}}, "time_this_iter_s": 24.256476402282715, "timesteps_since_restore": 5135371, "time_since_restore": 3058.5284032821655, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42220, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf400>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfcf8>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-48-56", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 168.60856794166045}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1623.2248586052478, "node_ip": "10.138.0.2", "timesteps_total": 5179611, "iterations_since_restore": 118, "episode_reward_mean": 1372.3058629114953, "custom_metrics": {"cost1_max": 432.1187678684805, "cost1_mean": 370.6034223819375, "system_level_velocity_mean": 14.193678930817677, "outflow_rate_max": 1302.274125679732, "cost1_min": 80.23785106752746, "system_level_velocity_max": 19.641661220915278, "system_level_velocity_min": 11.215220628537738, "outflow_rate_min": 419.22127463342616, "cost2_max": -22.887466772550404, "cost2_mean": -90.48546132427833, "outflow_rate_mean": 1131.2946219504047, "cost2_min": -120.11497825863182}, "training_iteration": 118, "episodes_total": 1793, "episode_len_mean": 687.32, "timestamp": 1557208162, "time_total_s": 3084.9618833065033, "pid": 32008, "info": {"num_steps_trained": 5179611, "num_steps_sampled": 5179611, "load_time_ms": 15.682, "grad_time_ms": 10462.451, "sample_time_ms": 15460.525, "update_time_ms": 7.461, "default": {"vf_explained_var": 0.9690675735473633, "vf_loss": 10.854743957519531, "entropy": 1.239083170890808, "cur_lr": 0.0005000000237487257, "total_loss": 10.851558685302734, "kl": 0.015485206618905067, "policy_loss": -0.005798653699457645, "cur_kl_coeff": 0.16875001788139343}}, "time_this_iter_s": 26.43348002433777, "timesteps_since_restore": 5179611, "time_since_restore": 3084.9618833065033, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44240, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cedd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce160>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce0b8>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-49-22", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 168.60856794166045}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1623.2248586052478, "node_ip": "10.138.0.2", "timesteps_total": 5222629, "iterations_since_restore": 119, "episode_reward_mean": 1347.8535534571065, "custom_metrics": {"cost1_max": 432.1187678684805, "cost1_mean": 364.55072339007563, "system_level_velocity_mean": 14.33945751974619, "outflow_rate_max": 1302.274125679732, "cost1_min": 28.807146550103404, "system_level_velocity_max": 19.641661220915278, "system_level_velocity_min": 11.215220628537738, "outflow_rate_min": 321.1013202073825, "cost2_max": -10.368577334404284, "cost2_mean": -86.94773349517948, "outflow_rate_mean": 1116.5164691820855, "cost2_min": -120.11497825863182}, "training_iteration": 119, "episodes_total": 1812, "episode_len_mean": 674.19, "timestamp": 1557208187, "time_total_s": 3109.861424922943, "pid": 32008, "info": {"num_steps_trained": 5222629, "num_steps_sampled": 5222629, "load_time_ms": 16.008, "grad_time_ms": 10498.397, "sample_time_ms": 15251.357, "update_time_ms": 7.533, "default": {"vf_explained_var": 0.9614614844322205, "vf_loss": 14.543163299560547, "entropy": 1.203472375869751, "cur_lr": 0.0005000000237487257, "total_loss": 14.538832664489746, "kl": 0.01823931559920311, "policy_loss": -0.007410661317408085, "cur_kl_coeff": 0.16875001788139343}}, "time_this_iter_s": 24.89954161643982, "timesteps_since_restore": 5222629, "time_since_restore": 3109.861424922943, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43018, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce6d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ced30>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce3c8>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-49-47", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 50.0177860893085}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1623.2248586052478, "node_ip": "10.138.0.2", "timesteps_total": 5267842, "iterations_since_restore": 120, "episode_reward_mean": 1354.437686022316, "custom_metrics": {"cost1_max": 432.1187678684805, "cost1_mean": 367.4498300072981, "system_level_velocity_mean": 14.37459779368499, "outflow_rate_max": 1302.274125679732, "cost1_min": 28.807146550103404, "system_level_velocity_max": 19.641661220915278, "system_level_velocity_min": 11.215220628537738, "outflow_rate_min": 321.1013202073825, "cost2_max": -10.368577334404284, "cost2_mean": -86.74839808257495, "outflow_rate_mean": 1125.202211747775, "cost2_min": -119.85963213530904}, "training_iteration": 120, "episodes_total": 1823, "episode_len_mean": 677.7, "timestamp": 1557208213, "time_total_s": 3135.8568761348724, "pid": 32008, "info": {"num_steps_trained": 5267842, "num_steps_sampled": 5267842, "load_time_ms": 15.624, "grad_time_ms": 10614.335, "sample_time_ms": 15033.636, "update_time_ms": 7.72, "default": {"vf_explained_var": 0.9820607900619507, "vf_loss": 7.067096710205078, "entropy": 1.2071542739868164, "cur_lr": 0.0005000000237487257, "total_loss": 7.062941074371338, "kl": 0.01440902054309845, "policy_loss": -0.0065862699411809444, "cur_kl_coeff": 0.16875003278255463}}, "time_this_iter_s": 25.99545121192932, "timesteps_since_restore": 5267842, "time_since_restore": 3135.8568761348724, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 45213, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce828>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce320>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-50-13", "hostname": "flow-main", "episodes_this_iter": 11, "episode_reward_min": 50.0177860893085}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1623.2248586052478, "node_ip": "10.138.0.2", "timesteps_total": 5310616, "iterations_since_restore": 121, "episode_reward_mean": 1347.158406095185, "custom_metrics": {"cost1_max": 432.1187678684805, "cost1_mean": 366.25528422461315, "system_level_velocity_mean": 14.490631887979116, "outflow_rate_max": 1310.4959988438263, "cost1_min": 28.807146550103404, "system_level_velocity_max": 19.641661220915278, "system_level_velocity_min": 11.215220628537738, "outflow_rate_min": 321.1013202073825, "cost2_max": -10.368577334404284, "cost2_mean": -84.6719413146545, "outflow_rate_mean": 1123.4120278457929, "cost2_min": -115.57098256332094}, "training_iteration": 121, "episodes_total": 1841, "episode_len_mean": 672.14, "timestamp": 1557208238, "time_total_s": 3160.6305768489838, "pid": 32008, "info": {"num_steps_trained": 5310616, "num_steps_sampled": 5310616, "load_time_ms": 15.22, "grad_time_ms": 10616.305, "sample_time_ms": 14899.036, "update_time_ms": 7.781, "default": {"vf_explained_var": 0.9687812328338623, "vf_loss": 12.184319496154785, "entropy": 1.2020881175994873, "cur_lr": 0.0005000000237487257, "total_loss": 12.179689407348633, "kl": 0.014084084890782833, "policy_loss": -0.007007503416389227, "cur_kl_coeff": 0.16875001788139343}}, "time_this_iter_s": 24.773700714111328, "timesteps_since_restore": 5310616, "time_since_restore": 3160.6305768489838, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42774, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d10b8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d17f0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-50-38", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 50.0177860893085}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1623.2248586052478, "node_ip": "10.138.0.2", "timesteps_total": 5354756, "iterations_since_restore": 122, "episode_reward_mean": 1339.225434903345, "custom_metrics": {"cost1_max": 432.1187678684805, "cost1_mean": 364.9725230274856, "system_level_velocity_mean": 14.594187116953503, "outflow_rate_max": 1310.4959988438263, "cost1_min": 28.807146550103404, "system_level_velocity_max": 19.641661220915278, "system_level_velocity_min": 11.215220628537738, "outflow_rate_min": 321.1013202073825, "cost2_max": -10.368577334404284, "cost2_mean": -82.87319210028299, "outflow_rate_mean": 1116.0110871850936, "cost2_min": -115.57098256332094}, "training_iteration": 122, "episodes_total": 1859, "episode_len_mean": 666.66, "timestamp": 1557208265, "time_total_s": 3187.044669866562, "pid": 32008, "info": {"num_steps_trained": 5354756, "num_steps_sampled": 5354756, "load_time_ms": 14.922, "grad_time_ms": 10606.767, "sample_time_ms": 14905.87, "update_time_ms": 8.009, "default": {"vf_explained_var": 0.974157989025116, "vf_loss": 10.356521606445312, "entropy": 1.2104625701904297, "cur_lr": 0.0005000000237487257, "total_loss": 10.352667808532715, "kl": 0.01474785152822733, "policy_loss": -0.006341581232845783, "cur_kl_coeff": 0.16875003278255463}}, "time_this_iter_s": 26.414093017578125, "timesteps_since_restore": 5354756, "time_since_restore": 3187.044669866562, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44140, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce6d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ced30>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cee48>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-51-05", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 50.0177860893085}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1623.2248586052478, "node_ip": "10.138.0.2", "timesteps_total": 5398559, "iterations_since_restore": 123, "episode_reward_mean": 1340.0515775683216, "custom_metrics": {"cost1_max": 432.1187678684805, "cost1_mean": 364.78727899870086, "system_level_velocity_mean": 14.504480383442145, "outflow_rate_max": 1310.4959988438263, "cost1_min": 28.807146550103404, "system_level_velocity_max": 19.641661220915278, "system_level_velocity_min": 11.215220628537738, "outflow_rate_min": 321.1013202073825, "cost2_max": -10.368577334404284, "cost2_mean": -84.09056343807211, "outflow_rate_mean": 1112.2522363861958, "cost2_min": -115.57098256332094}, "training_iteration": 123, "episodes_total": 1872, "episode_len_mean": 669.96, "timestamp": 1557208291, "time_total_s": 3213.243270635605, "pid": 32008, "info": {"num_steps_trained": 5398559, "num_steps_sampled": 5398559, "load_time_ms": 14.231, "grad_time_ms": 10628.033, "sample_time_ms": 14970.122, "update_time_ms": 8.15, "default": {"vf_explained_var": 0.9842737317085266, "vf_loss": 6.376483917236328, "entropy": 1.2022801637649536, "cur_lr": 0.0005000000237487257, "total_loss": 6.370935916900635, "kl": 0.01766873523592949, "policy_loss": -0.00853012129664421, "cur_kl_coeff": 0.16875003278255463}}, "time_this_iter_s": 26.19860076904297, "timesteps_since_restore": 5398559, "time_since_restore": 3213.243270635605, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43803, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa080>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7978>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-51-31", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 50.0177860893085}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1606.3126922086474, "node_ip": "10.138.0.2", "timesteps_total": 5442341, "iterations_since_restore": 124, "episode_reward_mean": 1351.9456682480504, "custom_metrics": {"cost1_max": 479.56110566494453, "cost1_mean": 367.85785323402456, "system_level_velocity_mean": 14.454183953811706, "outflow_rate_max": 1310.4959988438263, "cost1_min": 28.807146550103404, "system_level_velocity_max": 19.51978261073452, "system_level_velocity_min": 11.215220628537738, "outflow_rate_min": 321.1013202073825, "cost2_max": -10.368577334404284, "cost2_mean": -84.54574905693542, "outflow_rate_mean": 1121.0774551597228, "cost2_min": -114.13464434985924}, "training_iteration": 124, "episodes_total": 1885, "episode_len_mean": 675.83, "timestamp": 1557208318, "time_total_s": 3240.6532640457153, "pid": 32008, "info": {"num_steps_trained": 5442341, "num_steps_sampled": 5442341, "load_time_ms": 13.786, "grad_time_ms": 10758.666, "sample_time_ms": 14865.515, "update_time_ms": 8.532, "default": {"vf_explained_var": 0.9549300074577332, "vf_loss": 13.563163757324219, "entropy": 1.1684809923171997, "cur_lr": 0.0005000000237487257, "total_loss": 13.558002471923828, "kl": 0.01662190817296505, "policy_loss": -0.007966235280036926, "cur_kl_coeff": 0.16875003278255463}}, "time_this_iter_s": 27.409993410110474, "timesteps_since_restore": 5442341, "time_since_restore": 3240.6532640457153, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43782, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cea90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ceac8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce0b8>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-51-58", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 50.0177860893085}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1592.792168376239, "node_ip": "10.138.0.2", "timesteps_total": 5486079, "iterations_since_restore": 125, "episode_reward_mean": 1372.8407400938959, "custom_metrics": {"cost1_max": 479.56110566494453, "cost1_mean": 373.40928292377777, "system_level_velocity_mean": 14.435705555081817, "outflow_rate_max": 1310.4959988438263, "cost1_min": 100.35776839590046, "system_level_velocity_max": 19.161227508471022, "system_level_velocity_min": 12.436697160629242, "outflow_rate_min": 456.7646476442717, "cost2_max": -23.24450961478076, "cost2_mean": -87.071482431616, "outflow_rate_mean": 1132.9422745628854, "cost2_min": -116.44869676725231}, "training_iteration": 125, "episodes_total": 1902, "episode_len_mean": 683.97, "timestamp": 1557208345, "time_total_s": 3267.7813222408295, "pid": 32008, "info": {"num_steps_trained": 5486079, "num_steps_sampled": 5486079, "load_time_ms": 13.496, "grad_time_ms": 10856.303, "sample_time_ms": 14869.631, "update_time_ms": 8.939, "default": {"vf_explained_var": 0.9746443033218384, "vf_loss": 9.69433307647705, "entropy": 1.215793251991272, "cur_lr": 0.0005000000237487257, "total_loss": 9.68858814239502, "kl": 0.015515915118157864, "policy_loss": -0.008363630622625351, "cur_kl_coeff": 0.16875001788139343}}, "time_this_iter_s": 27.128058195114136, "timesteps_since_restore": 5486079, "time_since_restore": 3267.7813222408295, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43738, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce470>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cef98>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-52-25", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 236.23281902738557}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1592.792168376239, "node_ip": "10.138.0.2", "timesteps_total": 5530537, "iterations_since_restore": 126, "episode_reward_mean": 1374.588777563706, "custom_metrics": {"cost1_max": 479.56110566494453, "cost1_mean": 373.73079745779245, "system_level_velocity_mean": 14.446311923805453, "outflow_rate_max": 1310.4959988438263, "cost1_min": 100.35776839590046, "system_level_velocity_max": 19.161227508471022, "system_level_velocity_min": 12.567794603468354, "outflow_rate_min": 456.7646476442717, "cost2_max": -23.24450961478076, "cost2_mean": -87.21219538201207, "outflow_rate_mean": 1134.437932822537, "cost2_min": -116.44869676725231}, "training_iteration": 126, "episodes_total": 1915, "episode_len_mean": 683.97, "timestamp": 1557208370, "time_total_s": 3292.845597267151, "pid": 32008, "info": {"num_steps_trained": 5530537, "num_steps_sampled": 5530537, "load_time_ms": 13.535, "grad_time_ms": 10921.612, "sample_time_ms": 14810.405, "update_time_ms": 9.054, "default": {"vf_explained_var": 0.9718461036682129, "vf_loss": 9.66408920288086, "entropy": 1.2174034118652344, "cur_lr": 0.0005000000237487257, "total_loss": 9.660956382751465, "kl": 0.01509577501565218, "policy_loss": -0.005679856985807419, "cur_kl_coeff": 0.16875003278255463}}, "time_this_iter_s": 25.06427502632141, "timesteps_since_restore": 5530537, "time_since_restore": 3292.845597267151, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44458, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce358>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce898>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-52-50", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 236.23281902738557}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1592.792168376239, "node_ip": "10.138.0.2", "timesteps_total": 5574373, "iterations_since_restore": 127, "episode_reward_mean": 1383.8079082175893, "custom_metrics": {"cost1_max": 479.56110566494453, "cost1_mean": 374.8367262987677, "system_level_velocity_mean": 14.490246384706904, "outflow_rate_max": 1310.4959988438263, "cost1_min": 100.35776839590046, "system_level_velocity_max": 19.161227508471022, "system_level_velocity_min": 12.567794603468354, "outflow_rate_min": 456.7646476442717, "cost2_max": -23.24450961478076, "cost2_mean": -87.9731298392969, "outflow_rate_mean": 1136.525462031539, "cost2_min": -128.43662656865365}, "training_iteration": 127, "episodes_total": 1931, "episode_len_mean": 683.97, "timestamp": 1557208398, "time_total_s": 3320.097067832947, "pid": 32008, "info": {"num_steps_trained": 5574373, "num_steps_sampled": 5574373, "load_time_ms": 13.59, "grad_time_ms": 10996.214, "sample_time_ms": 15035.37, "update_time_ms": 9.353, "default": {"vf_explained_var": 0.982088565826416, "vf_loss": 7.386855602264404, "entropy": 1.2421135902404785, "cur_lr": 0.0005000000237487257, "total_loss": 7.382532119750977, "kl": 0.013985681347548962, "policy_loss": -0.00668339291587472, "cur_kl_coeff": 0.16875003278255463}}, "time_this_iter_s": 27.2514705657959, "timesteps_since_restore": 5574373, "time_since_restore": 3320.097067832947, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43836, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cedd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cec88>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce5f8>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-53-18", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 236.23281902738557}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1566.2865546485464, "node_ip": "10.138.0.2", "timesteps_total": 5617844, "iterations_since_restore": 128, "episode_reward_mean": 1385.4653770401842, "custom_metrics": {"cost1_max": 479.56110566494453, "cost1_mean": 379.8216821511604, "system_level_velocity_mean": 14.539347599880966, "outflow_rate_max": 1309.2978517865909, "cost1_min": 104.44667270869013, "system_level_velocity_max": 19.080993967797035, "system_level_velocity_min": 12.129778431985521, "outflow_rate_min": 463.42559889808206, "cost2_max": -23.24450961478076, "cost2_mean": -87.68575137558057, "outflow_rate_mean": 1145.5590384711902, "cost2_min": -128.43662656865365}, "training_iteration": 128, "episodes_total": 1948, "episode_len_mean": 689.53, "timestamp": 1557208423, "time_total_s": 3345.448647260666, "pid": 32008, "info": {"num_steps_trained": 5617844, "num_steps_sampled": 5617844, "load_time_ms": 13.449, "grad_time_ms": 11005.962, "sample_time_ms": 14917.342, "update_time_ms": 9.504, "default": {"vf_explained_var": 0.9704219698905945, "vf_loss": 11.913446426391602, "entropy": 1.2066718339920044, "cur_lr": 0.0005000000237487257, "total_loss": 11.90800666809082, "kl": 0.01497693732380867, "policy_loss": -0.007965918630361557, "cur_kl_coeff": 0.16875003278255463}}, "time_this_iter_s": 25.351579427719116, "timesteps_since_restore": 5617844, "time_since_restore": 3345.448647260666, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43471, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf8d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf0b8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf278>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-53-43", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 270.64912033642213}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1597.2651098191486, "node_ip": "10.138.0.2", "timesteps_total": 5660752, "iterations_since_restore": 129, "episode_reward_mean": 1385.7551506866564, "custom_metrics": {"cost1_max": 479.56110566494453, "cost1_mean": 381.8565252315651, "system_level_velocity_mean": 14.641534013726396, "outflow_rate_max": 1309.2978517865909, "cost1_min": 76.24263729681513, "system_level_velocity_max": 19.53902118581693, "system_level_velocity_min": 12.129778431985521, "outflow_rate_min": 422.42830430347203, "cost2_max": -23.61380300501771, "cost2_mean": -88.4216473137039, "outflow_rate_mean": 1151.229346056281, "cost2_min": -128.43662656865365}, "training_iteration": 129, "episodes_total": 1962, "episode_len_mean": 689.1, "timestamp": 1557208448, "time_total_s": 3370.5987491607666, "pid": 32008, "info": {"num_steps_trained": 5660752, "num_steps_sampled": 5660752, "load_time_ms": 13.178, "grad_time_ms": 10943.68, "sample_time_ms": 15002.653, "update_time_ms": 9.526, "default": {"vf_explained_var": 0.9763726592063904, "vf_loss": 8.623708724975586, "entropy": 1.2447295188903809, "cur_lr": 0.0005000000237487257, "total_loss": 8.617926597595215, "kl": 0.015770750120282173, "policy_loss": -0.008442644961178303, "cur_kl_coeff": 0.16875001788139343}}, "time_this_iter_s": 25.150101900100708, "timesteps_since_restore": 5660752, "time_since_restore": 3370.5987491607666, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42908, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfcf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf940>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf748>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-54-08", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 172.20903315031165}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1597.2651098191486, "node_ip": "10.138.0.2", "timesteps_total": 5703502, "iterations_since_restore": 130, "episode_reward_mean": 1387.3673673383537, "custom_metrics": {"cost1_max": 466.52194194366047, "cost1_mean": 380.4294597699136, "system_level_velocity_mean": 14.58694520848978, "outflow_rate_max": 1308.4125950875741, "cost1_min": 76.24263729681513, "system_level_velocity_max": 19.53902118581693, "system_level_velocity_min": 12.129778431985521, "outflow_rate_min": 422.42830430347203, "cost2_max": -23.61380300501771, "cost2_mean": -89.67613864047074, "outflow_rate_mean": 1150.1089403824517, "cost2_min": -128.43662656865365}, "training_iteration": 130, "episodes_total": 1978, "episode_len_mean": 689.1, "timestamp": 1557208474, "time_total_s": 3396.4907143115997, "pid": 32008, "info": {"num_steps_trained": 5703502, "num_steps_sampled": 5703502, "load_time_ms": 13.304, "grad_time_ms": 10780.365, "sample_time_ms": 15155.02, "update_time_ms": 9.503, "default": {"vf_explained_var": 0.9716042876243591, "vf_loss": 10.929417610168457, "entropy": 1.2311235666275024, "cur_lr": 0.0005000000237487257, "total_loss": 10.925830841064453, "kl": 0.01656489074230194, "policy_loss": -0.006382559891790152, "cur_kl_coeff": 0.16875001788139343}}, "time_this_iter_s": 25.89196515083313, "timesteps_since_restore": 5703502, "time_since_restore": 3396.4907143115997, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42750, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa6a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa518>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aae10>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-54-34", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 172.20903315031165}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1597.2651098191486, "node_ip": "10.138.0.2", "timesteps_total": 5747578, "iterations_since_restore": 131, "episode_reward_mean": 1383.720798643896, "custom_metrics": {"cost1_max": 466.52194194366047, "cost1_mean": 381.53884577816183, "system_level_velocity_mean": 14.627031396134573, "outflow_rate_max": 1308.4125950875741, "cost1_min": 76.24263729681513, "system_level_velocity_max": 19.53902118581693, "system_level_velocity_min": 12.129778431985521, "outflow_rate_min": 422.42830430347203, "cost2_max": -23.61380300501771, "cost2_mean": -89.78860813246392, "outflow_rate_mean": 1152.2063347099497, "cost2_min": -128.43662656865365}, "training_iteration": 131, "episodes_total": 1992, "episode_len_mean": 689.1, "timestamp": 1557208499, "time_total_s": 3421.5411562919617, "pid": 32008, "info": {"num_steps_trained": 5747578, "num_steps_sampled": 5747578, "load_time_ms": 13.714, "grad_time_ms": 10793.296, "sample_time_ms": 15169.495, "update_time_ms": 9.448, "default": {"vf_explained_var": 0.9747202396392822, "vf_loss": 8.960090637207031, "entropy": 1.2275736331939697, "cur_lr": 0.0005000000237487257, "total_loss": 8.954763412475586, "kl": 0.014777435921132565, "policy_loss": -0.007821067236363888, "cur_kl_coeff": 0.16875003278255463}}, "time_this_iter_s": 25.05044198036194, "timesteps_since_restore": 5747578, "time_since_restore": 3421.5411562919617, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44076, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce630>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cee48>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-54-59", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 172.20903315031165}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1597.2651098191486, "node_ip": "10.138.0.2", "timesteps_total": 5790591, "iterations_since_restore": 132, "episode_reward_mean": 1371.4585660901678, "custom_metrics": {"cost1_max": 466.52194194366047, "cost1_mean": 380.10153751678996, "system_level_velocity_mean": 14.711445026363647, "outflow_rate_max": 1308.4125950875741, "cost1_min": 76.24263729681513, "system_level_velocity_max": 19.53902118581693, "system_level_velocity_min": 12.129778431985521, "outflow_rate_min": 422.42830430347203, "cost2_max": -23.61380300501771, "cost2_mean": -89.71394594800954, "outflow_rate_mean": 1146.63093422003, "cost2_min": -128.43662656865365}, "training_iteration": 132, "episodes_total": 2007, "episode_len_mean": 684.54, "timestamp": 1557208525, "time_total_s": 3447.5042605400085, "pid": 32008, "info": {"num_steps_trained": 5790591, "num_steps_sampled": 5790591, "load_time_ms": 14.048, "grad_time_ms": 10740.186, "sample_time_ms": 15178.187, "update_time_ms": 9.51, "default": {"vf_explained_var": 0.9687620997428894, "vf_loss": 13.372933387756348, "entropy": 1.2351646423339844, "cur_lr": 0.0005000000237487257, "total_loss": 13.36774730682373, "kl": 0.01694302260875702, "policy_loss": -0.008045573718845844, "cur_kl_coeff": 0.16875001788139343}}, "time_this_iter_s": 25.963104248046875, "timesteps_since_restore": 5790591, "time_since_restore": 3447.5042605400085, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43013, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfe80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b46a0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfb38>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-55-25", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 172.20903315031165}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1597.2651098191486, "node_ip": "10.138.0.2", "timesteps_total": 5833031, "iterations_since_restore": 133, "episode_reward_mean": 1360.6928073433694, "custom_metrics": {"cost1_max": 466.52194194366047, "cost1_mean": 379.14448064681767, "system_level_velocity_mean": 14.854018832656397, "outflow_rate_max": 1353.2716197824273, "cost1_min": 34.039801112935855, "system_level_velocity_max": 19.53902118581693, "system_level_velocity_min": 12.129778431985521, "outflow_rate_min": 323.4363846761304, "cost2_max": -12.180964090317863, "cost2_mean": -88.33273454861447, "outflow_rate_mean": 1142.3181339514786, "cost2_min": -117.15502246161641}, "training_iteration": 133, "episodes_total": 2025, "episode_len_mean": 678.04, "timestamp": 1557208551, "time_total_s": 3472.7339634895325, "pid": 32008, "info": {"num_steps_trained": 5833031, "num_steps_sampled": 5833031, "load_time_ms": 14.042, "grad_time_ms": 10742.769, "sample_time_ms": 15077.826, "update_time_ms": 9.442, "default": {"vf_explained_var": 0.9538333415985107, "vf_loss": 17.336894989013672, "entropy": 1.2440117597579956, "cur_lr": 0.0005000000237487257, "total_loss": 17.333311080932617, "kl": 0.022041650488972664, "policy_loss": -0.007300464902073145, "cur_kl_coeff": 0.16875003278255463}}, "time_this_iter_s": 25.229702949523926, "timesteps_since_restore": 5833031, "time_since_restore": 3472.7339634895325, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42440, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9588>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9eb8>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-55-51", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 70.09629584475287}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1597.2651098191486, "node_ip": "10.138.0.2", "timesteps_total": 5876284, "iterations_since_restore": 134, "episode_reward_mean": 1359.6357069142502, "custom_metrics": {"cost1_max": 453.06792163149754, "cost1_mean": 377.8862599135365, "system_level_velocity_mean": 14.804072238842384, "outflow_rate_max": 1353.2716197824273, "cost1_min": 34.039801112935855, "system_level_velocity_max": 19.53902118581693, "system_level_velocity_min": 12.361594536599396, "outflow_rate_min": 323.4363846761304, "cost2_max": -12.180964090317863, "cost2_mean": -89.09305108555404, "outflow_rate_mean": 1142.506659704809, "cost2_min": -117.97784292559902}, "training_iteration": 134, "episodes_total": 2040, "episode_len_mean": 678.04, "timestamp": 1557208577, "time_total_s": 3499.002909898758, "pid": 32008, "info": {"num_steps_trained": 5876284, "num_steps_sampled": 5876284, "load_time_ms": 14.526, "grad_time_ms": 10613.434, "sample_time_ms": 15094.31, "update_time_ms": 9.295, "default": {"vf_explained_var": 0.968730628490448, "vf_loss": 10.865262985229492, "entropy": 1.2495062351226807, "cur_lr": 0.0005000000237487257, "total_loss": 10.862170219421387, "kl": 0.012293875217437744, "policy_loss": -0.006205183919519186, "cur_kl_coeff": 0.25312498211860657}}, "time_this_iter_s": 26.268946409225464, "timesteps_since_restore": 5876284, "time_since_restore": 3499.002909898758, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43253, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b46a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cea90>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce518>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-56-17", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 70.09629584475287}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1597.2651098191486, "node_ip": "10.138.0.2", "timesteps_total": 5921184, "iterations_since_restore": 135, "episode_reward_mean": 1378.9368668087222, "custom_metrics": {"cost1_max": 436.421291002099, "cost1_mean": 381.29856632789046, "system_level_velocity_mean": 14.759033625934462, "outflow_rate_max": 1353.2716197824273, "cost1_min": 34.039801112935855, "system_level_velocity_max": 19.102012377112498, "system_level_velocity_min": 12.361594536599396, "outflow_rate_min": 323.4363846761304, "cost2_max": -12.180964090317863, "cost2_mean": -89.67627589391662, "outflow_rate_mean": 1151.8841687428371, "cost2_min": -117.97784292559902}, "training_iteration": 135, "episodes_total": 2052, "episode_len_mean": 683.95, "timestamp": 1557208603, "time_total_s": 3525.5702521800995, "pid": 32008, "info": {"num_steps_trained": 5921184, "num_steps_sampled": 5921184, "load_time_ms": 14.585, "grad_time_ms": 10559.432, "sample_time_ms": 15091.389, "update_time_ms": 9.046, "default": {"vf_explained_var": 0.9787972569465637, "vf_loss": 7.164883613586426, "entropy": 1.2433316707611084, "cur_lr": 0.0005000000237487257, "total_loss": 7.1617631912231445, "kl": 0.011741452850401402, "policy_loss": -0.006091657560318708, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 26.567342281341553, "timesteps_since_restore": 5921184, "time_since_restore": 3525.5702521800995, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44900, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf7f0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdda0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-56-43", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 70.09629584475287}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1597.7077899802523, "node_ip": "10.138.0.2", "timesteps_total": 5963836, "iterations_since_restore": 136, "episode_reward_mean": 1374.806425512052, "custom_metrics": {"cost1_max": 436.421291002099, "cost1_mean": 378.90348480338895, "system_level_velocity_mean": 14.668900078587162, "outflow_rate_max": 1353.2716197824273, "cost1_min": 34.039801112935855, "system_level_velocity_max": 19.102012377112498, "system_level_velocity_min": 12.361594536599396, "outflow_rate_min": 323.4363846761304, "cost2_max": -12.180964090317863, "cost2_mean": -88.76734403500664, "outflow_rate_mean": 1148.0045489708154, "cost2_min": -117.97784292559902}, "training_iteration": 136, "episodes_total": 2068, "episode_len_mean": 683.95, "timestamp": 1557208631, "time_total_s": 3552.8407912254333, "pid": 32008, "info": {"num_steps_trained": 5963836, "num_steps_sampled": 5963836, "load_time_ms": 14.309, "grad_time_ms": 10618.045, "sample_time_ms": 15254.19, "update_time_ms": 9.24, "default": {"vf_explained_var": 0.9737212657928467, "vf_loss": 10.3826265335083, "entropy": 1.222180962562561, "cur_lr": 0.0005000000237487257, "total_loss": 10.380157470703125, "kl": 0.011521011590957642, "policy_loss": -0.005384227726608515, "cur_kl_coeff": 0.25312498211860657}}, "time_this_iter_s": 27.270539045333862, "timesteps_since_restore": 5963836, "time_since_restore": 3552.8407912254333, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42652, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf4a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfef0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf8d0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-57-11", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 70.09629584475287}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1597.7077899802523, "node_ip": "10.138.0.2", "timesteps_total": 6007774, "iterations_since_restore": 137, "episode_reward_mean": 1344.191222229245, "custom_metrics": {"cost1_max": 445.7406075378493, "cost1_mean": 373.1960280558087, "system_level_velocity_mean": 14.799535168482375, "outflow_rate_max": 1353.2716197824273, "cost1_min": 31.38296409806276, "system_level_velocity_max": 19.73816377824374, "system_level_velocity_min": 12.414846061969058, "outflow_rate_min": 323.4363846761304, "cost2_max": -12.180964090317863, "cost2_mean": -87.15217171027564, "outflow_rate_mean": 1133.8866479204175, "cost2_min": -117.97784292559902}, "training_iteration": 137, "episodes_total": 2086, "episode_len_mean": 671.75, "timestamp": 1557208656, "time_total_s": 3577.941638469696, "pid": 32008, "info": {"num_steps_trained": 6007774, "num_steps_sampled": 6007774, "load_time_ms": 14.19, "grad_time_ms": 10569.427, "sample_time_ms": 15087.984, "update_time_ms": 9.024, "default": {"vf_explained_var": 0.9539188742637634, "vf_loss": 16.974271774291992, "entropy": 1.2286235094070435, "cur_lr": 0.0005000000237487257, "total_loss": 16.97101593017578, "kl": 0.011358452029526234, "policy_loss": -0.00612980080768466, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 25.100847244262695, "timesteps_since_restore": 6007774, "time_since_restore": 3577.941638469696, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43938, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd5f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd710>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd7f0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-57-36", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 57.97857654781788}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1597.7077899802523, "node_ip": "10.138.0.2", "timesteps_total": 6049452, "iterations_since_restore": 138, "episode_reward_mean": 1363.2680675388776, "custom_metrics": {"cost1_max": 445.7406075378493, "cost1_mean": 378.3436110393974, "system_level_velocity_mean": 14.729285573582853, "outflow_rate_max": 1353.2716197824273, "cost1_min": 31.38296409806276, "system_level_velocity_max": 19.73816377824374, "system_level_velocity_min": 12.414846061969058, "outflow_rate_min": 323.4363846761304, "cost2_max": -12.180964090317863, "cost2_mean": -86.96959564352164, "outflow_rate_mean": 1145.840955588113, "cost2_min": -117.97784292559902}, "training_iteration": 138, "episodes_total": 2102, "episode_len_mean": 681.3, "timestamp": 1557208680, "time_total_s": 3602.3124973773956, "pid": 32008, "info": {"num_steps_trained": 6049452, "num_steps_sampled": 6049452, "load_time_ms": 13.962, "grad_time_ms": 10477.479, "sample_time_ms": 15080.506, "update_time_ms": 8.829, "default": {"vf_explained_var": 0.9754512906074524, "vf_loss": 9.504164695739746, "entropy": 1.241769552230835, "cur_lr": 0.0005000000237487257, "total_loss": 9.5003080368042, "kl": 0.012130131013691425, "policy_loss": -0.006925999652594328, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 24.370858907699585, "timesteps_since_restore": 6049452, "time_since_restore": 3602.3124973773956, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 41678, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865a58>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865278>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-58-00", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 57.97857654781788}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1597.7077899802523, "node_ip": "10.138.0.2", "timesteps_total": 6092113, "iterations_since_restore": 139, "episode_reward_mean": 1374.7728908587576, "custom_metrics": {"cost1_max": 474.60563202196283, "cost1_mean": 384.3895663549965, "system_level_velocity_mean": 14.783647210984322, "outflow_rate_max": 1365.2695393789363, "cost1_min": 31.38296409806276, "system_level_velocity_max": 19.73816377824374, "system_level_velocity_min": 12.414846061969058, "outflow_rate_min": 328.3754157727966, "cost2_max": -15.752493520944133, "cost2_mean": -86.28452216769684, "outflow_rate_mean": 1157.4702090174012, "cost2_min": -117.97784292559902}, "training_iteration": 139, "episodes_total": 2116, "episode_len_mean": 687.8, "timestamp": 1557208706, "time_total_s": 3628.1753764152527, "pid": 32008, "info": {"num_steps_trained": 6092113, "num_steps_sampled": 6092113, "load_time_ms": 13.972, "grad_time_ms": 10470.206, "sample_time_ms": 15159.441, "update_time_ms": 8.838, "default": {"vf_explained_var": 0.9745545983314514, "vf_loss": 12.019219398498535, "entropy": 1.2733814716339111, "cur_lr": 0.0005000000237487257, "total_loss": 12.014389991760254, "kl": 0.012940392829477787, "policy_loss": -0.008104166015982628, "cur_kl_coeff": 0.25312498211860657}}, "time_this_iter_s": 25.862879037857056, "timesteps_since_restore": 6092113, "time_since_restore": 3628.1753764152527, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42661, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa6d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdbe0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdfd0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-58-26", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 57.97857654781788}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1597.7077899802523, "node_ip": "10.138.0.2", "timesteps_total": 6136774, "iterations_since_restore": 140, "episode_reward_mean": 1339.9613704665505, "custom_metrics": {"cost1_max": 474.60563202196283, "cost1_mean": 374.8160907105438, "system_level_velocity_mean": 14.759667195655203, "outflow_rate_max": 1365.2695393789363, "cost1_min": 29.486374916700544, "system_level_velocity_max": 20.089939868568024, "system_level_velocity_min": 12.25455369347086, "outflow_rate_min": 328.3754157727966, "cost2_max": -14.76158930182749, "cost2_mean": -84.17597404799119, "outflow_rate_mean": 1132.3638899429118, "cost2_min": -117.61723765893001}, "training_iteration": 140, "episodes_total": 2133, "episode_len_mean": 675.63, "timestamp": 1557208733, "time_total_s": 3654.594407558441, "pid": 32008, "info": {"num_steps_trained": 6136774, "num_steps_sampled": 6136774, "load_time_ms": 13.834, "grad_time_ms": 10533.085, "sample_time_ms": 15150.002, "update_time_ms": 8.935, "default": {"vf_explained_var": 0.9726263284683228, "vf_loss": 11.356114387512207, "entropy": 1.255508303642273, "cur_lr": 0.0005000000237487257, "total_loss": 11.351255416870117, "kl": 0.013471364974975586, "policy_loss": -0.008268756791949272, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 26.419031143188477, "timesteps_since_restore": 6136774, "time_since_restore": 3654.594407558441, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44661, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf160>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfc50>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-58-53", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 57.42889876891658}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1597.7077899802523, "node_ip": "10.138.0.2", "timesteps_total": 6180113, "iterations_since_restore": 141, "episode_reward_mean": 1321.2400700396986, "custom_metrics": {"cost1_max": 474.60563202196283, "cost1_mean": 369.3754196691106, "system_level_velocity_mean": 14.85090479878892, "outflow_rate_max": 1365.2695393789363, "cost1_min": 29.486374916700544, "system_level_velocity_max": 20.089939868568024, "system_level_velocity_min": 12.25455369347086, "outflow_rate_min": 328.3754157727966, "cost2_max": -14.76158930182749, "cost2_mean": -82.13085429729868, "outflow_rate_mean": 1116.2448643341686, "cost2_min": -117.61723765893001}, "training_iteration": 141, "episodes_total": 2148, "episode_len_mean": 664.05, "timestamp": 1557208758, "time_total_s": 3679.4967584609985, "pid": 32008, "info": {"num_steps_trained": 6180113, "num_steps_sampled": 6180113, "load_time_ms": 13.429, "grad_time_ms": 10489.024, "sample_time_ms": 15179.358, "update_time_ms": 9.057, "default": {"vf_explained_var": 0.9513869285583496, "vf_loss": 17.167396545410156, "entropy": 1.260028600692749, "cur_lr": 0.0005000000237487257, "total_loss": 17.16382598876953, "kl": 0.01530002523213625, "policy_loss": -0.007444966584444046, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 24.902350902557373, "timesteps_since_restore": 6180113, "time_since_restore": 3679.4967584609985, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43339, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668657f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865710>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668655c0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-59-18", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 57.42889876891658}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1597.7077899802523, "node_ip": "10.138.0.2", "timesteps_total": 6222809, "iterations_since_restore": 142, "episode_reward_mean": 1315.8800883368503, "custom_metrics": {"cost1_max": 474.60563202196283, "cost1_mean": 367.56548079996816, "system_level_velocity_mean": 14.876072664283106, "outflow_rate_max": 1365.2695393789363, "cost1_min": 29.486374916700544, "system_level_velocity_max": 20.089939868568024, "system_level_velocity_min": 12.25455369347086, "outflow_rate_min": 328.3754157727966, "cost2_max": -14.76158930182749, "cost2_mean": -81.79612305314322, "outflow_rate_mean": 1111.7257870125725, "cost2_min": -114.34443304623181}, "training_iteration": 142, "episodes_total": 2163, "episode_len_mean": 659.94, "timestamp": 1557208784, "time_total_s": 3705.847875595093, "pid": 32008, "info": {"num_steps_trained": 6222809, "num_steps_sampled": 6222809, "load_time_ms": 13.033, "grad_time_ms": 10478.924, "sample_time_ms": 15228.019, "update_time_ms": 8.911, "default": {"vf_explained_var": 0.9726212620735168, "vf_loss": 10.388848304748535, "entropy": 1.2480169534683228, "cur_lr": 0.0005000000237487257, "total_loss": 10.38465404510498, "kl": 0.01248153205960989, "policy_loss": -0.007353261578828096, "cur_kl_coeff": 0.25312498211860657}}, "time_this_iter_s": 26.35111713409424, "timesteps_since_restore": 6222809, "time_since_restore": 3705.847875595093, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42696, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865860>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865a58>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-59-44", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 57.42889876891658}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1584.1562254454016, "node_ip": "10.138.0.2", "timesteps_total": 6266189, "iterations_since_restore": 143, "episode_reward_mean": 1333.8042440231395, "custom_metrics": {"cost1_max": 474.60563202196283, "cost1_mean": 371.4485109519803, "system_level_velocity_mean": 14.818867623367318, "outflow_rate_max": 1365.2695393789363, "cost1_min": 29.486374916700544, "system_level_velocity_max": 20.089939868568024, "system_level_velocity_min": 12.25455369347086, "outflow_rate_min": 329.6337234057179, "cost2_max": -14.76158930182749, "cost2_mean": -81.60952525380418, "outflow_rate_mean": 1120.7126884768209, "cost2_min": -114.34443304623181}, "training_iteration": 143, "episodes_total": 2179, "episode_len_mean": 666.48, "timestamp": 1557208810, "time_total_s": 3732.275789499283, "pid": 32008, "info": {"num_steps_trained": 6266189, "num_steps_sampled": 6266189, "load_time_ms": 12.944, "grad_time_ms": 10482.0, "sample_time_ms": 15347.769, "update_time_ms": 8.949, "default": {"vf_explained_var": 0.9636735916137695, "vf_loss": 13.539200782775879, "entropy": 1.2606321573257446, "cur_lr": 0.0005000000237487257, "total_loss": 13.534211158752441, "kl": 0.01445122342556715, "policy_loss": -0.008647279813885689, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 26.427913904190063, "timesteps_since_restore": 6266189, "time_since_restore": 3732.275789499283, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43380, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865128>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865908>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-00-10", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 57.42889876891658}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1584.1562254454016, "node_ip": "10.138.0.2", "timesteps_total": 6310401, "iterations_since_restore": 144, "episode_reward_mean": 1337.6530795500591, "custom_metrics": {"cost1_max": 474.60563202196283, "cost1_mean": 372.0637675907359, "system_level_velocity_mean": 14.85030609070405, "outflow_rate_max": 1365.2695393789363, "cost1_min": 29.486374916700544, "system_level_velocity_max": 20.089939868568024, "system_level_velocity_min": 12.25455369347086, "outflow_rate_min": 329.6337234057179, "cost2_max": -14.76158930182749, "cost2_mean": -81.05448618315094, "outflow_rate_mean": 1123.083047911441, "cost2_min": -114.34443304623181}, "training_iteration": 144, "episodes_total": 2195, "episode_len_mean": 666.22, "timestamp": 1557208836, "time_total_s": 3757.5495233535767, "pid": 32008, "info": {"num_steps_trained": 6310401, "num_steps_sampled": 6310401, "load_time_ms": 13.004, "grad_time_ms": 10464.884, "sample_time_ms": 15265.549, "update_time_ms": 9.021, "default": {"vf_explained_var": 0.9654536843299866, "vf_loss": 12.98670482635498, "entropy": 1.2709698677062988, "cur_lr": 0.0005000000237487257, "total_loss": 12.983717918395996, "kl": 0.014774630777537823, "policy_loss": -0.006726227700710297, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 25.273733854293823, "timesteps_since_restore": 6310401, "time_since_restore": 3757.5495233535767, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44212, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aad30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9eb8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9550>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-00-36", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 57.42889876891658}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1570.9764859720826, "node_ip": "10.138.0.2", "timesteps_total": 6353850, "iterations_since_restore": 145, "episode_reward_mean": 1310.8146801393607, "custom_metrics": {"cost1_max": 474.60563202196283, "cost1_mean": 362.9771153285516, "system_level_velocity_mean": 14.746379940323962, "outflow_rate_max": 1353.360513060852, "cost1_min": 29.486374916700544, "system_level_velocity_max": 20.089939868568024, "system_level_velocity_min": 12.25455369347086, "outflow_rate_min": 324.8763846761304, "cost2_max": -10.419594960105933, "cost2_mean": -81.04107020034438, "outflow_rate_mean": 1105.011244846223, "cost2_min": -115.69976880958433}, "training_iteration": 145, "episodes_total": 2213, "episode_len_mean": 657.21, "timestamp": 1557208862, "time_total_s": 3783.9088294506073, "pid": 32008, "info": {"num_steps_trained": 6353850, "num_steps_sampled": 6353850, "load_time_ms": 12.998, "grad_time_ms": 10429.011, "sample_time_ms": 15283.486, "update_time_ms": 9.326, "default": {"vf_explained_var": 0.9656449556350708, "vf_loss": 12.258622169494629, "entropy": 1.2700403928756714, "cur_lr": 0.0005000000237487257, "total_loss": 12.254772186279297, "kl": 0.014382163994014263, "policy_loss": -0.007489546202123165, "cur_kl_coeff": 0.25312498211860657}}, "time_this_iter_s": 26.35930609703064, "timesteps_since_restore": 6353850, "time_since_restore": 3783.9088294506073, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43449, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865860>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668656d8>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-01-02", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 57.42889876891658}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1567.3456591170425, "node_ip": "10.138.0.2", "timesteps_total": 6399019, "iterations_since_restore": 146, "episode_reward_mean": 1325.855562164391, "custom_metrics": {"cost1_max": 441.3698629044113, "cost1_mean": 366.9089018004467, "system_level_velocity_mean": 14.675427216369826, "outflow_rate_max": 1353.360513060852, "cost1_min": 33.590985858407954, "system_level_velocity_max": 19.323564853263253, "system_level_velocity_min": 12.317836717167834, "outflow_rate_min": 324.8763846761304, "cost2_max": -10.419594960105933, "cost2_mean": -82.46138811723033, "outflow_rate_mean": 1116.4810496589294, "cost2_min": -115.69976880958433}, "training_iteration": 146, "episodes_total": 2227, "episode_len_mean": 664.63, "timestamp": 1557208889, "time_total_s": 3810.3550894260406, "pid": 32008, "info": {"num_steps_trained": 6399019, "num_steps_sampled": 6399019, "load_time_ms": 13.132, "grad_time_ms": 10264.227, "sample_time_ms": 15364.558, "update_time_ms": 9.363, "default": {"vf_explained_var": 0.9719625115394592, "vf_loss": 9.276206016540527, "entropy": 1.3004580736160278, "cur_lr": 0.0005000000237487257, "total_loss": 9.272278785705566, "kl": 0.013910677284002304, "policy_loss": -0.007447991985827684, "cur_kl_coeff": 0.25312498211860657}}, "time_this_iter_s": 26.44625997543335, "timesteps_since_restore": 6399019, "time_since_restore": 3810.3550894260406, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 45169, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668650b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865eb8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865048>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-01-29", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 63.45517438647651}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1567.3456591170425, "node_ip": "10.138.0.2", "timesteps_total": 6441387, "iterations_since_restore": 147, "episode_reward_mean": 1327.571166720163, "custom_metrics": {"cost1_max": 441.3698629044113, "cost1_mean": 364.2520746571528, "system_level_velocity_mean": 14.45335999331811, "outflow_rate_max": 1353.360513060852, "cost1_min": 29.403094373501727, "system_level_velocity_max": 19.88354133408931, "system_level_velocity_min": 12.296684135007927, "outflow_rate_min": 324.8763846761304, "cost2_max": -10.419594960105933, "cost2_mean": -84.39238665126477, "outflow_rate_mean": 1115.0683050565065, "cost2_min": -116.82510980309347}, "training_iteration": 147, "episodes_total": 2245, "episode_len_mean": 669.64, "timestamp": 1557208914, "time_total_s": 3835.736375808716, "pid": 32008, "info": {"num_steps_trained": 6441387, "num_steps_sampled": 6441387, "load_time_ms": 13.076, "grad_time_ms": 10152.223, "sample_time_ms": 15504.988, "update_time_ms": 9.458, "default": {"vf_explained_var": 0.9744266271591187, "vf_loss": 8.872350692749023, "entropy": 1.288543701171875, "cur_lr": 0.0005000000237487257, "total_loss": 8.86845588684082, "kl": 0.012515821494162083, "policy_loss": -0.007062521763145924, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 25.38128638267517, "timesteps_since_restore": 6441387, "time_since_restore": 3835.736375808716, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42368, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865ef0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865390>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-01-54", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 53.86169906128385}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1567.3456591170425, "node_ip": "10.138.0.2", "timesteps_total": 6485265, "iterations_since_restore": 148, "episode_reward_mean": 1309.0151248721245, "custom_metrics": {"cost1_max": 441.3698629044113, "cost1_mean": 362.2902767689829, "system_level_velocity_mean": 14.5752401741368, "outflow_rate_max": 1353.360513060852, "cost1_min": 29.403094373501727, "system_level_velocity_max": 19.88354133408931, "system_level_velocity_min": 12.296684135007927, "outflow_rate_min": 324.8763846761304, "cost2_max": -10.419594960105933, "cost2_mean": -82.43906725603745, "outflow_rate_mean": 1111.9952375547616, "cost2_min": -116.82510980309347}, "training_iteration": 148, "episodes_total": 2259, "episode_len_mean": 662.59, "timestamp": 1557208942, "time_total_s": 3863.940322160721, "pid": 32008, "info": {"num_steps_trained": 6485265, "num_steps_sampled": 6485265, "load_time_ms": 13.22, "grad_time_ms": 10317.349, "sample_time_ms": 15724.207, "update_time_ms": 9.494, "default": {"vf_explained_var": 0.9623247385025024, "vf_loss": 13.576661109924316, "entropy": 1.2998173236846924, "cur_lr": 0.0005000000237487257, "total_loss": 13.573442459106445, "kl": 0.013834134675562382, "policy_loss": -0.006721273995935917, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 28.203946352005005, "timesteps_since_restore": 6485265, "time_since_restore": 3863.940322160721, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43878, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668657f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1e48>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865f98>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-02-22", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 53.86169906128385}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1567.3456591170425, "node_ip": "10.138.0.2", "timesteps_total": 6529452, "iterations_since_restore": 149, "episode_reward_mean": 1301.0812506074735, "custom_metrics": {"cost1_max": 441.3698629044113, "cost1_mean": 357.4007525582732, "system_level_velocity_mean": 14.399293292992377, "outflow_rate_max": 1353.360513060852, "cost1_min": 29.403094373501727, "system_level_velocity_max": 19.88354133408931, "system_level_velocity_min": 11.315056248132112, "outflow_rate_min": 324.8763846761304, "cost2_max": -10.419594960105933, "cost2_mean": -83.87402198688604, "outflow_rate_mean": 1099.5105463347543, "cost2_min": -116.82510980309347}, "training_iteration": 149, "episodes_total": 2275, "episode_len_mean": 662.59, "timestamp": 1557208969, "time_total_s": 3890.698689222336, "pid": 32008, "info": {"num_steps_trained": 6529452, "num_steps_sampled": 6529452, "load_time_ms": 13.134, "grad_time_ms": 10329.315, "sample_time_ms": 15803.653, "update_time_ms": 9.559, "default": {"vf_explained_var": 0.9795603156089783, "vf_loss": 7.959079265594482, "entropy": 1.3233473300933838, "cur_lr": 0.0005000000237487257, "total_loss": 7.954277038574219, "kl": 0.015706069767475128, "policy_loss": -0.008776968345046043, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 26.75836706161499, "timesteps_since_restore": 6529452, "time_since_restore": 3890.698689222336, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44187, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668655f8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668656d8>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-02-49", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 53.86169906128385}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1543.7968070854743, "node_ip": "10.138.0.2", "timesteps_total": 6573041, "iterations_since_restore": 150, "episode_reward_mean": 1270.9294756620054, "custom_metrics": {"cost1_max": 441.3698629044113, "cost1_mean": 349.14652920938056, "system_level_velocity_mean": 14.434880702314551, "outflow_rate_max": 1308.0837985988371, "cost1_min": 29.133912711397606, "system_level_velocity_max": 19.88354133408931, "system_level_velocity_min": 10.646322680416853, "outflow_rate_min": 324.8763846761304, "cost2_max": -10.419594960105933, "cost2_mean": -83.18273986373671, "outflow_rate_mean": 1081.862257549487, "cost2_min": -116.82510980309347}, "training_iteration": 150, "episodes_total": 2295, "episode_len_mean": 649.87, "timestamp": 1557208995, "time_total_s": 3916.558361053467, "pid": 32008, "info": {"num_steps_trained": 6573041, "num_steps_sampled": 6573041, "load_time_ms": 13.032, "grad_time_ms": 10308.697, "sample_time_ms": 15769.901, "update_time_ms": 9.683, "default": {"vf_explained_var": 0.9606252312660217, "vf_loss": 13.250774383544922, "entropy": 1.3219828605651855, "cur_lr": 0.0005000000237487257, "total_loss": 13.246260643005371, "kl": 0.013315231539309025, "policy_loss": -0.00788481067866087, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 25.85967183113098, "timesteps_since_restore": 6573041, "time_since_restore": 3916.558361053467, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43589, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865f60>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865eb8>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-03-15", "hostname": "flow-main", "episodes_this_iter": 20, "episode_reward_min": 53.17317860409545}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1543.7968070854743, "node_ip": "10.138.0.2", "timesteps_total": 6617134, "iterations_since_restore": 151, "episode_reward_mean": 1279.47640341189, "custom_metrics": {"cost1_max": 441.3698629044113, "cost1_mean": 349.7103282527615, "system_level_velocity_mean": 14.340738518000776, "outflow_rate_max": 1308.0837985988371, "cost1_min": 29.133912711397606, "system_level_velocity_max": 19.88354133408931, "system_level_velocity_min": 10.646322680416853, "outflow_rate_min": 324.8763846761304, "cost2_max": -11.369012927052815, "cost2_mean": -83.68811300514905, "outflow_rate_mean": 1084.6895092185416, "cost2_min": -116.82510980309347}, "training_iteration": 151, "episodes_total": 2305, "episode_len_mean": 653.96, "timestamp": 1557209021, "time_total_s": 3942.8767173290253, "pid": 32008, "info": {"num_steps_trained": 6617134, "num_steps_sampled": 6617134, "load_time_ms": 13.159, "grad_time_ms": 10332.693, "sample_time_ms": 15888.969, "update_time_ms": 9.727, "default": {"vf_explained_var": 0.9726403951644897, "vf_loss": 8.79587173461914, "entropy": 1.3196897506713867, "cur_lr": 0.0005000000237487257, "total_loss": 8.792152404785156, "kl": 0.013806501403450966, "policy_loss": -0.007214442826807499, "cur_kl_coeff": 0.25312498211860657}}, "time_this_iter_s": 26.31835627555847, "timesteps_since_restore": 6617134, "time_since_restore": 3942.8767173290253, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44093, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865908>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865ef0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-03-41", "hostname": "flow-main", "episodes_this_iter": 10, "episode_reward_min": 53.17317860409545}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1532.917992134675, "node_ip": "10.138.0.2", "timesteps_total": 6660765, "iterations_since_restore": 152, "episode_reward_mean": 1280.234772717338, "custom_metrics": {"cost1_max": 441.06769114172874, "cost1_mean": 350.52238155297056, "system_level_velocity_mean": 14.380247696566942, "outflow_rate_max": 1337.2590062482022, "cost1_min": 29.133912711397606, "system_level_velocity_max": 19.88354133408931, "system_level_velocity_min": 10.646322680416853, "outflow_rate_min": 324.8763846761304, "cost2_max": -11.369012927052815, "cost2_mean": -82.80269039549741, "outflow_rate_mean": 1087.8347401764943, "cost2_min": -118.64253942986552}, "training_iteration": 152, "episodes_total": 2322, "episode_len_mean": 653.19, "timestamp": 1557209047, "time_total_s": 3968.476355791092, "pid": 32008, "info": {"num_steps_trained": 6660765, "num_steps_sampled": 6660765, "load_time_ms": 13.26, "grad_time_ms": 10356.025, "sample_time_ms": 15791.994, "update_time_ms": 9.695, "default": {"vf_explained_var": 0.9663378596305847, "vf_loss": 11.875429153442383, "entropy": 1.2982012033462524, "cur_lr": 0.0005000000237487257, "total_loss": 11.87147045135498, "kl": 0.014268683269619942, "policy_loss": -0.007570003159344196, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 25.59963846206665, "timesteps_since_restore": 6660765, "time_since_restore": 3968.476355791092, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43631, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ceb38>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cec50>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-04-07", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 53.17317860409545}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1532.917992134675, "node_ip": "10.138.0.2", "timesteps_total": 6703145, "iterations_since_restore": 153, "episode_reward_mean": 1302.7977507138828, "custom_metrics": {"cost1_max": 441.06769114172874, "cost1_mean": 355.14602911698233, "system_level_velocity_mean": 14.242194015098605, "outflow_rate_max": 1337.2590062482022, "cost1_min": 29.133912711397606, "system_level_velocity_max": 19.806126875590913, "system_level_velocity_min": 10.646322680416853, "outflow_rate_min": 324.8763846761304, "cost2_max": -11.369012927052815, "cost2_mean": -83.30773910026659, "outflow_rate_mean": 1099.0849308553893, "cost2_min": -118.64253942986552}, "training_iteration": 153, "episodes_total": 2340, "episode_len_mean": 664.51, "timestamp": 1557209072, "time_total_s": 3993.5971965789795, "pid": 32008, "info": {"num_steps_trained": 6703145, "num_steps_sampled": 6703145, "load_time_ms": 13.281, "grad_time_ms": 10281.566, "sample_time_ms": 15735.854, "update_time_ms": 9.789, "default": {"vf_explained_var": 0.9679272174835205, "vf_loss": 11.486957550048828, "entropy": 1.269398808479309, "cur_lr": 0.0005000000237487257, "total_loss": 11.483551979064941, "kl": 0.015094912610948086, "policy_loss": -0.007226481568068266, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 25.120840787887573, "timesteps_since_restore": 6703145, "time_since_restore": 3993.5971965789795, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42380, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d17f0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1da0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-04-32", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 53.17317860409545}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1532.917992134675, "node_ip": "10.138.0.2", "timesteps_total": 6745070, "iterations_since_restore": 154, "episode_reward_mean": 1303.9210376123146, "custom_metrics": {"cost1_max": 445.0709412416425, "cost1_mean": 355.36681894474737, "system_level_velocity_mean": 14.252732453235142, "outflow_rate_max": 1337.2590062482022, "cost1_min": 29.133912711397606, "system_level_velocity_max": 19.806126875590913, "system_level_velocity_min": 10.646322680416853, "outflow_rate_min": 324.8763846761304, "cost2_max": -11.369012927052815, "cost2_mean": -80.68304993349133, "outflow_rate_mean": 1099.0682567678239, "cost2_min": -118.64253942986552}, "training_iteration": 154, "episodes_total": 2352, "episode_len_mean": 664.51, "timestamp": 1557209099, "time_total_s": 4020.119271993637, "pid": 32008, "info": {"num_steps_trained": 6745070, "num_steps_sampled": 6745070, "load_time_ms": 12.883, "grad_time_ms": 10231.289, "sample_time_ms": 15910.196, "update_time_ms": 9.76, "default": {"vf_explained_var": 0.975338876247406, "vf_loss": 7.747860908508301, "entropy": 1.2741153240203857, "cur_lr": 0.0005000000237487257, "total_loss": 7.744564533233643, "kl": 0.012965228408575058, "policy_loss": -0.006577837280929089, "cur_kl_coeff": 0.25312498211860657}}, "time_this_iter_s": 26.522075414657593, "timesteps_since_restore": 6745070, "time_since_restore": 4020.119271993637, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 41925, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ceb70>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ced30>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-04-59", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 53.17317860409545}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1532.917992134675, "node_ip": "10.138.0.2", "timesteps_total": 6788966, "iterations_since_restore": 155, "episode_reward_mean": 1320.7670782635082, "custom_metrics": {"cost1_max": 445.0709412416425, "cost1_mean": 358.75967967486446, "system_level_velocity_mean": 14.219496884678378, "outflow_rate_max": 1337.2590062482022, "cost1_min": 29.133912711397606, "system_level_velocity_max": 19.806126875590913, "system_level_velocity_min": 10.646322680416853, "outflow_rate_min": 324.8763846761304, "cost2_max": -11.369012927052815, "cost2_mean": -77.59626835564153, "outflow_rate_mean": 1110.512109372881, "cost2_min": -118.64253942986552}, "training_iteration": 155, "episodes_total": 2370, "episode_len_mean": 670.11, "timestamp": 1557209125, "time_total_s": 4046.725981235504, "pid": 32008, "info": {"num_steps_trained": 6788966, "num_steps_sampled": 6788966, "load_time_ms": 12.908, "grad_time_ms": 10241.408, "sample_time_ms": 15924.163, "update_time_ms": 9.668, "default": {"vf_explained_var": 0.9506575465202332, "vf_loss": 15.214303016662598, "entropy": 1.290651798248291, "cur_lr": 0.0005000000237487257, "total_loss": 15.211982727050781, "kl": 0.012065012007951736, "policy_loss": -0.005372190847992897, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 26.606709241867065, "timesteps_since_restore": 6788966, "time_since_restore": 4046.725981235504, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43896, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cec50>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce358>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-05-25", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 53.17317860409545}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1604.0661022941015, "node_ip": "10.138.0.2", "timesteps_total": 6832211, "iterations_since_restore": 156, "episode_reward_mean": 1330.9403584683605, "custom_metrics": {"cost1_max": 454.7686381313991, "cost1_mean": 361.8468579416104, "system_level_velocity_mean": 14.250265200039529, "outflow_rate_max": 1337.2590062482022, "cost1_min": 29.112448281213734, "system_level_velocity_max": 19.73427056835613, "system_level_velocity_min": 11.370179444903618, "outflow_rate_min": 329.6337234057179, "cost2_max": -13.747011249150239, "cost2_mean": -74.56280015453704, "outflow_rate_mean": 1116.1642815179105, "cost2_min": -118.64253942986552}, "training_iteration": 156, "episodes_total": 2385, "episode_len_mean": 672.54, "timestamp": 1557209151, "time_total_s": 4072.0033209323883, "pid": 32008, "info": {"num_steps_trained": 6832211, "num_steps_sampled": 6832211, "load_time_ms": 12.866, "grad_time_ms": 10193.368, "sample_time_ms": 15855.87, "update_time_ms": 9.663, "default": {"vf_explained_var": 0.9447588324546814, "vf_loss": 17.951339721679688, "entropy": 1.2950689792633057, "cur_lr": 0.0005000000237487257, "total_loss": 17.948246002197266, "kl": 0.014187862165272236, "policy_loss": -0.0066862995736300945, "cur_kl_coeff": 0.25312498211860657}}, "time_this_iter_s": 25.277339696884155, "timesteps_since_restore": 6832211, "time_since_restore": 4072.0033209323883, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43245, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ceba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ced68>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce128>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-05-51", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 56.86134037587359}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1604.0661022941015, "node_ip": "10.138.0.2", "timesteps_total": 6874134, "iterations_since_restore": 157, "episode_reward_mean": 1334.8486842667744, "custom_metrics": {"cost1_max": 454.7686381313991, "cost1_mean": 360.26329097076996, "system_level_velocity_mean": 14.244275219567621, "outflow_rate_max": 1337.2590062482022, "cost1_min": 29.112448281213734, "system_level_velocity_max": 19.73427056835613, "system_level_velocity_min": 11.370179444903618, "outflow_rate_min": 324.13573579981335, "cost2_max": -12.960961960634613, "cost2_mean": -70.11909783065336, "outflow_rate_mean": 1109.8107935673243, "cost2_min": -118.64253942986552}, "training_iteration": 157, "episodes_total": 2402, "episode_len_mean": 670.99, "timestamp": 1557209176, "time_total_s": 4097.5983057022095, "pid": 32008, "info": {"num_steps_trained": 6874134, "num_steps_sampled": 6874134, "load_time_ms": 12.883, "grad_time_ms": 10198.628, "sample_time_ms": 15871.672, "update_time_ms": 9.725, "default": {"vf_explained_var": 0.946636438369751, "vf_loss": 14.803083419799805, "entropy": 1.3115068674087524, "cur_lr": 0.0005000000237487257, "total_loss": 14.800239562988281, "kl": 0.01407767366617918, "policy_loss": -0.006407394539564848, "cur_kl_coeff": 0.25312498211860657}}, "time_this_iter_s": 25.594984769821167, "timesteps_since_restore": 6874134, "time_since_restore": 4097.5983057022095, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 41923, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cea58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce1d0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cef60>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-06-16", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 56.86134037587359}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1604.0661022941015, "node_ip": "10.138.0.2", "timesteps_total": 6916741, "iterations_since_restore": 158, "episode_reward_mean": 1329.534296803475, "custom_metrics": {"cost1_max": 454.7686381313991, "cost1_mean": 359.2885571379681, "system_level_velocity_mean": 14.182785050995529, "outflow_rate_max": 1327.6886921069079, "cost1_min": 29.112448281213734, "system_level_velocity_max": 19.73427056835613, "system_level_velocity_min": 11.370179444903618, "outflow_rate_min": 324.13573579981335, "cost2_max": -12.960961960634613, "cost2_mean": -66.66492054433405, "outflow_rate_mean": 1107.0193326255137, "cost2_min": -107.40748317917794}, "training_iteration": 158, "episodes_total": 2417, "episode_len_mean": 671.76, "timestamp": 1557209203, "time_total_s": 4124.578285932541, "pid": 32008, "info": {"num_steps_trained": 6916741, "num_steps_sampled": 6916741, "load_time_ms": 12.77, "grad_time_ms": 10050.153, "sample_time_ms": 15898.528, "update_time_ms": 9.79, "default": {"vf_explained_var": 0.9620164632797241, "vf_loss": 10.590545654296875, "entropy": 1.3041033744812012, "cur_lr": 0.0005000000237487257, "total_loss": 10.586324691772461, "kl": 0.013228869996964931, "policy_loss": -0.0075700352899730206, "cur_kl_coeff": 0.25312498211860657}}, "time_this_iter_s": 26.97998023033142, "timesteps_since_restore": 6916741, "time_since_restore": 4124.578285932541, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42607, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e9b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfbe0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cddd8>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-06-43", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 56.86134037587359}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1604.0661022941015, "node_ip": "10.138.0.2", "timesteps_total": 6959488, "iterations_since_restore": 159, "episode_reward_mean": 1311.955630225705, "custom_metrics": {"cost1_max": 454.7686381313991, "cost1_mean": 355.44166204313115, "system_level_velocity_mean": 14.345939989351367, "outflow_rate_max": 1327.6886921069079, "cost1_min": 29.112448281213734, "system_level_velocity_max": 19.73427056835613, "system_level_velocity_min": 11.261185987034997, "outflow_rate_min": 324.13573579981335, "cost2_max": -12.960961960634613, "cost2_mean": -62.96451925997574, "outflow_rate_mean": 1099.9939246022225, "cost2_min": -103.96106970650135}, "training_iteration": 159, "episodes_total": 2433, "episode_len_mean": 660.42, "timestamp": 1557209229, "time_total_s": 4150.44868016243, "pid": 32008, "info": {"num_steps_trained": 6959488, "num_steps_sampled": 6959488, "load_time_ms": 12.64, "grad_time_ms": 10033.664, "sample_time_ms": 15826.92, "update_time_ms": 9.641, "default": {"vf_explained_var": 0.9323511719703674, "vf_loss": 20.309877395629883, "entropy": 1.3160866498947144, "cur_lr": 0.0005000000237487257, "total_loss": 20.30588150024414, "kl": 0.016137827187776566, "policy_loss": -0.008082839660346508, "cur_kl_coeff": 0.25312498211860657}}, "time_this_iter_s": 25.870394229888916, "timesteps_since_restore": 6959488, "time_since_restore": 4150.44868016243, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42747, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce6d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cef28>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce940>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-07-09", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 56.86134037587359}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1604.0661022941015, "node_ip": "10.138.0.2", "timesteps_total": 7003426, "iterations_since_restore": 160, "episode_reward_mean": 1294.8613311829315, "custom_metrics": {"cost1_max": 454.7686381313991, "cost1_mean": 349.0805231255465, "system_level_velocity_mean": 14.296985923840674, "outflow_rate_max": 1327.6886921069079, "cost1_min": 29.112448281213734, "system_level_velocity_max": 19.945057912969325, "system_level_velocity_min": 11.261185987034997, "outflow_rate_min": 324.13573579981335, "cost2_max": -12.960961960634613, "cost2_mean": -61.65660445163611, "outflow_rate_mean": 1085.2727169634543, "cost2_min": -93.66216139407089}, "training_iteration": 160, "episodes_total": 2449, "episode_len_mean": 653.85, "timestamp": 1557209258, "time_total_s": 4179.090292215347, "pid": 32008, "info": {"num_steps_trained": 7003426, "num_steps_sampled": 7003426, "load_time_ms": 12.656, "grad_time_ms": 10088.364, "sample_time_ms": 16048.721, "update_time_ms": 9.553, "default": {"vf_explained_var": 0.9661073088645935, "vf_loss": 10.433501243591309, "entropy": 1.3326549530029297, "cur_lr": 0.0005000000237487257, "total_loss": 10.42754077911377, "kl": 0.01584840565919876, "policy_loss": -0.00997179001569748, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 28.64161205291748, "timesteps_since_restore": 7003426, "time_since_restore": 4179.090292215347, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43938, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1dd8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1ef0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-07-38", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 53.60964793954746}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1604.0661022941015, "node_ip": "10.138.0.2", "timesteps_total": 7047400, "iterations_since_restore": 161, "episode_reward_mean": 1307.9347038457008, "custom_metrics": {"cost1_max": 457.053056716137, "cost1_mean": 353.23330122004785, "system_level_velocity_mean": 14.322182350610701, "outflow_rate_max": 1327.6886921069079, "cost1_min": 29.112448281213734, "system_level_velocity_max": 19.945057912969325, "system_level_velocity_min": 11.261185987034997, "outflow_rate_min": 324.13573579981335, "cost2_max": -12.960961960634613, "cost2_mean": -62.68043978200714, "outflow_rate_mean": 1091.6710808373086, "cost2_min": -93.66216139407089}, "training_iteration": 161, "episodes_total": 2462, "episode_len_mean": 659.41, "timestamp": 1557209286, "time_total_s": 4206.95149230957, "pid": 32008, "info": {"num_steps_trained": 7047400, "num_steps_sampled": 7047400, "load_time_ms": 12.032, "grad_time_ms": 10120.201, "sample_time_ms": 16172.129, "update_time_ms": 9.723, "default": {"vf_explained_var": 0.9750752449035645, "vf_loss": 6.741108417510986, "entropy": 1.3319027423858643, "cur_lr": 0.0005000000237487257, "total_loss": 6.7367048263549805, "kl": 0.012329566292464733, "policy_loss": -0.007524892222136259, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 27.861200094223022, "timesteps_since_restore": 7047400, "time_since_restore": 4206.95149230957, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43974, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668acdd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4d30>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4240>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-08-06", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 53.60964793954746}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1568.826195571681, "node_ip": "10.138.0.2", "timesteps_total": 7090693, "iterations_since_restore": 162, "episode_reward_mean": 1308.3915667964877, "custom_metrics": {"cost1_max": 457.053056716137, "cost1_mean": 352.5948524118638, "system_level_velocity_mean": 14.19944578293634, "outflow_rate_max": 1319.8894008920374, "cost1_min": 29.112448281213734, "system_level_velocity_max": 19.945057912969325, "system_level_velocity_min": 11.261185987034997, "outflow_rate_min": 324.13573579981335, "cost2_max": -12.960961960634613, "cost2_mean": -62.36956426259223, "outflow_rate_mean": 1089.0580787849651, "cost2_min": -93.66216139407089}, "training_iteration": 162, "episodes_total": 2481, "episode_len_mean": 663.43, "timestamp": 1557209313, "time_total_s": 4234.177246809006, "pid": 32008, "info": {"num_steps_trained": 7090693, "num_steps_sampled": 7090693, "load_time_ms": 11.883, "grad_time_ms": 10101.06, "sample_time_ms": 16351.72, "update_time_ms": 9.777, "default": {"vf_explained_var": 0.9545564651489258, "vf_loss": 13.553545951843262, "entropy": 1.3268380165100098, "cur_lr": 0.0005000000237487257, "total_loss": 13.548904418945312, "kl": 0.01389992143958807, "policy_loss": -0.00815989263355732, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 27.225754499435425, "timesteps_since_restore": 7090693, "time_since_restore": 4234.177246809006, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43293, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668accc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf400>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac128>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-08-33", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 53.60964793954746}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1568.826195571681, "node_ip": "10.138.0.2", "timesteps_total": 7131957, "iterations_since_restore": 163, "episode_reward_mean": 1308.848170078925, "custom_metrics": {"cost1_max": 457.053056716137, "cost1_mean": 356.0346874531318, "system_level_velocity_mean": 14.153368988041962, "outflow_rate_max": 1347.0794161966153, "cost1_min": 29.27467367004111, "system_level_velocity_max": 19.945057912969325, "system_level_velocity_min": 11.261185987034997, "outflow_rate_min": 324.13573579981335, "cost2_max": -12.960961960634613, "cost2_mean": -62.13954188392174, "outflow_rate_mean": 1098.0630079177784, "cost2_min": -93.66216139407089}, "training_iteration": 163, "episodes_total": 2496, "episode_len_mean": 670.0, "timestamp": 1557209339, "time_total_s": 4260.665651321411, "pid": 32008, "info": {"num_steps_trained": 7131957, "num_steps_sampled": 7131957, "load_time_ms": 11.902, "grad_time_ms": 10125.259, "sample_time_ms": 16462.131, "update_time_ms": 9.689, "default": {"vf_explained_var": 0.9593775272369385, "vf_loss": 12.272259712219238, "entropy": 1.3220778703689575, "cur_lr": 0.0005000000237487257, "total_loss": 12.268132209777832, "kl": 0.014581700786948204, "policy_loss": -0.00781883392482996, "cur_kl_coeff": 0.25312498211860657}}, "time_this_iter_s": 26.488404512405396, "timesteps_since_restore": 7131957, "time_since_restore": 4260.665651321411, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 41264, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865860>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac080>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-08-59", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 53.60964793954746}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1568.826195571681, "node_ip": "10.138.0.2", "timesteps_total": 7175702, "iterations_since_restore": 164, "episode_reward_mean": 1313.9393618504182, "custom_metrics": {"cost1_max": 457.053056716137, "cost1_mean": 359.44569189753093, "system_level_velocity_mean": 14.226633443377766, "outflow_rate_max": 1347.0794161966153, "cost1_min": 29.27467367004111, "system_level_velocity_max": 19.945057912969325, "system_level_velocity_min": 11.261185987034997, "outflow_rate_min": 329.6337234057179, "cost2_max": -15.902930770070183, "cost2_mean": -62.38885516608554, "outflow_rate_mean": 1106.038637469024, "cost2_min": -93.66216139407089}, "training_iteration": 164, "episodes_total": 2510, "episode_len_mean": 671.92, "timestamp": 1557209365, "time_total_s": 4286.460790395737, "pid": 32008, "info": {"num_steps_trained": 7175702, "num_steps_sampled": 7175702, "load_time_ms": 12.143, "grad_time_ms": 10196.217, "sample_time_ms": 16317.895, "update_time_ms": 9.778, "default": {"vf_explained_var": 0.9468182325363159, "vf_loss": 14.718453407287598, "entropy": 1.3281129598617554, "cur_lr": 0.0005000000237487257, "total_loss": 14.715006828308105, "kl": 0.013127637095749378, "policy_loss": -0.006770177278667688, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 25.79513907432556, "timesteps_since_restore": 7175702, "time_since_restore": 4286.460790395737, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43745, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdd30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cee80>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce390>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-09-25", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 53.60964793954746}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1568.826195571681, "node_ip": "10.138.0.2", "timesteps_total": 7218673, "iterations_since_restore": 165, "episode_reward_mean": 1327.005446623337, "custom_metrics": {"cost1_max": 457.053056716137, "cost1_mean": 363.7390628819295, "system_level_velocity_mean": 14.252981213698138, "outflow_rate_max": 1354.2093519520715, "cost1_min": 29.27467367004111, "system_level_velocity_max": 19.945057912969325, "system_level_velocity_min": 11.475470614639443, "outflow_rate_min": 329.6337234057179, "cost2_max": -15.902930770070183, "cost2_mean": -64.09021905651534, "outflow_rate_mean": 1112.9410102416216, "cost2_min": -97.32841118517115}, "training_iteration": 165, "episodes_total": 2526, "episode_len_mean": 677.51, "timestamp": 1557209392, "time_total_s": 4312.849449634552, "pid": 32008, "info": {"num_steps_trained": 7218673, "num_steps_sampled": 7218673, "load_time_ms": 12.038, "grad_time_ms": 10198.393, "sample_time_ms": 16294.069, "update_time_ms": 9.79, "default": {"vf_explained_var": 0.9693201780319214, "vf_loss": 10.889328002929688, "entropy": 1.3217737674713135, "cur_lr": 0.0005000000237487257, "total_loss": 10.88510799407959, "kl": 0.015269860625267029, "policy_loss": -0.008084272965788841, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 26.388659238815308, "timesteps_since_restore": 7218673, "time_since_restore": 4312.849449634552, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42971, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1cf8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c10f0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-09-52", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 53.60964793954746}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1542.5262399071642, "node_ip": "10.138.0.2", "timesteps_total": 7260618, "iterations_since_restore": 166, "episode_reward_mean": 1329.1002356688964, "custom_metrics": {"cost1_max": 457.053056716137, "cost1_mean": 366.3859253325704, "system_level_velocity_mean": 14.380266040790517, "outflow_rate_max": 1354.2093519520715, "cost1_min": 29.27467367004111, "system_level_velocity_max": 19.945057912969325, "system_level_velocity_min": 11.475470614639443, "outflow_rate_min": 329.6337234057179, "cost2_max": -15.902930770070183, "cost2_mean": -64.46483321729752, "outflow_rate_mean": 1116.2002033524168, "cost2_min": -97.32841118517115}, "training_iteration": 166, "episodes_total": 2541, "episode_len_mean": 676.74, "timestamp": 1557209417, "time_total_s": 4338.579126834869, "pid": 32008, "info": {"num_steps_trained": 7260618, "num_steps_sampled": 7260618, "load_time_ms": 12.09, "grad_time_ms": 10280.198, "sample_time_ms": 16257.31, "update_time_ms": 9.799, "default": {"vf_explained_var": 0.9618297815322876, "vf_loss": 12.570218086242676, "entropy": 1.3480435609817505, "cur_lr": 0.0005000000237487257, "total_loss": 12.565059661865234, "kl": 0.014487452805042267, "policy_loss": -0.008826063014566898, "cur_kl_coeff": 0.25312498211860657}}, "time_this_iter_s": 25.729677200317383, "timesteps_since_restore": 7260618, "time_since_restore": 4338.579126834869, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 41945, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668acd68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668acc18>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac7f0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-10-17", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 53.60964793954746}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1542.5262399071642, "node_ip": "10.138.0.2", "timesteps_total": 7303267, "iterations_since_restore": 167, "episode_reward_mean": 1324.437439356019, "custom_metrics": {"cost1_max": 454.9892733875897, "cost1_mean": 370.02005858652296, "system_level_velocity_mean": 14.492796760652839, "outflow_rate_max": 1369.598405175512, "cost1_min": 95.26945893810787, "system_level_velocity_max": 19.341410627455836, "system_level_velocity_min": 11.475470614639443, "outflow_rate_min": 438.7193230430037, "cost2_max": -26.949949733296215, "cost2_mean": -65.63569117814276, "outflow_rate_mean": 1123.150589732108, "cost2_min": -97.32841118517115}, "training_iteration": 167, "episodes_total": 2558, "episode_len_mean": 677.87, "timestamp": 1557209443, "time_total_s": 4364.427826881409, "pid": 32008, "info": {"num_steps_trained": 7303267, "num_steps_sampled": 7303267, "load_time_ms": 12.137, "grad_time_ms": 10318.901, "sample_time_ms": 16244.388, "update_time_ms": 9.751, "default": {"vf_explained_var": 0.9659166932106018, "vf_loss": 11.961414337158203, "entropy": 1.3326911926269531, "cur_lr": 0.0005000000237487257, "total_loss": 11.956398010253906, "kl": 0.015312472358345985, "policy_loss": -0.008892989717423916, "cur_kl_coeff": 0.25312498211860657}}, "time_this_iter_s": 25.848700046539307, "timesteps_since_restore": 7303267, "time_since_restore": 4364.427826881409, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42649, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668acda0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668acc88>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668acf98>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-10-43", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 234.07127155895083}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1542.5262399071642, "node_ip": "10.138.0.2", "timesteps_total": 7344645, "iterations_since_restore": 168, "episode_reward_mean": 1295.8620414519348, "custom_metrics": {"cost1_max": 487.75495393638596, "cost1_mean": 367.2673124949134, "system_level_velocity_mean": 14.802423737100641, "outflow_rate_max": 1369.598405175512, "cost1_min": 29.05620554173754, "system_level_velocity_max": 19.832606071652894, "system_level_velocity_min": 11.911377515091468, "outflow_rate_min": 326.2713828205716, "cost2_max": -13.343406133776957, "cost2_mean": -65.14078057113844, "outflow_rate_mean": 1116.6203866335802, "cost2_min": -97.32841118517115}, "training_iteration": 168, "episodes_total": 2576, "episode_len_mean": 663.85, "timestamp": 1557209467, "time_total_s": 4388.379207849503, "pid": 32008, "info": {"num_steps_trained": 7344645, "num_steps_sampled": 7344645, "load_time_ms": 12.149, "grad_time_ms": 10233.566, "sample_time_ms": 16024.287, "update_time_ms": 9.823, "default": {"vf_explained_var": 0.9392251372337341, "vf_loss": 19.441431045532227, "entropy": 1.3279696702957153, "cur_lr": 0.0005000000237487257, "total_loss": 19.437400817871094, "kl": 0.01383363176137209, "policy_loss": -0.007533008698374033, "cur_kl_coeff": 0.25312498211860657}}, "time_this_iter_s": 23.951380968093872, "timesteps_since_restore": 7344645, "time_since_restore": 4388.379207849503, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 41378, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ace80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac4a8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac780>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-11-07", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 54.91054567743711}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1542.5262399071642, "node_ip": "10.138.0.2", "timesteps_total": 7386520, "iterations_since_restore": 169, "episode_reward_mean": 1303.3686316116678, "custom_metrics": {"cost1_max": 487.75495393638596, "cost1_mean": 371.2664477761656, "system_level_velocity_mean": 14.957907534449207, "outflow_rate_max": 1369.598405175512, "cost1_min": 29.05620554173754, "system_level_velocity_max": 19.832606071652894, "system_level_velocity_min": 11.911377515091468, "outflow_rate_min": 326.2713828205716, "cost2_max": -13.343406133776957, "cost2_mean": -66.23888276864525, "outflow_rate_mean": 1124.045202259844, "cost2_min": -97.32841118517115}, "training_iteration": 169, "episodes_total": 2594, "episode_len_mean": 663.85, "timestamp": 1557209493, "time_total_s": 4414.297045469284, "pid": 32008, "info": {"num_steps_trained": 7386520, "num_steps_sampled": 7386520, "load_time_ms": 12.153, "grad_time_ms": 10134.697, "sample_time_ms": 16127.437, "update_time_ms": 9.688, "default": {"vf_explained_var": 0.9669519662857056, "vf_loss": 11.72106647491455, "entropy": 1.3482897281646729, "cur_lr": 0.0005000000237487257, "total_loss": 11.715411186218262, "kl": 0.014672521501779556, "policy_loss": -0.009370388463139534, "cur_kl_coeff": 0.25312498211860657}}, "time_this_iter_s": 25.917837619781494, "timesteps_since_restore": 7386520, "time_since_restore": 4414.297045469284, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 41875, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1400>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1e10>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-11-33", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 54.91054567743711}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1542.5262399071642, "node_ip": "10.138.0.2", "timesteps_total": 7429330, "iterations_since_restore": 170, "episode_reward_mean": 1297.7509757185592, "custom_metrics": {"cost1_max": 487.75495393638596, "cost1_mean": 371.7813095681023, "system_level_velocity_mean": 14.987015423621228, "outflow_rate_max": 1369.598405175512, "cost1_min": 29.05620554173754, "system_level_velocity_max": 19.832606071652894, "system_level_velocity_min": 11.911377515091468, "outflow_rate_min": 326.2713828205716, "cost2_max": -13.343406133776957, "cost2_mean": -67.43776269905972, "outflow_rate_mean": 1125.8497590169743, "cost2_min": -97.33177342412284}, "training_iteration": 170, "episodes_total": 2608, "episode_len_mean": 663.85, "timestamp": 1557209520, "time_total_s": 4441.26802611351, "pid": 32008, "info": {"num_steps_trained": 7429330, "num_steps_sampled": 7429330, "load_time_ms": 12.098, "grad_time_ms": 10012.516, "sample_time_ms": 16085.5, "update_time_ms": 9.585, "default": {"vf_explained_var": 0.9602129459381104, "vf_loss": 12.864174842834473, "entropy": 1.342933177947998, "cur_lr": 0.0005000000237487257, "total_loss": 12.858255386352539, "kl": 0.015038707293570042, "policy_loss": -0.009727702476084232, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 26.970980644226074, "timesteps_since_restore": 7429330, "time_since_restore": 4441.26802611351, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42810, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac0b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aca20>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac9e8>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-12-00", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 54.91054567743711}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1542.5262399071642, "node_ip": "10.138.0.2", "timesteps_total": 7473813, "iterations_since_restore": 171, "episode_reward_mean": 1304.639182340711, "custom_metrics": {"cost1_max": 487.75495393638596, "cost1_mean": 374.9799457757054, "system_level_velocity_mean": 14.996003245168957, "outflow_rate_max": 1369.598405175512, "cost1_min": 29.05620554173754, "system_level_velocity_max": 19.832606071652894, "system_level_velocity_min": 11.911377515091468, "outflow_rate_min": 326.2713828205716, "cost2_max": -13.343406133776957, "cost2_mean": -68.45570046723624, "outflow_rate_mean": 1130.3083660399395, "cost2_min": -98.77910386362029}, "training_iteration": 171, "episodes_total": 2620, "episode_len_mean": 668.4, "timestamp": 1557209547, "time_total_s": 4468.023273944855, "pid": 32008, "info": {"num_steps_trained": 7473813, "num_steps_sampled": 7473813, "load_time_ms": 12.635, "grad_time_ms": 9965.915, "sample_time_ms": 16018.561, "update_time_ms": 9.471, "default": {"vf_explained_var": 0.9753330945968628, "vf_loss": 7.112185955047607, "entropy": 1.3609871864318848, "cur_lr": 0.0005000000237487257, "total_loss": 7.111283779144287, "kl": 0.014555566012859344, "policy_loss": -0.004585957154631615, "cur_kl_coeff": 0.25312498211860657}}, "time_this_iter_s": 26.755247831344604, "timesteps_since_restore": 7473813, "time_since_restore": 4468.023273944855, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44483, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668acba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac208>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ace10>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-12-27", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 54.91054567743711}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1536.7244005345037, "node_ip": "10.138.0.2", "timesteps_total": 7517621, "iterations_since_restore": 172, "episode_reward_mean": 1300.8306647486816, "custom_metrics": {"cost1_max": 487.75495393638596, "cost1_mean": 371.3187712299585, "system_level_velocity_mean": 14.837360184640287, "outflow_rate_max": 1369.598405175512, "cost1_min": 29.05620554173754, "system_level_velocity_max": 19.832606071652894, "system_level_velocity_min": 11.911377515091468, "outflow_rate_min": 326.2713828205716, "cost2_max": -13.343406133776957, "cost2_mean": -68.42571470863786, "outflow_rate_mean": 1121.975255317469, "cost2_min": -108.5380543445848}, "training_iteration": 172, "episodes_total": 2636, "episode_len_mean": 669.52, "timestamp": 1557209575, "time_total_s": 4495.892793178558, "pid": 32008, "info": {"num_steps_trained": 7517621, "num_steps_sampled": 7517621, "load_time_ms": 12.803, "grad_time_ms": 10000.99, "sample_time_ms": 16048.011, "update_time_ms": 9.378, "default": {"vf_explained_var": 0.9726012945175171, "vf_loss": 9.252203941345215, "entropy": 1.3568766117095947, "cur_lr": 0.0005000000237487257, "total_loss": 9.246776580810547, "kl": 0.014789738692343235, "policy_loss": -0.009172019548714161, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 27.869519233703613, "timesteps_since_restore": 7517621, "time_since_restore": 4495.892793178558, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43808, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668acf28>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac780>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-12-55", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 54.91054567743711}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1522.5889117310292, "node_ip": "10.138.0.2", "timesteps_total": 7559616, "iterations_since_restore": 173, "episode_reward_mean": 1294.9417689818372, "custom_metrics": {"cost1_max": 487.75495393638596, "cost1_mean": 372.1924936577137, "system_level_velocity_mean": 14.90308243566014, "outflow_rate_max": 1369.598405175512, "cost1_min": 29.05620554173754, "system_level_velocity_max": 20.129648619114086, "system_level_velocity_min": 12.079826805539591, "outflow_rate_min": 326.2713828205716, "cost2_max": -13.343406133776957, "cost2_mean": -67.29657564811785, "outflow_rate_mean": 1122.106518233132, "cost2_min": -108.5380543445848}, "training_iteration": 173, "episodes_total": 2653, "episode_len_mean": 668.35, "timestamp": 1557209599, "time_total_s": 4520.372222185135, "pid": 32008, "info": {"num_steps_trained": 7559616, "num_steps_sampled": 7559616, "load_time_ms": 13.133, "grad_time_ms": 9982.607, "sample_time_ms": 15865.932, "update_time_ms": 9.427, "default": {"vf_explained_var": 0.9580768346786499, "vf_loss": 13.17895221710205, "entropy": 1.360465407371521, "cur_lr": 0.0005000000237487257, "total_loss": 13.17404842376709, "kl": 0.01564907655119896, "policy_loss": -0.008866293355822563, "cur_kl_coeff": 0.25312498211860657}}, "time_this_iter_s": 24.479429006576538, "timesteps_since_restore": 7559616, "time_since_restore": 4520.372222185135, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 41995, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac2e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac438>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac7f0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-13-19", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 54.665840985597534}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1556.0900550045965, "node_ip": "10.138.0.2", "timesteps_total": 7601928, "iterations_since_restore": 174, "episode_reward_mean": 1316.5001939143376, "custom_metrics": {"cost1_max": 451.0284851103632, "cost1_mean": 374.50090350948676, "system_level_velocity_mean": 14.660996226860778, "outflow_rate_max": 1349.1728710930608, "cost1_min": 29.05620554173754, "system_level_velocity_max": 20.129648619114086, "system_level_velocity_min": 12.079826805539591, "outflow_rate_min": 329.6337234057179, "cost2_max": -13.159406774692119, "cost2_mean": -69.2941832661383, "outflow_rate_mean": 1124.9786770199114, "cost2_min": -108.5380543445848}, "training_iteration": 174, "episodes_total": 2670, "episode_len_mean": 680.29, "timestamp": 1557209626, "time_total_s": 4546.81938791275, "pid": 32008, "info": {"num_steps_trained": 7601928, "num_steps_sampled": 7601928, "load_time_ms": 13.087, "grad_time_ms": 9933.084, "sample_time_ms": 15982.702, "update_time_ms": 9.306, "default": {"vf_explained_var": 0.9653351902961731, "vf_loss": 11.718267440795898, "entropy": 1.344892978668213, "cur_lr": 0.0005000000237487257, "total_loss": 11.71436882019043, "kl": 0.015642905607819557, "policy_loss": -0.007858648896217346, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 26.447165727615356, "timesteps_since_restore": 7601928, "time_since_restore": 4546.81938791275, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42312, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668acd30>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ace80>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-13-46", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 54.665840985597534}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1556.0900550045965, "node_ip": "10.138.0.2", "timesteps_total": 7644672, "iterations_since_restore": 175, "episode_reward_mean": 1327.6247121499757, "custom_metrics": {"cost1_max": 453.00658771280206, "cost1_mean": 376.50057403282995, "system_level_velocity_mean": 14.567997581116432, "outflow_rate_max": 1375.317477647829, "cost1_min": 29.07071750888635, "system_level_velocity_max": 20.129648619114086, "system_level_velocity_min": 12.079826805539591, "outflow_rate_min": 329.6337234057179, "cost2_max": -13.159406774692119, "cost2_mean": -70.99570605020443, "outflow_rate_mean": 1130.2682961374421, "cost2_min": -108.5380543445848}, "training_iteration": 175, "episodes_total": 2683, "episode_len_mean": 686.86, "timestamp": 1557209652, "time_total_s": 4572.9900550842285, "pid": 32008, "info": {"num_steps_trained": 7644672, "num_steps_sampled": 7644672, "load_time_ms": 13.175, "grad_time_ms": 9887.802, "sample_time_ms": 16004.696, "update_time_ms": 9.312, "default": {"vf_explained_var": 0.9651269316673279, "vf_loss": 11.422689437866211, "entropy": 1.348858118057251, "cur_lr": 0.0005000000237487257, "total_loss": 11.416053771972656, "kl": 0.018232561647892, "policy_loss": -0.011250404641032219, "cur_kl_coeff": 0.25312498211860657}}, "time_this_iter_s": 26.17066717147827, "timesteps_since_restore": 7644672, "time_since_restore": 4572.9900550842285, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42744, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668655c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865390>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865dd8>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-14-12", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 54.665840985597534}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1556.0900550045965, "node_ip": "10.138.0.2", "timesteps_total": 7689749, "iterations_since_restore": 176, "episode_reward_mean": 1332.7063239868573, "custom_metrics": {"cost1_max": 456.17490483996573, "cost1_mean": 377.2759908294119, "system_level_velocity_mean": 14.604165709340045, "outflow_rate_max": 1375.317477647829, "cost1_min": 29.07071750888635, "system_level_velocity_max": 20.129648619114086, "system_level_velocity_min": 12.036527360849549, "outflow_rate_min": 329.6337234057179, "cost2_max": -13.159406774692119, "cost2_mean": -71.96496754780257, "outflow_rate_mean": 1128.959417855635, "cost2_min": -108.5380543445848}, "training_iteration": 176, "episodes_total": 2697, "episode_len_mean": 686.86, "timestamp": 1557209679, "time_total_s": 4600.0843296051025, "pid": 32008, "info": {"num_steps_trained": 7689749, "num_steps_sampled": 7689749, "load_time_ms": 13.128, "grad_time_ms": 9945.853, "sample_time_ms": 16083.233, "update_time_ms": 9.091, "default": {"vf_explained_var": 0.9743883013725281, "vf_loss": 7.2772536277771, "entropy": 1.3926563262939453, "cur_lr": 0.0005000000237487257, "total_loss": 7.275559902191162, "kl": 0.016356954351067543, "policy_loss": -0.00583454966545105, "cur_kl_coeff": 0.25312498211860657}}, "time_this_iter_s": 27.094274520874023, "timesteps_since_restore": 7689749, "time_since_restore": 4600.0843296051025, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 45077, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac2b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac320>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668accf8>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-14-39", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 54.665840985597534}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1556.0900550045965, "node_ip": "10.138.0.2", "timesteps_total": 7733664, "iterations_since_restore": 177, "episode_reward_mean": 1314.1891871908038, "custom_metrics": {"cost1_max": 456.17490483996573, "cost1_mean": 370.7216026953693, "system_level_velocity_mean": 14.531297995763005, "outflow_rate_max": 1375.317477647829, "cost1_min": 29.07071750888635, "system_level_velocity_max": 20.129648619114086, "system_level_velocity_min": 11.697859658479691, "outflow_rate_min": 305.87407302463674, "cost2_max": -8.747230297787421, "cost2_mean": -71.34591916115744, "outflow_rate_mean": 1111.173474302263, "cost2_min": -108.5380543445848}, "training_iteration": 177, "episodes_total": 2714, "episode_len_mean": 680.31, "timestamp": 1557209706, "time_total_s": 4627.019560813904, "pid": 32008, "info": {"num_steps_trained": 7733664, "num_steps_sampled": 7733664, "load_time_ms": 13.127, "grad_time_ms": 10004.234, "sample_time_ms": 16132.994, "update_time_ms": 9.142, "default": {"vf_explained_var": 0.9724803566932678, "vf_loss": 9.328165054321289, "entropy": 1.3759841918945312, "cur_lr": 0.0005000000237487257, "total_loss": 9.32529067993164, "kl": 0.015489298850297928, "policy_loss": -0.006794898770749569, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 26.93523120880127, "timesteps_since_restore": 7733664, "time_since_restore": 4627.019560813904, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43915, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668acb38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac390>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac748>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-15-06", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 54.665840985597534}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1556.0900550045965, "node_ip": "10.138.0.2", "timesteps_total": 7776007, "iterations_since_restore": 178, "episode_reward_mean": 1308.8411568530473, "custom_metrics": {"cost1_max": 456.17490483996573, "cost1_mean": 370.31485766712944, "system_level_velocity_mean": 14.527691645400017, "outflow_rate_max": 1375.317477647829, "cost1_min": 29.07071750888635, "system_level_velocity_max": 20.129648619114086, "system_level_velocity_min": 11.697859658479691, "outflow_rate_min": 305.87407302463674, "cost2_max": -8.747230297787421, "cost2_mean": -72.3788911293659, "outflow_rate_mean": 1109.3957540903505, "cost2_min": -108.5380543445848}, "training_iteration": 178, "episodes_total": 2730, "episode_len_mean": 680.31, "timestamp": 1557209732, "time_total_s": 4652.669691562653, "pid": 32008, "info": {"num_steps_trained": 7776007, "num_steps_sampled": 7776007, "load_time_ms": 13.115, "grad_time_ms": 10122.288, "sample_time_ms": 16184.752, "update_time_ms": 9.125, "default": {"vf_explained_var": 0.9704154133796692, "vf_loss": 9.940900802612305, "entropy": 1.3817530870437622, "cur_lr": 0.0005000000237487257, "total_loss": 9.93675708770752, "kl": 0.014928280375897884, "policy_loss": -0.007922087796032429, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 25.65013074874878, "timesteps_since_restore": 7776007, "time_since_restore": 4652.669691562653, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42343, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cef98>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce390>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-15-32", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 54.665840985597534}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1568.1553852261125, "node_ip": "10.138.0.2", "timesteps_total": 7819948, "iterations_since_restore": 179, "episode_reward_mean": 1314.386049474073, "custom_metrics": {"cost1_max": 456.17490483996573, "cost1_mean": 369.77633198722305, "system_level_velocity_mean": 14.630108713745429, "outflow_rate_max": 1398.4958825585682, "cost1_min": 29.07071750888635, "system_level_velocity_max": 20.129648619114086, "system_level_velocity_min": 11.697859658479691, "outflow_rate_min": 305.87407302463674, "cost2_max": -8.747230297787421, "cost2_mean": -72.32545296730784, "outflow_rate_mean": 1112.4326140169535, "cost2_min": -106.44978153792587}, "training_iteration": 179, "episodes_total": 2747, "episode_len_mean": 675.84, "timestamp": 1557209758, "time_total_s": 4678.400497674942, "pid": 32008, "info": {"num_steps_trained": 7819948, "num_steps_sampled": 7819948, "load_time_ms": 13.628, "grad_time_ms": 10225.49, "sample_time_ms": 16060.34, "update_time_ms": 9.432, "default": {"vf_explained_var": 0.9513111114501953, "vf_loss": 14.668941497802734, "entropy": 1.4065957069396973, "cur_lr": 0.0005000000237487257, "total_loss": 14.663825035095215, "kl": 0.0141404177993536, "policy_loss": -0.008696547709405422, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 25.73080611228943, "timesteps_since_restore": 7819948, "time_since_restore": 4678.400497674942, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43941, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cda58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd5c0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd710>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-15-58", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 54.665840985597534}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1568.1553852261125, "node_ip": "10.138.0.2", "timesteps_total": 7864370, "iterations_since_restore": 180, "episode_reward_mean": 1318.3565122145094, "custom_metrics": {"cost1_max": 456.17490483996573, "cost1_mean": 370.5934117157763, "system_level_velocity_mean": 14.573802915467127, "outflow_rate_max": 1398.4958825585682, "cost1_min": 29.07071750888635, "system_level_velocity_max": 19.652579553022463, "system_level_velocity_min": 11.697859658479691, "outflow_rate_min": 305.87407302463674, "cost2_max": -8.747230297787421, "cost2_mean": -75.07592650645657, "outflow_rate_mean": 1117.003953246178, "cost2_min": -108.86039968379725}, "training_iteration": 180, "episodes_total": 2760, "episode_len_mean": 679.32, "timestamp": 1557209784, "time_total_s": 4704.831926345825, "pid": 32008, "info": {"num_steps_trained": 7864370, "num_steps_sampled": 7864370, "load_time_ms": 13.645, "grad_time_ms": 10294.456, "sample_time_ms": 15935.346, "update_time_ms": 9.349, "default": {"vf_explained_var": 0.9752271175384521, "vf_loss": 8.840319633483887, "entropy": 1.4177180528640747, "cur_lr": 0.0005000000237487257, "total_loss": 8.835204124450684, "kl": 0.01568281650543213, "policy_loss": -0.009085710160434246, "cur_kl_coeff": 0.25312498211860657}}, "time_this_iter_s": 26.43142867088318, "timesteps_since_restore": 7864370, "time_since_restore": 4704.831926345825, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44422, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bff28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfe10>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfd68>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-16-24", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 57.54283060358855}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1568.1553852261125, "node_ip": "10.138.0.2", "timesteps_total": 7907450, "iterations_since_restore": 181, "episode_reward_mean": 1330.3330827143, "custom_metrics": {"cost1_max": 507.77911794433487, "cost1_mean": 373.8143831111962, "system_level_velocity_mean": 14.527060154563646, "outflow_rate_max": 1398.4958825585682, "cost1_min": 30.637155281757803, "system_level_velocity_max": 19.372632528272657, "system_level_velocity_min": 11.662130252085968, "outflow_rate_min": 305.87407302463674, "cost2_max": -8.747230297787421, "cost2_mean": -78.68517771318993, "outflow_rate_mean": 1124.5099429006998, "cost2_min": -126.87219077679524}, "training_iteration": 181, "episodes_total": 2774, "episode_len_mean": 685.89, "timestamp": 1557209810, "time_total_s": 4731.0395402908325, "pid": 32008, "info": {"num_steps_trained": 7907450, "num_steps_sampled": 7907450, "load_time_ms": 13.985, "grad_time_ms": 10235.974, "sample_time_ms": 15939.125, "update_time_ms": 9.105, "default": {"vf_explained_var": 0.9783326983451843, "vf_loss": 7.648831367492676, "entropy": 1.4222787618637085, "cur_lr": 0.0005000000237487257, "total_loss": 7.644535541534424, "kl": 0.013704302720725536, "policy_loss": -0.007764799986034632, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 26.207613945007324, "timesteps_since_restore": 7907450, "time_since_restore": 4731.0395402908325, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43080, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668acd30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac8d0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac748>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-16-50", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 57.54283060358855}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1568.1553852261125, "node_ip": "10.138.0.2", "timesteps_total": 7952411, "iterations_since_restore": 182, "episode_reward_mean": 1325.9977945746152, "custom_metrics": {"cost1_max": 507.77911794433487, "cost1_mean": 372.3524779800214, "system_level_velocity_mean": 14.48104170462518, "outflow_rate_max": 1398.4958825585682, "cost1_min": 30.637155281757803, "system_level_velocity_max": 19.372632528272657, "system_level_velocity_min": 11.662130252085968, "outflow_rate_min": 305.87407302463674, "cost2_max": -8.747230297787421, "cost2_mean": -81.81151821536133, "outflow_rate_mean": 1125.5824589277713, "cost2_min": -126.87219077679524}, "training_iteration": 182, "episodes_total": 2790, "episode_len_mean": 685.89, "timestamp": 1557209837, "time_total_s": 4757.770416021347, "pid": 32008, "info": {"num_steps_trained": 7952411, "num_steps_sampled": 7952411, "load_time_ms": 13.883, "grad_time_ms": 10156.629, "sample_time_ms": 15907.203, "update_time_ms": 9.141, "default": {"vf_explained_var": 0.9650974273681641, "vf_loss": 10.595894813537598, "entropy": 1.4345165491104126, "cur_lr": 0.0005000000237487257, "total_loss": 10.59228229522705, "kl": 0.015236860141158104, "policy_loss": -0.007469115313142538, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 26.730875730514526, "timesteps_since_restore": 7952411, "time_since_restore": 4757.770416021347, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44961, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf5c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1e48>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1160>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-17-17", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 57.54283060358855}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1568.1553852261125, "node_ip": "10.138.0.2", "timesteps_total": 7995460, "iterations_since_restore": 183, "episode_reward_mean": 1334.2094858386527, "custom_metrics": {"cost1_max": 507.77911794433487, "cost1_mean": 375.338686169655, "system_level_velocity_mean": 14.433517783029021, "outflow_rate_max": 1398.4958825585682, "cost1_min": 177.4501212091838, "system_level_velocity_max": 19.372632528272657, "system_level_velocity_min": 11.662130252085968, "outflow_rate_min": 642.3942372901122, "cost2_max": -39.31018880142153, "cost2_mean": -85.76106560537082, "outflow_rate_mean": 1132.0583872206153, "cost2_min": -126.87219077679524}, "training_iteration": 183, "episodes_total": 2804, "episode_len_mean": 692.44, "timestamp": 1557209862, "time_total_s": 4782.756827831268, "pid": 32008, "info": {"num_steps_trained": 7995460, "num_steps_sampled": 7995460, "load_time_ms": 13.752, "grad_time_ms": 10077.539, "sample_time_ms": 16038.786, "update_time_ms": 8.78, "default": {"vf_explained_var": 0.9713659882545471, "vf_loss": 10.346885681152344, "entropy": 1.4225531816482544, "cur_lr": 0.0005000000237487257, "total_loss": 10.342178344726562, "kl": 0.013862584717571735, "policy_loss": -0.008216090500354767, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 24.986411809921265, "timesteps_since_restore": 7995460, "time_since_restore": 4782.756827831268, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43049, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfe80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf588>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfb70>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-17-42", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 516.5559752490029}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1568.1553852261125, "node_ip": "10.138.0.2", "timesteps_total": 8037579, "iterations_since_restore": 184, "episode_reward_mean": 1332.0873875352236, "custom_metrics": {"cost1_max": 507.77911794433487, "cost1_mean": 377.96070969168983, "system_level_velocity_mean": 14.559238967079834, "outflow_rate_max": 1398.4958825585682, "cost1_min": 177.4501212091838, "system_level_velocity_max": 19.372632528272657, "system_level_velocity_min": 11.662130252085968, "outflow_rate_min": 642.3942372901122, "cost2_max": -39.31018880142153, "cost2_mean": -88.39890162735864, "outflow_rate_mean": 1139.3535433533775, "cost2_min": -126.87219077679524}, "training_iteration": 184, "episodes_total": 2821, "episode_len_mean": 692.44, "timestamp": 1557209888, "time_total_s": 4808.121750593185, "pid": 32008, "info": {"num_steps_trained": 8037579, "num_steps_sampled": 8037579, "load_time_ms": 13.867, "grad_time_ms": 9977.738, "sample_time_ms": 16031.484, "update_time_ms": 8.536, "default": {"vf_explained_var": 0.9690548181533813, "vf_loss": 11.239458084106445, "entropy": 1.414020299911499, "cur_lr": 0.0005000000237487257, "total_loss": 11.233580589294434, "kl": 0.014926730655133724, "policy_loss": -0.009656156413257122, "cur_kl_coeff": 0.25312498211860657}}, "time_this_iter_s": 25.364922761917114, "timesteps_since_restore": 8037579, "time_since_restore": 4808.121750593185, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42119, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf2b0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfd30>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-18-08", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 516.5559752490029}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1568.1553852261125, "node_ip": "10.138.0.2", "timesteps_total": 8082635, "iterations_since_restore": 185, "episode_reward_mean": 1329.783231624575, "custom_metrics": {"cost1_max": 508.5236998137392, "cost1_mean": 380.0243546722484, "system_level_velocity_mean": 14.663108726830679, "outflow_rate_max": 1398.4958825585682, "cost1_min": 177.4501212091838, "system_level_velocity_max": 19.372632528272657, "system_level_velocity_min": 11.662130252085968, "outflow_rate_min": 642.3942372901122, "cost2_max": -39.31018880142153, "cost2_mean": -90.39915125688984, "outflow_rate_mean": 1144.1870176316722, "cost2_min": -126.87219077679524}, "training_iteration": 185, "episodes_total": 2834, "episode_len_mean": 692.44, "timestamp": 1557209914, "time_total_s": 4834.311204433441, "pid": 32008, "info": {"num_steps_trained": 8082635, "num_steps_sampled": 8082635, "load_time_ms": 13.942, "grad_time_ms": 9960.221, "sample_time_ms": 16052.772, "update_time_ms": 8.569, "default": {"vf_explained_var": 0.9681939482688904, "vf_loss": 10.457765579223633, "entropy": 1.422123670578003, "cur_lr": 0.0005000000237487257, "total_loss": 10.453568458557129, "kl": 0.013807340525090694, "policy_loss": -0.0076911840587854385, "cur_kl_coeff": 0.25312498211860657}}, "time_this_iter_s": 26.189453840255737, "timesteps_since_restore": 8082635, "time_since_restore": 4834.311204433441, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 45056, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875dd8>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875cc0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-18-34", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 516.5559752490029}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1544.6394005984653, "node_ip": "10.138.0.2", "timesteps_total": 8125914, "iterations_since_restore": 186, "episode_reward_mean": 1305.1178034227794, "custom_metrics": {"cost1_max": 508.5236998137392, "cost1_mean": 375.8279014265707, "system_level_velocity_mean": 14.67172603429415, "outflow_rate_max": 1387.5179085325703, "cost1_min": 29.529221259371443, "system_level_velocity_max": 20.21847407182818, "system_level_velocity_min": 11.662130252085968, "outflow_rate_min": 329.6337234057179, "cost2_max": -18.162781385507976, "cost2_mean": -93.7496017297909, "outflow_rate_mean": 1132.7329100143077, "cost2_min": -126.87219077679524}, "training_iteration": 186, "episodes_total": 2851, "episode_len_mean": 688.37, "timestamp": 1557209939, "time_total_s": 4859.836069107056, "pid": 32008, "info": {"num_steps_trained": 8125914, "num_steps_sampled": 8125914, "load_time_ms": 14.263, "grad_time_ms": 9812.859, "sample_time_ms": 16043.373, "update_time_ms": 8.528, "default": {"vf_explained_var": 0.956626296043396, "vf_loss": 16.47890281677246, "entropy": 1.4052603244781494, "cur_lr": 0.0005000000237487257, "total_loss": 16.474178314208984, "kl": 0.015269754454493523, "policy_loss": -0.008589369244873524, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 25.524864673614502, "timesteps_since_restore": 8125914, "time_since_restore": 4859.836069107056, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43279, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7978>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4668>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-18-59", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 51.105727894095146}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1544.6394005984653, "node_ip": "10.138.0.2", "timesteps_total": 8168418, "iterations_since_restore": 187, "episode_reward_mean": 1283.1713085781698, "custom_metrics": {"cost1_max": 508.5236998137392, "cost1_mean": 374.6574264325273, "system_level_velocity_mean": 14.972892771397825, "outflow_rate_max": 1419.478024704552, "cost1_min": 29.529221259371443, "system_level_velocity_max": 20.21847407182818, "system_level_velocity_min": 11.89402098383876, "outflow_rate_min": 328.3754157727966, "cost2_max": -15.262637348270204, "cost2_mean": -93.31834904875988, "outflow_rate_mean": 1130.2442744915923, "cost2_min": -125.09388711993606}, "training_iteration": 187, "episodes_total": 2871, "episode_len_mean": 676.67, "timestamp": 1557209965, "time_total_s": 4885.215760469437, "pid": 32008, "info": {"num_steps_trained": 8168418, "num_steps_sampled": 8168418, "load_time_ms": 14.409, "grad_time_ms": 9664.828, "sample_time_ms": 16035.259, "update_time_ms": 8.245, "default": {"vf_explained_var": 0.9536142945289612, "vf_loss": 16.858299255371094, "entropy": 1.4050990343093872, "cur_lr": 0.0005000000237487257, "total_loss": 16.85297393798828, "kl": 0.01643301546573639, "policy_loss": -0.009484190493822098, "cur_kl_coeff": 0.25312498211860657}}, "time_this_iter_s": 25.37969136238098, "timesteps_since_restore": 8168418, "time_since_restore": 4885.215760469437, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42504, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfb70>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf588>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-19-25", "hostname": "flow-main", "episodes_this_iter": 20, "episode_reward_min": 51.105727894095146}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1544.6394005984653, "node_ip": "10.138.0.2", "timesteps_total": 8210573, "iterations_since_restore": 188, "episode_reward_mean": 1270.2154474072015, "custom_metrics": {"cost1_max": 508.5236998137392, "cost1_mean": 372.0521279601677, "system_level_velocity_mean": 15.04397648222768, "outflow_rate_max": 1419.478024704552, "cost1_min": 29.529221259371443, "system_level_velocity_max": 20.21847407182818, "system_level_velocity_min": 11.89402098383876, "outflow_rate_min": 328.3754157727966, "cost2_max": -15.262637348270204, "cost2_mean": -93.04616907861308, "outflow_rate_mean": 1123.2063209853063, "cost2_min": -123.28704425080115}, "training_iteration": 188, "episodes_total": 2886, "episode_len_mean": 671.01, "timestamp": 1557209990, "time_total_s": 4910.845335245132, "pid": 32008, "info": {"num_steps_trained": 8210573, "num_steps_sampled": 8210573, "load_time_ms": 14.572, "grad_time_ms": 9505.116, "sample_time_ms": 16192.958, "update_time_ms": 8.019, "default": {"vf_explained_var": 0.9620548486709595, "vf_loss": 14.526034355163574, "entropy": 1.4154243469238281, "cur_lr": 0.0005000000237487257, "total_loss": 14.521024703979492, "kl": 0.015942394733428955, "policy_loss": -0.009047618135809898, "cur_kl_coeff": 0.25312498211860657}}, "time_this_iter_s": 25.6295747756958, "timesteps_since_restore": 8210573, "time_since_restore": 4910.845335245132, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42155, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aad30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac390>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac940>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-19-50", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 51.105727894095146}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1583.399295051264, "node_ip": "10.138.0.2", "timesteps_total": 8255266, "iterations_since_restore": 189, "episode_reward_mean": 1277.766095827789, "custom_metrics": {"cost1_max": 508.5236998137392, "cost1_mean": 375.9611422022431, "system_level_velocity_mean": 15.186797680043547, "outflow_rate_max": 1437.903521934451, "cost1_min": 29.529221259371443, "system_level_velocity_max": 20.21847407182818, "system_level_velocity_min": 11.89402098383876, "outflow_rate_min": 328.3754157727966, "cost2_max": -15.262637348270204, "cost2_mean": -94.40571692542393, "outflow_rate_mean": 1131.8206139282552, "cost2_min": -127.75219369934148}, "training_iteration": 189, "episodes_total": 2899, "episode_len_mean": 671.01, "timestamp": 1557210017, "time_total_s": 4937.525973081589, "pid": 32008, "info": {"num_steps_trained": 8255266, "num_steps_sampled": 8255266, "load_time_ms": 14.231, "grad_time_ms": 9417.394, "sample_time_ms": 16377.943, "update_time_ms": 7.811, "default": {"vf_explained_var": 0.9672073125839233, "vf_loss": 10.84677791595459, "entropy": 1.4280260801315308, "cur_lr": 0.0005000000237487257, "total_loss": 10.843031883239746, "kl": 0.01554784644395113, "policy_loss": -0.007681583054363728, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 26.6806378364563, "timesteps_since_restore": 8255266, "time_since_restore": 4937.525973081589, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44693, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875d68>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875dd8>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-20-17", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 51.105727894095146}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1672.8405460022018, "node_ip": "10.138.0.2", "timesteps_total": 8297670, "iterations_since_restore": 190, "episode_reward_mean": 1272.6917326330338, "custom_metrics": {"cost1_max": 517.1409773190985, "cost1_mean": 374.0858174601442, "system_level_velocity_mean": 15.335210532877351, "outflow_rate_max": 1443.1254455895823, "cost1_min": 29.529221259371443, "system_level_velocity_max": 20.21847407182818, "system_level_velocity_min": 12.449034465799377, "outflow_rate_min": 328.3754157727966, "cost2_max": -15.262637348270204, "cost2_mean": -95.81258135376524, "outflow_rate_mean": 1125.870020432612, "cost2_min": -127.75219369934148}, "training_iteration": 190, "episodes_total": 2916, "episode_len_mean": 664.09, "timestamp": 1557210042, "time_total_s": 4962.801332950592, "pid": 32008, "info": {"num_steps_trained": 8297670, "num_steps_sampled": 8297670, "load_time_ms": 14.744, "grad_time_ms": 9309.948, "sample_time_ms": 16369.94, "update_time_ms": 7.864, "default": {"vf_explained_var": 0.9612749218940735, "vf_loss": 14.189105033874512, "entropy": 1.4342905282974243, "cur_lr": 0.0005000000237487257, "total_loss": 14.184213638305664, "kl": 0.014052611775696278, "policy_loss": -0.008448255248367786, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 25.275359869003296, "timesteps_since_restore": 8297670, "time_since_restore": 4962.801332950592, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42404, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875b70>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875438>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-20-42", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 51.105727894095146}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1672.8405460022018, "node_ip": "10.138.0.2", "timesteps_total": 8340219, "iterations_since_restore": 191, "episode_reward_mean": 1267.9412281869343, "custom_metrics": {"cost1_max": 517.1409773190985, "cost1_mean": 373.97849506968157, "system_level_velocity_mean": 15.354223016041892, "outflow_rate_max": 1443.1254455895823, "cost1_min": 29.529221259371443, "system_level_velocity_max": 20.21847407182818, "system_level_velocity_min": 12.449034465799377, "outflow_rate_min": 328.3754157727966, "cost2_max": -15.262637348270204, "cost2_mean": -99.03151875355212, "outflow_rate_mean": 1127.0026984567476, "cost2_min": -127.75219369934148}, "training_iteration": 191, "episodes_total": 2932, "episode_len_mean": 664.09, "timestamp": 1557210067, "time_total_s": 4987.588482379913, "pid": 32008, "info": {"num_steps_trained": 8340219, "num_steps_sampled": 8340219, "load_time_ms": 14.85, "grad_time_ms": 9204.956, "sample_time_ms": 16333.907, "update_time_ms": 8.131, "default": {"vf_explained_var": 0.972334086894989, "vf_loss": 9.968912124633789, "entropy": 1.4094197750091553, "cur_lr": 0.0005000000237487257, "total_loss": 9.96437931060791, "kl": 0.016137151047587395, "policy_loss": -0.008617822080850601, "cur_kl_coeff": 0.25312498211860657}}, "time_this_iter_s": 24.78714942932129, "timesteps_since_restore": 8340219, "time_since_restore": 4987.588482379913, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42549, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac8d0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac940>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-21-07", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 51.105727894095146}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1672.8405460022018, "node_ip": "10.138.0.2", "timesteps_total": 8384919, "iterations_since_restore": 192, "episode_reward_mean": 1280.7239420548085, "custom_metrics": {"cost1_max": 517.1409773190985, "cost1_mean": 376.4418245228126, "system_level_velocity_mean": 15.307777172929224, "outflow_rate_max": 1443.1254455895823, "cost1_min": 29.529221259371443, "system_level_velocity_max": 20.21847407182818, "system_level_velocity_min": 12.49996263898895, "outflow_rate_min": 328.3754157727966, "cost2_max": -15.262637348270204, "cost2_mean": -100.27358500094789, "outflow_rate_mean": 1132.9584465472076, "cost2_min": -127.75219369934148}, "training_iteration": 192, "episodes_total": 2944, "episode_len_mean": 669.15, "timestamp": 1557210093, "time_total_s": 5013.300857543945, "pid": 32008, "info": {"num_steps_trained": 8384919, "num_steps_sampled": 8384919, "load_time_ms": 14.938, "grad_time_ms": 9188.131, "sample_time_ms": 16249.751, "update_time_ms": 7.937, "default": {"vf_explained_var": 0.9816403388977051, "vf_loss": 6.662528991699219, "entropy": 1.3961541652679443, "cur_lr": 0.0005000000237487257, "total_loss": 6.658180236816406, "kl": 0.015035711228847504, "policy_loss": -0.008154765702784061, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 25.712375164031982, "timesteps_since_restore": 8384919, "time_since_restore": 5013.300857543945, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44700, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875978>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875828>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-21-33", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 51.105727894095146}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1672.8405460022018, "node_ip": "10.138.0.2", "timesteps_total": 8429255, "iterations_since_restore": 193, "episode_reward_mean": 1288.0289760497271, "custom_metrics": {"cost1_max": 517.1409773190985, "cost1_mean": 377.6546589172675, "system_level_velocity_mean": 15.305472386496222, "outflow_rate_max": 1443.1254455895823, "cost1_min": 29.55898799572321, "system_level_velocity_max": 20.19888019608034, "system_level_velocity_min": 12.045545268401067, "outflow_rate_min": 328.3754157727966, "cost2_max": -15.262637348270204, "cost2_mean": -102.73472825132868, "outflow_rate_mean": 1136.7882200152867, "cost2_min": -131.2539097379617}, "training_iteration": 193, "episodes_total": 2961, "episode_len_mean": 670.66, "timestamp": 1557210119, "time_total_s": 5039.516580104828, "pid": 32008, "info": {"num_steps_trained": 8429255, "num_steps_sampled": 8429255, "load_time_ms": 14.825, "grad_time_ms": 9167.77, "sample_time_ms": 16393.84, "update_time_ms": 7.876, "default": {"vf_explained_var": 0.9587235450744629, "vf_loss": 13.943206787109375, "entropy": 1.4300742149353027, "cur_lr": 0.0005000000237487257, "total_loss": 13.939977645874023, "kl": 0.01518189162015915, "policy_loss": -0.007070558145642281, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 26.21572256088257, "timesteps_since_restore": 8429255, "time_since_restore": 5039.516580104828, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44336, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668756a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875710>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875b70>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-21-59", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 53.697375660219116}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1672.8405460022018, "node_ip": "10.138.0.2", "timesteps_total": 8472934, "iterations_since_restore": 194, "episode_reward_mean": 1302.0558084840552, "custom_metrics": {"cost1_max": 519.5880147414215, "cost1_mean": 383.10527702577156, "system_level_velocity_mean": 15.378234047665114, "outflow_rate_max": 1443.1254455895823, "cost1_min": 29.498086560930986, "system_level_velocity_max": 20.19888019608034, "system_level_velocity_min": 12.045545268401067, "outflow_rate_min": 329.6337234057179, "cost2_max": -16.100661422656998, "cost2_mean": -105.82423072564102, "outflow_rate_mean": 1149.6826025380508, "cost2_min": -145.31094048707487}, "training_iteration": 194, "episodes_total": 2978, "episode_len_mean": 676.39, "timestamp": 1557210144, "time_total_s": 5064.766100645065, "pid": 32008, "info": {"num_steps_trained": 8472934, "num_steps_sampled": 8472934, "load_time_ms": 15.195, "grad_time_ms": 9146.404, "sample_time_ms": 16402.188, "update_time_ms": 7.87, "default": {"vf_explained_var": 0.9632382392883301, "vf_loss": 16.658939361572266, "entropy": 1.392863392829895, "cur_lr": 0.0005000000237487257, "total_loss": 16.655637741088867, "kl": 0.014288152568042278, "policy_loss": -0.006918660830706358, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 25.249520540237427, "timesteps_since_restore": 8472934, "time_since_restore": 5064.766100645065, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43679, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668752e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf6a0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfd68>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-22-24", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 53.697375660219116}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1672.8405460022018, "node_ip": "10.138.0.2", "timesteps_total": 8516171, "iterations_since_restore": 195, "episode_reward_mean": 1292.259663158166, "custom_metrics": {"cost1_max": 519.5880147414215, "cost1_mean": 379.62724578083805, "system_level_velocity_mean": 15.356526352488492, "outflow_rate_max": 1443.1254455895823, "cost1_min": 29.498086560930986, "system_level_velocity_max": 20.19888019608034, "system_level_velocity_min": 12.045545268401067, "outflow_rate_min": 329.6337234057179, "cost2_max": -16.100661422656998, "cost2_mean": -109.10459503846207, "outflow_rate_mean": 1141.7645322788087, "cost2_min": -147.43793898017793}, "training_iteration": 195, "episodes_total": 2996, "episode_len_mean": 672.99, "timestamp": 1557210170, "time_total_s": 5090.410702943802, "pid": 32008, "info": {"num_steps_trained": 8516171, "num_steps_sampled": 8516171, "load_time_ms": 15.06, "grad_time_ms": 9063.588, "sample_time_ms": 16431.7, "update_time_ms": 7.448, "default": {"vf_explained_var": 0.9655030965805054, "vf_loss": 12.24772834777832, "entropy": 1.4241068363189697, "cur_lr": 0.0005000000237487257, "total_loss": 12.243725776672363, "kl": 0.01479384582489729, "policy_loss": -0.0077467914670705795, "cur_kl_coeff": 0.25312498211860657}}, "time_this_iter_s": 25.644602298736572, "timesteps_since_restore": 8516171, "time_since_restore": 5090.410702943802, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43237, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875be0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875fd0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-22-50", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 53.697375660219116}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1639.3783476967913, "node_ip": "10.138.0.2", "timesteps_total": 8561895, "iterations_since_restore": 196, "episode_reward_mean": 1293.6738356346054, "custom_metrics": {"cost1_max": 519.5880147414215, "cost1_mean": 378.19820154243274, "system_level_velocity_mean": 15.290927650562084, "outflow_rate_max": 1433.6356832128638, "cost1_min": 29.498086560930986, "system_level_velocity_max": 20.19888019608034, "system_level_velocity_min": 11.774504948055048, "outflow_rate_min": 329.6337234057179, "cost2_max": -16.100661422656998, "cost2_mean": -110.87442241903305, "outflow_rate_mean": 1139.005112564574, "cost2_min": -147.43793898017793}, "training_iteration": 196, "episodes_total": 3010, "episode_len_mean": 673.34, "timestamp": 1557210196, "time_total_s": 5116.577890872955, "pid": 32008, "info": {"num_steps_trained": 8561895, "num_steps_sampled": 8561895, "load_time_ms": 15.078, "grad_time_ms": 9092.452, "sample_time_ms": 16467.923, "update_time_ms": 7.378, "default": {"vf_explained_var": 0.9748710989952087, "vf_loss": 7.792250633239746, "entropy": 1.4318513870239258, "cur_lr": 0.0005000000237487257, "total_loss": 7.788177013397217, "kl": 0.014857777394354343, "policy_loss": -0.007834723219275475, "cur_kl_coeff": 0.25312498211860657}}, "time_this_iter_s": 26.167187929153442, "timesteps_since_restore": 8561895, "time_since_restore": 5116.577890872955, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 45724, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875c18>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668758d0>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-23-16", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 53.697375660219116}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1639.3783476967913, "node_ip": "10.138.0.2", "timesteps_total": 8607537, "iterations_since_restore": 197, "episode_reward_mean": 1312.3331540663366, "custom_metrics": {"cost1_max": 519.5880147414215, "cost1_mean": 379.87791948530224, "system_level_velocity_mean": 15.153706869655839, "outflow_rate_max": 1433.6356832128638, "cost1_min": 29.498086560930986, "system_level_velocity_max": 20.08104214028626, "system_level_velocity_min": 11.774504948055048, "outflow_rate_min": 329.6337234057179, "cost2_max": -16.100661422656998, "cost2_mean": -112.94271492827893, "outflow_rate_mean": 1146.5381592522838, "cost2_min": -147.43793898017793}, "training_iteration": 197, "episodes_total": 3020, "episode_len_mean": 679.91, "timestamp": 1557210223, "time_total_s": 5143.21194434166, "pid": 32008, "info": {"num_steps_trained": 8607537, "num_steps_sampled": 8607537, "load_time_ms": 15.471, "grad_time_ms": 9140.595, "sample_time_ms": 16545.922, "update_time_ms": 7.319, "default": {"vf_explained_var": 0.9762659072875977, "vf_loss": 7.641027450561523, "entropy": 1.4551481008529663, "cur_lr": 0.0005000000237487257, "total_loss": 7.6367692947387695, "kl": 0.014882620424032211, "policy_loss": -0.008025250397622585, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 26.634053468704224, "timesteps_since_restore": 8607537, "time_since_restore": 5143.21194434166, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 45642, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875550>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875438>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-23-43", "hostname": "flow-main", "episodes_this_iter": 10, "episode_reward_min": 58.63909231682682}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1557.463339474452, "node_ip": "10.138.0.2", "timesteps_total": 8651706, "iterations_since_restore": 198, "episode_reward_mean": 1289.760441544464, "custom_metrics": {"cost1_max": 519.5880147414215, "cost1_mean": 373.19579766952387, "system_level_velocity_mean": 15.166547177264642, "outflow_rate_max": 1433.6356832128638, "cost1_min": 29.498086560930986, "system_level_velocity_max": 20.418323136371136, "system_level_velocity_min": 11.774504948055048, "outflow_rate_min": 329.6337234057179, "cost2_max": -16.100661422656998, "cost2_mean": -113.0084591045073, "outflow_rate_mean": 1131.5244711631776, "cost2_min": -147.43793898017793}, "training_iteration": 198, "episodes_total": 3038, "episode_len_mean": 671.04, "timestamp": 1557210248, "time_total_s": 5168.6673102378845, "pid": 32008, "info": {"num_steps_trained": 8651706, "num_steps_sampled": 8651706, "load_time_ms": 15.154, "grad_time_ms": 9192.011, "sample_time_ms": 16480.37, "update_time_ms": 7.289, "default": {"vf_explained_var": 0.9626162052154541, "vf_loss": 14.615912437438965, "entropy": 1.4530609846115112, "cur_lr": 0.0005000000237487257, "total_loss": 14.611451148986816, "kl": 0.01562904752790928, "policy_loss": -0.00841616652905941, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 25.455365896224976, "timesteps_since_restore": 8651706, "time_since_restore": 5168.6673102378845, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 44169, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfb38>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfe48>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-24-08", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 58.63909231682682}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1620.951875785406, "node_ip": "10.138.0.2", "timesteps_total": 8694164, "iterations_since_restore": 199, "episode_reward_mean": 1285.3384387247868, "custom_metrics": {"cost1_max": 530.8488383445688, "cost1_mean": 371.8006138297329, "system_level_velocity_mean": 15.15598491821929, "outflow_rate_max": 1459.2824692114134, "cost1_min": 29.498086560930986, "system_level_velocity_max": 20.418323136371136, "system_level_velocity_min": 11.774504948055048, "outflow_rate_min": 329.6337234057179, "cost2_max": -16.100661422656998, "cost2_mean": -113.37984463575731, "outflow_rate_mean": 1127.3023098094488, "cost2_min": -147.43793898017793}, "training_iteration": 199, "episodes_total": 3056, "episode_len_mean": 670.39, "timestamp": 1557210273, "time_total_s": 5193.421336174011, "pid": 32008, "info": {"num_steps_trained": 8694164, "num_steps_sampled": 8694164, "load_time_ms": 15.227, "grad_time_ms": 9206.36, "sample_time_ms": 16272.413, "update_time_ms": 7.108, "default": {"vf_explained_var": 0.9587835669517517, "vf_loss": 16.4560604095459, "entropy": 1.4555656909942627, "cur_lr": 0.0005000000237487257, "total_loss": 16.453176498413086, "kl": 0.014928975142538548, "policy_loss": -0.006660769693553448, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 24.75402593612671, "timesteps_since_restore": 8694164, "time_since_restore": 5193.421336174011, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 42458, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668755f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668751d0>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875e48>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-24-33", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 58.63909231682682}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": true, "episode_reward_max": 1620.951875785406, "node_ip": "10.138.0.2", "timesteps_total": 8737687, "iterations_since_restore": 200, "episode_reward_mean": 1288.6774692645351, "custom_metrics": {"cost1_max": 530.8488383445688, "cost1_mean": 372.8173271348792, "system_level_velocity_mean": 15.0637203258491, "outflow_rate_max": 1459.2824692114134, "cost1_min": 29.498086560930986, "system_level_velocity_max": 20.418323136371136, "system_level_velocity_min": 11.774504948055048, "outflow_rate_min": 329.6337234057179, "cost2_max": -16.100661422656998, "cost2_mean": -115.94029927734879, "outflow_rate_mean": 1133.799964560885, "cost2_min": -148.2632236228305}, "training_iteration": 200, "episodes_total": 3072, "episode_len_mean": 675.45, "timestamp": 1557210299, "time_total_s": 5218.8999791145325, "pid": 32008, "info": {"num_steps_trained": 8737687, "num_steps_sampled": 8737687, "load_time_ms": 15.062, "grad_time_ms": 9269.824, "sample_time_ms": 16231.675, "update_time_ms": 6.861, "default": {"vf_explained_var": 0.9699017405509949, "vf_loss": 11.138421058654785, "entropy": 1.467254877090454, "cur_lr": 0.0005000000237487257, "total_loss": 11.133831024169922, "kl": 0.014704418368637562, "policy_loss": -0.008313392288982868, "cur_kl_coeff": 0.2531249523162842}}, "time_this_iter_s": 25.47864294052124, "timesteps_since_restore": 8737687, "time_since_restore": 5218.8999791145325, "experiment_id": "4b2095ee856c4f9ab1658fd8dbf26e40", "timesteps_this_iter": 43523, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875e10>", "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875b00>"}, "vf_loss_coeff": 1.0, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "lstm_cell_size": 256, "conv_filters": null, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "squash_to_range": false, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "use_lstm": false, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "zero_mean": true, "custom_options": {}, "channel_major": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:5.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_rewards": null, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_param": 0.3, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-24-59", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 58.63909231682682}

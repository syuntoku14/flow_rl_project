{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 61.551357780082476, "node_ip": "10.138.0.2", "timesteps_total": 53095, "iterations_since_restore": 1, "custom_metrics": {"cost1_max": 34.20078525532584, "cost1_min": 34.20078525532584, "system_level_velocity_mean": 18.806187641374404, "outflow_rate_max": 319.92940939152567, "cost1_mean": 34.20078525532584, "outflow_rate_min": 319.92940939152567, "system_level_velocity_max": 18.806187641374404, "system_level_velocity_min": 18.806187641374404, "cost2_max": -18.758004258604906, "cost2_mean": -18.758004258604906, "outflow_rate_mean": 319.92940939152567, "cost2_min": -18.758004258604906}, "training_iteration": 1, "episodes_total": 1, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205128, "time_total_s": 54.60124373435974, "episode_len_mean": 50.0, "pid": 32002, "time_since_restore": 54.60124373435974, "time_this_iter_s": 54.60124373435974, "timesteps_since_restore": 53095, "info": {"num_steps_trained": 53095, "load_time_ms": 75.269, "num_steps_sampled": 53095, "grad_time_ms": 11711.8, "sample_time_ms": 41605.118, "update_time_ms": 1051.637, "default": {"vf_explained_var": 0.9110041260719299, "vf_loss": 1.9794268608093262, "entropy": 1.420882225036621, "cur_lr": 0.0005000000237487257, "total_loss": 1.9793084859848022, "kl": 0.00023068062728270888, "policy_loss": -0.00016441091429442167, "cur_kl_coeff": 0.20000004768371582}}, "episode_reward_mean": 61.551357780082476, "timesteps_this_iter": 53095, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66b13e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66b13eb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66b13e48>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_04-58-48", "hostname": "flow-main", "episodes_this_iter": 1, "episode_reward_min": 61.551357780082476}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 882.8917194495737, "node_ip": "10.138.0.2", "timesteps_total": 98023, "iterations_since_restore": 2, "custom_metrics": {"cost1_max": 280.91505358703023, "cost1_min": 34.20078525532584, "system_level_velocity_mean": 9.494462640298446, "outflow_rate_max": 722.4289768420259, "cost1_mean": 228.3528474952772, "outflow_rate_min": 202.5712823348694, "system_level_velocity_max": 18.806187641374404, "system_level_velocity_min": 7.023356142955065, "cost2_max": -18.758004258604906, "cost2_mean": -72.57413706012224, "outflow_rate_mean": 533.0427188079766, "cost2_min": -105.59014255760819}, "training_iteration": 2, "episodes_total": 21, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205155, "time_total_s": 81.79289698600769, "episode_len_mean": 669.047619047619, "pid": 32002, "time_since_restore": 81.79289698600769, "time_this_iter_s": 27.19165325164795, "timesteps_since_restore": 98023, "info": {"num_steps_trained": 98023, "load_time_ms": 50.277, "num_steps_sampled": 98023, "grad_time_ms": 10709.074, "sample_time_ms": 29480.313, "update_time_ms": 530.975, "default": {"vf_explained_var": 0.9766515493392944, "vf_loss": 1.3807317018508911, "entropy": 1.4434800148010254, "cur_lr": 0.0005000000237487257, "total_loss": 1.3800565004348755, "kl": 0.004115238320082426, "policy_loss": -0.0010868851095438004, "cur_kl_coeff": 0.10000001639127731}}, "episode_reward_mean": 634.2033010642926, "timesteps_this_iter": 44928, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7f28>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7eb8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_04-59-15", "hostname": "flow-main", "episodes_this_iter": 20, "episode_reward_min": 61.551357780082476}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 885.5246646147914, "node_ip": "10.138.0.2", "timesteps_total": 149919, "iterations_since_restore": 3, "custom_metrics": {"cost1_max": 343.42778256207293, "cost1_min": 34.20078525532584, "system_level_velocity_mean": 9.349516352972648, "outflow_rate_max": 900.4889270846113, "cost1_mean": 232.32600616835708, "outflow_rate_min": 202.5712823348694, "system_level_velocity_max": 18.806187641374404, "system_level_velocity_min": 7.023356142955065, "cost2_max": -18.758004258604906, "cost2_mean": -74.09325886899018, "outflow_rate_mean": 537.158614434147, "cost2_min": -105.59014255760819}, "training_iteration": 3, "episodes_total": 35, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205186, "time_total_s": 112.52451801300049, "episode_len_mean": 681.4285714285714, "pid": 32002, "time_since_restore": 112.52451801300049, "time_this_iter_s": 30.731621026992798, "timesteps_since_restore": 149919, "info": {"num_steps_trained": 149919, "load_time_ms": 38.411, "num_steps_sampled": 149919, "grad_time_ms": 11093.922, "sample_time_ms": 25895.842, "update_time_ms": 357.341, "default": {"vf_explained_var": 0.9802894592285156, "vf_loss": 0.9834121465682983, "entropy": 1.4266510009765625, "cur_lr": 0.0005000000237487257, "total_loss": 0.9817633032798767, "kl": 0.007890715263783932, "policy_loss": -0.002043413696810603, "cur_kl_coeff": 0.05000000819563866}}, "episode_reward_mean": 649.7460391206894, "timesteps_this_iter": 51896, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689ea58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e9b0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_04-59-46", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 61.551357780082476}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 959.054692344164, "node_ip": "10.138.0.2", "timesteps_total": 197337, "iterations_since_restore": 4, "custom_metrics": {"cost1_max": 343.42778256207293, "cost1_min": 34.20078525532584, "system_level_velocity_mean": 9.622526143903283, "outflow_rate_max": 1001.6060828807557, "cost1_mean": 232.898207165792, "outflow_rate_min": 202.5712823348694, "system_level_velocity_max": 20.159073369052994, "system_level_velocity_min": 6.682913680378831, "cost2_max": -18.758004258604906, "cost2_mean": -73.58508339629883, "outflow_rate_mean": 548.994692702904, "cost2_min": -105.59014255760819}, "training_iteration": 4, "episodes_total": 44, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205214, "time_total_s": 140.54214930534363, "episode_len_mean": 672.7727272727273, "pid": 32002, "time_since_restore": 140.54214930534363, "time_this_iter_s": 28.01763129234314, "timesteps_since_restore": 197337, "info": {"num_steps_trained": 197337, "load_time_ms": 32.062, "num_steps_sampled": 197337, "grad_time_ms": 11475.615, "sample_time_ms": 23238.694, "update_time_ms": 270.451, "default": {"vf_explained_var": 0.9839159250259399, "vf_loss": 2.4561426639556885, "entropy": 1.4027823209762573, "cur_lr": 0.0005000000237487257, "total_loss": 2.4554598331451416, "kl": 0.0037002512253820896, "policy_loss": -0.0008675227290950716, "cur_kl_coeff": 0.05000000447034836}}, "episode_reward_mean": 657.4547603201967, "timesteps_this_iter": 47418, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e6d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e630>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e6a0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-00-14", "hostname": "flow-main", "episodes_this_iter": 9, "episode_reward_min": 61.551357780082476}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1318.7111395621946, "node_ip": "10.138.0.2", "timesteps_total": 245489, "iterations_since_restore": 5, "custom_metrics": {"cost1_max": 437.4533776996985, "cost1_min": 34.20078525532584, "system_level_velocity_mean": 10.694830823881384, "outflow_rate_max": 1244.1183306112007, "cost1_mean": 257.5241977132584, "outflow_rate_min": 202.5712823348694, "system_level_velocity_max": 20.159073369052994, "system_level_velocity_min": 6.682913680378831, "cost2_max": -18.758004258604906, "cost2_mean": -82.37014691739539, "outflow_rate_mean": 625.8959212218622, "cost2_min": -131.45829718216913}, "training_iteration": 5, "episodes_total": 60, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205245, "time_total_s": 171.2539746761322, "episode_len_mean": 670.2166666666667, "pid": 32002, "time_since_restore": 171.2539746761322, "time_this_iter_s": 30.711825370788574, "timesteps_since_restore": 245489, "info": {"num_steps_trained": 245489, "load_time_ms": 28.812, "num_steps_sampled": 245489, "grad_time_ms": 11436.345, "sample_time_ms": 22454.153, "update_time_ms": 218.338, "default": {"vf_explained_var": 0.9896569848060608, "vf_loss": 1.8185456991195679, "entropy": 1.4001127481460571, "cur_lr": 0.0005000000237487257, "total_loss": 1.8169711828231812, "kl": 0.006356330588459969, "policy_loss": -0.0017335343873128295, "cur_kl_coeff": 0.02500000409781933}}, "episode_reward_mean": 720.3898375906293, "timesteps_this_iter": 48152, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa7b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa048>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-00-45", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 61.551357780082476}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1318.7111395621946, "node_ip": "10.138.0.2", "timesteps_total": 298622, "iterations_since_restore": 6, "custom_metrics": {"cost1_max": 503.1821140852735, "cost1_min": 34.20078525532584, "system_level_velocity_mean": 11.06493998231388, "outflow_rate_max": 1356.8572302703535, "cost1_mean": 270.6851395456813, "outflow_rate_min": 202.5712823348694, "system_level_velocity_max": 20.159073369052994, "system_level_velocity_min": 6.682913680378831, "cost2_max": -18.758004258604906, "cost2_mean": -87.71668967473238, "outflow_rate_mean": 646.1567427245577, "cost2_min": -131.45829718216913}, "training_iteration": 6, "episodes_total": 76, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205276, "time_total_s": 202.28082466125488, "episode_len_mean": 676.4868421052631, "pid": 32002, "time_since_restore": 202.28082466125488, "time_this_iter_s": 31.02684998512268, "timesteps_since_restore": 298622, "info": {"num_steps_trained": 298622, "load_time_ms": 26.757, "num_steps_sampled": 298622, "grad_time_ms": 11490.144, "sample_time_ms": 21903.224, "update_time_ms": 183.16, "default": {"vf_explained_var": 0.9920031428337097, "vf_loss": 1.3089762926101685, "entropy": 1.4337244033813477, "cur_lr": 0.0005000000237487257, "total_loss": 1.306403398513794, "kl": 0.014733930118381977, "policy_loss": -0.0029412356670945883, "cur_kl_coeff": 0.02500000409781933}}, "episode_reward_mean": 755.2842713547282, "timesteps_this_iter": 53133, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7a58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7eb8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-01-16", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 61.551357780082476}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1318.7111395621946, "node_ip": "10.138.0.2", "timesteps_total": 354033, "iterations_since_restore": 7, "custom_metrics": {"cost1_max": 503.1821140852735, "cost1_min": 34.20078525532584, "system_level_velocity_mean": 11.227059708145001, "outflow_rate_max": 1356.8572302703535, "cost1_mean": 276.45540371280526, "outflow_rate_min": 202.5712823348694, "system_level_velocity_max": 20.159073369052994, "system_level_velocity_min": 6.682913680378831, "cost2_max": -18.758004258604906, "cost2_mean": -89.6832878366925, "outflow_rate_mean": 661.6669018187636, "cost2_min": -131.45829718216913}, "training_iteration": 7, "episodes_total": 85, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205305, "time_total_s": 231.52470111846924, "episode_len_mean": 678.9764705882353, "pid": 32002, "time_since_restore": 231.52470111846924, "time_this_iter_s": 29.243876457214355, "timesteps_since_restore": 354033, "info": {"num_steps_trained": 354033, "load_time_ms": 25.511, "num_steps_sampled": 354033, "grad_time_ms": 11546.708, "sample_time_ms": 21236.309, "update_time_ms": 157.942, "default": {"vf_explained_var": 0.9936867952346802, "vf_loss": 1.0108263492584229, "entropy": 1.4397650957107544, "cur_lr": 0.0005000000237487257, "total_loss": 1.0085989236831665, "kl": 0.00890561193227768, "policy_loss": -0.002450266620144248, "cur_kl_coeff": 0.02500000223517418}}, "episode_reward_mean": 774.8878457163531, "timesteps_this_iter": 55411, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689ec88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689edd8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-01-45", "hostname": "flow-main", "episodes_this_iter": 9, "episode_reward_min": 61.551357780082476}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1318.7111395621946, "node_ip": "10.138.0.2", "timesteps_total": 405678, "iterations_since_restore": 8, "custom_metrics": {"cost1_max": 503.1821140852735, "cost1_min": 34.20078525532584, "system_level_velocity_mean": 11.075012015279524, "outflow_rate_max": 1356.8572302703535, "cost1_mean": 274.3119011564435, "outflow_rate_min": 202.5712823348694, "system_level_velocity_max": 20.159073369052994, "system_level_velocity_min": 6.682913680378831, "cost2_max": -18.758004258604906, "cost2_mean": -91.59170482681412, "outflow_rate_mean": 653.9811898717857, "cost2_min": -131.45829718216913}, "training_iteration": 8, "episodes_total": 98, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205335, "time_total_s": 261.6207547187805, "episode_len_mean": 681.765306122449, "pid": 32002, "time_since_restore": 261.6207547187805, "time_this_iter_s": 30.09605360031128, "timesteps_since_restore": 405678, "info": {"num_steps_trained": 405678, "load_time_ms": 24.471, "num_steps_sampled": 405678, "grad_time_ms": 11513.541, "sample_time_ms": 20918.668, "update_time_ms": 139.056, "default": {"vf_explained_var": 0.9962695837020874, "vf_loss": 0.6227788925170898, "entropy": 1.4497333765029907, "cur_lr": 0.0005000000237487257, "total_loss": 0.6205583810806274, "kl": 0.007644119206815958, "policy_loss": -0.0024116230197250843, "cur_kl_coeff": 0.02500000409781933}}, "episode_reward_mean": 777.8852428951957, "timesteps_this_iter": 51645, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7ac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7588>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-02-15", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 61.551357780082476}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1318.7111395621946, "node_ip": "10.138.0.2", "timesteps_total": 458839, "iterations_since_restore": 9, "custom_metrics": {"cost1_max": 503.1821140852735, "cost1_min": 78.85936409502746, "system_level_velocity_mean": 10.91774973188608, "outflow_rate_max": 1356.8572302703535, "cost1_mean": 274.8799139944022, "outflow_rate_min": 213.34074002361268, "system_level_velocity_max": 20.159073369052994, "system_level_velocity_min": 6.682913680378831, "cost2_max": -35.94347358180701, "cost2_mean": -94.93164901622214, "outflow_rate_mean": 656.9472590434485, "cost2_min": -131.45829718216913}, "training_iteration": 9, "episodes_total": 113, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205367, "time_total_s": 293.186660528183, "episode_len_mean": 688.63, "pid": 32002, "time_since_restore": 293.186660528183, "time_this_iter_s": 31.565905809402466, "timesteps_since_restore": 458839, "info": {"num_steps_trained": 458839, "load_time_ms": 23.397, "num_steps_sampled": 458839, "grad_time_ms": 11589.138, "sample_time_ms": 20733.96, "update_time_ms": 124.523, "default": {"vf_explained_var": 0.9923753142356873, "vf_loss": 0.9050436615943909, "entropy": 1.4716691970825195, "cur_lr": 0.0005000000237487257, "total_loss": 0.9039489030838013, "kl": 0.01143286470323801, "policy_loss": -0.0013806363567709923, "cur_kl_coeff": 0.02500000409781933}}, "episode_reward_mean": 797.7176362192314, "timesteps_this_iter": 53161, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e630>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-02-47", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 160.48692674442648}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1318.7111395621946, "node_ip": "10.138.0.2", "timesteps_total": 507286, "iterations_since_restore": 10, "custom_metrics": {"cost1_max": 503.1821140852735, "cost1_min": 78.85936409502746, "system_level_velocity_mean": 10.916485770070029, "outflow_rate_max": 1356.8572302703535, "cost1_mean": 274.7072480036041, "outflow_rate_min": 213.34074002361268, "system_level_velocity_max": 20.159073369052994, "system_level_velocity_min": 6.682913680378831, "cost2_max": -35.94347358180701, "cost2_mean": -97.07200009167866, "outflow_rate_mean": 665.6060473938774, "cost2_min": -131.45829718216913}, "training_iteration": 10, "episodes_total": 123, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205394, "time_total_s": 320.6888201236725, "episode_len_mean": 688.63, "pid": 32002, "time_since_restore": 320.6888201236725, "time_this_iter_s": 27.502159595489502, "timesteps_since_restore": 507286, "info": {"num_steps_trained": 507286, "load_time_ms": 22.413, "num_steps_sampled": 507286, "grad_time_ms": 11515.848, "sample_time_ms": 20313.617, "update_time_ms": 113.048, "default": {"vf_explained_var": 0.9917541146278381, "vf_loss": 1.3343935012817383, "entropy": 1.3930585384368896, "cur_lr": 0.0005000000237487257, "total_loss": 1.3323360681533813, "kl": 0.008983430452644825, "policy_loss": -0.0022819964215159416, "cur_kl_coeff": 0.02500000223517418}}, "episode_reward_mean": 809.8883836575134, "timesteps_this_iter": 48447, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa4e0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa940>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-03-14", "hostname": "flow-main", "episodes_this_iter": 10, "episode_reward_min": 160.48692674442648}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1318.7111395621946, "node_ip": "10.138.0.2", "timesteps_total": 554390, "iterations_since_restore": 11, "custom_metrics": {"cost1_max": 503.1821140852735, "cost1_min": 30.807201130961058, "system_level_velocity_mean": 11.078251579578021, "outflow_rate_max": 1356.8572302703535, "cost1_mean": 274.8765403935649, "outflow_rate_min": 213.34074002361268, "system_level_velocity_max": 20.159073369052994, "system_level_velocity_min": 6.682913680378831, "cost2_max": -15.380175716101403, "cost2_mean": -97.66471666932267, "outflow_rate_mean": 693.3948949308339, "cost2_min": -131.45829718216913}, "training_iteration": 11, "episodes_total": 136, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205423, "time_total_s": 349.12859654426575, "episode_len_mean": 682.09, "pid": 32002, "time_since_restore": 349.12859654426575, "time_this_iter_s": 28.43977642059326, "timesteps_since_restore": 554390, "info": {"num_steps_trained": 554390, "load_time_ms": 16.355, "num_steps_sampled": 554390, "grad_time_ms": 11426.24, "sample_time_ms": 17904.111, "update_time_ms": 8.683, "default": {"vf_explained_var": 0.981705367565155, "vf_loss": 3.0423033237457275, "entropy": 1.4020435810089111, "cur_lr": 0.0005000000237487257, "total_loss": 3.0383055210113525, "kl": 0.01602865383028984, "policy_loss": -0.004398380406200886, "cur_kl_coeff": 0.02500000223517418}}, "episode_reward_mean": 825.2744855407391, "timesteps_this_iter": 47104, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66b139b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66af9ef0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e358>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-03-43", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 55.54074308283089}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1318.7111395621946, "node_ip": "10.138.0.2", "timesteps_total": 603541, "iterations_since_restore": 12, "custom_metrics": {"cost1_max": 503.1821140852735, "cost1_min": 30.807201130961058, "system_level_velocity_mean": 10.895877836021832, "outflow_rate_max": 1356.8572302703535, "cost1_mean": 279.22305839716523, "outflow_rate_min": 213.34074002361268, "system_level_velocity_max": 18.959955138224036, "system_level_velocity_min": 6.943922451779976, "cost2_max": -15.380175716101403, "cost2_mean": -101.15759128839278, "outflow_rate_mean": 728.4375169100682, "cost2_min": -131.45829718216913}, "training_iteration": 12, "episodes_total": 151, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205453, "time_total_s": 380.02443766593933, "episode_len_mean": 693.46, "pid": 32002, "time_since_restore": 380.02443766593933, "time_this_iter_s": 30.895841121673584, "timesteps_since_restore": 603541, "info": {"num_steps_trained": 603541, "load_time_ms": 15.527, "num_steps_sampled": 603541, "grad_time_ms": 11664.159, "sample_time_ms": 18038.053, "update_time_ms": 8.393, "default": {"vf_explained_var": 0.9849753379821777, "vf_loss": 2.452336072921753, "entropy": 1.3695874214172363, "cur_lr": 0.0005000000237487257, "total_loss": 2.451089382171631, "kl": 0.009422722272574902, "policy_loss": -0.0014823040692135692, "cur_kl_coeff": 0.02500000409781933}}, "episode_reward_mean": 856.9072036935609, "timesteps_this_iter": 49151, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b47b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4fd0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-04-13", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 55.54074308283089}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1313.770735538126, "node_ip": "10.138.0.2", "timesteps_total": 653365, "iterations_since_restore": 13, "custom_metrics": {"cost1_max": 503.1821140852735, "cost1_min": 30.807201130961058, "system_level_velocity_mean": 10.643190718080131, "outflow_rate_max": 1356.8572302703535, "cost1_mean": 272.9962100653885, "outflow_rate_min": 213.34074002361268, "system_level_velocity_max": 18.959955138224036, "system_level_velocity_min": 6.943922451779976, "cost2_max": -15.380175716101403, "cost2_mean": -100.98150335357988, "outflow_rate_mean": 735.944938757673, "cost2_min": -126.7989880122491}, "training_iteration": 13, "episodes_total": 163, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205482, "time_total_s": 408.5901868343353, "episode_len_mean": 693.46, "pid": 32002, "time_since_restore": 408.5901868343353, "time_this_iter_s": 28.565749168395996, "timesteps_since_restore": 653365, "info": {"num_steps_trained": 653365, "load_time_ms": 15.54, "num_steps_sampled": 653365, "grad_time_ms": 11595.381, "sample_time_ms": 17891.869, "update_time_ms": 8.204, "default": {"vf_explained_var": 0.9848225116729736, "vf_loss": 2.522207498550415, "entropy": 1.390744924545288, "cur_lr": 0.0005000000237487257, "total_loss": 2.520705223083496, "kl": 0.011514577083289623, "policy_loss": -0.0017901795217767358, "cur_kl_coeff": 0.025000005960464478}}, "episode_reward_mean": 858.9020568506636, "timesteps_this_iter": 49824, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689ee10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e9b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e5c0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-04-42", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 55.54074308283089}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1195.7079809093525, "node_ip": "10.138.0.2", "timesteps_total": 700833, "iterations_since_restore": 14, "custom_metrics": {"cost1_max": 440.8529645201771, "cost1_min": 30.807201130961058, "system_level_velocity_mean": 10.485005048961016, "outflow_rate_max": 1155.2927036672372, "cost1_mean": 270.05911484574267, "outflow_rate_min": 234.85380116618074, "system_level_velocity_max": 18.899308235045226, "system_level_velocity_min": 6.943922451779976, "cost2_max": -15.380175716101403, "cost2_mean": -101.40069358506794, "outflow_rate_mean": 763.6374378761883, "cost2_min": -126.7989880122491}, "training_iteration": 14, "episodes_total": 176, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205509, "time_total_s": 435.5188105106354, "episode_len_mean": 693.46, "pid": 32002, "time_since_restore": 435.5188105106354, "time_this_iter_s": 26.92862367630005, "timesteps_since_restore": 700833, "info": {"num_steps_trained": 700833, "load_time_ms": 16.974, "num_steps_sampled": 700833, "grad_time_ms": 11399.06, "sample_time_ms": 17979.514, "update_time_ms": 7.891, "default": {"vf_explained_var": 0.9800821542739868, "vf_loss": 3.390087604522705, "entropy": 1.3624738454818726, "cur_lr": 0.0005000000237487257, "total_loss": 3.3890881538391113, "kl": 0.009550826624035835, "policy_loss": -0.0012380952248349786, "cur_kl_coeff": 0.02500000223517418}}, "episode_reward_mean": 878.2821747933688, "timesteps_this_iter": 47468, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689eda0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e518>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-05-09", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 55.54074308283089}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1276.5126497949107, "node_ip": "10.138.0.2", "timesteps_total": 748844, "iterations_since_restore": 15, "custom_metrics": {"cost1_max": 344.3468122572773, "cost1_min": 30.807201130961058, "system_level_velocity_mean": 10.520336213180721, "outflow_rate_max": 1096.1584497502497, "cost1_mean": 272.83652716299423, "outflow_rate_min": 234.85380116618074, "system_level_velocity_max": 18.899308235045226, "system_level_velocity_min": 6.943922451779976, "cost2_max": -15.380175716101403, "cost2_mean": -103.17064351675506, "outflow_rate_mean": 805.711877688907, "cost2_min": -132.9131501203837}, "training_iteration": 15, "episodes_total": 191, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205537, "time_total_s": 463.3450083732605, "episode_len_mean": 693.46, "pid": 32002, "time_since_restore": 463.3450083732605, "time_this_iter_s": 27.826197862625122, "timesteps_since_restore": 748844, "info": {"num_steps_trained": 748844, "load_time_ms": 16.69, "num_steps_sampled": 748844, "grad_time_ms": 11356.807, "sample_time_ms": 17734.28, "update_time_ms": 7.677, "default": {"vf_explained_var": 0.981516420841217, "vf_loss": 3.4417178630828857, "entropy": 1.3450628519058228, "cur_lr": 0.0005000000237487257, "total_loss": 3.4398868083953857, "kl": 0.015144668519496918, "policy_loss": -0.002209578873589635, "cur_kl_coeff": 0.025000005960464478}}, "episode_reward_mean": 914.0678109198592, "timesteps_this_iter": 48011, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b47f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4908>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4f28>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-05-37", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 55.54074308283089}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1317.2115470296994, "node_ip": "10.138.0.2", "timesteps_total": 795492, "iterations_since_restore": 16, "custom_metrics": {"cost1_max": 364.27925859369344, "cost1_min": 30.807201130961058, "system_level_velocity_mean": 10.809227857911502, "outflow_rate_max": 1166.5786158368398, "cost1_mean": 281.3118853792989, "outflow_rate_min": 234.85380116618074, "system_level_velocity_max": 18.899308235045226, "system_level_velocity_min": 6.943922451779976, "cost2_max": -15.380175716101403, "cost2_mean": -103.1461344296031, "outflow_rate_mean": 852.9075500784217, "cost2_min": -132.9131501203837}, "training_iteration": 16, "episodes_total": 203, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205563, "time_total_s": 489.8713495731354, "episode_len_mean": 693.46, "pid": 32002, "time_since_restore": 489.8713495731354, "time_this_iter_s": 26.526341199874878, "timesteps_since_restore": 795492, "info": {"num_steps_trained": 795492, "load_time_ms": 16.433, "num_steps_sampled": 795492, "grad_time_ms": 11242.916, "sample_time_ms": 17399.38, "update_time_ms": 7.788, "default": {"vf_explained_var": 0.9851861596107483, "vf_loss": 3.2090158462524414, "entropy": 1.340486764907837, "cur_lr": 0.0005000000237487257, "total_loss": 3.2076144218444824, "kl": 0.00970508437603712, "policy_loss": -0.0016442687483504415, "cur_kl_coeff": 0.02500000409781933}}, "episode_reward_mean": 945.4429684455276, "timesteps_this_iter": 46648, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b48d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4c50>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a72e8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-06-03", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 55.54074308283089}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1320.1682377822897, "node_ip": "10.138.0.2", "timesteps_total": 841156, "iterations_since_restore": 17, "custom_metrics": {"cost1_max": 364.27925859369344, "cost1_min": 30.807201130961058, "system_level_velocity_mean": 11.532762585312458, "outflow_rate_max": 1174.5294788667516, "cost1_mean": 296.51361729614496, "outflow_rate_min": 325.2093327816105, "system_level_velocity_max": 19.37699019420383, "system_level_velocity_min": 8.754910510371332, "cost2_max": -15.380175716101403, "cost2_mean": -105.12308789406875, "outflow_rate_mean": 922.6617208608108, "cost2_min": -134.7192463556514}, "training_iteration": 17, "episodes_total": 219, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205591, "time_total_s": 517.5692827701569, "episode_len_mean": 686.96, "pid": 32002, "time_since_restore": 517.5692827701569, "time_this_iter_s": 27.697933197021484, "timesteps_since_restore": 841156, "info": {"num_steps_trained": 841156, "load_time_ms": 16.017, "num_steps_sampled": 841156, "grad_time_ms": 11075.336, "sample_time_ms": 17412.874, "update_time_ms": 7.854, "default": {"vf_explained_var": 0.9819148778915405, "vf_loss": 4.305236339569092, "entropy": 1.350739598274231, "cur_lr": 0.0005000000237487257, "total_loss": 4.302090167999268, "kl": 0.01092307548969984, "policy_loss": -0.0034194777254015207, "cur_kl_coeff": 0.02500000409781933}}, "episode_reward_mean": 996.9101722286049, "timesteps_this_iter": 45664, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b47f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4748>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4908>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-06-31", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 55.54074308283089}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1320.1682377822897, "node_ip": "10.138.0.2", "timesteps_total": 885569, "iterations_since_restore": 18, "custom_metrics": {"cost1_max": 373.81781740475503, "cost1_min": 34.32101113666267, "system_level_velocity_mean": 11.947742790218392, "outflow_rate_max": 1209.9220183407751, "cost1_mean": 312.750152839696, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.37699019420383, "system_level_velocity_min": 9.432370986438933, "cost2_max": -17.649099518963638, "cost2_mean": -108.67891412108376, "outflow_rate_mean": 974.0863353688417, "cost2_min": -134.7192463556514}, "training_iteration": 18, "episodes_total": 235, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205618, "time_total_s": 543.9870624542236, "episode_len_mean": 693.5, "pid": 32002, "time_since_restore": 543.9870624542236, "time_this_iter_s": 26.417779684066772, "timesteps_since_restore": 885569, "info": {"num_steps_trained": 885569, "load_time_ms": 15.996, "num_steps_sampled": 885569, "grad_time_ms": 10907.867, "sample_time_ms": 17214.073, "update_time_ms": 7.862, "default": {"vf_explained_var": 0.9795957207679749, "vf_loss": 4.340058326721191, "entropy": 1.3268139362335205, "cur_lr": 0.0005000000237487257, "total_loss": 4.336938858032227, "kl": 0.010733657516539097, "policy_loss": -0.003387835342437029, "cur_kl_coeff": 0.02500000409781933}}, "episode_reward_mean": 1055.0529249655985, "timesteps_this_iter": 44413, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b49b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b45f8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4438>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-06-58", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 61.99236603690447}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1320.1682377822897, "node_ip": "10.138.0.2", "timesteps_total": 931460, "iterations_since_restore": 19, "custom_metrics": {"cost1_max": 373.81781740475503, "cost1_min": 33.980655913559815, "system_level_velocity_mean": 12.277603661991632, "outflow_rate_max": 1209.9220183407751, "cost1_mean": 317.69804122158445, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.37699019420383, "system_level_velocity_min": 9.977449840359702, "cost2_max": -13.326628650956179, "cost2_mean": -106.92882893718914, "outflow_rate_mean": 993.7297206057052, "cost2_min": -134.7192463556514}, "training_iteration": 19, "episodes_total": 248, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205646, "time_total_s": 572.1449801921844, "episode_len_mean": 687.0, "pid": 32002, "time_since_restore": 572.1449801921844, "time_this_iter_s": 28.157917737960815, "timesteps_since_restore": 931460, "info": {"num_steps_trained": 931460, "load_time_ms": 15.883, "num_steps_sampled": 931460, "grad_time_ms": 10799.671, "sample_time_ms": 16982.315, "update_time_ms": 7.7, "default": {"vf_explained_var": 0.9522849321365356, "vf_loss": 7.054281234741211, "entropy": 1.2852929830551147, "cur_lr": 0.0005000000237487257, "total_loss": 7.052157402038574, "kl": 0.011205833405256271, "policy_loss": -0.0024046828038990498, "cur_kl_coeff": 0.02500000409781933}}, "episode_reward_mean": 1077.2892296193481, "timesteps_this_iter": 45891, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aada0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa5f8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-07-26", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 61.99236603690447}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1320.1682377822897, "node_ip": "10.138.0.2", "timesteps_total": 975914, "iterations_since_restore": 20, "custom_metrics": {"cost1_max": 373.81781740475503, "cost1_min": 33.980655913559815, "system_level_velocity_mean": 12.489515905969473, "outflow_rate_max": 1209.9220183407751, "cost1_mean": 324.31911728070344, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.37699019420383, "system_level_velocity_min": 9.977449840359702, "cost2_max": -13.326628650956179, "cost2_mean": -103.2068020541371, "outflow_rate_mean": 1010.3466018851036, "cost2_min": -134.7192463556514}, "training_iteration": 20, "episodes_total": 261, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205673, "time_total_s": 598.9422292709351, "episode_len_mean": 687.0, "pid": 32002, "time_since_restore": 598.9422292709351, "time_this_iter_s": 26.79724907875061, "timesteps_since_restore": 975914, "info": {"num_steps_trained": 975914, "load_time_ms": 16.274, "num_steps_sampled": 975914, "grad_time_ms": 10672.087, "sample_time_ms": 17039.937, "update_time_ms": 7.519, "default": {"vf_explained_var": 0.96893310546875, "vf_loss": 6.075976371765137, "entropy": 1.2722160816192627, "cur_lr": 0.0005000000237487257, "total_loss": 6.072999477386475, "kl": 0.013859831728041172, "policy_loss": -0.0033234835136681795, "cur_kl_coeff": 0.02500000409781933}}, "episode_reward_mean": 1100.7829216162363, "timesteps_this_iter": 44454, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4908>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b46a0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-07-53", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 61.99236603690447}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1320.1682377822897, "node_ip": "10.138.0.2", "timesteps_total": 1020532, "iterations_since_restore": 21, "custom_metrics": {"cost1_max": 385.22235988611754, "cost1_min": 33.980655913559815, "system_level_velocity_mean": 12.806442265761467, "outflow_rate_max": 1209.9220183407751, "cost1_mean": 329.64703979222145, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.37699019420383, "system_level_velocity_min": 10.681157006951247, "cost2_max": -13.326628650956179, "cost2_mean": -97.29346869943214, "outflow_rate_mean": 1022.0125176042585, "cost2_min": -134.7192463556514}, "training_iteration": 21, "episodes_total": 277, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205699, "time_total_s": 625.0692276954651, "episode_len_mean": 681.4, "pid": 32002, "time_since_restore": 625.0692276954651, "time_this_iter_s": 26.12699842453003, "timesteps_since_restore": 1020532, "info": {"num_steps_trained": 1020532, "load_time_ms": 16.356, "num_steps_sampled": 1020532, "grad_time_ms": 10553.273, "sample_time_ms": 16927.265, "update_time_ms": 7.405, "default": {"vf_explained_var": 0.9447574019432068, "vf_loss": 9.358317375183105, "entropy": 1.2583683729171753, "cur_lr": 0.0005000000237487257, "total_loss": 9.356104850769043, "kl": 0.01025176141411066, "policy_loss": -0.0024690062273293734, "cur_kl_coeff": 0.02500000409781933}}, "episode_reward_mean": 1108.7159476206575, "timesteps_this_iter": 44618, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66b13f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4f60>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a75f8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-08-19", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 61.99236603690447}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1320.1682377822897, "node_ip": "10.138.0.2", "timesteps_total": 1062752, "iterations_since_restore": 22, "custom_metrics": {"cost1_max": 385.22235988611754, "cost1_min": 33.980655913559815, "system_level_velocity_mean": 13.052920274124606, "outflow_rate_max": 1209.9220183407751, "cost1_mean": 332.4530521874916, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.37699019420383, "system_level_velocity_min": 10.792350286762105, "cost2_max": -13.326628650956179, "cost2_mean": -90.04492235859372, "outflow_rate_mean": 1029.7663198331716, "cost2_min": -134.7192463556514}, "training_iteration": 22, "episodes_total": 293, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205724, "time_total_s": 650.5482935905457, "episode_len_mean": 675.64, "pid": 32002, "time_since_restore": 650.5482935905457, "time_this_iter_s": 25.479065895080566, "timesteps_since_restore": 1062752, "info": {"num_steps_trained": 1062752, "load_time_ms": 16.201, "num_steps_sampled": 1062752, "grad_time_ms": 10253.415, "sample_time_ms": 16687.117, "update_time_ms": 7.413, "default": {"vf_explained_var": 0.9370476007461548, "vf_loss": 10.375917434692383, "entropy": 1.2410038709640503, "cur_lr": 0.0005000000237487257, "total_loss": 10.372642517089844, "kl": 0.014791720546782017, "policy_loss": -0.003643660806119442, "cur_kl_coeff": 0.02500000037252903}}, "episode_reward_mean": 1109.6816523421257, "timesteps_this_iter": 42220, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4cf8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4cc0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-08-44", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 61.99236603690447}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1314.1706772724528, "node_ip": "10.138.0.2", "timesteps_total": 1104734, "iterations_since_restore": 23, "custom_metrics": {"cost1_max": 399.2854770232806, "cost1_min": 33.980655913559815, "system_level_velocity_mean": 13.104418386299706, "outflow_rate_max": 1209.9220183407751, "cost1_mean": 339.0602084686522, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.125275749878117, "system_level_velocity_min": 11.370723028208031, "cost2_max": -13.326628650956179, "cost2_mean": -83.255213729072, "outflow_rate_mean": 1044.2591570505401, "cost2_min": -134.7192463556514}, "training_iteration": 23, "episodes_total": 311, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205749, "time_total_s": 675.5761938095093, "episode_len_mean": 682.14, "pid": 32002, "time_since_restore": 675.5761938095093, "time_this_iter_s": 25.027900218963623, "timesteps_since_restore": 1104734, "info": {"num_steps_trained": 1104734, "load_time_ms": 16.244, "num_steps_sampled": 1104734, "grad_time_ms": 10096.406, "sample_time_ms": 16492.677, "update_time_ms": 7.174, "default": {"vf_explained_var": 0.9154735207557678, "vf_loss": 12.07357406616211, "entropy": 1.2266466617584229, "cur_lr": 0.0005000000237487257, "total_loss": 12.070900917053223, "kl": 0.012453158386051655, "policy_loss": -0.002984087448567152, "cur_kl_coeff": 0.02500000409781933}}, "episode_reward_mean": 1123.9316218551812, "timesteps_this_iter": 41982, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b44e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4860>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e7b8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-09-09", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 62.157961446769}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1314.1706772724528, "node_ip": "10.138.0.2", "timesteps_total": 1149374, "iterations_since_restore": 24, "custom_metrics": {"cost1_max": 399.2854770232806, "cost1_min": 33.980655913559815, "system_level_velocity_mean": 13.156989177787448, "outflow_rate_max": 1209.9220183407751, "cost1_mean": 340.72379746452395, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.125275749878117, "system_level_velocity_min": 11.370723028208031, "cost2_max": -13.326628650956179, "cost2_mean": -79.68609889169946, "outflow_rate_mean": 1050.7230728624143, "cost2_min": -128.65763835761075}, "training_iteration": 24, "episodes_total": 324, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205776, "time_total_s": 702.2213354110718, "episode_len_mean": 682.14, "pid": 32002, "time_since_restore": 702.2213354110718, "time_this_iter_s": 26.6451416015625, "timesteps_since_restore": 1149374, "info": {"num_steps_trained": 1149374, "load_time_ms": 15.2, "num_steps_sampled": 1149374, "grad_time_ms": 10070.362, "sample_time_ms": 16491.368, "update_time_ms": 7.382, "default": {"vf_explained_var": 0.9546124935150146, "vf_loss": 7.9274396896362305, "entropy": 1.2370697259902954, "cur_lr": 0.0005000000237487257, "total_loss": 7.925420761108398, "kl": 0.010991888120770454, "policy_loss": -0.002293946221470833, "cur_kl_coeff": 0.02500000409781933}}, "episode_reward_mean": 1124.139669426436, "timesteps_this_iter": 44640, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b45c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4240>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-09-36", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 62.157961446769}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1314.1706772724528, "node_ip": "10.138.0.2", "timesteps_total": 1193821, "iterations_since_restore": 25, "custom_metrics": {"cost1_max": 399.2854770232806, "cost1_min": 33.980655913559815, "system_level_velocity_mean": 13.228097596181282, "outflow_rate_max": 1198.6927321535607, "cost1_mean": 342.74316198360594, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.125275749878117, "system_level_velocity_min": 11.370723028208031, "cost2_max": -13.326628650956179, "cost2_mean": -76.90398220026465, "outflow_rate_mean": 1054.29030407625, "cost2_min": -117.44296134488648}, "training_iteration": 25, "episodes_total": 336, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205802, "time_total_s": 728.355571269989, "episode_len_mean": 682.14, "pid": 32002, "time_since_restore": 728.355571269989, "time_this_iter_s": 26.134235858917236, "timesteps_since_restore": 1193821, "info": {"num_steps_trained": 1193821, "load_time_ms": 15.375, "num_steps_sampled": 1193821, "grad_time_ms": 10045.849, "sample_time_ms": 16346.436, "update_time_ms": 7.492, "default": {"vf_explained_var": 0.973967432975769, "vf_loss": 5.665719509124756, "entropy": 1.239768147468567, "cur_lr": 0.0005000000237487257, "total_loss": 5.663486480712891, "kl": 0.009794325567781925, "policy_loss": -0.002477742498740554, "cur_kl_coeff": 0.02500000409781933}}, "episode_reward_mean": 1120.579745260888, "timesteps_this_iter": 44447, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b92b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9240>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-10-02", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 62.157961446769}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1310.8216872218518, "node_ip": "10.138.0.2", "timesteps_total": 1237717, "iterations_since_restore": 26, "custom_metrics": {"cost1_max": 399.2854770232806, "cost1_min": 84.50063818590385, "system_level_velocity_mean": 13.356821711977563, "outflow_rate_max": 1199.5628391114203, "cost1_mean": 350.64993548481465, "outflow_rate_min": 396.9210864977157, "system_level_velocity_max": 18.364414711935005, "system_level_velocity_min": 11.742349405557533, "cost2_max": -23.80563815007926, "cost2_mean": -77.73171927136931, "outflow_rate_mean": 1072.0047045093786, "cost2_min": -123.55937154018366}, "training_iteration": 26, "episodes_total": 354, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205829, "time_total_s": 754.9167098999023, "episode_len_mean": 688.64, "pid": 32002, "time_since_restore": 754.9167098999023, "time_this_iter_s": 26.56113862991333, "timesteps_since_restore": 1237717, "info": {"num_steps_trained": 1237717, "load_time_ms": 15.345, "num_steps_sampled": 1237717, "grad_time_ms": 10093.194, "sample_time_ms": 16302.697, "update_time_ms": 7.352, "default": {"vf_explained_var": 0.9700765609741211, "vf_loss": 7.186068534851074, "entropy": 1.2605711221694946, "cur_lr": 0.0005000000237487257, "total_loss": 7.183324813842773, "kl": 0.01028963178396225, "policy_loss": -0.003001642879098654, "cur_kl_coeff": 0.025000005960464478}}, "episode_reward_mean": 1135.4919910814156, "timesteps_this_iter": 43896, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b95f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aacf8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-10-29", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 187.5417655535094}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1433.8524841887408, "node_ip": "10.138.0.2", "timesteps_total": 1279814, "iterations_since_restore": 27, "custom_metrics": {"cost1_max": 428.6903325016525, "cost1_min": 84.50063818590385, "system_level_velocity_mean": 13.513898804381386, "outflow_rate_max": 1275.1871645990375, "cost1_mean": 354.08087675934473, "outflow_rate_min": 396.9210864977157, "system_level_velocity_max": 18.364414711935005, "system_level_velocity_min": 11.742349405557533, "cost2_max": -23.80563815007926, "cost2_mean": -80.30440553794138, "outflow_rate_mean": 1080.6069639462685, "cost2_min": -123.55937154018366}, "training_iteration": 27, "episodes_total": 369, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205854, "time_total_s": 780.0237185955048, "episode_len_mean": 688.64, "pid": 32002, "time_since_restore": 780.0237185955048, "time_this_iter_s": 25.107008695602417, "timesteps_since_restore": 1279814, "info": {"num_steps_trained": 1279814, "load_time_ms": 15.135, "num_steps_sampled": 1279814, "grad_time_ms": 10067.188, "sample_time_ms": 16069.516, "update_time_ms": 7.488, "default": {"vf_explained_var": 0.9794281721115112, "vf_loss": 5.488697528839111, "entropy": 1.2605470418930054, "cur_lr": 0.0005000000237487257, "total_loss": 5.486994743347168, "kl": 0.009327228181064129, "policy_loss": -0.0019360159058123827, "cur_kl_coeff": 0.02500000223517418}}, "episode_reward_mean": 1138.3736043657868, "timesteps_this_iter": 42097, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9b38>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9cf8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-10-54", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 187.5417655535094}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1433.8524841887408, "node_ip": "10.138.0.2", "timesteps_total": 1322222, "iterations_since_restore": 28, "custom_metrics": {"cost1_max": 428.6903325016525, "cost1_min": 84.50063818590385, "system_level_velocity_mean": 13.715220485186281, "outflow_rate_max": 1318.2203052500765, "cost1_mean": 362.65237290864854, "outflow_rate_min": 396.9210864977157, "system_level_velocity_max": 18.249496903648414, "system_level_velocity_min": 11.9440616419292, "cost2_max": -23.80563815007926, "cost2_mean": -82.07413408388183, "outflow_rate_mean": 1104.643420137748, "cost2_min": -123.55937154018366}, "training_iteration": 28, "episodes_total": 385, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205880, "time_total_s": 805.8043124675751, "episode_len_mean": 694.24, "pid": 32002, "time_since_restore": 805.8043124675751, "time_this_iter_s": 25.780593872070312, "timesteps_since_restore": 1322222, "info": {"num_steps_trained": 1322222, "load_time_ms": 14.796, "num_steps_sampled": 1322222, "grad_time_ms": 10166.507, "sample_time_ms": 15906.075, "update_time_ms": 7.667, "default": {"vf_explained_var": 0.9428596496582031, "vf_loss": 11.722478866577148, "entropy": 1.2415610551834106, "cur_lr": 0.0005000000237487257, "total_loss": 11.720695495605469, "kl": 0.012070943601429462, "policy_loss": -0.0020861248485744, "cur_kl_coeff": 0.02500000409781933}}, "episode_reward_mean": 1153.882959448288, "timesteps_this_iter": 42408, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c16d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1b70>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-11-20", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 187.5417655535094}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1433.8524841887408, "node_ip": "10.138.0.2", "timesteps_total": 1367539, "iterations_since_restore": 29, "custom_metrics": {"cost1_max": 449.2909341019857, "cost1_min": 321.2115421148678, "system_level_velocity_mean": 13.854348686083997, "outflow_rate_max": 1320.7970645387375, "cost1_mean": 369.66884813625546, "outflow_rate_min": 984.3310154177431, "system_level_velocity_max": 16.826441858777088, "system_level_velocity_min": 12.00502957105577, "cost2_max": -56.227801280608546, "cost2_mean": -86.80357129082536, "outflow_rate_mean": 1122.6625648044235, "cost2_min": -123.55937154018366}, "training_iteration": 29, "episodes_total": 400, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205907, "time_total_s": 833.0971028804779, "episode_len_mean": 700.0, "pid": 32002, "time_since_restore": 833.0971028804779, "time_this_iter_s": 27.292790412902832, "timesteps_since_restore": 1367539, "info": {"num_steps_trained": 1367539, "load_time_ms": 14.801, "num_steps_sampled": 1367539, "grad_time_ms": 10160.293, "sample_time_ms": 15825.883, "update_time_ms": 7.938, "default": {"vf_explained_var": 0.9755107760429382, "vf_loss": 6.265660285949707, "entropy": 1.2929238080978394, "cur_lr": 0.0005000000237487257, "total_loss": 6.263254165649414, "kl": 0.011908643878996372, "policy_loss": -0.002703855512663722, "cur_kl_coeff": 0.02500000409781933}}, "episode_reward_mean": 1165.0395683186096, "timesteps_this_iter": 45317, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9c88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9b70>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9e48>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-11-47", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 1006.6510111064156}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1433.8524841887408, "node_ip": "10.138.0.2", "timesteps_total": 1412582, "iterations_since_restore": 30, "custom_metrics": {"cost1_max": 449.2909341019857, "cost1_min": 29.308998955654197, "system_level_velocity_mean": 14.020053450956386, "outflow_rate_max": 1320.7970645387375, "cost1_mean": 368.7458681914732, "outflow_rate_min": 324.6102532524653, "system_level_velocity_max": 20.102140477300463, "system_level_velocity_min": 12.100909882090548, "cost2_max": -14.778058317197363, "cost2_mean": -89.670461346891, "outflow_rate_mean": 1122.959856872877, "cost2_min": -123.55937154018366}, "training_iteration": 30, "episodes_total": 410, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205933, "time_total_s": 859.0650553703308, "episode_len_mean": 693.43, "pid": 32002, "time_since_restore": 859.0650553703308, "time_this_iter_s": 25.967952489852905, "timesteps_since_restore": 1412582, "info": {"num_steps_trained": 1412582, "load_time_ms": 14.921, "num_steps_sampled": 1412582, "grad_time_ms": 10327.757, "sample_time_ms": 15574.25, "update_time_ms": 8.084, "default": {"vf_explained_var": 0.9805894494056702, "vf_loss": 5.239681243896484, "entropy": 1.273635983467102, "cur_lr": 0.0005000000237487257, "total_loss": 5.236335754394531, "kl": 0.014421737752854824, "policy_loss": -0.0037058251909911633, "cur_kl_coeff": 0.02500000409781933}}, "episode_reward_mean": 1160.2419720716907, "timesteps_this_iter": 45043, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b40b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4d30>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b47f0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-12-13", "hostname": "flow-main", "episodes_this_iter": 10, "episode_reward_min": 53.20734523673839}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1433.8524841887408, "node_ip": "10.138.0.2", "timesteps_total": 1456190, "iterations_since_restore": 31, "custom_metrics": {"cost1_max": 449.2909341019857, "cost1_min": 29.308998955654197, "system_level_velocity_mean": 14.243259758245218, "outflow_rate_max": 1366.5150129768538, "cost1_mean": 373.58070745647836, "outflow_rate_min": 324.6102532524653, "system_level_velocity_max": 20.102140477300463, "system_level_velocity_min": 12.100909882090548, "cost2_max": -14.778058317197363, "cost2_mean": -91.97192163451771, "outflow_rate_mean": 1133.5784534939842, "cost2_min": -132.02771885696976}, "training_iteration": 31, "episodes_total": 428, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205959, "time_total_s": 885.1312754154205, "episode_len_mean": 693.43, "pid": 32002, "time_since_restore": 885.1312754154205, "time_this_iter_s": 26.06622004508972, "timesteps_since_restore": 1456190, "info": {"num_steps_trained": 1456190, "load_time_ms": 14.775, "num_steps_sampled": 1456190, "grad_time_ms": 10494.135, "sample_time_ms": 15401.818, "update_time_ms": 8.292, "default": {"vf_explained_var": 0.9719468355178833, "vf_loss": 8.16955280303955, "entropy": 1.2462400197982788, "cur_lr": 0.0005000000237487257, "total_loss": 8.167425155639648, "kl": 0.010329293087124825, "policy_loss": -0.002386032836511731, "cur_kl_coeff": 0.025000005960464478}}, "episode_reward_mean": 1169.1620108461684, "timesteps_this_iter": 43608, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1198>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1fd0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-12-39", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 53.20734523673839}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1433.8524841887408, "node_ip": "10.138.0.2", "timesteps_total": 1497745, "iterations_since_restore": 32, "custom_metrics": {"cost1_max": 483.68042896220265, "cost1_min": 29.308998955654197, "system_level_velocity_mean": 14.434647599750972, "outflow_rate_max": 1366.5150129768538, "cost1_mean": 377.7780265006047, "outflow_rate_min": 324.6102532524653, "system_level_velocity_max": 20.102140477300463, "system_level_velocity_min": 12.100909882090548, "cost2_max": -14.778058317197363, "cost2_mean": -93.31839904319959, "outflow_rate_mean": 1145.8915532406158, "cost2_min": -132.02771885696976}, "training_iteration": 32, "episodes_total": 445, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557205986, "time_total_s": 911.6680815219879, "episode_len_mean": 693.43, "pid": 32002, "time_since_restore": 911.6680815219879, "time_this_iter_s": 26.536806106567383, "timesteps_since_restore": 1497745, "info": {"num_steps_trained": 1497745, "load_time_ms": 14.702, "num_steps_sampled": 1497745, "grad_time_ms": 10639.371, "sample_time_ms": 15361.154, "update_time_ms": 8.517, "default": {"vf_explained_var": 0.9757763743400574, "vf_loss": 7.708236217498779, "entropy": 1.2467041015625, "cur_lr": 0.0005000000237487257, "total_loss": 7.704719543457031, "kl": 0.010976527817547321, "policy_loss": -0.0037906276993453503, "cur_kl_coeff": 0.02500000409781933}}, "episode_reward_mean": 1168.5165291648705, "timesteps_this_iter": 41555, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4400>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4588>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-13-06", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 53.20734523673839}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1379.4165830436486, "node_ip": "10.138.0.2", "timesteps_total": 1539831, "iterations_since_restore": 33, "custom_metrics": {"cost1_max": 483.68042896220265, "cost1_min": 29.308998955654197, "system_level_velocity_mean": 14.652826379990296, "outflow_rate_max": 1366.5150129768538, "cost1_mean": 377.99751542676563, "outflow_rate_min": 324.6102532524653, "system_level_velocity_max": 20.102140477300463, "system_level_velocity_min": 12.618931310571176, "cost2_max": -14.778058317197363, "cost2_mean": -93.48678886199535, "outflow_rate_mean": 1143.5393664175149, "cost2_min": -132.02771885696976}, "training_iteration": 33, "episodes_total": 461, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206011, "time_total_s": 936.9975035190582, "episode_len_mean": 686.93, "pid": 32002, "time_since_restore": 936.9975035190582, "time_this_iter_s": 25.329421997070312, "timesteps_since_restore": 1539831, "info": {"num_steps_trained": 1539831, "load_time_ms": 14.748, "num_steps_sampled": 1539831, "grad_time_ms": 10741.865, "sample_time_ms": 15285.976, "update_time_ms": 8.616, "default": {"vf_explained_var": 0.9657420516014099, "vf_loss": 8.81802749633789, "entropy": 1.2156325578689575, "cur_lr": 0.0005000000237487257, "total_loss": 8.815703392028809, "kl": 0.01063245628029108, "policy_loss": -0.002588661154732108, "cur_kl_coeff": 0.02500000223517418}}, "episode_reward_mean": 1155.3490151217345, "timesteps_this_iter": 42086, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd5f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd630>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd5c0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-13-31", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 53.20734523673839}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1379.4165830436486, "node_ip": "10.138.0.2", "timesteps_total": 1584891, "iterations_since_restore": 34, "custom_metrics": {"cost1_max": 483.68042896220265, "cost1_min": 29.308998955654197, "system_level_velocity_mean": 14.74838365753767, "outflow_rate_max": 1366.5150129768538, "cost1_mean": 379.9527815703945, "outflow_rate_min": 324.6102532524653, "system_level_velocity_max": 20.102140477300463, "system_level_velocity_min": 12.618931310571176, "cost2_max": -14.778058317197363, "cost2_mean": -93.82964968319261, "outflow_rate_mean": 1145.4865784068265, "cost2_min": -132.02771885696976}, "training_iteration": 34, "episodes_total": 476, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206037, "time_total_s": 962.729909658432, "episode_len_mean": 686.93, "pid": 32002, "time_since_restore": 962.729909658432, "time_this_iter_s": 25.73240613937378, "timesteps_since_restore": 1584891, "info": {"num_steps_trained": 1584891, "load_time_ms": 14.493, "num_steps_sampled": 1584891, "grad_time_ms": 10803.593, "sample_time_ms": 15132.709, "update_time_ms": 8.676, "default": {"vf_explained_var": 0.9653768539428711, "vf_loss": 7.492738246917725, "entropy": 1.188403606414795, "cur_lr": 0.0005000000237487257, "total_loss": 7.490176200866699, "kl": 0.013115206733345985, "policy_loss": -0.002890069968998432, "cur_kl_coeff": 0.02500000409781933}}, "episode_reward_mean": 1157.2133424660317, "timesteps_this_iter": 45060, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689ecf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1860>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7f60>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-13-57", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 53.20734523673839}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1379.4165830436486, "node_ip": "10.138.0.2", "timesteps_total": 1627541, "iterations_since_restore": 35, "custom_metrics": {"cost1_max": 483.68042896220265, "cost1_min": 29.308998955654197, "system_level_velocity_mean": 14.720774997778378, "outflow_rate_max": 1366.5150129768538, "cost1_mean": 379.2777717004615, "outflow_rate_min": 324.6102532524653, "system_level_velocity_max": 20.102140477300463, "system_level_velocity_min": 12.618931310571176, "cost2_max": -14.778058317197363, "cost2_mean": -94.66567948335498, "outflow_rate_mean": 1142.5407880850473, "cost2_min": -132.02771885696976}, "training_iteration": 35, "episodes_total": 487, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206061, "time_total_s": 986.6997420787811, "episode_len_mean": 686.93, "pid": 32002, "time_since_restore": 986.6997420787811, "time_this_iter_s": 23.96983242034912, "timesteps_since_restore": 1627541, "info": {"num_steps_trained": 1627541, "load_time_ms": 14.228, "num_steps_sampled": 1627541, "grad_time_ms": 10737.025, "sample_time_ms": 14980.973, "update_time_ms": 8.799, "default": {"vf_explained_var": 0.9798297882080078, "vf_loss": 5.536506175994873, "entropy": 1.2008907794952393, "cur_lr": 0.0005000000237487257, "total_loss": 5.533013820648193, "kl": 0.01179538294672966, "policy_loss": -0.003787384368479252, "cur_kl_coeff": 0.02500000223517418}}, "episode_reward_mean": 1156.3386951809687, "timesteps_this_iter": 42650, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cda20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdda0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66af93c8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-14-21", "hostname": "flow-main", "episodes_this_iter": 11, "episode_reward_min": 53.20734523673839}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1379.364931598433, "node_ip": "10.138.0.2", "timesteps_total": 1670432, "iterations_since_restore": 36, "custom_metrics": {"cost1_max": 483.68042896220265, "cost1_min": 29.308998955654197, "system_level_velocity_mean": 14.873463294586063, "outflow_rate_max": 1383.897305729706, "cost1_mean": 379.0816862651784, "outflow_rate_min": 324.6102532524653, "system_level_velocity_max": 20.102140477300463, "system_level_velocity_min": 12.577458308665342, "cost2_max": -14.778058317197363, "cost2_mean": -93.08405307333739, "outflow_rate_mean": 1141.841344162106, "cost2_min": -132.02771885696976}, "training_iteration": 36, "episodes_total": 505, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206087, "time_total_s": 1012.58802318573, "episode_len_mean": 681.42, "pid": 32002, "time_since_restore": 1012.58802318573, "time_this_iter_s": 25.888281106948853, "timesteps_since_restore": 1670432, "info": {"num_steps_trained": 1670432, "load_time_ms": 14.188, "num_steps_sampled": 1670432, "grad_time_ms": 10651.681, "sample_time_ms": 14996.509, "update_time_ms": 9.046, "default": {"vf_explained_var": 0.9591302871704102, "vf_loss": 11.445867538452148, "entropy": 1.186823844909668, "cur_lr": 0.0005000000237487257, "total_loss": 11.443314552307129, "kl": 0.011565202847123146, "policy_loss": -0.002842075191438198, "cur_kl_coeff": 0.025000005960464478}}, "episode_reward_mean": 1156.504381392502, "timesteps_this_iter": 42891, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c10f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c19e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1400>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-14-47", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 53.20734523673839}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1379.364931598433, "node_ip": "10.138.0.2", "timesteps_total": 1712476, "iterations_since_restore": 37, "custom_metrics": {"cost1_max": 483.68042896220265, "cost1_min": 34.37259791792763, "system_level_velocity_mean": 14.844353682067323, "outflow_rate_max": 1383.897305729706, "cost1_mean": 383.174814993571, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.186982971067586, "system_level_velocity_min": 12.577458308665342, "cost2_max": -15.087879060867845, "cost2_mean": -92.38006439336499, "outflow_rate_mean": 1149.3943088582073, "cost2_min": -118.02630378340262}, "training_iteration": 37, "episodes_total": 522, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206113, "time_total_s": 1039.050940990448, "episode_len_mean": 687.99, "pid": 32002, "time_since_restore": 1039.050940990448, "time_this_iter_s": 26.462917804718018, "timesteps_since_restore": 1712476, "info": {"num_steps_trained": 1712476, "load_time_ms": 14.325, "num_steps_sampled": 1712476, "grad_time_ms": 10646.751, "sample_time_ms": 15137.628, "update_time_ms": 9.129, "default": {"vf_explained_var": 0.9771483540534973, "vf_loss": 7.105715751647949, "entropy": 1.1775768995285034, "cur_lr": 0.0005000000237487257, "total_loss": 7.102405071258545, "kl": 0.011958818882703781, "policy_loss": -0.0036098386626690626, "cur_kl_coeff": 0.02500000223517418}}, "episode_reward_mean": 1159.375389284935, "timesteps_this_iter": 42044, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd4a8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd1d0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-15-13", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 62.58178510750448}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1379.364931598433, "node_ip": "10.138.0.2", "timesteps_total": 1755520, "iterations_since_restore": 38, "custom_metrics": {"cost1_max": 474.06834188496043, "cost1_min": 34.37259791792763, "system_level_velocity_mean": 15.004248549559888, "outflow_rate_max": 1383.897305729706, "cost1_mean": 383.442042957822, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.4204393500779, "system_level_velocity_min": 12.577458308665342, "cost2_max": -15.087879060867845, "cost2_mean": -91.35286335087838, "outflow_rate_mean": 1148.0068749923494, "cost2_min": -118.02630378340262}, "training_iteration": 38, "episodes_total": 538, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206141, "time_total_s": 1066.5589625835419, "episode_len_mean": 682.42, "pid": 32002, "time_since_restore": 1066.5589625835419, "time_this_iter_s": 27.508021593093872, "timesteps_since_restore": 1755520, "info": {"num_steps_trained": 1755520, "load_time_ms": 14.312, "num_steps_sampled": 1755520, "grad_time_ms": 10713.618, "sample_time_ms": 15240.605, "update_time_ms": 9.267, "default": {"vf_explained_var": 0.9608006477355957, "vf_loss": 11.240354537963867, "entropy": 1.1632086038589478, "cur_lr": 0.0005000000237487257, "total_loss": 11.23796558380127, "kl": 0.011606207117438316, "policy_loss": -0.002678028540685773, "cur_kl_coeff": 0.02500000409781933}}, "episode_reward_mean": 1156.170315355057, "timesteps_this_iter": 43044, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1d30>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c17f0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-15-41", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 62.58178510750448}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1379.364931598433, "node_ip": "10.138.0.2", "timesteps_total": 1798547, "iterations_since_restore": 39, "custom_metrics": {"cost1_max": 474.06834188496043, "cost1_min": 34.43951968484983, "system_level_velocity_mean": 15.083610679713493, "outflow_rate_max": 1383.897305729706, "cost1_mean": 377.9025899108628, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.576582769308256, "system_level_velocity_min": 12.577458308665342, "cost2_max": -19.68999551880815, "cost2_mean": -88.71256535175436, "outflow_rate_mean": 1137.5577084716078, "cost2_min": -118.02630378340262}, "training_iteration": 39, "episodes_total": 557, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206167, "time_total_s": 1092.826449394226, "episode_len_mean": 671.67, "pid": 32002, "time_since_restore": 1092.826449394226, "time_this_iter_s": 26.267486810684204, "timesteps_since_restore": 1798547, "info": {"num_steps_trained": 1798547, "load_time_ms": 14.044, "num_steps_sampled": 1798547, "grad_time_ms": 10651.127, "sample_time_ms": 15199.52, "update_time_ms": 9.247, "default": {"vf_explained_var": 0.9407976269721985, "vf_loss": 16.411861419677734, "entropy": 1.1319854259490967, "cur_lr": 0.0005000000237487257, "total_loss": 16.40890121459961, "kl": 0.013987870886921883, "policy_loss": -0.003308521583676338, "cur_kl_coeff": 0.02500000409781933}}, "episode_reward_mean": 1143.6853058009806, "timesteps_this_iter": 43027, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd240>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd6d8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-16-07", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 67.77737743455067}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1379.364931598433, "node_ip": "10.138.0.2", "timesteps_total": 1842477, "iterations_since_restore": 40, "custom_metrics": {"cost1_max": 474.06834188496043, "cost1_min": 34.43951968484983, "system_level_velocity_mean": 15.153793197605342, "outflow_rate_max": 1383.897305729706, "cost1_mean": 379.6578892933573, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.576582769308256, "system_level_velocity_min": 12.577458308665342, "cost2_max": -19.68999551880815, "cost2_mean": -88.36874735734078, "outflow_rate_mean": 1143.2887874566018, "cost2_min": -118.02630378340262}, "training_iteration": 40, "episodes_total": 569, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206193, "time_total_s": 1118.9635937213898, "episode_len_mean": 671.67, "pid": 32002, "time_since_restore": 1118.9635937213898, "time_this_iter_s": 26.137144327163696, "timesteps_since_restore": 1842477, "info": {"num_steps_trained": 1842477, "load_time_ms": 13.538, "num_steps_sampled": 1842477, "grad_time_ms": 10614.208, "sample_time_ms": 15252.336, "update_time_ms": 9.187, "default": {"vf_explained_var": 0.9777559041976929, "vf_loss": 6.786843299865723, "entropy": 1.1474802494049072, "cur_lr": 0.0005000000237487257, "total_loss": 6.783515453338623, "kl": 0.012215306982398033, "policy_loss": -0.0036331280134618282, "cur_kl_coeff": 0.02500000409781933}}, "episode_reward_mean": 1147.59638869291, "timesteps_this_iter": 43930, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9630>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-16-33", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 67.77737743455067}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1420.911207667526, "node_ip": "10.138.0.2", "timesteps_total": 1886115, "iterations_since_restore": 41, "custom_metrics": {"cost1_max": 474.06834188496043, "cost1_min": 34.43951968484983, "system_level_velocity_mean": 15.230009760704656, "outflow_rate_max": 1383.897305729706, "cost1_mean": 378.0994679047144, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.576582769308256, "system_level_velocity_min": 12.440864397397876, "cost2_max": -19.68999551880815, "cost2_mean": -88.09586306035311, "outflow_rate_mean": 1140.0169799074745, "cost2_min": -118.02630378340262}, "training_iteration": 41, "episodes_total": 585, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206219, "time_total_s": 1145.067254781723, "episode_len_mean": 666.93, "pid": 32002, "time_since_restore": 1145.067254781723, "time_this_iter_s": 26.103661060333252, "timesteps_since_restore": 1886115, "info": {"num_steps_trained": 1886115, "load_time_ms": 13.787, "num_steps_sampled": 1886115, "grad_time_ms": 10538.786, "sample_time_ms": 15329.092, "update_time_ms": 9.281, "default": {"vf_explained_var": 0.9710044264793396, "vf_loss": 8.929265975952148, "entropy": 1.1517179012298584, "cur_lr": 0.0005000000237487257, "total_loss": 8.926497459411621, "kl": 0.01171948853880167, "policy_loss": -0.003060659859329462, "cur_kl_coeff": 0.025000005960464478}}, "episode_reward_mean": 1136.965925170714, "timesteps_this_iter": 43638, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b49e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4dd8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4080>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-16-59", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 67.77737743455067}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1420.911207667526, "node_ip": "10.138.0.2", "timesteps_total": 1928375, "iterations_since_restore": 42, "custom_metrics": {"cost1_max": 489.438479222782, "cost1_min": 34.31823408703333, "system_level_velocity_mean": 15.270814159915808, "outflow_rate_max": 1381.1608776936177, "cost1_mean": 374.33618992890734, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.576582769308256, "system_level_velocity_min": 12.440864397397876, "cost2_max": -17.399641641866193, "cost2_mean": -87.84019417095105, "outflow_rate_mean": 1128.4344439521226, "cost2_min": -118.02630378340262}, "training_iteration": 42, "episodes_total": 603, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206246, "time_total_s": 1171.4916446208954, "episode_len_mean": 660.95, "pid": 32002, "time_since_restore": 1171.4916446208954, "time_this_iter_s": 26.424389839172363, "timesteps_since_restore": 1928375, "info": {"num_steps_trained": 1928375, "load_time_ms": 13.567, "num_steps_sampled": 1928375, "grad_time_ms": 10526.051, "sample_time_ms": 15329.023, "update_time_ms": 9.166, "default": {"vf_explained_var": 0.9701750874519348, "vf_loss": 10.345174789428711, "entropy": 1.1330333948135376, "cur_lr": 0.0005000000237487257, "total_loss": 10.342877388000488, "kl": 0.014436439611017704, "policy_loss": -0.0026575785595923662, "cur_kl_coeff": 0.025000005960464478}}, "episode_reward_mean": 1118.4359509453272, "timesteps_this_iter": 42260, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1208>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-17-26", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 67.77737743455067}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1420.911207667526, "node_ip": "10.138.0.2", "timesteps_total": 1971401, "iterations_since_restore": 43, "custom_metrics": {"cost1_max": 489.438479222782, "cost1_min": 34.31823408703333, "system_level_velocity_mean": 15.387775836971462, "outflow_rate_max": 1381.1608776936177, "cost1_mean": 373.2699998963225, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.576582769308256, "system_level_velocity_min": 12.440864397397876, "cost2_max": -17.399641641866193, "cost2_mean": -87.81233997634138, "outflow_rate_mean": 1127.8674038287495, "cost2_min": -117.91203111253654}, "training_iteration": 43, "episodes_total": 620, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206272, "time_total_s": 1197.571941614151, "episode_len_mean": 655.35, "pid": 32002, "time_since_restore": 1197.571941614151, "time_this_iter_s": 26.080296993255615, "timesteps_since_restore": 1971401, "info": {"num_steps_trained": 1971401, "load_time_ms": 13.479, "num_steps_sampled": 1971401, "grad_time_ms": 10507.47, "sample_time_ms": 15424.657, "update_time_ms": 9.291, "default": {"vf_explained_var": 0.975077211856842, "vf_loss": 8.225480079650879, "entropy": 1.132778525352478, "cur_lr": 0.0005000000237487257, "total_loss": 8.222745895385742, "kl": 0.014650531113147736, "policy_loss": -0.0031001355964690447, "cur_kl_coeff": 0.02500000409781933}}, "episode_reward_mean": 1111.459065807806, "timesteps_this_iter": 43026, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7208>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9320>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-17-52", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 67.77737743455067}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1420.911207667526, "node_ip": "10.138.0.2", "timesteps_total": 2016185, "iterations_since_restore": 44, "custom_metrics": {"cost1_max": 489.438479222782, "cost1_min": 34.31823408703333, "system_level_velocity_mean": 15.311321565603919, "outflow_rate_max": 1381.1608776936177, "cost1_mean": 370.9124415094244, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.576582769308256, "system_level_velocity_min": 12.440864397397876, "cost2_max": -17.399641641866193, "cost2_mean": -90.20789442821972, "outflow_rate_mean": 1121.2122994309566, "cost2_min": -126.2799819103531}, "training_iteration": 44, "episodes_total": 636, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206299, "time_total_s": 1224.6174437999725, "episode_len_mean": 655.94, "pid": 32002, "time_since_restore": 1224.6174437999725, "time_this_iter_s": 27.045502185821533, "timesteps_since_restore": 2016185, "info": {"num_steps_trained": 2016185, "load_time_ms": 13.438, "num_steps_sampled": 2016185, "grad_time_ms": 10441.52, "sample_time_ms": 15621.925, "update_time_ms": 9.264, "default": {"vf_explained_var": 0.9790371060371399, "vf_loss": 7.025726318359375, "entropy": 1.1446661949157715, "cur_lr": 0.0005000000237487257, "total_loss": 7.021754264831543, "kl": 0.01675572618842125, "policy_loss": -0.004390897694975138, "cur_kl_coeff": 0.025000005960464478}}, "episode_reward_mean": 1104.2599447298333, "timesteps_this_iter": 44784, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cda90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cda20>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-18-19", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 67.77737743455067}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1420.911207667526, "node_ip": "10.138.0.2", "timesteps_total": 2060353, "iterations_since_restore": 45, "custom_metrics": {"cost1_max": 489.438479222782, "cost1_min": 34.31823408703333, "system_level_velocity_mean": 15.290394850786114, "outflow_rate_max": 1381.1608776936177, "cost1_mean": 367.0369478657317, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 20.001859067286464, "system_level_velocity_min": 12.440864397397876, "cost2_max": -17.399641641866193, "cost2_mean": -92.66518378131609, "outflow_rate_mean": 1112.598004133663, "cost2_min": -129.1669177555616}, "training_iteration": 45, "episodes_total": 651, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206325, "time_total_s": 1250.1584906578064, "episode_len_mean": 652.76, "pid": 32002, "time_since_restore": 1250.1584906578064, "time_this_iter_s": 25.541046857833862, "timesteps_since_restore": 2060353, "info": {"num_steps_trained": 2060353, "load_time_ms": 13.723, "num_steps_sampled": 2060353, "grad_time_ms": 10445.031, "sample_time_ms": 15775.589, "update_time_ms": 8.898, "default": {"vf_explained_var": 0.9692249298095703, "vf_loss": 10.501285552978516, "entropy": 1.1047755479812622, "cur_lr": 0.0005000000237487257, "total_loss": 10.49874210357666, "kl": 0.019283222034573555, "policy_loss": -0.0030248952098190784, "cur_kl_coeff": 0.025000005960464478}}, "episode_reward_mean": 1087.8256541728792, "timesteps_this_iter": 44168, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd2b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd470>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd7b8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-18-45", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 70.73933329141936}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1420.911207667526, "node_ip": "10.138.0.2", "timesteps_total": 2104568, "iterations_since_restore": 46, "custom_metrics": {"cost1_max": 489.438479222782, "cost1_min": 34.31823408703333, "system_level_velocity_mean": 15.13715012008794, "outflow_rate_max": 1391.7366261549755, "cost1_mean": 365.8593862147977, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 20.001859067286464, "system_level_velocity_min": 12.440864397397876, "cost2_max": -17.399641641866193, "cost2_mean": -98.13442800278256, "outflow_rate_mean": 1111.9395714482944, "cost2_min": -138.44287063288346}, "training_iteration": 46, "episodes_total": 667, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206351, "time_total_s": 1276.7974412441254, "episode_len_mean": 658.5, "pid": 32002, "time_since_restore": 1276.7974412441254, "time_this_iter_s": 26.63895058631897, "timesteps_since_restore": 2104568, "info": {"num_steps_trained": 2104568, "load_time_ms": 13.375, "num_steps_sampled": 2104568, "grad_time_ms": 10432.539, "sample_time_ms": 15865.678, "update_time_ms": 8.689, "default": {"vf_explained_var": 0.977840781211853, "vf_loss": 7.328494548797607, "entropy": 1.1345133781433105, "cur_lr": 0.0005000000237487257, "total_loss": 7.325211524963379, "kl": 0.01567724160850048, "policy_loss": -0.0036753180902451277, "cur_kl_coeff": 0.025000005960464478}}, "episode_reward_mean": 1082.7128407016555, "timesteps_this_iter": 44215, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa5c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1ef0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4438>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-19-11", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 70.73933329141936}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1353.0625030953092, "node_ip": "10.138.0.2", "timesteps_total": 2146517, "iterations_since_restore": 47, "custom_metrics": {"cost1_max": 489.438479222782, "cost1_min": 34.31823408703333, "system_level_velocity_mean": 15.370223331212694, "outflow_rate_max": 1391.7366261549755, "cost1_mean": 359.66240255810095, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 20.001859067286464, "system_level_velocity_min": 12.468287498578052, "cost2_max": -17.399641641866193, "cost2_mean": -100.49762006244401, "outflow_rate_mean": 1094.4826832954016, "cost2_min": -146.4054722740634}, "training_iteration": 47, "episodes_total": 684, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206377, "time_total_s": 1302.4985210895538, "episode_len_mean": 642.9, "pid": 32002, "time_since_restore": 1302.4985210895538, "time_this_iter_s": 25.701079845428467, "timesteps_since_restore": 2146517, "info": {"num_steps_trained": 2146517, "load_time_ms": 13.51, "num_steps_sampled": 2146517, "grad_time_ms": 10429.723, "sample_time_ms": 15790.159, "update_time_ms": 8.697, "default": {"vf_explained_var": 0.9633115530014038, "vf_loss": 14.116348266601562, "entropy": 1.1185904741287231, "cur_lr": 0.0005000000237487257, "total_loss": 14.114235877990723, "kl": 0.013743650168180466, "policy_loss": -0.0024577591102570295, "cur_kl_coeff": 0.02500000409781933}}, "episode_reward_mean": 1049.0681198611308, "timesteps_this_iter": 41949, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c14a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1f28>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-19-37", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 70.73933329141936}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1411.3803119331997, "node_ip": "10.138.0.2", "timesteps_total": 2189338, "iterations_since_restore": 48, "custom_metrics": {"cost1_max": 494.5619982151271, "cost1_min": 93.60307796583086, "system_level_velocity_mean": 15.57787124309087, "outflow_rate_max": 1429.8944669295618, "cost1_mean": 368.95429711823556, "outflow_rate_min": 434.1780920120596, "system_level_velocity_max": 20.001859067286464, "system_level_velocity_min": 12.514008820604088, "cost2_max": -28.97663417672167, "cost2_mean": -104.68724223127681, "outflow_rate_mean": 1117.966957066089, "cost2_min": -146.4054722740634}, "training_iteration": 48, "episodes_total": 703, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206402, "time_total_s": 1327.4725461006165, "episode_len_mean": 648.81, "pid": 32002, "time_since_restore": 1327.4725461006165, "time_this_iter_s": 24.974025011062622, "timesteps_since_restore": 2189338, "info": {"num_steps_trained": 2189338, "load_time_ms": 13.763, "num_steps_sampled": 2189338, "grad_time_ms": 10258.567, "sample_time_ms": 15709.716, "update_time_ms": 8.604, "default": {"vf_explained_var": 0.969761073589325, "vf_loss": 11.515372276306152, "entropy": 1.1175241470336914, "cur_lr": 0.0005000000237487257, "total_loss": 11.51156997680664, "kl": 0.017605626955628395, "policy_loss": -0.004242949653416872, "cur_kl_coeff": 0.025000005960464478}}, "episode_reward_mean": 1068.5051567800667, "timesteps_this_iter": 42821, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1c88>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c19e8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-20-02", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 218.52970552094806}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1411.3803119331997, "node_ip": "10.138.0.2", "timesteps_total": 2232813, "iterations_since_restore": 49, "custom_metrics": {"cost1_max": 494.5619982151271, "cost1_min": 93.60307796583086, "system_level_velocity_mean": 15.631585049600583, "outflow_rate_max": 1452.677441036887, "cost1_mean": 369.73916763927673, "outflow_rate_min": 452.4396856384514, "system_level_velocity_max": 20.001859067286464, "system_level_velocity_min": 12.514008820604088, "cost2_max": -33.552147255500884, "cost2_mean": -107.37898732140046, "outflow_rate_mean": 1118.7905779429043, "cost2_min": -146.4054722740634}, "training_iteration": 49, "episodes_total": 719, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206430, "time_total_s": 1355.1644628047943, "episode_len_mean": 648.8, "pid": 32002, "time_since_restore": 1355.1644628047943, "time_this_iter_s": 27.691916704177856, "timesteps_since_restore": 2232813, "info": {"num_steps_trained": 2232813, "load_time_ms": 14.379, "num_steps_sampled": 2232813, "grad_time_ms": 10232.245, "sample_time_ms": 15878.868, "update_time_ms": 8.467, "default": {"vf_explained_var": 0.9753982424736023, "vf_loss": 8.734049797058105, "entropy": 1.12161386013031, "cur_lr": 0.0005000000237487257, "total_loss": 8.731230735778809, "kl": 0.014192997477948666, "policy_loss": -0.003175156656652689, "cur_kl_coeff": 0.02500000409781933}}, "episode_reward_mean": 1069.2029261819896, "timesteps_this_iter": 43475, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689eeb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9518>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-20-30", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 218.52970552094806}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1411.3803119331997, "node_ip": "10.138.0.2", "timesteps_total": 2276757, "iterations_since_restore": 50, "custom_metrics": {"cost1_max": 494.5619982151271, "cost1_min": 35.72387180791312, "system_level_velocity_mean": 15.755336547087152, "outflow_rate_max": 1452.677441036887, "cost1_mean": 367.64158526988473, "outflow_rate_min": 325.2200543648311, "system_level_velocity_max": 20.001859067286464, "system_level_velocity_min": 12.514008820604088, "cost2_max": -22.22353988006339, "cost2_mean": -107.07015663858378, "outflow_rate_mean": 1111.3988460216688, "cost2_min": -146.4054722740634}, "training_iteration": 50, "episodes_total": 733, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206459, "time_total_s": 1383.8919053077698, "episode_len_mean": 641.99, "pid": 32002, "time_since_restore": 1383.8919053077698, "time_this_iter_s": 28.727442502975464, "timesteps_since_restore": 2276757, "info": {"num_steps_trained": 2276757, "load_time_ms": 14.555, "num_steps_sampled": 2276757, "grad_time_ms": 10278.62, "sample_time_ms": 16093.277, "update_time_ms": 8.511, "default": {"vf_explained_var": 0.9717875123023987, "vf_loss": 10.531607627868652, "entropy": 1.1386457681655884, "cur_lr": 0.0005000000237487257, "total_loss": 10.527666091918945, "kl": 0.016850771382451057, "policy_loss": -0.004362970124930143, "cur_kl_coeff": 0.02500000409781933}}, "episode_reward_mean": 1057.306471939565, "timesteps_this_iter": 43944, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd9b0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-20-59", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 73.94468718568375}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1411.3803119331997, "node_ip": "10.138.0.2", "timesteps_total": 2321625, "iterations_since_restore": 51, "custom_metrics": {"cost1_max": 494.5619982151271, "cost1_min": 35.72387180791312, "system_level_velocity_mean": 15.667945612171064, "outflow_rate_max": 1452.677441036887, "cost1_mean": 371.8520249549975, "outflow_rate_min": 325.2200543648311, "system_level_velocity_max": 19.97988078072605, "system_level_velocity_min": 12.514008820604088, "cost2_max": -22.22353988006339, "cost2_mean": -108.19476797062927, "outflow_rate_mean": 1121.492231693132, "cost2_min": -146.4054722740634}, "training_iteration": 51, "episodes_total": 751, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206486, "time_total_s": 1411.4038760662079, "episode_len_mean": 650.78, "pid": 32002, "time_since_restore": 1411.4038760662079, "time_this_iter_s": 27.51197075843811, "timesteps_since_restore": 2321625, "info": {"num_steps_trained": 2321625, "load_time_ms": 14.182, "num_steps_sampled": 2321625, "grad_time_ms": 10223.134, "sample_time_ms": 16292.858, "update_time_ms": 8.432, "default": {"vf_explained_var": 0.9705027341842651, "vf_loss": 10.15865421295166, "entropy": 1.1462270021438599, "cur_lr": 0.0005000000237487257, "total_loss": 10.15371036529541, "kl": 0.016489345580339432, "policy_loss": -0.005356015637516975, "cur_kl_coeff": 0.025000005960464478}}, "episode_reward_mean": 1064.3530094990904, "timesteps_this_iter": 44868, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdf28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cda58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd2e8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-21-26", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 73.94468718568375}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1411.3803119331997, "node_ip": "10.138.0.2", "timesteps_total": 2364311, "iterations_since_restore": 52, "custom_metrics": {"cost1_max": 494.5619982151271, "cost1_min": 35.72387180791312, "system_level_velocity_mean": 15.810965237262627, "outflow_rate_max": 1452.677441036887, "cost1_mean": 371.57194272208085, "outflow_rate_min": 325.2200543648311, "system_level_velocity_max": 19.97988078072605, "system_level_velocity_min": 12.893817502028659, "cost2_max": -22.22353988006339, "cost2_mean": -106.50421125958184, "outflow_rate_mean": 1117.7509066920031, "cost2_min": -146.4054722740634}, "training_iteration": 52, "episodes_total": 765, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206512, "time_total_s": 1437.7789559364319, "episode_len_mean": 644.96, "pid": 32002, "time_since_restore": 1437.7789559364319, "time_this_iter_s": 26.375079870224, "timesteps_since_restore": 2364311, "info": {"num_steps_trained": 2364311, "load_time_ms": 14.257, "num_steps_sampled": 2364311, "grad_time_ms": 10164.796, "sample_time_ms": 16349.112, "update_time_ms": 8.21, "default": {"vf_explained_var": 0.9739103317260742, "vf_loss": 9.096505165100098, "entropy": 1.1213181018829346, "cur_lr": 0.0005000000237487257, "total_loss": 9.091867446899414, "kl": 0.01948155090212822, "policy_loss": -0.005124475806951523, "cur_kl_coeff": 0.02500000223517418}}, "episode_reward_mean": 1058.3784001280746, "timesteps_this_iter": 42686, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9a58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9eb8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-21-52", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 73.94468718568375}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1411.3803119331997, "node_ip": "10.138.0.2", "timesteps_total": 2408257, "iterations_since_restore": 53, "custom_metrics": {"cost1_max": 494.5619982151271, "cost1_min": 29.21049711545078, "system_level_velocity_mean": 15.682147058842595, "outflow_rate_max": 1452.677441036887, "cost1_mean": 368.79816474243984, "outflow_rate_min": 325.2200543648311, "system_level_velocity_max": 20.087921294501733, "system_level_velocity_min": 12.893817502028659, "cost2_max": -15.999914985323839, "cost2_mean": -107.14826549367399, "outflow_rate_mean": 1116.2031018238922, "cost2_min": -146.4054722740634}, "training_iteration": 53, "episodes_total": 783, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206540, "time_total_s": 1465.3118886947632, "episode_len_mean": 646.46, "pid": 32002, "time_since_restore": 1465.3118886947632, "time_this_iter_s": 27.5329327583313, "timesteps_since_restore": 2408257, "info": {"num_steps_trained": 2408257, "load_time_ms": 13.983, "num_steps_sampled": 2408257, "grad_time_ms": 10108.804, "sample_time_ms": 16551.205, "update_time_ms": 8.168, "default": {"vf_explained_var": 0.9638893604278564, "vf_loss": 12.14068603515625, "entropy": 1.1536362171173096, "cur_lr": 0.0005000000237487257, "total_loss": 12.137088775634766, "kl": 0.017452189698815346, "policy_loss": -0.004033888690173626, "cur_kl_coeff": 0.02500000409781933}}, "episode_reward_mean": 1054.6075927525985, "timesteps_this_iter": 43946, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cddd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cda58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd898>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-22-20", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 54.865502253805566}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1351.5568743298204, "node_ip": "10.138.0.2", "timesteps_total": 2451630, "iterations_since_restore": 54, "custom_metrics": {"cost1_max": 481.2785988701214, "cost1_min": 29.21049711545078, "system_level_velocity_mean": 15.432700993129854, "outflow_rate_max": 1452.677441036887, "cost1_mean": 365.79388377457843, "outflow_rate_min": 325.2200543648311, "system_level_velocity_max": 20.087921294501733, "system_level_velocity_min": 12.477387260546244, "cost2_max": -15.999914985323839, "cost2_mean": -108.46326654588853, "outflow_rate_mean": 1112.0572409310587, "cost2_min": -145.86580557521543}, "training_iteration": 54, "episodes_total": 799, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206567, "time_total_s": 1492.5176358222961, "episode_len_mean": 652.04, "pid": 32002, "time_since_restore": 1492.5176358222961, "time_this_iter_s": 27.20574712753296, "timesteps_since_restore": 2451630, "info": {"num_steps_trained": 2451630, "load_time_ms": 14.014, "num_steps_sampled": 2451630, "grad_time_ms": 10147.696, "sample_time_ms": 16528.88, "update_time_ms": 7.985, "default": {"vf_explained_var": 0.981460690498352, "vf_loss": 6.683094024658203, "entropy": 1.1280269622802734, "cur_lr": 0.0005000000237487257, "total_loss": 6.678458213806152, "kl": 0.01475886907428503, "policy_loss": -0.0050051272846758366, "cur_kl_coeff": 0.025000005960464478}}, "episode_reward_mean": 1056.9948107093726, "timesteps_this_iter": 43373, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cde80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd5f8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd2b0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-22-47", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 54.865502253805566}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1356.8285554373983, "node_ip": "10.138.0.2", "timesteps_total": 2493710, "iterations_since_restore": 55, "custom_metrics": {"cost1_max": 478.43657022765876, "cost1_min": 29.21049711545078, "system_level_velocity_mean": 15.392745932315123, "outflow_rate_max": 1393.1141393692344, "cost1_mean": 364.0171014490905, "outflow_rate_min": 325.2200543648311, "system_level_velocity_max": 20.09635563178421, "system_level_velocity_min": 12.477387260546244, "cost2_max": -15.999914985323839, "cost2_mean": -109.40768320118057, "outflow_rate_mean": 1108.8974096527643, "cost2_min": -145.86580557521543}, "training_iteration": 55, "episodes_total": 814, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206593, "time_total_s": 1517.8180363178253, "episode_len_mean": 652.01, "pid": 32002, "time_since_restore": 1517.8180363178253, "time_this_iter_s": 25.300400495529175, "timesteps_since_restore": 2493710, "info": {"num_steps_trained": 2493710, "load_time_ms": 13.858, "num_steps_sampled": 2493710, "grad_time_ms": 10064.25, "sample_time_ms": 16587.619, "update_time_ms": 8.205, "default": {"vf_explained_var": 0.9748513102531433, "vf_loss": 9.479284286499023, "entropy": 1.1292082071304321, "cur_lr": 0.0005000000237487257, "total_loss": 9.474456787109375, "kl": 0.017060138285160065, "policy_loss": -0.005254353862255812, "cur_kl_coeff": 0.02500000223517418}}, "episode_reward_mean": 1047.0228171459253, "timesteps_this_iter": 42080, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d18d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d19e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d12b0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-23-13", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 54.865502253805566}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1356.8285554373983, "node_ip": "10.138.0.2", "timesteps_total": 2537010, "iterations_since_restore": 56, "custom_metrics": {"cost1_max": 487.6351337862783, "cost1_min": 29.21049711545078, "system_level_velocity_mean": 15.498754005529145, "outflow_rate_max": 1393.1141393692344, "cost1_mean": 363.0697818373013, "outflow_rate_min": 325.2200543648311, "system_level_velocity_max": 20.09635563178421, "system_level_velocity_min": 12.477387260546244, "cost2_max": -15.999914985323839, "cost2_mean": -109.8465236350122, "outflow_rate_mean": 1107.5313618905568, "cost2_min": -145.86580557521543}, "training_iteration": 56, "episodes_total": 830, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206619, "time_total_s": 1544.3260831832886, "episode_len_mean": 647.32, "pid": 32002, "time_since_restore": 1544.3260831832886, "time_this_iter_s": 26.508046865463257, "timesteps_since_restore": 2537010, "info": {"num_steps_trained": 2537010, "load_time_ms": 14.335, "num_steps_sampled": 2537010, "grad_time_ms": 9989.52, "sample_time_ms": 16649.44, "update_time_ms": 8.437, "default": {"vf_explained_var": 0.9686763882637024, "vf_loss": 11.737003326416016, "entropy": 1.0938801765441895, "cur_lr": 0.0005000000237487257, "total_loss": 11.73245620727539, "kl": 0.019544808194041252, "policy_loss": -0.005034949164837599, "cur_kl_coeff": 0.025000005960464478}}, "episode_reward_mean": 1033.9731461618226, "timesteps_this_iter": 43300, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd2e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9dd8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-23-39", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 54.865502253805566}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1356.8285554373983, "node_ip": "10.138.0.2", "timesteps_total": 2580065, "iterations_since_restore": 57, "custom_metrics": {"cost1_max": 487.6351337862783, "cost1_min": 29.21049711545078, "system_level_velocity_mean": 15.638515171803624, "outflow_rate_max": 1421.4928425265718, "cost1_mean": 373.44403969660505, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.09635563178421, "system_level_velocity_min": 12.477387260546244, "cost2_max": -15.999914985323839, "cost2_mean": -112.51626709788545, "outflow_rate_mean": 1133.062817720417, "cost2_min": -145.86580557521543}, "training_iteration": 57, "episodes_total": 846, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206644, "time_total_s": 1569.5727190971375, "episode_len_mean": 657.05, "pid": 32002, "time_since_restore": 1569.5727190971375, "time_this_iter_s": 25.246635913848877, "timesteps_since_restore": 2580065, "info": {"num_steps_trained": 2580065, "load_time_ms": 14.136, "num_steps_sampled": 2580065, "grad_time_ms": 9958.2, "sample_time_ms": 16638.097, "update_time_ms": 8.194, "default": {"vf_explained_var": 0.9743605852127075, "vf_loss": 10.370367050170898, "entropy": 1.0912103652954102, "cur_lr": 0.0005000000237487257, "total_loss": 10.366798400878906, "kl": 0.017054865136742592, "policy_loss": -0.00399510795250535, "cur_kl_coeff": 0.02500000409781933}}, "episode_reward_mean": 1060.6661570774036, "timesteps_this_iter": 43055, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d13c8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1048>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-24-04", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 54.865502253805566}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1416.518771564015, "node_ip": "10.138.0.2", "timesteps_total": 2622004, "iterations_since_restore": 58, "custom_metrics": {"cost1_max": 495.0277429945003, "cost1_min": 29.21049711545078, "system_level_velocity_mean": 15.819678454114921, "outflow_rate_max": 1470.7156145152544, "cost1_mean": 370.9542452044256, "outflow_rate_min": 308.80706590232967, "system_level_velocity_max": 20.09635563178421, "system_level_velocity_min": 12.477387260546244, "cost2_max": -11.7100382491117, "cost2_mean": -113.83557390370169, "outflow_rate_mean": 1127.8164017599604, "cost2_min": -145.87910049586895}, "training_iteration": 58, "episodes_total": 865, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206670, "time_total_s": 1595.6271123886108, "episode_len_mean": 647.41, "pid": 32002, "time_since_restore": 1595.6271123886108, "time_this_iter_s": 26.05439329147339, "timesteps_since_restore": 2622004, "info": {"num_steps_trained": 2622004, "load_time_ms": 14.088, "num_steps_sampled": 2622004, "grad_time_ms": 9977.045, "sample_time_ms": 16728.727, "update_time_ms": 8.089, "default": {"vf_explained_var": 0.9650306701660156, "vf_loss": 13.024195671081543, "entropy": 1.1207609176635742, "cur_lr": 0.0005000000237487257, "total_loss": 13.019059181213379, "kl": 0.021591326221823692, "policy_loss": -0.0056768967770040035, "cur_kl_coeff": 0.02500000409781933}}, "episode_reward_mean": 1051.2545224556366, "timesteps_this_iter": 41939, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdd30>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd5f8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-24-30", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 54.865502253805566}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1416.518771564015, "node_ip": "10.138.0.2", "timesteps_total": 2667116, "iterations_since_restore": 59, "custom_metrics": {"cost1_max": 495.0277429945003, "cost1_min": 30.904035618389305, "system_level_velocity_mean": 15.711819259513959, "outflow_rate_max": 1470.7156145152544, "cost1_mean": 381.96195200773536, "outflow_rate_min": 308.80706590232967, "system_level_velocity_max": 20.09635563178421, "system_level_velocity_min": 12.477387260546244, "cost2_max": -11.7100382491117, "cost2_mean": -116.27732581796958, "outflow_rate_mean": 1153.5630429335702, "cost2_min": -148.42163554332183}, "training_iteration": 59, "episodes_total": 880, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206697, "time_total_s": 1622.0271153450012, "episode_len_mean": 666.25, "pid": 32002, "time_since_restore": 1622.0271153450012, "time_this_iter_s": 26.40000295639038, "timesteps_since_restore": 2667116, "info": {"num_steps_trained": 2667116, "load_time_ms": 13.739, "num_steps_sampled": 2667116, "grad_time_ms": 9937.908, "sample_time_ms": 16639.544, "update_time_ms": 8.112, "default": {"vf_explained_var": 0.976710855960846, "vf_loss": 6.566707134246826, "entropy": 1.132484793663025, "cur_lr": 0.0005000000237487257, "total_loss": 6.561323642730713, "kl": 0.01746991090476513, "policy_loss": -0.0060391356237232685, "cur_kl_coeff": 0.03749999776482582}}, "episode_reward_mean": 1088.5335959423626, "timesteps_this_iter": 45112, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d12b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1860>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1908>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-24-57", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 56.273094162137674}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1416.518771564015, "node_ip": "10.138.0.2", "timesteps_total": 2711607, "iterations_since_restore": 60, "custom_metrics": {"cost1_max": 495.0277429945003, "cost1_min": 30.904035618389305, "system_level_velocity_mean": 15.718726927002908, "outflow_rate_max": 1470.7156145152544, "cost1_mean": 381.93333424477305, "outflow_rate_min": 308.80706590232967, "system_level_velocity_max": 20.09635563178421, "system_level_velocity_min": 12.82743380410138, "cost2_max": -11.7100382491117, "cost2_mean": -115.74310401946866, "outflow_rate_mean": 1152.726887387296, "cost2_min": -148.42163554332183}, "training_iteration": 60, "episodes_total": 890, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206723, "time_total_s": 1648.2033393383026, "episode_len_mean": 666.25, "pid": 32002, "time_since_restore": 1648.2033393383026, "time_this_iter_s": 26.17622399330139, "timesteps_since_restore": 2711607, "info": {"num_steps_trained": 2711607, "load_time_ms": 13.979, "num_steps_sampled": 2711607, "grad_time_ms": 9808.422, "sample_time_ms": 16511.102, "update_time_ms": 7.843, "default": {"vf_explained_var": 0.9830812215805054, "vf_loss": 5.96110200881958, "entropy": 1.1175457239151, "cur_lr": 0.0005000000237487257, "total_loss": 5.955567836761475, "kl": 0.019745666533708572, "policy_loss": -0.006274215877056122, "cur_kl_coeff": 0.03749999776482582}}, "episode_reward_mean": 1084.5147021113874, "timesteps_this_iter": 44491, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7cf8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7ba8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-25-23", "hostname": "flow-main", "episodes_this_iter": 10, "episode_reward_min": 56.273094162137674}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1416.518771564015, "node_ip": "10.138.0.2", "timesteps_total": 2755677, "iterations_since_restore": 61, "custom_metrics": {"cost1_max": 495.0277429945003, "cost1_min": 30.904035618389305, "system_level_velocity_mean": 15.689806791110447, "outflow_rate_max": 1470.7156145152544, "cost1_mean": 385.7427573202578, "outflow_rate_min": 308.80706590232967, "system_level_velocity_max": 19.943223384707153, "system_level_velocity_min": 12.82743380410138, "cost2_max": -11.7100382491117, "cost2_mean": -116.73549641232036, "outflow_rate_mean": 1161.6960547268675, "cost2_min": -148.42163554332183}, "training_iteration": 61, "episodes_total": 908, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206748, "time_total_s": 1673.4405362606049, "episode_len_mean": 671.89, "pid": 32002, "time_since_restore": 1673.4405362606049, "time_this_iter_s": 25.237196922302246, "timesteps_since_restore": 2755677, "info": {"num_steps_trained": 2755677, "load_time_ms": 14.018, "num_steps_sampled": 2755677, "grad_time_ms": 9773.846, "sample_time_ms": 16317.933, "update_time_ms": 7.668, "default": {"vf_explained_var": 0.9801996946334839, "vf_loss": 7.009777545928955, "entropy": 1.1323736906051636, "cur_lr": 0.0005000000237487257, "total_loss": 7.005492687225342, "kl": 0.017008258029818535, "policy_loss": -0.004922566469758749, "cur_kl_coeff": 0.03749999776482582}}, "episode_reward_mean": 1092.4800274102981, "timesteps_this_iter": 44070, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d13c8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-25-48", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 56.273094162137674}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1416.518771564015, "node_ip": "10.138.0.2", "timesteps_total": 2798789, "iterations_since_restore": 62, "custom_metrics": {"cost1_max": 495.0277429945003, "cost1_min": 30.904035618389305, "system_level_velocity_mean": 15.33229625303684, "outflow_rate_max": 1470.7156145152544, "cost1_mean": 384.5259460908468, "outflow_rate_min": 308.80706590232967, "system_level_velocity_max": 19.739177737683818, "system_level_velocity_min": 12.625595977504846, "cost2_max": -11.7100382491117, "cost2_mean": -116.42894144101923, "outflow_rate_mean": 1163.086794739107, "cost2_min": -148.42163554332183}, "training_iteration": 62, "episodes_total": 926, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206776, "time_total_s": 1700.7625064849854, "episode_len_mean": 681.89, "pid": 32002, "time_since_restore": 1700.7625064849854, "time_this_iter_s": 27.321970224380493, "timesteps_since_restore": 2798789, "info": {"num_steps_trained": 2798789, "load_time_ms": 14.321, "num_steps_sampled": 2798789, "grad_time_ms": 9857.342, "sample_time_ms": 16328.346, "update_time_ms": 7.726, "default": {"vf_explained_var": 0.978699803352356, "vf_loss": 8.45568561553955, "entropy": 1.1190366744995117, "cur_lr": 0.0005000000237487257, "total_loss": 8.450712203979492, "kl": 0.018978096544742584, "policy_loss": -0.005685255862772465, "cur_kl_coeff": 0.03749999403953552}}, "episode_reward_mean": 1117.3024698498905, "timesteps_this_iter": 43112, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b90f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9ef0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b90b8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-26-16", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 56.273094162137674}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1467.6984016986526, "node_ip": "10.138.0.2", "timesteps_total": 2842632, "iterations_since_restore": 63, "custom_metrics": {"cost1_max": 495.0277429945003, "cost1_min": 30.904035618389305, "system_level_velocity_mean": 15.248163778804823, "outflow_rate_max": 1470.7156145152544, "cost1_mean": 384.6001374598651, "outflow_rate_min": 308.80706590232967, "system_level_velocity_max": 19.739177737683818, "system_level_velocity_min": 12.625595977504846, "cost2_max": -11.7100382491117, "cost2_mean": -114.05779324683084, "outflow_rate_mean": 1162.433717361208, "cost2_min": -148.42163554332183}, "training_iteration": 63, "episodes_total": 937, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206803, "time_total_s": 1727.7673125267029, "episode_len_mean": 684.54, "pid": 32002, "time_since_restore": 1727.7673125267029, "time_this_iter_s": 27.00480604171753, "timesteps_since_restore": 2842632, "info": {"num_steps_trained": 2842632, "load_time_ms": 14.79, "num_steps_sampled": 2842632, "grad_time_ms": 9899.986, "sample_time_ms": 16231.325, "update_time_ms": 7.741, "default": {"vf_explained_var": 0.9772170186042786, "vf_loss": 7.444100379943848, "entropy": 1.1195905208587646, "cur_lr": 0.0005000000237487257, "total_loss": 7.440507411956787, "kl": 0.014942930079996586, "policy_loss": -0.004152968525886536, "cur_kl_coeff": 0.03749999403953552}}, "episode_reward_mean": 1125.8943966252664, "timesteps_this_iter": 43843, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1a20>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-26-43", "hostname": "flow-main", "episodes_this_iter": 11, "episode_reward_min": 56.273094162137674}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1467.6984016986526, "node_ip": "10.138.0.2", "timesteps_total": 2887558, "iterations_since_restore": 64, "custom_metrics": {"cost1_max": 495.0277429945003, "cost1_min": 146.53829499814967, "system_level_velocity_mean": 15.171698052680858, "outflow_rate_max": 1470.7156145152544, "cost1_mean": 381.5095185543616, "outflow_rate_min": 580.2920291428059, "system_level_velocity_max": 19.739177737683818, "system_level_velocity_min": 12.625595977504846, "cost2_max": -49.28711686023482, "cost2_mean": -112.18473901831521, "outflow_rate_mean": 1155.2825848124567, "cost2_min": -148.42163554332183}, "training_iteration": 64, "episodes_total": 954, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206829, "time_total_s": 1754.1889081001282, "episode_len_mean": 681.9, "pid": 32002, "time_since_restore": 1754.1889081001282, "time_this_iter_s": 26.421595573425293, "timesteps_since_restore": 2887558, "info": {"num_steps_trained": 2887558, "load_time_ms": 14.913, "num_steps_sampled": 2887558, "grad_time_ms": 9876.469, "sample_time_ms": 16174.662, "update_time_ms": 7.759, "default": {"vf_explained_var": 0.9719379544258118, "vf_loss": 10.03284740447998, "entropy": 1.0996639728546143, "cur_lr": 0.0005000000237487257, "total_loss": 10.028854370117188, "kl": 0.018139837309718132, "policy_loss": -0.004673508927226067, "cur_kl_coeff": 0.03749999403953552}}, "episode_reward_mean": 1122.045071824043, "timesteps_this_iter": 44926, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cde10>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd630>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-27-09", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 370.3452661335091}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1467.6984016986526, "node_ip": "10.138.0.2", "timesteps_total": 2930668, "iterations_since_restore": 65, "custom_metrics": {"cost1_max": 485.46385902305127, "cost1_min": 104.02923243926142, "system_level_velocity_mean": 15.028217841067534, "outflow_rate_max": 1417.540818217521, "cost1_mean": 379.9472510474295, "outflow_rate_min": 461.9696232056455, "system_level_velocity_max": 19.74353925646573, "system_level_velocity_min": 12.625595977504846, "cost2_max": -31.8360444063226, "cost2_mean": -108.67692471451585, "outflow_rate_mean": 1150.6328556059282, "cost2_min": -148.42163554332183}, "training_iteration": 65, "episodes_total": 972, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206855, "time_total_s": 1779.811326265335, "episode_len_mean": 685.25, "pid": 32002, "time_since_restore": 1779.811326265335, "time_this_iter_s": 25.62241816520691, "timesteps_since_restore": 2930668, "info": {"num_steps_trained": 2930668, "load_time_ms": 14.969, "num_steps_sampled": 2930668, "grad_time_ms": 9958.067, "sample_time_ms": 16127.652, "update_time_ms": 7.83, "default": {"vf_explained_var": 0.9782818555831909, "vf_loss": 9.269728660583496, "entropy": 1.0960239171981812, "cur_lr": 0.0005000000237487257, "total_loss": 9.264026641845703, "kl": 0.018962835893034935, "policy_loss": -0.006412466522306204, "cur_kl_coeff": 0.03749999403953552}}, "episode_reward_mean": 1107.9387872193606, "timesteps_this_iter": 43110, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1400>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1320>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-27-35", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 252.64794627277172}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1473.5883161020831, "node_ip": "10.138.0.2", "timesteps_total": 2972181, "iterations_since_restore": 66, "custom_metrics": {"cost1_max": 527.7576584499488, "cost1_min": 104.02923243926142, "system_level_velocity_mean": 15.272445646094623, "outflow_rate_max": 1432.5938416027084, "cost1_mean": 383.13557266404035, "outflow_rate_min": 461.9696232056455, "system_level_velocity_max": 20.049148401632102, "system_level_velocity_min": 12.138162490559774, "cost2_max": -31.8360444063226, "cost2_mean": -106.30301411714932, "outflow_rate_mean": 1155.1502822979394, "cost2_min": -137.7545238086573}, "training_iteration": 66, "episodes_total": 989, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206880, "time_total_s": 1804.7641139030457, "episode_len_mean": 680.26, "pid": 32002, "time_since_restore": 1804.7641139030457, "time_this_iter_s": 24.95278763771057, "timesteps_since_restore": 2972181, "info": {"num_steps_trained": 2972181, "load_time_ms": 15.005, "num_steps_sampled": 2972181, "grad_time_ms": 10010.828, "sample_time_ms": 15918.446, "update_time_ms": 7.653, "default": {"vf_explained_var": 0.9726401567459106, "vf_loss": 11.718985557556152, "entropy": 1.0820955038070679, "cur_lr": 0.0005000000237487257, "total_loss": 11.715312004089355, "kl": 0.020987505093216896, "policy_loss": -0.004461248405277729, "cur_kl_coeff": 0.03749999403953552}}, "episode_reward_mean": 1114.1897748127296, "timesteps_this_iter": 41513, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c15f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c17f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1fd0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-28-00", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 252.64794627277172}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1473.5883161020831, "node_ip": "10.138.0.2", "timesteps_total": 3016944, "iterations_since_restore": 67, "custom_metrics": {"cost1_max": 527.7576584499488, "cost1_min": 96.00255840974992, "system_level_velocity_mean": 15.211871397211466, "outflow_rate_max": 1432.5938416027084, "cost1_mean": 377.38567429712236, "outflow_rate_min": 441.6661572198458, "system_level_velocity_max": 20.049148401632102, "system_level_velocity_min": 12.138162490559774, "cost2_max": -28.856969780588024, "cost2_mean": -105.16196146281592, "outflow_rate_mean": 1144.2981650430393, "cost2_min": -142.6792581611004}, "training_iteration": 67, "episodes_total": 1005, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206907, "time_total_s": 1831.699077129364, "episode_len_mean": 674.63, "pid": 32002, "time_since_restore": 1831.699077129364, "time_this_iter_s": 26.93496322631836, "timesteps_since_restore": 3016944, "info": {"num_steps_trained": 3016944, "load_time_ms": 15.306, "num_steps_sampled": 3016944, "grad_time_ms": 10119.831, "sample_time_ms": 15977.604, "update_time_ms": 7.853, "default": {"vf_explained_var": 0.9756608605384827, "vf_loss": 8.676127433776855, "entropy": 1.108897089958191, "cur_lr": 0.0005000000237487257, "total_loss": 8.67164134979248, "kl": 0.017567550763487816, "policy_loss": -0.005474671721458435, "cur_kl_coeff": 0.05624999478459358}}, "episode_reward_mean": 1103.6353635164567, "timesteps_this_iter": 44763, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d14a8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d14e0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-28-27", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 239.5485877590285}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1473.5883161020831, "node_ip": "10.138.0.2", "timesteps_total": 3061884, "iterations_since_restore": 68, "custom_metrics": {"cost1_max": 527.7576584499488, "cost1_min": 96.00255840974992, "system_level_velocity_mean": 15.329814843662907, "outflow_rate_max": 1432.5938416027084, "cost1_mean": 380.4786201088922, "outflow_rate_min": 441.6661572198458, "system_level_velocity_max": 20.049148401632102, "system_level_velocity_min": 12.138162490559774, "cost2_max": -28.856969780588024, "cost2_mean": -104.00133332577956, "outflow_rate_mean": 1147.2329257251097, "cost2_min": -142.6792581611004}, "training_iteration": 68, "episodes_total": 1015, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206932, "time_total_s": 1857.3151967525482, "episode_len_mean": 674.63, "pid": 32002, "time_since_restore": 1857.3151967525482, "time_this_iter_s": 25.616119623184204, "timesteps_since_restore": 3061884, "info": {"num_steps_trained": 3061884, "load_time_ms": 15.622, "num_steps_sampled": 3061884, "grad_time_ms": 10229.711, "sample_time_ms": 15822.067, "update_time_ms": 7.801, "default": {"vf_explained_var": 0.9849591851234436, "vf_loss": 5.549887657165527, "entropy": 1.1006940603256226, "cur_lr": 0.0005000000237487257, "total_loss": 5.547181606292725, "kl": 0.014621256850659847, "policy_loss": -0.0035283053293824196, "cur_kl_coeff": 0.05625000596046448}}, "episode_reward_mean": 1101.249720189259, "timesteps_this_iter": 44940, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd5c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd8d0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-28-52", "hostname": "flow-main", "episodes_this_iter": 10, "episode_reward_min": 239.5485877590285}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1473.5883161020831, "node_ip": "10.138.0.2", "timesteps_total": 3106053, "iterations_since_restore": 69, "custom_metrics": {"cost1_max": 527.7576584499488, "cost1_min": 33.25241828568305, "system_level_velocity_mean": 15.476827159370306, "outflow_rate_max": 1432.5938416027084, "cost1_mean": 371.81838017176915, "outflow_rate_min": 320.0023115965836, "system_level_velocity_max": 20.049148401632102, "system_level_velocity_min": 12.138162490559774, "cost2_max": -25.336208475178413, "cost2_mean": -104.02322277092863, "outflow_rate_mean": 1126.7138814118102, "cost2_min": -142.6792581611004}, "training_iteration": 69, "episodes_total": 1035, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206958, "time_total_s": 1883.1572740077972, "episode_len_mean": 658.66, "pid": 32002, "time_since_restore": 1883.1572740077972, "time_this_iter_s": 25.842077255249023, "timesteps_since_restore": 3106053, "info": {"num_steps_trained": 3106053, "load_time_ms": 15.859, "num_steps_sampled": 3106053, "grad_time_ms": 10311.796, "sample_time_ms": 15682.738, "update_time_ms": 7.852, "default": {"vf_explained_var": 0.9692376852035522, "vf_loss": 11.897610664367676, "entropy": 1.1014716625213623, "cur_lr": 0.0005000000237487257, "total_loss": 11.892990112304688, "kl": 0.018282726407051086, "policy_loss": -0.0056503391824662685, "cur_kl_coeff": 0.05624999850988388}}, "episode_reward_mean": 1066.941630418574, "timesteps_this_iter": 44169, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa7b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa978>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-29-18", "hostname": "flow-main", "episodes_this_iter": 20, "episode_reward_min": 65.566801905459}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1473.5883161020831, "node_ip": "10.138.0.2", "timesteps_total": 3147435, "iterations_since_restore": 70, "custom_metrics": {"cost1_max": 527.7576584499488, "cost1_min": 33.25241828568305, "system_level_velocity_mean": 15.512800402429265, "outflow_rate_max": 1432.5938416027084, "cost1_mean": 374.8315854585755, "outflow_rate_min": 320.0023115965836, "system_level_velocity_max": 20.049148401632102, "system_level_velocity_min": 12.138162490559774, "cost2_max": -25.336208475178413, "cost2_mean": -105.85256493518115, "outflow_rate_mean": 1130.1770356705913, "cost2_min": -142.6792581611004}, "training_iteration": 70, "episodes_total": 1053, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557206984, "time_total_s": 1908.941078901291, "episode_len_mean": 662.86, "pid": 32002, "time_since_restore": 1908.941078901291, "time_this_iter_s": 25.783804893493652, "timesteps_since_restore": 3147435, "info": {"num_steps_trained": 3147435, "load_time_ms": 15.334, "num_steps_sampled": 3147435, "grad_time_ms": 10316.76, "sample_time_ms": 15641.642, "update_time_ms": 8.089, "default": {"vf_explained_var": 0.9812676906585693, "vf_loss": 8.343060493469238, "entropy": 1.0990196466445923, "cur_lr": 0.0005000000237487257, "total_loss": 8.3362455368042, "kl": 0.018824631348252296, "policy_loss": -0.00787406973540783, "cur_kl_coeff": 0.05625000223517418}}, "episode_reward_mean": 1067.7777194631576, "timesteps_this_iter": 41382, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9278>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9080>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-29-44", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 65.566801905459}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1473.5883161020831, "node_ip": "10.138.0.2", "timesteps_total": 3191061, "iterations_since_restore": 71, "custom_metrics": {"cost1_max": 527.7576584499488, "cost1_min": 33.25241828568305, "system_level_velocity_mean": 15.495950790297927, "outflow_rate_max": 1432.5938416027084, "cost1_mean": 378.39018296845165, "outflow_rate_min": 320.0023115965836, "system_level_velocity_max": 20.049148401632102, "system_level_velocity_min": 12.138162490559774, "cost2_max": -25.336208475178413, "cost2_mean": -107.13362013466138, "outflow_rate_mean": 1137.7359916589103, "cost2_min": -142.6792581611004}, "training_iteration": 71, "episodes_total": 1066, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207011, "time_total_s": 1935.3348603248596, "episode_len_mean": 668.42, "pid": 32002, "time_since_restore": 1935.3348603248596, "time_this_iter_s": 26.393781423568726, "timesteps_since_restore": 3191061, "info": {"num_steps_trained": 3191061, "load_time_ms": 15.377, "num_steps_sampled": 3191061, "grad_time_ms": 10417.231, "sample_time_ms": 15657.185, "update_time_ms": 8.355, "default": {"vf_explained_var": 0.9851688146591187, "vf_loss": 4.9748687744140625, "entropy": 1.119729995727539, "cur_lr": 0.0005000000237487257, "total_loss": 4.9680047035217285, "kl": 0.019302085041999817, "policy_loss": -0.007949733175337315, "cur_kl_coeff": 0.05624999850988388}}, "episode_reward_mean": 1075.6084064689855, "timesteps_this_iter": 43626, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1be0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d17b8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-30-11", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 65.566801905459}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1473.5883161020831, "node_ip": "10.138.0.2", "timesteps_total": 3233494, "iterations_since_restore": 72, "custom_metrics": {"cost1_max": 485.0139591520093, "cost1_min": 33.25241828568305, "system_level_velocity_mean": 15.590380468934152, "outflow_rate_max": 1432.5938416027084, "cost1_mean": 372.7653063977873, "outflow_rate_min": 320.0023115965836, "system_level_velocity_max": 20.2368749828887, "system_level_velocity_min": 12.59421974672099, "cost2_max": -25.336208475178413, "cost2_mean": -106.89973608048807, "outflow_rate_mean": 1125.4543951196354, "cost2_min": -142.6792581611004}, "training_iteration": 72, "episodes_total": 1085, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207035, "time_total_s": 1960.0280857086182, "episode_len_mean": 657.34, "pid": 32002, "time_since_restore": 1960.0280857086182, "time_this_iter_s": 24.693225383758545, "timesteps_since_restore": 3233494, "info": {"num_steps_trained": 3233494, "load_time_ms": 15.131, "num_steps_sampled": 3233494, "grad_time_ms": 10364.534, "sample_time_ms": 15444.603, "update_time_ms": 8.383, "default": {"vf_explained_var": 0.9695156812667847, "vf_loss": 13.486522674560547, "entropy": 1.097055196762085, "cur_lr": 0.0005000000237487257, "total_loss": 13.482510566711426, "kl": 0.01956050843000412, "policy_loss": -0.005113612860441208, "cur_kl_coeff": 0.05624999850988388}}, "episode_reward_mean": 1065.1860523600703, "timesteps_this_iter": 42433, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d10f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1d68>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d10b8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-30-35", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 65.566801905459}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1358.8681240666626, "node_ip": "10.138.0.2", "timesteps_total": 3277646, "iterations_since_restore": 73, "custom_metrics": {"cost1_max": 504.8456468594684, "cost1_min": 33.25241828568305, "system_level_velocity_mean": 15.626686459667292, "outflow_rate_max": 1466.55854212067, "cost1_mean": 377.2665546641142, "outflow_rate_min": 320.0023115965836, "system_level_velocity_max": 20.2368749828887, "system_level_velocity_min": 12.59421974672099, "cost2_max": -25.336208475178413, "cost2_mean": -108.32748433299359, "outflow_rate_mean": 1135.595337642788, "cost2_min": -140.31213700018492}, "training_iteration": 73, "episodes_total": 1097, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207061, "time_total_s": 1985.8576765060425, "episode_len_mean": 662.97, "pid": 32002, "time_since_restore": 1985.8576765060425, "time_this_iter_s": 25.829590797424316, "timesteps_since_restore": 3277646, "info": {"num_steps_trained": 3277646, "load_time_ms": 14.787, "num_steps_sampled": 3277646, "grad_time_ms": 10399.178, "sample_time_ms": 15293.601, "update_time_ms": 8.468, "default": {"vf_explained_var": 0.9817904233932495, "vf_loss": 6.9600701332092285, "entropy": 1.1232956647872925, "cur_lr": 0.0005000000237487257, "total_loss": 6.955381870269775, "kl": 0.022495077922940254, "policy_loss": -0.00595387676730752, "cur_kl_coeff": 0.05624999478459358}}, "episode_reward_mean": 1070.5686229767273, "timesteps_this_iter": 44152, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7208>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aafd0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-31-01", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 65.566801905459}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1350.803871228706, "node_ip": "10.138.0.2", "timesteps_total": 3321126, "iterations_since_restore": 74, "custom_metrics": {"cost1_max": 504.8456468594684, "cost1_min": 33.25241828568305, "system_level_velocity_mean": 15.683609688279953, "outflow_rate_max": 1466.55854212067, "cost1_mean": 373.9186947950086, "outflow_rate_min": 320.0023115965836, "system_level_velocity_max": 20.2368749828887, "system_level_velocity_min": 12.59421974672099, "cost2_max": -25.336208475178413, "cost2_mean": -108.49435807047135, "outflow_rate_mean": 1127.8946035268093, "cost2_min": -141.03918177255616}, "training_iteration": 74, "episodes_total": 1115, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207088, "time_total_s": 2012.448246717453, "episode_len_mean": 657.56, "pid": 32002, "time_since_restore": 2012.448246717453, "time_this_iter_s": 26.590570211410522, "timesteps_since_restore": 3321126, "info": {"num_steps_trained": 3321126, "load_time_ms": 14.681, "num_steps_sampled": 3321126, "grad_time_ms": 10364.843, "sample_time_ms": 15344.498, "update_time_ms": 8.714, "default": {"vf_explained_var": 0.9774345755577087, "vf_loss": 8.816261291503906, "entropy": 1.1337872743606567, "cur_lr": 0.0005000000237487257, "total_loss": 8.81033706665039, "kl": 0.018010199069976807, "policy_loss": -0.0074440594762563705, "cur_kl_coeff": 0.08437501639127731}}, "episode_reward_mean": 1054.057290415698, "timesteps_this_iter": 43480, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4cc0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9f60>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-31-28", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 65.566801905459}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1339.0781879709227, "node_ip": "10.138.0.2", "timesteps_total": 3364220, "iterations_since_restore": 75, "custom_metrics": {"cost1_max": 504.8456468594684, "cost1_min": 91.0979171397519, "system_level_velocity_mean": 15.558856924033746, "outflow_rate_max": 1475.574567978413, "cost1_mean": 378.1633765893788, "outflow_rate_min": 422.6413324582012, "system_level_velocity_max": 20.2368749828887, "system_level_velocity_min": 12.592224624482848, "cost2_max": -32.796620874118744, "cost2_mean": -110.68709564397776, "outflow_rate_mean": 1141.0194373127138, "cost2_min": -141.03918177255616}, "training_iteration": 75, "episodes_total": 1133, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207115, "time_total_s": 2039.4817626476288, "episode_len_mean": 668.08, "pid": 32002, "time_since_restore": 2039.4817626476288, "time_this_iter_s": 27.03351593017578, "timesteps_since_restore": 3364220, "info": {"num_steps_trained": 3364220, "load_time_ms": 14.59, "num_steps_sampled": 3364220, "grad_time_ms": 10375.063, "sample_time_ms": 15474.225, "update_time_ms": 8.774, "default": {"vf_explained_var": 0.9759069085121155, "vf_loss": 10.021459579467773, "entropy": 1.1257449388504028, "cur_lr": 0.0005000000237487257, "total_loss": 10.01677417755127, "kl": 0.016665630042552948, "policy_loss": -0.0060912747867405415, "cur_kl_coeff": 0.08437500894069672}}, "episode_reward_mean": 1069.7628185349815, "timesteps_this_iter": 43094, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c15c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9a90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c19b0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-31-55", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 213.32163245533016}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1335.4344786785402, "node_ip": "10.138.0.2", "timesteps_total": 3408655, "iterations_since_restore": 76, "custom_metrics": {"cost1_max": 504.8456468594684, "cost1_min": 91.0979171397519, "system_level_velocity_mean": 15.574188901912036, "outflow_rate_max": 1475.574567978413, "cost1_mean": 382.2515954779488, "outflow_rate_min": 422.6413324582012, "system_level_velocity_max": 20.2368749828887, "system_level_velocity_min": 12.592224624482848, "cost2_max": -32.796620874118744, "cost2_mean": -111.14229855135198, "outflow_rate_mean": 1151.6629279051033, "cost2_min": -141.03918177255616}, "training_iteration": 76, "episodes_total": 1144, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207141, "time_total_s": 2065.2050309181213, "episode_len_mean": 673.07, "pid": 32002, "time_since_restore": 2065.2050309181213, "time_this_iter_s": 25.723268270492554, "timesteps_since_restore": 3408655, "info": {"num_steps_trained": 3408655, "load_time_ms": 14.432, "num_steps_sampled": 3408655, "grad_time_ms": 10459.771, "sample_time_ms": 15466.879, "update_time_ms": 9.158, "default": {"vf_explained_var": 0.983638346195221, "vf_loss": 6.265161991119385, "entropy": 1.1266227960586548, "cur_lr": 0.0005000000237487257, "total_loss": 6.259471416473389, "kl": 0.018523460254073143, "policy_loss": -0.00725362217053771, "cur_kl_coeff": 0.08437501639127731}}, "episode_reward_mean": 1081.0804786895033, "timesteps_this_iter": 44435, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd9b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd898>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-32-21", "hostname": "flow-main", "episodes_this_iter": 11, "episode_reward_min": 213.32163245533016}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1335.4344786785402, "node_ip": "10.138.0.2", "timesteps_total": 3452678, "iterations_since_restore": 77, "custom_metrics": {"cost1_max": 504.8456468594684, "cost1_min": 76.78502854386214, "system_level_velocity_mean": 15.635876731902608, "outflow_rate_max": 1475.574567978413, "cost1_mean": 379.4569132804468, "outflow_rate_min": 409.39732213683595, "system_level_velocity_max": 20.2368749828887, "system_level_velocity_min": 12.592224624482848, "cost2_max": -32.796620874118744, "cost2_mean": -109.89678733934596, "outflow_rate_mean": 1146.7865327748193, "cost2_min": -141.03918177255616}, "training_iteration": 77, "episodes_total": 1164, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207167, "time_total_s": 2092.01176571846, "episode_len_mean": 667.14, "pid": 32002, "time_since_restore": 2092.01176571846, "time_this_iter_s": 26.806734800338745, "timesteps_since_restore": 3452678, "info": {"num_steps_trained": 3452678, "load_time_ms": 14.481, "num_steps_sampled": 3452678, "grad_time_ms": 10479.286, "sample_time_ms": 15432.03, "update_time_ms": 9.089, "default": {"vf_explained_var": 0.9780318140983582, "vf_loss": 9.17834186553955, "entropy": 1.1319981813430786, "cur_lr": 0.0005000000237487257, "total_loss": 9.17267894744873, "kl": 0.016320642083883286, "policy_loss": -0.007038719952106476, "cur_kl_coeff": 0.08437500894069672}}, "episode_reward_mean": 1072.8467212180904, "timesteps_this_iter": 44023, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689ee10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e630>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1080>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-32-47", "hostname": "flow-main", "episodes_this_iter": 20, "episode_reward_min": 160.85425834790692}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1442.6807395006135, "node_ip": "10.138.0.2", "timesteps_total": 3496784, "iterations_since_restore": 78, "custom_metrics": {"cost1_max": 504.8456468594684, "cost1_min": 76.78502854386214, "system_level_velocity_mean": 15.671593160902589, "outflow_rate_max": 1475.574567978413, "cost1_mean": 379.8734605959985, "outflow_rate_min": 409.39732213683595, "system_level_velocity_max": 20.2368749828887, "system_level_velocity_min": 12.592224624482848, "cost2_max": -32.796620874118744, "cost2_mean": -111.41621111090008, "outflow_rate_mean": 1148.5245032584335, "cost2_min": -141.03918177255616}, "training_iteration": 78, "episodes_total": 1178, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207194, "time_total_s": 2118.2311837673187, "episode_len_mean": 666.89, "pid": 32002, "time_since_restore": 2118.2311837673187, "time_this_iter_s": 26.219418048858643, "timesteps_since_restore": 3496784, "info": {"num_steps_trained": 3496784, "load_time_ms": 13.961, "num_steps_sampled": 3496784, "grad_time_ms": 10442.373, "sample_time_ms": 15530.094, "update_time_ms": 9.45, "default": {"vf_explained_var": 0.9757223129272461, "vf_loss": 9.766234397888184, "entropy": 1.1176295280456543, "cur_lr": 0.0005000000237487257, "total_loss": 9.760318756103516, "kl": 0.019757680594921112, "policy_loss": -0.00758164981380105, "cur_kl_coeff": 0.08437501639127731}}, "episode_reward_mean": 1073.8339084736353, "timesteps_this_iter": 44106, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd208>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd780>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-33-14", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 160.85425834790692}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1442.6807395006135, "node_ip": "10.138.0.2", "timesteps_total": 3540658, "iterations_since_restore": 79, "custom_metrics": {"cost1_max": 505.8869752957222, "cost1_min": 29.60303171419612, "system_level_velocity_mean": 15.533153312167979, "outflow_rate_max": 1475.574567978413, "cost1_mean": 378.8391997060363, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.51308926590014, "system_level_velocity_min": 12.592224624482848, "cost2_max": -20.381148989149494, "cost2_mean": -112.28785015286964, "outflow_rate_mean": 1146.70996448516, "cost2_min": -141.03918177255616}, "training_iteration": 79, "episodes_total": 1194, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207220, "time_total_s": 2144.547955751419, "episode_len_mean": 670.95, "pid": 32002, "time_since_restore": 2144.547955751419, "time_this_iter_s": 26.316771984100342, "timesteps_since_restore": 3540658, "info": {"num_steps_trained": 3540658, "load_time_ms": 13.711, "num_steps_sampled": 3540658, "grad_time_ms": 10386.727, "sample_time_ms": 15633.751, "update_time_ms": 9.486, "default": {"vf_explained_var": 0.9745424389839172, "vf_loss": 9.651192665100098, "entropy": 1.1112666130065918, "cur_lr": 0.0005000000237487257, "total_loss": 9.646848678588867, "kl": 0.01711965911090374, "policy_loss": -0.005788882728666067, "cur_kl_coeff": 0.08437501639127731}}, "episode_reward_mean": 1074.453077655201, "timesteps_this_iter": 43874, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d18d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d14e0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-33-40", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 55.18365554191015}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1442.6807395006135, "node_ip": "10.138.0.2", "timesteps_total": 3584937, "iterations_since_restore": 80, "custom_metrics": {"cost1_max": 505.8869752957222, "cost1_min": 29.60303171419612, "system_level_velocity_mean": 15.466478461273233, "outflow_rate_max": 1475.574567978413, "cost1_mean": 371.467149892975, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.51308926590014, "system_level_velocity_min": 12.592224624482848, "cost2_max": -20.381148989149494, "cost2_mean": -111.72087427517891, "outflow_rate_mean": 1127.1933242376506, "cost2_min": -140.96661403597338}, "training_iteration": 80, "episodes_total": 1212, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207246, "time_total_s": 2170.2520196437836, "episode_len_mean": 663.32, "pid": 32002, "time_since_restore": 2170.2520196437836, "time_this_iter_s": 25.704063892364502, "timesteps_since_restore": 3584937, "info": {"num_steps_trained": 3584937, "load_time_ms": 14.127, "num_steps_sampled": 3584937, "grad_time_ms": 10353.741, "sample_time_ms": 15659.489, "update_time_ms": 9.287, "default": {"vf_explained_var": 0.9668148159980774, "vf_loss": 12.107965469360352, "entropy": 1.1383389234542847, "cur_lr": 0.0005000000237487257, "total_loss": 12.100979804992676, "kl": 0.021357975900173187, "policy_loss": -0.008788343518972397, "cur_kl_coeff": 0.08437500894069672}}, "episode_reward_mean": 1058.8842147709397, "timesteps_this_iter": 44279, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd4e0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd6a0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-34-06", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 55.18365554191015}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1442.6807395006135, "node_ip": "10.138.0.2", "timesteps_total": 3628246, "iterations_since_restore": 81, "custom_metrics": {"cost1_max": 505.8869752957222, "cost1_min": 29.60303171419612, "system_level_velocity_mean": 15.432221574335449, "outflow_rate_max": 1474.9612085657106, "cost1_mean": 370.465684253335, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.51308926590014, "system_level_velocity_min": 11.8211528027935, "cost2_max": -20.381148989149494, "cost2_mean": -111.87227650028316, "outflow_rate_mean": 1122.178362499835, "cost2_min": -140.96661403597338}, "training_iteration": 81, "episodes_total": 1225, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207271, "time_total_s": 2195.185783624649, "episode_len_mean": 663.32, "pid": 32002, "time_since_restore": 2195.185783624649, "time_this_iter_s": 24.93376398086548, "timesteps_since_restore": 3628246, "info": {"num_steps_trained": 3628246, "load_time_ms": 14.118, "num_steps_sampled": 3628246, "grad_time_ms": 10257.245, "sample_time_ms": 15609.931, "update_time_ms": 9.069, "default": {"vf_explained_var": 0.9869265556335449, "vf_loss": 5.884625434875488, "entropy": 1.1142240762710571, "cur_lr": 0.0005000000237487257, "total_loss": 5.87988805770874, "kl": 0.015894751995801926, "policy_loss": -0.0067497482523322105, "cur_kl_coeff": 0.1265624761581421}}, "episode_reward_mean": 1055.2812913411012, "timesteps_this_iter": 43309, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d11d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1cf8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1c50>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-34-31", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 55.18365554191015}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1442.6807395006135, "node_ip": "10.138.0.2", "timesteps_total": 3670959, "iterations_since_restore": 82, "custom_metrics": {"cost1_max": 505.8869752957222, "cost1_min": 29.60303171419612, "system_level_velocity_mean": 15.644652253276513, "outflow_rate_max": 1474.9612085657106, "cost1_mean": 371.6744134457552, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.51308926590014, "system_level_velocity_min": 11.8211528027935, "cost2_max": -20.381148989149494, "cost2_mean": -112.29054842865955, "outflow_rate_mean": 1121.2959046760413, "cost2_min": -140.96661403597338}, "training_iteration": 82, "episodes_total": 1246, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207297, "time_total_s": 2221.458862543106, "episode_len_mean": 657.7, "pid": 32002, "time_since_restore": 2221.458862543106, "time_this_iter_s": 26.27307891845703, "timesteps_since_restore": 3670959, "info": {"num_steps_trained": 3670959, "load_time_ms": 13.819, "num_steps_sampled": 3670959, "grad_time_ms": 10274.935, "sample_time_ms": 15753.214, "update_time_ms": 9.281, "default": {"vf_explained_var": 0.9701246619224548, "vf_loss": 12.709843635559082, "entropy": 1.0975652933120728, "cur_lr": 0.0005000000237487257, "total_loss": 12.705309867858887, "kl": 0.016752663999795914, "policy_loss": -0.006652171723544598, "cur_kl_coeff": 0.12656249105930328}}, "episode_reward_mean": 1045.5688060365144, "timesteps_this_iter": 42713, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1400>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cddd8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-34-57", "hostname": "flow-main", "episodes_this_iter": 21, "episode_reward_min": 55.18365554191015}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1442.6807395006135, "node_ip": "10.138.0.2", "timesteps_total": 3714098, "iterations_since_restore": 83, "custom_metrics": {"cost1_max": 505.8869752957222, "cost1_min": 29.60303171419612, "system_level_velocity_mean": 15.685889805020745, "outflow_rate_max": 1474.9612085657106, "cost1_mean": 372.9111153979096, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.51308926590014, "system_level_velocity_min": 11.8211528027935, "cost2_max": -20.381148989149494, "cost2_mean": -113.99472473073754, "outflow_rate_mean": 1125.688511975366, "cost2_min": -140.96661403597338}, "training_iteration": 83, "episodes_total": 1262, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207323, "time_total_s": 2247.6508145332336, "episode_len_mean": 658.13, "pid": 32002, "time_since_restore": 2247.6508145332336, "time_this_iter_s": 26.191951990127563, "timesteps_since_restore": 3714098, "info": {"num_steps_trained": 3714098, "load_time_ms": 13.818, "num_steps_sampled": 3714098, "grad_time_ms": 10151.061, "sample_time_ms": 15913.227, "update_time_ms": 9.197, "default": {"vf_explained_var": 0.9786161184310913, "vf_loss": 8.302988052368164, "entropy": 1.1121257543563843, "cur_lr": 0.0005000000237487257, "total_loss": 8.29919719696045, "kl": 0.015385483391582966, "policy_loss": -0.0057378425262868404, "cur_kl_coeff": 0.12656249105930328}}, "episode_reward_mean": 1044.738482815815, "timesteps_this_iter": 43139, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a78d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd9b0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-35-23", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 55.18365554191015}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1393.7409505851351, "node_ip": "10.138.0.2", "timesteps_total": 3758025, "iterations_since_restore": 84, "custom_metrics": {"cost1_max": 505.8869752957222, "cost1_min": 29.60303171419612, "system_level_velocity_mean": 15.762183511848743, "outflow_rate_max": 1435.452478247873, "cost1_mean": 374.71853565100514, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.51308926590014, "system_level_velocity_min": 11.8211528027935, "cost2_max": -20.381148989149494, "cost2_mean": -114.77758248034466, "outflow_rate_mean": 1128.8252736906043, "cost2_min": -140.96661403597338}, "training_iteration": 84, "episodes_total": 1275, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207349, "time_total_s": 2273.2815866470337, "episode_len_mean": 658.09, "pid": 32002, "time_since_restore": 2273.2815866470337, "time_this_iter_s": 25.63077211380005, "timesteps_since_restore": 3758025, "info": {"num_steps_trained": 3758025, "load_time_ms": 14.383, "num_steps_sampled": 3758025, "grad_time_ms": 10073.989, "sample_time_ms": 15896.945, "update_time_ms": 8.854, "default": {"vf_explained_var": 0.97749263048172, "vf_loss": 8.508644104003906, "entropy": 1.1283682584762573, "cur_lr": 0.0005000000237487257, "total_loss": 8.502495765686035, "kl": 0.01648709736764431, "policy_loss": -0.008236109279096127, "cur_kl_coeff": 0.1265624761581421}}, "episode_reward_mean": 1043.8654680724594, "timesteps_this_iter": 43927, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1d30>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1320>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-35-49", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 55.18365554191015}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1393.7409505851351, "node_ip": "10.138.0.2", "timesteps_total": 3801682, "iterations_since_restore": 85, "custom_metrics": {"cost1_max": 504.0117931826053, "cost1_min": 90.54256616175348, "system_level_velocity_mean": 15.674915010286105, "outflow_rate_max": 1435.452478247873, "cost1_mean": 376.90657654844324, "outflow_rate_min": 411.33301059368245, "system_level_velocity_max": 19.906852255862454, "system_level_velocity_min": 11.8211528027935, "cost2_max": -35.35946364145226, "cost2_mean": -116.73987392877267, "outflow_rate_mean": 1137.4943673152777, "cost2_min": -140.29501598094964}, "training_iteration": 85, "episodes_total": 1291, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207375, "time_total_s": 2298.8700335025787, "episode_len_mean": 664.66, "pid": 32002, "time_since_restore": 2298.8700335025787, "time_this_iter_s": 25.588446855545044, "timesteps_since_restore": 3801682, "info": {"num_steps_trained": 3801682, "load_time_ms": 14.594, "num_steps_sampled": 3801682, "grad_time_ms": 10044.622, "sample_time_ms": 15783.682, "update_time_ms": 8.518, "default": {"vf_explained_var": 0.9853942394256592, "vf_loss": 6.151928424835205, "entropy": 1.1263777017593384, "cur_lr": 0.0005000000237487257, "total_loss": 6.146274089813232, "kl": 0.016880040988326073, "policy_loss": -0.00779107166454196, "cur_kl_coeff": 0.1265624761581421}}, "episode_reward_mean": 1046.8767181734204, "timesteps_this_iter": 43657, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c19e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfe10>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c17f0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-36-15", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 223.50598335907299}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1393.7409505851351, "node_ip": "10.138.0.2", "timesteps_total": 3845263, "iterations_since_restore": 86, "custom_metrics": {"cost1_max": 507.51020601098253, "cost1_min": 30.205219517701423, "system_level_velocity_mean": 15.647943006225336, "outflow_rate_max": 1435.452478247873, "cost1_mean": 380.5201144827038, "outflow_rate_min": 319.54044312360406, "system_level_velocity_max": 19.906852255862454, "system_level_velocity_min": 11.8211528027935, "cost2_max": -17.332495781010362, "cost2_mean": -118.85818236229223, "outflow_rate_mean": 1150.939263020989, "cost2_min": -147.14366960224174}, "training_iteration": 86, "episodes_total": 1308, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207401, "time_total_s": 2325.5791363716125, "episode_len_mean": 671.14, "pid": 32002, "time_since_restore": 2325.5791363716125, "time_this_iter_s": 26.709102869033813, "timesteps_since_restore": 3845263, "info": {"num_steps_trained": 3845263, "load_time_ms": 14.502, "num_steps_sampled": 3845263, "grad_time_ms": 9939.942, "sample_time_ms": 15987.889, "update_time_ms": 8.023, "default": {"vf_explained_var": 0.9787331819534302, "vf_loss": 8.477418899536133, "entropy": 1.1145809888839722, "cur_lr": 0.0005000000237487257, "total_loss": 8.472947120666504, "kl": 0.016731327399611473, "policy_loss": -0.0065892962738871574, "cur_kl_coeff": 0.1265624761581421}}, "episode_reward_mean": 1050.5122451485843, "timesteps_this_iter": 43581, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9ba8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9710>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-36-41", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 53.86185342951698}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1393.7409505851351, "node_ip": "10.138.0.2", "timesteps_total": 3886371, "iterations_since_restore": 87, "custom_metrics": {"cost1_max": 507.51020601098253, "cost1_min": 30.205219517701423, "system_level_velocity_mean": 15.886860339116051, "outflow_rate_max": 1435.452478247873, "cost1_mean": 377.08181619925097, "outflow_rate_min": 319.54044312360406, "system_level_velocity_max": 20.26354377036132, "system_level_velocity_min": 12.761616227664188, "cost2_max": -17.332495781010362, "cost2_mean": -118.81153355331928, "outflow_rate_mean": 1143.528400161721, "cost2_min": -147.14366960224174}, "training_iteration": 87, "episodes_total": 1327, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207426, "time_total_s": 2350.467861890793, "episode_len_mean": 658.77, "pid": 32002, "time_since_restore": 2350.467861890793, "time_this_iter_s": 24.888725519180298, "timesteps_since_restore": 3886371, "info": {"num_steps_trained": 3886371, "load_time_ms": 14.512, "num_steps_sampled": 3886371, "grad_time_ms": 9771.715, "sample_time_ms": 15968.087, "update_time_ms": 7.855, "default": {"vf_explained_var": 0.9728772044181824, "vf_loss": 11.91609001159668, "entropy": 1.12496018409729, "cur_lr": 0.0005000000237487257, "total_loss": 11.911992073059082, "kl": 0.01638374663889408, "policy_loss": -0.006171321030706167, "cur_kl_coeff": 0.1265624761581421}}, "episode_reward_mean": 1028.7523398288479, "timesteps_this_iter": 41108, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aae10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aaef0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa358>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-37-06", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 53.86185342951698}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1406.4709038000465, "node_ip": "10.138.0.2", "timesteps_total": 3928708, "iterations_since_restore": 88, "custom_metrics": {"cost1_max": 507.51020601098253, "cost1_min": 30.205219517701423, "system_level_velocity_mean": 15.817839318687593, "outflow_rate_max": 1480.5025041310628, "cost1_mean": 378.9064763878261, "outflow_rate_min": 319.54044312360406, "system_level_velocity_max": 20.26354377036132, "system_level_velocity_min": 12.761616227664188, "cost2_max": -17.332495781010362, "cost2_mean": -120.69749655183625, "outflow_rate_mean": 1149.5291960218292, "cost2_min": -147.14366960224174}, "training_iteration": 88, "episodes_total": 1343, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207452, "time_total_s": 2375.9373309612274, "episode_len_mean": 664.91, "pid": 32002, "time_since_restore": 2375.9373309612274, "time_this_iter_s": 25.46946907043457, "timesteps_since_restore": 3928708, "info": {"num_steps_trained": 3928708, "load_time_ms": 14.439, "num_steps_sampled": 3928708, "grad_time_ms": 9675.972, "sample_time_ms": 15989.662, "update_time_ms": 7.432, "default": {"vf_explained_var": 0.9748558402061462, "vf_loss": 9.842814445495605, "entropy": 1.1309720277786255, "cur_lr": 0.0005000000237487257, "total_loss": 9.838315963745117, "kl": 0.018211202695965767, "policy_loss": -0.006803630851209164, "cur_kl_coeff": 0.1265624761581421}}, "episode_reward_mean": 1031.2339621042545, "timesteps_this_iter": 42337, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf4e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfef0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfcc0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-37-32", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 53.86185342951698}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1406.4709038000465, "node_ip": "10.138.0.2", "timesteps_total": 3969874, "iterations_since_restore": 89, "custom_metrics": {"cost1_max": 524.5175146530495, "cost1_min": 30.205219517701423, "system_level_velocity_mean": 15.830140417254153, "outflow_rate_max": 1480.5025041310628, "cost1_mean": 374.0180839308604, "outflow_rate_min": 319.54044312360406, "system_level_velocity_max": 20.26354377036132, "system_level_velocity_min": 12.761616227664188, "cost2_max": -17.332495781010362, "cost2_mean": -120.33945270358522, "outflow_rate_mean": 1138.8225692334117, "cost2_min": -156.11013579849086}, "training_iteration": 89, "episodes_total": 1358, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207478, "time_total_s": 2402.185722589493, "episode_len_mean": 658.41, "pid": 32002, "time_since_restore": 2402.185722589493, "time_this_iter_s": 26.24839162826538, "timesteps_since_restore": 3969874, "info": {"num_steps_trained": 3969874, "load_time_ms": 14.502, "num_steps_sampled": 3969874, "grad_time_ms": 9623.748, "sample_time_ms": 16036.52, "update_time_ms": 7.137, "default": {"vf_explained_var": 0.9715117812156677, "vf_loss": 12.288535118103027, "entropy": 1.119657039642334, "cur_lr": 0.0005000000237487257, "total_loss": 12.28357219696045, "kl": 0.017338398844003677, "policy_loss": -0.00715674040839076, "cur_kl_coeff": 0.1265624761581421}}, "episode_reward_mean": 1014.4692294667345, "timesteps_this_iter": 41166, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf358>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e630>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-37-58", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 53.86185342951698}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1406.4709038000465, "node_ip": "10.138.0.2", "timesteps_total": 4012462, "iterations_since_restore": 90, "custom_metrics": {"cost1_max": 524.5175146530495, "cost1_min": 30.205219517701423, "system_level_velocity_mean": 16.056229485161175, "outflow_rate_max": 1491.6036708841118, "cost1_mean": 375.5961579787174, "outflow_rate_min": 319.54044312360406, "system_level_velocity_max": 20.35220207842887, "system_level_velocity_min": 12.828538991484384, "cost2_max": -17.332495781010362, "cost2_mean": -119.43832608300715, "outflow_rate_mean": 1138.7565065374868, "cost2_min": -156.11013579849086}, "training_iteration": 90, "episodes_total": 1379, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207504, "time_total_s": 2428.247606754303, "episode_len_mean": 652.29, "pid": 32002, "time_since_restore": 2428.247606754303, "time_this_iter_s": 26.06188416481018, "timesteps_since_restore": 4012462, "info": {"num_steps_trained": 4012462, "load_time_ms": 14.303, "num_steps_sampled": 4012462, "grad_time_ms": 9625.272, "sample_time_ms": 16070.322, "update_time_ms": 7.086, "default": {"vf_explained_var": 0.9563098549842834, "vf_loss": 18.178129196166992, "entropy": 1.1559374332427979, "cur_lr": 0.0005000000237487257, "total_loss": 18.173797607421875, "kl": 0.017201950773596764, "policy_loss": -0.00650795130059123, "cur_kl_coeff": 0.12656249105930328}}, "episode_reward_mean": 1012.2831862515324, "timesteps_this_iter": 42588, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bffd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfb38>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfa58>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-38-24", "hostname": "flow-main", "episodes_this_iter": 21, "episode_reward_min": 53.86185342951698}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1406.4709038000465, "node_ip": "10.138.0.2", "timesteps_total": 4055141, "iterations_since_restore": 91, "custom_metrics": {"cost1_max": 524.5175146530495, "cost1_min": 30.205219517701423, "system_level_velocity_mean": 16.244068587726687, "outflow_rate_max": 1491.6036708841118, "cost1_mean": 372.7700876692316, "outflow_rate_min": 319.54044312360406, "system_level_velocity_max": 20.35220207842887, "system_level_velocity_min": 12.715699442494431, "cost2_max": -17.332495781010362, "cost2_mean": -117.78005816799447, "outflow_rate_mean": 1130.9165046023618, "cost2_min": -156.11013579849086}, "training_iteration": 91, "episodes_total": 1395, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207529, "time_total_s": 2453.531350135803, "episode_len_mean": 640.83, "pid": 32002, "time_since_restore": 2453.531350135803, "time_this_iter_s": 25.283743381500244, "timesteps_since_restore": 4055141, "info": {"num_steps_trained": 4055141, "load_time_ms": 14.555, "num_steps_sampled": 4055141, "grad_time_ms": 9661.829, "sample_time_ms": 16067.954, "update_time_ms": 7.017, "default": {"vf_explained_var": 0.9684523344039917, "vf_loss": 12.422245979309082, "entropy": 1.1837867498397827, "cur_lr": 0.0005000000237487257, "total_loss": 12.418269157409668, "kl": 0.015297452919185162, "policy_loss": -0.005912240594625473, "cur_kl_coeff": 0.12656249105930328}}, "episode_reward_mean": 1006.1332999020239, "timesteps_this_iter": 42679, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1668>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1828>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-38-49", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 53.86185342951698}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1406.4709038000465, "node_ip": "10.138.0.2", "timesteps_total": 4098857, "iterations_since_restore": 92, "custom_metrics": {"cost1_max": 524.5175146530495, "cost1_min": 34.58888315067919, "system_level_velocity_mean": 16.196122021953872, "outflow_rate_max": 1491.6036708841118, "cost1_mean": 376.47527095222824, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 20.35220207842887, "system_level_velocity_min": 12.715699442494431, "cost2_max": -22.770336528317635, "cost2_mean": -118.33450397758696, "outflow_rate_mean": 1138.4216145112023, "cost2_min": -156.11013579849086}, "training_iteration": 92, "episodes_total": 1410, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207555, "time_total_s": 2479.6168451309204, "episode_len_mean": 647.39, "pid": 32002, "time_since_restore": 2479.6168451309204, "time_this_iter_s": 26.085494995117188, "timesteps_since_restore": 4098857, "info": {"num_steps_trained": 4098857, "load_time_ms": 15.255, "num_steps_sampled": 4098857, "grad_time_ms": 9671.203, "sample_time_ms": 16038.956, "update_time_ms": 6.806, "default": {"vf_explained_var": 0.9821138381958008, "vf_loss": 6.184911251068115, "entropy": 1.1957911252975464, "cur_lr": 0.0005000000237487257, "total_loss": 6.179628849029541, "kl": 0.015536456368863583, "policy_loss": -0.00724813574925065, "cur_kl_coeff": 0.1265624761581421}}, "episode_reward_mean": 1026.8945668477625, "timesteps_this_iter": 43716, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf8d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfef0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-39-15", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 67.21682487450177}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1406.4709038000465, "node_ip": "10.138.0.2", "timesteps_total": 4142084, "iterations_since_restore": 93, "custom_metrics": {"cost1_max": 524.5175146530495, "cost1_min": 34.63317609513562, "system_level_velocity_mean": 15.995298500103388, "outflow_rate_max": 1491.6036708841118, "cost1_mean": 380.20864609308796, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 20.35220207842887, "system_level_velocity_min": 12.715699442494431, "cost2_max": -22.770336528317635, "cost2_mean": -119.73714000759873, "outflow_rate_mean": 1149.680215651524, "cost2_min": -156.11013579849086}, "training_iteration": 93, "episodes_total": 1425, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207581, "time_total_s": 2505.425307750702, "episode_len_mean": 659.76, "pid": 32002, "time_since_restore": 2505.425307750702, "time_this_iter_s": 25.808462619781494, "timesteps_since_restore": 4142084, "info": {"num_steps_trained": 4142084, "load_time_ms": 15.438, "num_steps_sampled": 4142084, "grad_time_ms": 9733.643, "sample_time_ms": 15939.135, "update_time_ms": 6.712, "default": {"vf_explained_var": 0.9858302474021912, "vf_loss": 5.544923305511475, "entropy": 1.21073579788208, "cur_lr": 0.0005000000237487257, "total_loss": 5.540700912475586, "kl": 0.016626643016934395, "policy_loss": -0.006326359696686268, "cur_kl_coeff": 0.12656249105930328}}, "episode_reward_mean": 1041.3796910774277, "timesteps_this_iter": 43227, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bffd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfd68>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf4a8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-39-41", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 67.74635554755744}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1376.928603315433, "node_ip": "10.138.0.2", "timesteps_total": 4185218, "iterations_since_restore": 94, "custom_metrics": {"cost1_max": 524.5175146530495, "cost1_min": 34.63317609513562, "system_level_velocity_mean": 16.07126496140766, "outflow_rate_max": 1491.6036708841118, "cost1_mean": 379.63618099850703, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 20.35220207842887, "system_level_velocity_min": 12.715699442494431, "cost2_max": -22.770336528317635, "cost2_mean": -118.54588222220583, "outflow_rate_mean": 1146.6867778157618, "cost2_min": -156.11013579849086}, "training_iteration": 94, "episodes_total": 1438, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207606, "time_total_s": 2530.5648472309113, "episode_len_mean": 655.72, "pid": 32002, "time_since_restore": 2530.5648472309113, "time_this_iter_s": 25.13953948020935, "timesteps_since_restore": 4185218, "info": {"num_steps_trained": 4185218, "load_time_ms": 14.876, "num_steps_sampled": 4185218, "grad_time_ms": 9850.021, "sample_time_ms": 15774.151, "update_time_ms": 6.774, "default": {"vf_explained_var": 0.9742787480354309, "vf_loss": 11.16065788269043, "entropy": 1.2216739654541016, "cur_lr": 0.0005000000237487257, "total_loss": 11.156909942626953, "kl": 0.014195496216416359, "policy_loss": -0.005543526262044907, "cur_kl_coeff": 0.1265624761581421}}, "episode_reward_mean": 1039.5347605330576, "timesteps_this_iter": 43134, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf240>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa7b8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-40-06", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 67.74635554755744}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1395.484664639815, "node_ip": "10.138.0.2", "timesteps_total": 4226944, "iterations_since_restore": 95, "custom_metrics": {"cost1_max": 507.48824008582665, "cost1_min": 34.65311065192274, "system_level_velocity_mean": 16.08575255635273, "outflow_rate_max": 1491.6036708841118, "cost1_mean": 385.7074806169746, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 20.35220207842887, "system_level_velocity_min": 12.634961891858653, "cost2_max": -22.770336528317635, "cost2_mean": -119.43486387734627, "outflow_rate_mean": 1158.4365065796344, "cost2_min": -150.68449462653277}, "training_iteration": 95, "episodes_total": 1458, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207631, "time_total_s": 2554.899204969406, "episode_len_mean": 662.22, "pid": 32002, "time_since_restore": 2554.899204969406, "time_this_iter_s": 24.334357738494873, "timesteps_since_restore": 4226944, "info": {"num_steps_trained": 4226944, "load_time_ms": 14.821, "num_steps_sampled": 4226944, "grad_time_ms": 9935.191, "sample_time_ms": 15562.895, "update_time_ms": 6.823, "default": {"vf_explained_var": 0.9809328317642212, "vf_loss": 7.714323043823242, "entropy": 1.2354459762573242, "cur_lr": 0.0005000000237487257, "total_loss": 7.708617687225342, "kl": 0.016891956329345703, "policy_loss": -0.00784237589687109, "cur_kl_coeff": 0.1265624761581421}}, "episode_reward_mean": 1066.2356002972158, "timesteps_this_iter": 41726, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfb70>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf8d0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-40-31", "hostname": "flow-main", "episodes_this_iter": 20, "episode_reward_min": 67.74635554755744}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1395.484664639815, "node_ip": "10.138.0.2", "timesteps_total": 4270990, "iterations_since_restore": 96, "custom_metrics": {"cost1_max": 533.5284927187606, "cost1_min": 34.65311065192274, "system_level_velocity_mean": 15.920938724009382, "outflow_rate_max": 1479.457932525259, "cost1_mean": 381.61616704995606, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 20.341636287778766, "system_level_velocity_min": 12.634961891858653, "cost2_max": -23.322507329459448, "cost2_mean": -120.5382785037092, "outflow_rate_mean": 1151.1595367720781, "cost2_min": -150.68449462653277}, "training_iteration": 96, "episodes_total": 1474, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207657, "time_total_s": 2581.419689178467, "episode_len_mean": 662.47, "pid": 32002, "time_since_restore": 2581.419689178467, "time_this_iter_s": 26.52048420906067, "timesteps_since_restore": 4270990, "info": {"num_steps_trained": 4270990, "load_time_ms": 15.136, "num_steps_sampled": 4270990, "grad_time_ms": 10096.487, "sample_time_ms": 15380.929, "update_time_ms": 6.961, "default": {"vf_explained_var": 0.9782892465591431, "vf_loss": 8.795111656188965, "entropy": 1.2471694946289062, "cur_lr": 0.0005000000237487257, "total_loss": 8.790818214416504, "kl": 0.01583963632583618, "policy_loss": -0.006298758089542389, "cur_kl_coeff": 0.12656249105930328}}, "episode_reward_mean": 1064.4775852936148, "timesteps_this_iter": 44046, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf0b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf358>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf320>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-40-57", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 62.154119395274}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1395.484664639815, "node_ip": "10.138.0.2", "timesteps_total": 4314368, "iterations_since_restore": 97, "custom_metrics": {"cost1_max": 533.5284927187606, "cost1_min": 34.70971889791691, "system_level_velocity_mean": 15.868620066392769, "outflow_rate_max": 1479.457932525259, "cost1_mean": 388.738202807841, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 20.341636287778766, "system_level_velocity_min": 12.634961891858653, "cost2_max": -23.871638653111926, "cost2_mean": -122.77010241917976, "outflow_rate_mean": 1167.1928326139207, "cost2_min": -150.68449462653277}, "training_iteration": 97, "episodes_total": 1488, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207683, "time_total_s": 2607.124870300293, "episode_len_mean": 673.99, "pid": 32002, "time_since_restore": 2607.124870300293, "time_this_iter_s": 25.705181121826172, "timesteps_since_restore": 4314368, "info": {"num_steps_trained": 4314368, "load_time_ms": 14.916, "num_steps_sampled": 4314368, "grad_time_ms": 10237.296, "sample_time_ms": 15320.774, "update_time_ms": 7.211, "default": {"vf_explained_var": 0.9851346015930176, "vf_loss": 5.997107982635498, "entropy": 1.2253789901733398, "cur_lr": 0.0005000000237487257, "total_loss": 5.9933671951293945, "kl": 0.017573952674865723, "policy_loss": -0.005965008400380611, "cur_kl_coeff": 0.1265624761581421}}, "episode_reward_mean": 1081.8066503490354, "timesteps_this_iter": 43378, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bff28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfb38>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfd68>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-41-23", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 62.154119395274}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1395.484664639815, "node_ip": "10.138.0.2", "timesteps_total": 4358015, "iterations_since_restore": 98, "custom_metrics": {"cost1_max": 533.5284927187606, "cost1_min": 30.444656826981557, "system_level_velocity_mean": 15.917055691472944, "outflow_rate_max": 1479.457932525259, "cost1_mean": 388.37181876046327, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 20.438601696308094, "system_level_velocity_min": 12.634961891858653, "cost2_max": -21.97529666826629, "cost2_mean": -122.75324318714632, "outflow_rate_mean": 1165.5888852556836, "cost2_min": -150.68449462653277}, "training_iteration": 98, "episodes_total": 1505, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207709, "time_total_s": 2633.3288490772247, "episode_len_mean": 672.39, "pid": 32002, "time_since_restore": 2633.3288490772247, "time_this_iter_s": 26.203978776931763, "timesteps_since_restore": 4358015, "info": {"num_steps_trained": 4358015, "load_time_ms": 15.285, "num_steps_sampled": 4358015, "grad_time_ms": 10288.951, "sample_time_ms": 15339.907, "update_time_ms": 7.312, "default": {"vf_explained_var": 0.9781109094619751, "vf_loss": 9.543703079223633, "entropy": 1.234422206878662, "cur_lr": 0.0005000000237487257, "total_loss": 9.537256240844727, "kl": 0.019161611795425415, "policy_loss": -0.008872326463460922, "cur_kl_coeff": 0.1265624761581421}}, "episode_reward_mean": 1070.9141983012241, "timesteps_this_iter": 43647, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf240>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf6d8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-41-49", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 53.48946712587003}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1395.484664639815, "node_ip": "10.138.0.2", "timesteps_total": 4400934, "iterations_since_restore": 99, "custom_metrics": {"cost1_max": 533.5284927187606, "cost1_min": 30.444656826981557, "system_level_velocity_mean": 16.13003096745671, "outflow_rate_max": 1454.4130175222494, "cost1_mean": 390.29852947264436, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 20.438601696308094, "system_level_velocity_min": 12.634961891858653, "cost2_max": -21.97529666826629, "cost2_mean": -122.67258231197333, "outflow_rate_mean": 1167.998843160743, "cost2_min": -145.6750052860844}, "training_iteration": 99, "episodes_total": 1520, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207734, "time_total_s": 2658.1614151000977, "episode_len_mean": 666.7, "pid": 32002, "time_since_restore": 2658.1614151000977, "time_this_iter_s": 24.832566022872925, "timesteps_since_restore": 4400934, "info": {"num_steps_trained": 4400934, "load_time_ms": 15.185, "num_steps_sampled": 4400934, "grad_time_ms": 10325.92, "sample_time_ms": 15160.431, "update_time_ms": 7.47, "default": {"vf_explained_var": 0.9738726019859314, "vf_loss": 10.387149810791016, "entropy": 1.223062515258789, "cur_lr": 0.0005000000237487257, "total_loss": 10.381284713745117, "kl": 0.01631799153983593, "policy_loss": -0.007930495776236057, "cur_kl_coeff": 0.1265624761581421}}, "episode_reward_mean": 1067.1831062405809, "timesteps_this_iter": 42919, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d17b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1470>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1a20>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-42-14", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 53.48946712587003}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1395.484664639815, "node_ip": "10.138.0.2", "timesteps_total": 4442627, "iterations_since_restore": 100, "custom_metrics": {"cost1_max": 533.5284927187606, "cost1_min": 30.444656826981557, "system_level_velocity_mean": 16.089183801794675, "outflow_rate_max": 1454.4130175222494, "cost1_mean": 384.39976494584096, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 20.438601696308094, "system_level_velocity_min": 12.634961891858653, "cost2_max": -21.97529666826629, "cost2_mean": -122.67663426488174, "outflow_rate_mean": 1158.7994722012027, "cost2_min": -145.6750052860844}, "training_iteration": 100, "episodes_total": 1543, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207760, "time_total_s": 2684.162985086441, "episode_len_mean": 660.44, "pid": 32002, "time_since_restore": 2684.162985086441, "time_this_iter_s": 26.001569986343384, "timesteps_since_restore": 4442627, "info": {"num_steps_trained": 4442627, "load_time_ms": 14.948, "num_steps_sampled": 4442627, "grad_time_ms": 10346.871, "sample_time_ms": 15134.075, "update_time_ms": 7.537, "default": {"vf_explained_var": 0.9644415974617004, "vf_loss": 16.00996971130371, "entropy": 1.2219935655593872, "cur_lr": 0.0005000000237487257, "total_loss": 16.005128860473633, "kl": 0.017101256176829338, "policy_loss": -0.007004925049841404, "cur_kl_coeff": 0.1265624761581421}}, "episode_reward_mean": 1053.3062091706909, "timesteps_this_iter": 41693, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfef0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf128>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-42-40", "hostname": "flow-main", "episodes_this_iter": 23, "episode_reward_min": 53.48946712587003}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1364.6503229418188, "node_ip": "10.138.0.2", "timesteps_total": 4485738, "iterations_since_restore": 101, "custom_metrics": {"cost1_max": 533.5284927187606, "cost1_min": 30.444656826981557, "system_level_velocity_mean": 16.020864213251528, "outflow_rate_max": 1454.4130175222494, "cost1_mean": 382.26972624843233, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 20.438601696308094, "system_level_velocity_min": 12.634961891858653, "cost2_max": -21.97529666826629, "cost2_mean": -122.74490479772967, "outflow_rate_mean": 1155.9258308566025, "cost2_min": -145.6750052860844}, "training_iteration": 101, "episodes_total": 1556, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207786, "time_total_s": 2710.192814350128, "episode_len_mean": 660.44, "pid": 32002, "time_since_restore": 2710.192814350128, "time_this_iter_s": 26.029829263687134, "timesteps_since_restore": 4485738, "info": {"num_steps_trained": 4485738, "load_time_ms": 14.675, "num_steps_sampled": 4485738, "grad_time_ms": 10345.918, "sample_time_ms": 15210.544, "update_time_ms": 7.499, "default": {"vf_explained_var": 0.9803657531738281, "vf_loss": 6.744776248931885, "entropy": 1.2163461446762085, "cur_lr": 0.0005000000237487257, "total_loss": 6.738140106201172, "kl": 0.0164848230779171, "policy_loss": -0.008722075261175632, "cur_kl_coeff": 0.1265624761581421}}, "episode_reward_mean": 1045.9145177504986, "timesteps_this_iter": 43111, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d15f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1c50>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d11d0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-43-06", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 53.48946712587003}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1364.6503229418188, "node_ip": "10.138.0.2", "timesteps_total": 4532678, "iterations_since_restore": 102, "custom_metrics": {"cost1_max": 510.95510120303686, "cost1_min": 30.444656826981557, "system_level_velocity_mean": 16.10371933226811, "outflow_rate_max": 1454.4130175222494, "cost1_mean": 376.0222755595723, "outflow_rate_min": 325.7922196319009, "system_level_velocity_max": 20.438601696308094, "system_level_velocity_min": 12.848164349650594, "cost2_max": -21.97529666826629, "cost2_mean": -119.65022739427022, "outflow_rate_mean": 1143.37588960376, "cost2_min": -145.6750052860844}, "training_iteration": 102, "episodes_total": 1570, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207814, "time_total_s": 2737.39745593071, "episode_len_mean": 648.95, "pid": 32002, "time_since_restore": 2737.39745593071, "time_this_iter_s": 27.204641580581665, "timesteps_since_restore": 4532678, "info": {"num_steps_trained": 4532678, "load_time_ms": 14.911, "num_steps_sampled": 4532678, "grad_time_ms": 10352.152, "sample_time_ms": 15315.072, "update_time_ms": 7.523, "default": {"vf_explained_var": 0.9730883240699768, "vf_loss": 9.213728904724121, "entropy": 1.2411668300628662, "cur_lr": 0.0005000000237487257, "total_loss": 9.209884643554688, "kl": 0.016783451661467552, "policy_loss": -0.005967859178781509, "cur_kl_coeff": 0.1265624761581421}}, "episode_reward_mean": 1028.6828677027263, "timesteps_this_iter": 46940, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bff60>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf390>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-43-34", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 53.48946712587003}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1364.6503229418188, "node_ip": "10.138.0.2", "timesteps_total": 4575783, "iterations_since_restore": 103, "custom_metrics": {"cost1_max": 510.95510120303686, "cost1_min": 29.178201329743697, "system_level_velocity_mean": 15.969379891373947, "outflow_rate_max": 1439.053933533428, "cost1_mean": 362.62707148182847, "outflow_rate_min": 321.55674479680556, "system_level_velocity_max": 20.438601696308094, "system_level_velocity_min": 12.848164349650594, "cost2_max": -19.881894897064566, "cost2_mean": -115.71279926851267, "outflow_rate_mean": 1115.57572492649, "cost2_min": -144.5995015961787}, "training_iteration": 103, "episodes_total": 1590, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207839, "time_total_s": 2762.4792354106903, "episode_len_mean": 634.97, "pid": 32002, "time_since_restore": 2762.4792354106903, "time_this_iter_s": 25.08177947998047, "timesteps_since_restore": 4575783, "info": {"num_steps_trained": 4575783, "load_time_ms": 14.787, "num_steps_sampled": 4575783, "grad_time_ms": 10297.378, "sample_time_ms": 15295.907, "update_time_ms": 7.758, "default": {"vf_explained_var": 0.9666483998298645, "vf_loss": 13.248058319091797, "entropy": 1.2264783382415771, "cur_lr": 0.0005000000237487257, "total_loss": 13.243364334106445, "kl": 0.018324261531233788, "policy_loss": -0.007014479488134384, "cur_kl_coeff": 0.1265624761581421}}, "episode_reward_mean": 1001.296231176657, "timesteps_this_iter": 43105, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d12b0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-43-59", "hostname": "flow-main", "episodes_this_iter": 20, "episode_reward_min": 53.48946712587003}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1364.6503229418188, "node_ip": "10.138.0.2", "timesteps_total": 4617667, "iterations_since_restore": 104, "custom_metrics": {"cost1_max": 510.95510120303686, "cost1_min": 29.178201329743697, "system_level_velocity_mean": 15.99969248337775, "outflow_rate_max": 1439.053933533428, "cost1_mean": 360.62281065726216, "outflow_rate_min": 321.55674479680556, "system_level_velocity_max": 20.207273214028593, "system_level_velocity_min": 12.848164349650594, "cost2_max": -19.881894897064566, "cost2_mean": -115.45602864603866, "outflow_rate_mean": 1109.8327331187406, "cost2_min": -152.14016113296123}, "training_iteration": 104, "episodes_total": 1608, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207865, "time_total_s": 2788.4855723381042, "episode_len_mean": 630.46, "pid": 32002, "time_since_restore": 2788.4855723381042, "time_this_iter_s": 26.00633692741394, "timesteps_since_restore": 4617667, "info": {"num_steps_trained": 4617667, "load_time_ms": 14.815, "num_steps_sampled": 4617667, "grad_time_ms": 10214.685, "sample_time_ms": 15465.373, "update_time_ms": 7.73, "default": {"vf_explained_var": 0.9735543131828308, "vf_loss": 11.061835289001465, "entropy": 1.225102186203003, "cur_lr": 0.0005000000237487257, "total_loss": 11.056869506835938, "kl": 0.01722402311861515, "policy_loss": -0.0071450951509177685, "cur_kl_coeff": 0.12656249105930328}}, "episode_reward_mean": 996.5828855641194, "timesteps_this_iter": 41884, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b46a0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4390>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-44-25", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 55.133910214440014}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1364.6503229418188, "node_ip": "10.138.0.2", "timesteps_total": 4659416, "iterations_since_restore": 105, "custom_metrics": {"cost1_max": 501.45749179602774, "cost1_min": 29.178201329743697, "system_level_velocity_mean": 15.963599964556918, "outflow_rate_max": 1403.5454424231239, "cost1_mean": 355.9043486162785, "outflow_rate_min": 313.37907889324333, "system_level_velocity_max": 20.207273214028593, "system_level_velocity_min": 12.848164349650594, "cost2_max": -16.961745064624683, "cost2_mean": -114.59295493597511, "outflow_rate_mean": 1102.687897041029, "cost2_min": -152.14016113296123}, "training_iteration": 105, "episodes_total": 1627, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207891, "time_total_s": 2814.4121181964874, "episode_len_mean": 625.4, "pid": 32002, "time_since_restore": 2814.4121181964874, "time_this_iter_s": 25.92654585838318, "timesteps_since_restore": 4659416, "info": {"num_steps_trained": 4659416, "load_time_ms": 14.774, "num_steps_sampled": 4659416, "grad_time_ms": 10123.201, "sample_time_ms": 15716.032, "update_time_ms": 7.672, "default": {"vf_explained_var": 0.9763314723968506, "vf_loss": 9.333271026611328, "entropy": 1.2433382272720337, "cur_lr": 0.0005000000237487257, "total_loss": 9.328216552734375, "kl": 0.017415067180991173, "policy_loss": -0.007259793113917112, "cur_kl_coeff": 0.1265624761581421}}, "episode_reward_mean": 989.7233729399866, "timesteps_this_iter": 41749, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4898>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd7b8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-44-51", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 55.133910214440014}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1356.7521702725562, "node_ip": "10.138.0.2", "timesteps_total": 4703429, "iterations_since_restore": 106, "custom_metrics": {"cost1_max": 501.45749179602774, "cost1_min": 29.178201329743697, "system_level_velocity_mean": 15.967476087802568, "outflow_rate_max": 1403.5454424231239, "cost1_mean": 356.15046462071297, "outflow_rate_min": 313.37907889324333, "system_level_velocity_max": 20.119579992829827, "system_level_velocity_min": 12.848164349650594, "cost2_max": -16.961745064624683, "cost2_mean": -114.30861663612308, "outflow_rate_mean": 1100.834415480952, "cost2_min": -160.74931412168343}, "training_iteration": 106, "episodes_total": 1641, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207917, "time_total_s": 2841.218528032303, "episode_len_mean": 625.35, "pid": 32002, "time_since_restore": 2841.218528032303, "time_this_iter_s": 26.80640983581543, "timesteps_since_restore": 4703429, "info": {"num_steps_trained": 4703429, "load_time_ms": 14.634, "num_steps_sampled": 4703429, "grad_time_ms": 9968.294, "sample_time_ms": 15900.674, "update_time_ms": 7.493, "default": {"vf_explained_var": 0.9763085842132568, "vf_loss": 9.04329776763916, "entropy": 1.2386611700057983, "cur_lr": 0.0005000000237487257, "total_loss": 9.039504051208496, "kl": 0.01545026246458292, "policy_loss": -0.005747974384576082, "cur_kl_coeff": 0.1265624761581421}}, "episode_reward_mean": 989.6591495243115, "timesteps_this_iter": 44013, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1198>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1f60>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-45-17", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 55.133910214440014}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1356.7521702725562, "node_ip": "10.138.0.2", "timesteps_total": 4747814, "iterations_since_restore": 107, "custom_metrics": {"cost1_max": 501.45749179602774, "cost1_min": 29.178201329743697, "system_level_velocity_mean": 15.926717663505734, "outflow_rate_max": 1403.5454424231239, "cost1_mean": 354.18000135392197, "outflow_rate_min": 313.37907889324333, "system_level_velocity_max": 20.119579992829827, "system_level_velocity_min": 12.848164349650594, "cost2_max": -16.961745064624683, "cost2_mean": -114.43956030248968, "outflow_rate_mean": 1097.771198779914, "cost2_min": -160.74931412168343}, "training_iteration": 107, "episodes_total": 1654, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207944, "time_total_s": 2867.800025701523, "episode_len_mean": 624.5, "pid": 32002, "time_since_restore": 2867.800025701523, "time_this_iter_s": 26.58149766921997, "timesteps_since_restore": 4747814, "info": {"num_steps_trained": 4747814, "load_time_ms": 14.662, "num_steps_sampled": 4747814, "grad_time_ms": 9913.073, "sample_time_ms": 16043.691, "update_time_ms": 7.38, "default": {"vf_explained_var": 0.9833820462226868, "vf_loss": 6.978609561920166, "entropy": 1.2505360841751099, "cur_lr": 0.0005000000237487257, "total_loss": 6.973247528076172, "kl": 0.01616867631673813, "policy_loss": -0.007408040575683117, "cur_kl_coeff": 0.1265624761581421}}, "episode_reward_mean": 984.4330494379128, "timesteps_this_iter": 44385, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4e80>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4358>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-45-44", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 55.133910214440014}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1356.7521702725562, "node_ip": "10.138.0.2", "timesteps_total": 4791223, "iterations_since_restore": 108, "custom_metrics": {"cost1_max": 504.3844453361445, "cost1_min": 29.178201329743697, "system_level_velocity_mean": 15.996729537364763, "outflow_rate_max": 1435.070876977982, "cost1_mean": 359.7552885505927, "outflow_rate_min": 313.37907889324333, "system_level_velocity_max": 20.119579992829827, "system_level_velocity_min": 12.926297178495037, "cost2_max": -16.961745064624683, "cost2_mean": -117.04263271397669, "outflow_rate_mean": 1107.827829286919, "cost2_min": -160.74931412168343}, "training_iteration": 108, "episodes_total": 1672, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207969, "time_total_s": 2892.9045884609222, "episode_len_mean": 630.52, "pid": 32002, "time_since_restore": 2892.9045884609222, "time_this_iter_s": 25.104562759399414, "timesteps_since_restore": 4791223, "info": {"num_steps_trained": 4791223, "load_time_ms": 14.349, "num_steps_sampled": 4791223, "grad_time_ms": 9897.25, "sample_time_ms": 15951.807, "update_time_ms": 7.523, "default": {"vf_explained_var": 0.9796216487884521, "vf_loss": 8.692461967468262, "entropy": 1.2744998931884766, "cur_lr": 0.0005000000237487257, "total_loss": 8.686591148376465, "kl": 0.01722799241542816, "policy_loss": -0.008051744662225246, "cur_kl_coeff": 0.12656249105930328}}, "episode_reward_mean": 996.1479138172691, "timesteps_this_iter": 43409, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b47b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4080>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-46-09", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 55.133910214440014}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1452.7384511469918, "node_ip": "10.138.0.2", "timesteps_total": 4831768, "iterations_since_restore": 109, "custom_metrics": {"cost1_max": 504.3844453361445, "cost1_min": 35.393518184359934, "system_level_velocity_mean": 15.939787656616323, "outflow_rate_max": 1464.7497123692585, "cost1_mean": 373.496467645991, "outflow_rate_min": 313.37907889324333, "system_level_velocity_max": 20.119579992829827, "system_level_velocity_min": 12.926297178495037, "cost2_max": -16.961745064624683, "cost2_mean": -123.36863790968053, "outflow_rate_mean": 1140.618934156218, "cost2_min": -160.74931412168343}, "training_iteration": 109, "episodes_total": 1692, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557207994, "time_total_s": 2918.058456659317, "episode_len_mean": 652.4, "pid": 32002, "time_since_restore": 2918.058456659317, "time_this_iter_s": 25.153868198394775, "timesteps_since_restore": 4831768, "info": {"num_steps_trained": 4831768, "load_time_ms": 14.463, "num_steps_sampled": 4831768, "grad_time_ms": 9823.843, "sample_time_ms": 16055.115, "update_time_ms": 7.57, "default": {"vf_explained_var": 0.9815900921821594, "vf_loss": 8.117084503173828, "entropy": 1.2919130325317383, "cur_lr": 0.0005000000237487257, "total_loss": 8.111381530761719, "kl": 0.016278166323900223, "policy_loss": -0.007764175068587065, "cur_kl_coeff": 0.1265624761581421}}, "episode_reward_mean": 1028.2722837702543, "timesteps_this_iter": 40545, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7ef0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1f98>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-46-34", "hostname": "flow-main", "episodes_this_iter": 20, "episode_reward_min": 64.23013711380257}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1452.7384511469918, "node_ip": "10.138.0.2", "timesteps_total": 4875760, "iterations_since_restore": 110, "custom_metrics": {"cost1_max": 504.3844453361445, "cost1_min": 35.393518184359934, "system_level_velocity_mean": 15.936097685527331, "outflow_rate_max": 1464.7497123692585, "cost1_mean": 377.0250869148109, "outflow_rate_min": 313.37907889324333, "system_level_velocity_max": 20.119579992829827, "system_level_velocity_min": 12.773029416284574, "cost2_max": -16.961745064624683, "cost2_mean": -124.93685185273017, "outflow_rate_mean": 1147.8849328160886, "cost2_min": -160.74931412168343}, "training_iteration": 110, "episodes_total": 1704, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208021, "time_total_s": 2944.6557545661926, "episode_len_mean": 657.84, "pid": 32002, "time_since_restore": 2944.6557545661926, "time_this_iter_s": 26.59729790687561, "timesteps_since_restore": 4875760, "info": {"num_steps_trained": 4875760, "load_time_ms": 14.743, "num_steps_sampled": 4875760, "grad_time_ms": 9868.889, "sample_time_ms": 16068.924, "update_time_ms": 7.649, "default": {"vf_explained_var": 0.9853644371032715, "vf_loss": 4.993678569793701, "entropy": 1.295068383216858, "cur_lr": 0.0005000000237487257, "total_loss": 4.988785266876221, "kl": 0.01618082821369171, "policy_loss": -0.00694139301776886, "cur_kl_coeff": 0.1265624761581421}}, "episode_reward_mean": 1033.392374935437, "timesteps_this_iter": 43992, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1c50>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1908>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-47-01", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 64.23013711380257}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1452.7384511469918, "node_ip": "10.138.0.2", "timesteps_total": 4920267, "iterations_since_restore": 111, "custom_metrics": {"cost1_max": 504.3844453361445, "cost1_min": 35.393518184359934, "system_level_velocity_mean": 15.850401941570642, "outflow_rate_max": 1464.7497123692585, "cost1_mean": 373.35728955457415, "outflow_rate_min": 313.37907889324333, "system_level_velocity_max": 20.136454351241632, "system_level_velocity_min": 12.773029416284574, "cost2_max": -16.961745064624683, "cost2_mean": -125.66416775325666, "outflow_rate_mean": 1138.1559054746438, "cost2_min": -160.74931412168343}, "training_iteration": 111, "episodes_total": 1721, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208047, "time_total_s": 2971.033336162567, "episode_len_mean": 657.05, "pid": 32002, "time_since_restore": 2971.033336162567, "time_this_iter_s": 26.37758159637451, "timesteps_since_restore": 4920267, "info": {"num_steps_trained": 4920267, "load_time_ms": 14.902, "num_steps_sampled": 4920267, "grad_time_ms": 9865.515, "sample_time_ms": 16106.857, "update_time_ms": 7.679, "default": {"vf_explained_var": 0.9741277098655701, "vf_loss": 10.315545082092285, "entropy": 1.2782195806503296, "cur_lr": 0.0005000000237487257, "total_loss": 10.311638832092285, "kl": 0.017914317548274994, "policy_loss": -0.006173919886350632, "cur_kl_coeff": 0.12656249105930328}}, "episode_reward_mean": 1025.1902740981816, "timesteps_this_iter": 44507, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cebe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce0f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce2e8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-47-27", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 64.23013711380257}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1452.7384511469918, "node_ip": "10.138.0.2", "timesteps_total": 4963302, "iterations_since_restore": 112, "custom_metrics": {"cost1_max": 504.3844453361445, "cost1_min": 29.42489950194036, "system_level_velocity_mean": 15.934597902058467, "outflow_rate_max": 1464.7497123692585, "cost1_mean": 376.67131795207, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.405448358177534, "system_level_velocity_min": 12.773029416284574, "cost2_max": -19.99623134882463, "cost2_mean": -127.32743075093975, "outflow_rate_mean": 1149.0419292092633, "cost2_min": -159.9086330755944}, "training_iteration": 112, "episodes_total": 1738, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208073, "time_total_s": 2996.511838197708, "episode_len_mean": 659.17, "pid": 32002, "time_since_restore": 2996.511838197708, "time_this_iter_s": 25.47850203514099, "timesteps_since_restore": 4963302, "info": {"num_steps_trained": 4963302, "load_time_ms": 14.04, "num_steps_sampled": 4963302, "grad_time_ms": 9857.734, "sample_time_ms": 15943.498, "update_time_ms": 7.651, "default": {"vf_explained_var": 0.9715274572372437, "vf_loss": 12.346022605895996, "entropy": 1.2940839529037476, "cur_lr": 0.0005000000237487257, "total_loss": 12.342914581298828, "kl": 0.017387190833687782, "policy_loss": -0.005308155901730061, "cur_kl_coeff": 0.1265624761581421}}, "episode_reward_mean": 1033.6904490893905, "timesteps_this_iter": 43035, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ceda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cea90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce390>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-47-53", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 51.839265315691705}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1452.7384511469918, "node_ip": "10.138.0.2", "timesteps_total": 5005312, "iterations_since_restore": 113, "custom_metrics": {"cost1_max": 504.3844453361445, "cost1_min": 29.42489950194036, "system_level_velocity_mean": 15.885883004835293, "outflow_rate_max": 1464.7497123692585, "cost1_mean": 375.1901750491909, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.405448358177534, "system_level_velocity_min": 12.773029416284574, "cost2_max": -19.99623134882463, "cost2_mean": -126.95955445433974, "outflow_rate_mean": 1143.7474093090482, "cost2_min": -159.9086330755944}, "training_iteration": 113, "episodes_total": 1755, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208098, "time_total_s": 3021.729978322983, "episode_len_mean": 658.48, "pid": 32002, "time_since_restore": 3021.729978322983, "time_this_iter_s": 25.218140125274658, "timesteps_since_restore": 5005312, "info": {"num_steps_trained": 5005312, "load_time_ms": 14.004, "num_steps_sampled": 5005312, "grad_time_ms": 9908.173, "sample_time_ms": 15906.93, "update_time_ms": 7.439, "default": {"vf_explained_var": 0.9766116142272949, "vf_loss": 8.734865188598633, "entropy": 1.311838984489441, "cur_lr": 0.0005000000237487257, "total_loss": 8.729110717773438, "kl": 0.015837112441658974, "policy_loss": -0.007758609484881163, "cur_kl_coeff": 0.12656249105930328}}, "episode_reward_mean": 1034.1076722259274, "timesteps_this_iter": 42010, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c15c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7ef0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1e10>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-48-18", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 51.839265315691705}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1452.7384511469918, "node_ip": "10.138.0.2", "timesteps_total": 5047825, "iterations_since_restore": 114, "custom_metrics": {"cost1_max": 502.7532093502314, "cost1_min": 29.42489950194036, "system_level_velocity_mean": 15.876693629562691, "outflow_rate_max": 1464.7497123692585, "cost1_mean": 370.18065749865514, "outflow_rate_min": 327.9458014252228, "system_level_velocity_max": 20.405448358177534, "system_level_velocity_min": 12.773029416284574, "cost2_max": -16.70996833406996, "cost2_mean": -124.45036413497637, "outflow_rate_mean": 1129.683837567157, "cost2_min": -158.53140791453916}, "training_iteration": 114, "episodes_total": 1774, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208124, "time_total_s": 3047.2884624004364, "episode_len_mean": 651.62, "pid": 32002, "time_since_restore": 3047.2884624004364, "time_this_iter_s": 25.558484077453613, "timesteps_since_restore": 5047825, "info": {"num_steps_trained": 5047825, "load_time_ms": 14.001, "num_steps_sampled": 5047825, "grad_time_ms": 9861.439, "sample_time_ms": 15908.967, "update_time_ms": 7.591, "default": {"vf_explained_var": 0.9741675853729248, "vf_loss": 10.239612579345703, "entropy": 1.3175642490386963, "cur_lr": 0.0005000000237487257, "total_loss": 10.234076499938965, "kl": 0.01702864095568657, "policy_loss": -0.007691840175539255, "cur_kl_coeff": 0.12656249105930328}}, "episode_reward_mean": 1016.7172565607191, "timesteps_this_iter": 42513, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce3c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ced30>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ceb70>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-48-44", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 51.839265315691705}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1347.7007665215694, "node_ip": "10.138.0.2", "timesteps_total": 5089942, "iterations_since_restore": 115, "custom_metrics": {"cost1_max": 487.2498659266746, "cost1_min": 29.42489950194036, "system_level_velocity_mean": 15.866067254916361, "outflow_rate_max": 1418.7169294072094, "cost1_mean": 370.25796800888133, "outflow_rate_min": 327.9458014252228, "system_level_velocity_max": 20.405448358177534, "system_level_velocity_min": 12.773029416284574, "cost2_max": -16.70996833406996, "cost2_mean": -123.04204276511344, "outflow_rate_mean": 1126.8081385697888, "cost2_min": -158.0600797429326}, "training_iteration": 115, "episodes_total": 1787, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208149, "time_total_s": 3072.967519044876, "episode_len_mean": 651.62, "pid": 32002, "time_since_restore": 3072.967519044876, "time_this_iter_s": 25.679056644439697, "timesteps_since_restore": 5089942, "info": {"num_steps_trained": 5089942, "load_time_ms": 13.797, "num_steps_sampled": 5089942, "grad_time_ms": 9795.042, "sample_time_ms": 15952.359, "update_time_ms": 7.667, "default": {"vf_explained_var": 0.9853875637054443, "vf_loss": 5.978207588195801, "entropy": 1.2967321872711182, "cur_lr": 0.0005000000237487257, "total_loss": 5.970539093017578, "kl": 0.017967458814382553, "policy_loss": -0.00994273740798235, "cur_kl_coeff": 0.12656249105930328}}, "episode_reward_mean": 1018.0975974745164, "timesteps_this_iter": 42117, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce1d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e9b0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-49-09", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 51.839265315691705}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1375.4662443854288, "node_ip": "10.138.0.2", "timesteps_total": 5133189, "iterations_since_restore": 116, "custom_metrics": {"cost1_max": 489.9031244398585, "cost1_min": 29.42489950194036, "system_level_velocity_mean": 15.880331453918442, "outflow_rate_max": 1439.1245687337978, "cost1_mean": 374.3679720350587, "outflow_rate_min": 327.9458014252228, "system_level_velocity_max": 20.405448358177534, "system_level_velocity_min": 12.952266402613615, "cost2_max": -16.70996833406996, "cost2_mean": -121.68058585176306, "outflow_rate_mean": 1135.1483669399352, "cost2_min": -158.0600797429326}, "training_iteration": 116, "episodes_total": 1803, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208176, "time_total_s": 3099.6956672668457, "episode_len_mean": 655.8, "pid": 32002, "time_since_restore": 3099.6956672668457, "time_this_iter_s": 26.728148221969604, "timesteps_since_restore": 5133189, "info": {"num_steps_trained": 5133189, "load_time_ms": 13.958, "num_steps_sampled": 5133189, "grad_time_ms": 9747.306, "sample_time_ms": 15992.988, "update_time_ms": 7.67, "default": {"vf_explained_var": 0.9832296371459961, "vf_loss": 6.617922782897949, "entropy": 1.3100379705429077, "cur_lr": 0.0005000000237487257, "total_loss": 6.611780166625977, "kl": 0.017116708680987358, "policy_loss": -0.008308838121592999, "cur_kl_coeff": 0.12656249105930328}}, "episode_reward_mean": 1031.9354065670473, "timesteps_this_iter": 43247, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e0f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce780>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d11d0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-49-36", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 51.839265315691705}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1375.4662443854288, "node_ip": "10.138.0.2", "timesteps_total": 5177518, "iterations_since_restore": 117, "custom_metrics": {"cost1_max": 501.65165288096193, "cost1_min": 29.42489950194036, "system_level_velocity_mean": 15.779671950221534, "outflow_rate_max": 1439.1245687337978, "cost1_mean": 380.58570616272374, "outflow_rate_min": 327.9458014252228, "system_level_velocity_max": 20.405448358177534, "system_level_velocity_min": 12.895873307303518, "cost2_max": -16.70996833406996, "cost2_mean": -120.3790682106318, "outflow_rate_mean": 1149.5837552427638, "cost2_min": -158.0600797429326}, "training_iteration": 117, "episodes_total": 1818, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208203, "time_total_s": 3126.4775490760803, "episode_len_mean": 666.48, "pid": 32002, "time_since_restore": 3126.4775490760803, "time_this_iter_s": 26.78188180923462, "timesteps_since_restore": 5177518, "info": {"num_steps_trained": 5177518, "load_time_ms": 14.005, "num_steps_sampled": 5177518, "grad_time_ms": 9681.343, "sample_time_ms": 16077.612, "update_time_ms": 7.645, "default": {"vf_explained_var": 0.9840167164802551, "vf_loss": 6.624753952026367, "entropy": 1.33525812625885, "cur_lr": 0.0005000000237487257, "total_loss": 6.61892032623291, "kl": 0.018804233521223068, "policy_loss": -0.008213586173951626, "cur_kl_coeff": 0.1265624761581421}}, "episode_reward_mean": 1049.4440993998132, "timesteps_this_iter": 44329, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ceda0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce550>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-50-03", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 51.839265315691705}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1383.5531923209774, "node_ip": "10.138.0.2", "timesteps_total": 5221647, "iterations_since_restore": 118, "custom_metrics": {"cost1_max": 501.65165288096193, "cost1_min": 29.42489950194036, "system_level_velocity_mean": 15.547547804143814, "outflow_rate_max": 1439.1245687337978, "cost1_mean": 381.79952245027897, "outflow_rate_min": 327.9458014252228, "system_level_velocity_max": 20.27850963905097, "system_level_velocity_min": 12.895873307303518, "cost2_max": -16.70996833406996, "cost2_mean": -118.2697932814655, "outflow_rate_mean": 1154.5794090395789, "cost2_min": -158.0600797429326}, "training_iteration": 118, "episodes_total": 1832, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208230, "time_total_s": 3153.1441383361816, "episode_len_mean": 675.68, "pid": 32002, "time_since_restore": 3153.1441383361816, "time_this_iter_s": 26.66658926010132, "timesteps_since_restore": 5221647, "info": {"num_steps_trained": 5221647, "load_time_ms": 13.949, "num_steps_sampled": 5221647, "grad_time_ms": 9611.111, "sample_time_ms": 16304.577, "update_time_ms": 7.597, "default": {"vf_explained_var": 0.9860963821411133, "vf_loss": 5.4581403732299805, "entropy": 1.3424186706542969, "cur_lr": 0.0005000000237487257, "total_loss": 5.451879501342773, "kl": 0.020525814965367317, "policy_loss": -0.008858269080519676, "cur_kl_coeff": 0.12656249105930328}}, "episode_reward_mean": 1058.8664237294315, "timesteps_this_iter": 44129, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cedd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce0b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce358>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-50-30", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 51.839265315691705}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1466.744939915729, "node_ip": "10.138.0.2", "timesteps_total": 5262986, "iterations_since_restore": 119, "custom_metrics": {"cost1_max": 501.65165288096193, "cost1_min": 29.426823034911056, "system_level_velocity_mean": 15.566429278703207, "outflow_rate_max": 1439.1245687337978, "cost1_mean": 383.4171357266291, "outflow_rate_min": 327.9458014252228, "system_level_velocity_max": 20.27850963905097, "system_level_velocity_min": 12.895873307303518, "cost2_max": -16.70996833406996, "cost2_mean": -115.17226985713836, "outflow_rate_mean": 1157.7242113674602, "cost2_min": -158.0600797429326}, "training_iteration": 119, "episodes_total": 1851, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208255, "time_total_s": 3178.8382003307343, "episode_len_mean": 676.17, "pid": 32002, "time_since_restore": 3178.8382003307343, "time_this_iter_s": 25.694061994552612, "timesteps_since_restore": 5262986, "info": {"num_steps_trained": 5262986, "load_time_ms": 13.945, "num_steps_sampled": 5262986, "grad_time_ms": 9549.781, "sample_time_ms": 16422.205, "update_time_ms": 7.603, "default": {"vf_explained_var": 0.978983998298645, "vf_loss": 10.346860885620117, "entropy": 1.3256045579910278, "cur_lr": 0.0005000000237487257, "total_loss": 10.34066104888916, "kl": 0.016082607209682465, "policy_loss": -0.009252244606614113, "cur_kl_coeff": 0.18984375894069672}}, "episode_reward_mean": 1060.283780895255, "timesteps_this_iter": 41339, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d12b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1f60>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-50-55", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 55.53724366797007}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1466.744939915729, "node_ip": "10.138.0.2", "timesteps_total": 5306710, "iterations_since_restore": 120, "custom_metrics": {"cost1_max": 520.2866961712376, "cost1_min": 30.156396754006682, "system_level_velocity_mean": 15.600670973248155, "outflow_rate_max": 1441.163591551489, "cost1_mean": 386.53166848482243, "outflow_rate_min": 317.9670165501775, "system_level_velocity_max": 20.06476862126464, "system_level_velocity_min": 12.895873307303518, "cost2_max": -14.083635517843907, "cost2_mean": -113.61623518400644, "outflow_rate_mean": 1165.8851170081832, "cost2_min": -158.0600797429326}, "training_iteration": 120, "episodes_total": 1866, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208282, "time_total_s": 3205.1132311820984, "episode_len_mean": 677.73, "pid": 32002, "time_since_restore": 3205.1132311820984, "time_this_iter_s": 26.275030851364136, "timesteps_since_restore": 5306710, "info": {"num_steps_trained": 5306710, "load_time_ms": 14.032, "num_steps_sampled": 5306710, "grad_time_ms": 9360.923, "sample_time_ms": 16578.576, "update_time_ms": 7.611, "default": {"vf_explained_var": 0.9673130512237549, "vf_loss": 13.235420227050781, "entropy": 1.3481379747390747, "cur_lr": 0.0005000000237487257, "total_loss": 13.230265617370605, "kl": 0.01609678566455841, "policy_loss": -0.008210166357457638, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1077.249160358025, "timesteps_this_iter": 43724, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce0b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ceac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ceb00>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-51-22", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 54.3811095804073}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1466.744939915729, "node_ip": "10.138.0.2", "timesteps_total": 5349261, "iterations_since_restore": 121, "custom_metrics": {"cost1_max": 520.2866961712376, "cost1_min": 30.156396754006682, "system_level_velocity_mean": 15.508512647214094, "outflow_rate_max": 1441.163591551489, "cost1_mean": 380.6819914963619, "outflow_rate_min": 317.9670165501775, "system_level_velocity_max": 20.06476862126464, "system_level_velocity_min": 12.895873307303518, "cost2_max": -14.083635517843907, "cost2_mean": -110.59991398158283, "outflow_rate_mean": 1158.8509724186429, "cost2_min": -158.0600797429326}, "training_iteration": 121, "episodes_total": 1884, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208308, "time_total_s": 3231.7399871349335, "episode_len_mean": 672.23, "pid": 32002, "time_since_restore": 3231.7399871349335, "time_this_iter_s": 26.626755952835083, "timesteps_since_restore": 5349261, "info": {"num_steps_trained": 5349261, "load_time_ms": 14.101, "num_steps_sampled": 5349261, "grad_time_ms": 9224.033, "sample_time_ms": 16739.386, "update_time_ms": 7.78, "default": {"vf_explained_var": 0.9751232266426086, "vf_loss": 10.863612174987793, "entropy": 1.3376646041870117, "cur_lr": 0.0005000000237487257, "total_loss": 10.858570098876953, "kl": 0.0140113215893507, "policy_loss": -0.007701694034039974, "cur_kl_coeff": 0.18984375894069672}}, "episode_reward_mean": 1065.879593339715, "timesteps_this_iter": 42551, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf0f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce320>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c16d8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-51-48", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 54.3811095804073}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1466.744939915729, "node_ip": "10.138.0.2", "timesteps_total": 5392051, "iterations_since_restore": 122, "custom_metrics": {"cost1_max": 520.2866961712376, "cost1_min": 30.156396754006682, "system_level_velocity_mean": 15.518088460816164, "outflow_rate_max": 1441.163591551489, "cost1_mean": 376.1855931142015, "outflow_rate_min": 317.9670165501775, "system_level_velocity_max": 20.06476862126464, "system_level_velocity_min": 12.895873307303518, "cost2_max": -14.083635517843907, "cost2_mean": -107.50409347071941, "outflow_rate_mean": 1147.0814319223916, "cost2_min": -132.56226574478046}, "training_iteration": 122, "episodes_total": 1899, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208335, "time_total_s": 3257.9581649303436, "episode_len_mean": 665.73, "pid": 32002, "time_since_restore": 3257.9581649303436, "time_this_iter_s": 26.218177795410156, "timesteps_since_restore": 5392051, "info": {"num_steps_trained": 5392051, "load_time_ms": 14.165, "num_steps_sampled": 5392051, "grad_time_ms": 9028.388, "sample_time_ms": 17009.378, "update_time_ms": 7.837, "default": {"vf_explained_var": 0.97984379529953, "vf_loss": 8.311454772949219, "entropy": 1.349330186843872, "cur_lr": 0.0005000000237487257, "total_loss": 8.30501651763916, "kl": 0.015157273039221764, "policy_loss": -0.009315917268395424, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1056.0227134053596, "timesteps_this_iter": 42790, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce6d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ced30>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-52-15", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 54.3811095804073}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1466.744939915729, "node_ip": "10.138.0.2", "timesteps_total": 5434694, "iterations_since_restore": 123, "custom_metrics": {"cost1_max": 520.2866961712376, "cost1_min": 29.531357551925215, "system_level_velocity_mean": 15.613694462203343, "outflow_rate_max": 1441.163591551489, "cost1_mean": 373.16423881840785, "outflow_rate_min": 317.9670165501775, "system_level_velocity_max": 20.31673543837655, "system_level_velocity_min": 12.960432041404731, "cost2_max": -14.083635517843907, "cost2_mean": -105.67796186283189, "outflow_rate_mean": 1138.324092344453, "cost2_min": -130.61417913375192}, "training_iteration": 123, "episodes_total": 1917, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208361, "time_total_s": 3284.3573389053345, "episode_len_mean": 658.19, "pid": 32002, "time_since_restore": 3284.3573389053345, "time_this_iter_s": 26.399173974990845, "timesteps_since_restore": 5434694, "info": {"num_steps_trained": 5434694, "load_time_ms": 14.237, "num_steps_sampled": 5434694, "grad_time_ms": 8959.583, "sample_time_ms": 17193.816, "update_time_ms": 7.853, "default": {"vf_explained_var": 0.976195216178894, "vf_loss": 9.833037376403809, "entropy": 1.3531688451766968, "cur_lr": 0.0005000000237487257, "total_loss": 9.827784538269043, "kl": 0.014508234336972237, "policy_loss": -0.008006714284420013, "cur_kl_coeff": 0.18984375894069672}}, "episode_reward_mean": 1046.298288409617, "timesteps_this_iter": 42643, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cee10>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce5f8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-52-41", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 51.93244462622124}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1466.744939915729, "node_ip": "10.138.0.2", "timesteps_total": 5477562, "iterations_since_restore": 124, "custom_metrics": {"cost1_max": 520.2866961712376, "cost1_min": 29.531357551925215, "system_level_velocity_mean": 15.53034743293232, "outflow_rate_max": 1441.163591551489, "cost1_mean": 368.53114958836466, "outflow_rate_min": 317.9670165501775, "system_level_velocity_max": 20.31673543837655, "system_level_velocity_min": 12.877865633200145, "cost2_max": -14.083635517843907, "cost2_mean": -106.44738060087857, "outflow_rate_mean": 1128.215332389264, "cost2_min": -136.84569676194076}, "training_iteration": 124, "episodes_total": 1931, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208389, "time_total_s": 3311.8773126602173, "episode_len_mean": 654.81, "pid": 32002, "time_since_restore": 3311.8773126602173, "time_this_iter_s": 27.519973754882812, "timesteps_since_restore": 5477562, "info": {"num_steps_trained": 5477562, "load_time_ms": 14.066, "num_steps_sampled": 5477562, "grad_time_ms": 9010.878, "sample_time_ms": 17337.905, "update_time_ms": 7.953, "default": {"vf_explained_var": 0.982357919216156, "vf_loss": 7.592556476593018, "entropy": 1.3432440757751465, "cur_lr": 0.0005000000237487257, "total_loss": 7.586878776550293, "kl": 0.015019433572888374, "policy_loss": -0.008529559709131718, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1040.9843746527042, "timesteps_this_iter": 42868, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c15c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c10f0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-53-09", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 51.93244462622124}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1430.6827162698999, "node_ip": "10.138.0.2", "timesteps_total": 5522363, "iterations_since_restore": 125, "custom_metrics": {"cost1_max": 520.2866961712376, "cost1_min": 29.531357551925215, "system_level_velocity_mean": 15.491405906258667, "outflow_rate_max": 1441.163591551489, "cost1_mean": 367.33053429592013, "outflow_rate_min": 317.9670165501775, "system_level_velocity_max": 20.31673543837655, "system_level_velocity_min": 12.833164913913352, "cost2_max": -14.083635517843907, "cost2_mean": -106.69787755110829, "outflow_rate_mean": 1128.2330194411775, "cost2_min": -136.84569676194076}, "training_iteration": 125, "episodes_total": 1945, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208417, "time_total_s": 3340.0807769298553, "episode_len_mean": 654.81, "pid": 32002, "time_since_restore": 3340.0807769298553, "time_this_iter_s": 28.20346426963806, "timesteps_since_restore": 5522363, "info": {"num_steps_trained": 5522363, "load_time_ms": 14.58, "num_steps_sampled": 5522363, "grad_time_ms": 9126.354, "sample_time_ms": 17471.508, "update_time_ms": 8.226, "default": {"vf_explained_var": 0.9823498725891113, "vf_loss": 6.942471981048584, "entropy": 1.3358232975006104, "cur_lr": 0.0005000000237487257, "total_loss": 6.93505859375, "kl": 0.014069360680878162, "policy_loss": -0.010084239766001701, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1038.7466388506814, "timesteps_this_iter": 44801, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce198>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce668>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-53-37", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 51.93244462622124}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1426.223229288077, "node_ip": "10.138.0.2", "timesteps_total": 5565160, "iterations_since_restore": 126, "custom_metrics": {"cost1_max": 520.2866961712376, "cost1_min": 29.531357551925215, "system_level_velocity_mean": 15.37239489012786, "outflow_rate_max": 1407.56637504399, "cost1_mean": 380.3222314734186, "outflow_rate_min": 324.8763846761304, "system_level_velocity_max": 20.31673543837655, "system_level_velocity_min": 12.833164913913352, "cost2_max": -17.440922954533416, "cost2_mean": -110.13479228337387, "outflow_rate_mean": 1161.0169940950718, "cost2_min": -136.84569676194076}, "training_iteration": 126, "episodes_total": 1960, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208443, "time_total_s": 3365.9177713394165, "episode_len_mean": 677.08, "pid": 32002, "time_since_restore": 3365.9177713394165, "time_this_iter_s": 25.836994409561157, "timesteps_since_restore": 5565160, "info": {"num_steps_trained": 5565160, "load_time_ms": 14.454, "num_steps_sampled": 5565160, "grad_time_ms": 9102.07, "sample_time_ms": 17405.115, "update_time_ms": 8.455, "default": {"vf_explained_var": 0.9825595021247864, "vf_loss": 7.325595855712891, "entropy": 1.318530797958374, "cur_lr": 0.0005000000237487257, "total_loss": 7.319806098937988, "kl": 0.016011742874979973, "policy_loss": -0.008829616941511631, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1075.6305612803956, "timesteps_this_iter": 42797, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd2b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd438>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-54-03", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 51.93244462622124}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1407.1000361484253, "node_ip": "10.138.0.2", "timesteps_total": 5607728, "iterations_since_restore": 127, "custom_metrics": {"cost1_max": 502.24692344691135, "cost1_min": 29.531357551925215, "system_level_velocity_mean": 15.507382149754227, "outflow_rate_max": 1407.56637504399, "cost1_mean": 379.6345502537388, "outflow_rate_min": 324.8763846761304, "system_level_velocity_max": 20.31673543837655, "system_level_velocity_min": 12.833164913913352, "cost2_max": -17.440922954533416, "cost2_mean": -109.35833963685305, "outflow_rate_mean": 1154.942415768274, "cost2_min": -136.84569676194076}, "training_iteration": 127, "episodes_total": 1978, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208467, "time_total_s": 3390.5854601860046, "episode_len_mean": 671.01, "pid": 32002, "time_since_restore": 3390.5854601860046, "time_this_iter_s": 24.667688846588135, "timesteps_since_restore": 5607728, "info": {"num_steps_trained": 5607728, "load_time_ms": 14.456, "num_steps_sampled": 5607728, "grad_time_ms": 9088.265, "sample_time_ms": 17206.225, "update_time_ms": 8.704, "default": {"vf_explained_var": 0.9744842648506165, "vf_loss": 11.530997276306152, "entropy": 1.3465254306793213, "cur_lr": 0.0005000000237487257, "total_loss": 11.527201652526855, "kl": 0.01463695615530014, "policy_loss": -0.006573718506842852, "cur_kl_coeff": 0.18984375894069672}}, "episode_reward_mean": 1069.6359633389488, "timesteps_this_iter": 42568, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce240>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce4a8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-54-27", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 51.93244462622124}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1407.1000361484253, "node_ip": "10.138.0.2", "timesteps_total": 5650654, "iterations_since_restore": 128, "custom_metrics": {"cost1_max": 502.24692344691135, "cost1_min": 29.531357551925215, "system_level_velocity_mean": 15.552205752506188, "outflow_rate_max": 1423.5887344898551, "cost1_mean": 381.1978405893013, "outflow_rate_min": 324.8763846761304, "system_level_velocity_max": 20.31673543837655, "system_level_velocity_min": 12.833164913913352, "cost2_max": -17.440922954533416, "cost2_mean": -109.24842227430123, "outflow_rate_mean": 1157.4986304400115, "cost2_min": -136.84569676194076}, "training_iteration": 128, "episodes_total": 1994, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208494, "time_total_s": 3417.273423433304, "episode_len_mean": 671.01, "pid": 32002, "time_since_restore": 3417.273423433304, "time_this_iter_s": 26.687963247299194, "timesteps_since_restore": 5650654, "info": {"num_steps_trained": 5650654, "load_time_ms": 14.568, "num_steps_sampled": 5650654, "grad_time_ms": 9092.308, "sample_time_ms": 17204.349, "update_time_ms": 8.732, "default": {"vf_explained_var": 0.9842230677604675, "vf_loss": 7.08751916885376, "entropy": 1.361421823501587, "cur_lr": 0.0005000000237487257, "total_loss": 7.081681251525879, "kl": 0.01768982969224453, "policy_loss": -0.009195511229336262, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1072.2812844410028, "timesteps_this_iter": 42926, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfeb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf9e8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-54-54", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 51.93244462622124}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1415.774851086162, "node_ip": "10.138.0.2", "timesteps_total": 5692020, "iterations_since_restore": 129, "custom_metrics": {"cost1_max": 502.24692344691135, "cost1_min": 29.531357551925215, "system_level_velocity_mean": 15.516107485479644, "outflow_rate_max": 1460.3818926325398, "cost1_mean": 386.08882706719595, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.31673543837655, "system_level_velocity_min": 11.787428837547205, "cost2_max": -20.451816558860706, "cost2_mean": -110.43422481619753, "outflow_rate_mean": 1173.321103990834, "cost2_min": -137.93690882890888}, "training_iteration": 129, "episodes_total": 2011, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208519, "time_total_s": 3441.758470773697, "episode_len_mean": 678.48, "pid": 32002, "time_since_restore": 3441.758470773697, "time_this_iter_s": 24.485047340393066, "timesteps_since_restore": 5692020, "info": {"num_steps_trained": 5692020, "load_time_ms": 14.726, "num_steps_sampled": 5692020, "grad_time_ms": 9105.42, "sample_time_ms": 17070.096, "update_time_ms": 8.744, "default": {"vf_explained_var": 0.9819180965423584, "vf_loss": 8.741182327270508, "entropy": 1.3329623937606812, "cur_lr": 0.0005000000237487257, "total_loss": 8.735211372375488, "kl": 0.01605915278196335, "policy_loss": -0.009019988588988781, "cur_kl_coeff": 0.18984375894069672}}, "episode_reward_mean": 1090.401896689035, "timesteps_this_iter": 41366, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa080>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1eb8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-55-19", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 51.93244462622124}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1415.774851086162, "node_ip": "10.138.0.2", "timesteps_total": 5733259, "iterations_since_restore": 130, "custom_metrics": {"cost1_max": 502.24692344691135, "cost1_min": 74.43746197667595, "system_level_velocity_mean": 15.74478957356634, "outflow_rate_max": 1460.3818926325398, "cost1_mean": 388.7080149450672, "outflow_rate_min": 406.61272264772566, "system_level_velocity_max": 20.299912192917642, "system_level_velocity_min": 11.787428837547205, "cost2_max": -26.60354232638854, "cost2_mean": -109.10461141726346, "outflow_rate_mean": 1176.5114004677482, "cost2_min": -137.93690882890888}, "training_iteration": 130, "episodes_total": 2028, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208546, "time_total_s": 3468.587726831436, "episode_len_mean": 673.48, "pid": 32002, "time_since_restore": 3468.587726831436, "time_this_iter_s": 26.829256057739258, "timesteps_since_restore": 5733259, "info": {"num_steps_trained": 5733259, "load_time_ms": 14.518, "num_steps_sampled": 5733259, "grad_time_ms": 9197.832, "sample_time_ms": 17031.491, "update_time_ms": 8.84, "default": {"vf_explained_var": 0.97709059715271, "vf_loss": 11.605644226074219, "entropy": 1.357413411140442, "cur_lr": 0.0005000000237487257, "total_loss": 11.60088062286377, "kl": 0.01492439303547144, "policy_loss": -0.0075972420163452625, "cur_kl_coeff": 0.18984375894069672}}, "episode_reward_mean": 1094.1682004948439, "timesteps_this_iter": 41239, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1e48>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cedd8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-55-46", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 156.42987775919224}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1415.774851086162, "node_ip": "10.138.0.2", "timesteps_total": 5777401, "iterations_since_restore": 131, "custom_metrics": {"cost1_max": 511.37254473379994, "cost1_min": 34.43622739885693, "system_level_velocity_mean": 15.879778203433418, "outflow_rate_max": 1460.3818926325398, "cost1_mean": 390.24713312484323, "outflow_rate_min": 324.8763846761304, "system_level_velocity_max": 20.299912192917642, "system_level_velocity_min": 11.787428837547205, "cost2_max": -17.47881244758518, "cost2_mean": -107.61849112988558, "outflow_rate_mean": 1175.7036441756063, "cost2_min": -137.93690882890888}, "training_iteration": 131, "episodes_total": 2042, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208571, "time_total_s": 3494.0096051692963, "episode_len_mean": 670.36, "pid": 32002, "time_since_restore": 3494.0096051692963, "time_this_iter_s": 25.421878337860107, "timesteps_since_restore": 5777401, "info": {"num_steps_trained": 5777401, "load_time_ms": 14.342, "num_steps_sampled": 5777401, "grad_time_ms": 9268.162, "sample_time_ms": 16842.208, "update_time_ms": 8.938, "default": {"vf_explained_var": 0.9807304739952087, "vf_loss": 8.127264022827148, "entropy": 1.3544238805770874, "cur_lr": 0.0005000000237487257, "total_loss": 8.122125625610352, "kl": 0.014323141425848007, "policy_loss": -0.007858064025640488, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1099.3509607057197, "timesteps_this_iter": 44142, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf7b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf860>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf358>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-56-11", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 68.20399641982651}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1415.774851086162, "node_ip": "10.138.0.2", "timesteps_total": 5820261, "iterations_since_restore": 132, "custom_metrics": {"cost1_max": 511.37254473379994, "cost1_min": 34.43622739885693, "system_level_velocity_mean": 15.976152015323065, "outflow_rate_max": 1460.3818926325398, "cost1_mean": 393.3754547471862, "outflow_rate_min": 324.8763846761304, "system_level_velocity_max": 20.299912192917642, "system_level_velocity_min": 11.787428837547205, "cost2_max": -17.47881244758518, "cost2_mean": -106.60335598051128, "outflow_rate_mean": 1179.7244769028296, "cost2_min": -137.93690882890888}, "training_iteration": 132, "episodes_total": 2057, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208596, "time_total_s": 3519.301423072815, "episode_len_mean": 670.36, "pid": 32002, "time_since_restore": 3519.301423072815, "time_this_iter_s": 25.291817903518677, "timesteps_since_restore": 5820261, "info": {"num_steps_trained": 5820261, "load_time_ms": 14.791, "num_steps_sampled": 5820261, "grad_time_ms": 9352.597, "sample_time_ms": 16661.872, "update_time_ms": 8.87, "default": {"vf_explained_var": 0.9882162809371948, "vf_loss": 5.154441833496094, "entropy": 1.378974199295044, "cur_lr": 0.0005000000237487257, "total_loss": 5.1484375, "kl": 0.016723250970244408, "policy_loss": -0.009179177694022655, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1107.304331687539, "timesteps_this_iter": 42860, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf780>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfeb8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-56-36", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 68.20399641982651}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1415.774851086162, "node_ip": "10.138.0.2", "timesteps_total": 5863673, "iterations_since_restore": 133, "custom_metrics": {"cost1_max": 511.37254473379994, "cost1_min": 29.114395679302145, "system_level_velocity_mean": 15.874290690808866, "outflow_rate_max": 1460.3818926325398, "cost1_mean": 386.4864069579708, "outflow_rate_min": 324.8763846761304, "system_level_velocity_max": 20.299912192917642, "system_level_velocity_min": 11.787428837547205, "cost2_max": -17.47881244758518, "cost2_mean": -104.86241662994183, "outflow_rate_mean": 1165.1342052218288, "cost2_min": -137.93690882890888}, "training_iteration": 133, "episodes_total": 2075, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208622, "time_total_s": 3544.9968886375427, "episode_len_mean": 664.75, "pid": 32002, "time_since_restore": 3544.9968886375427, "time_this_iter_s": 25.695465564727783, "timesteps_since_restore": 5863673, "info": {"num_steps_trained": 5863673, "load_time_ms": 14.79, "num_steps_sampled": 5863673, "grad_time_ms": 9359.017, "sample_time_ms": 16586.702, "update_time_ms": 9.097, "default": {"vf_explained_var": 0.9730146527290344, "vf_loss": 11.909473419189453, "entropy": 1.3927334547042847, "cur_lr": 0.0005000000237487257, "total_loss": 11.904454231262207, "kl": 0.016393274068832397, "policy_loss": -0.008132032118737698, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1090.5834205467645, "timesteps_this_iter": 43412, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfc50>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf080>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-57-02", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 55.45235055297227}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1415.774851086162, "node_ip": "10.138.0.2", "timesteps_total": 5908184, "iterations_since_restore": 134, "custom_metrics": {"cost1_max": 511.37254473379994, "cost1_min": 29.114395679302145, "system_level_velocity_mean": 15.87545068690013, "outflow_rate_max": 1460.3818926325398, "cost1_mean": 386.77920214438086, "outflow_rate_min": 324.8763846761304, "system_level_velocity_max": 20.299912192917642, "system_level_velocity_min": 11.787428837547205, "cost2_max": -17.47881244758518, "cost2_mean": -104.4798630920456, "outflow_rate_mean": 1165.6626351556424, "cost2_min": -139.05955125600667}, "training_iteration": 134, "episodes_total": 2090, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208648, "time_total_s": 3571.2736146450043, "episode_len_mean": 664.75, "pid": 32002, "time_since_restore": 3571.2736146450043, "time_this_iter_s": 26.276726007461548, "timesteps_since_restore": 5908184, "info": {"num_steps_trained": 5908184, "load_time_ms": 14.878, "num_steps_sampled": 5908184, "grad_time_ms": 9360.592, "sample_time_ms": 16461.155, "update_time_ms": 8.964, "default": {"vf_explained_var": 0.9897541999816895, "vf_loss": 4.447902679443359, "entropy": 1.401558518409729, "cur_lr": 0.0005000000237487257, "total_loss": 4.4436726570129395, "kl": 0.01481138076633215, "policy_loss": -0.00704199867323041, "cur_kl_coeff": 0.18984375894069672}}, "episode_reward_mean": 1092.098950531149, "timesteps_this_iter": 44511, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865278>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-57-28", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 55.45235055297227}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1412.4468573855977, "node_ip": "10.138.0.2", "timesteps_total": 5952021, "iterations_since_restore": 135, "custom_metrics": {"cost1_max": 511.37254473379994, "cost1_min": 29.114395679302145, "system_level_velocity_mean": 15.765832707837376, "outflow_rate_max": 1406.221881267155, "cost1_mean": 380.0761087626738, "outflow_rate_min": 324.8763846761304, "system_level_velocity_max": 20.299912192917642, "system_level_velocity_min": 13.001806382237227, "cost2_max": -17.47881244758518, "cost2_mean": -101.85712299840738, "outflow_rate_mean": 1147.2876136582254, "cost2_min": -139.05955125600667}, "training_iteration": 135, "episodes_total": 2107, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208674, "time_total_s": 3596.952972650528, "episode_len_mean": 659.75, "pid": 32002, "time_since_restore": 3596.952972650528, "time_this_iter_s": 25.67935800552368, "timesteps_since_restore": 5952021, "info": {"num_steps_trained": 5952021, "load_time_ms": 14.818, "num_steps_sampled": 5952021, "grad_time_ms": 9250.457, "sample_time_ms": 16320.362, "update_time_ms": 8.717, "default": {"vf_explained_var": 0.9853835105895996, "vf_loss": 6.527746200561523, "entropy": 1.3987016677856445, "cur_lr": 0.0005000000237487257, "total_loss": 6.52415132522583, "kl": 0.01673196442425251, "policy_loss": -0.006771111395210028, "cur_kl_coeff": 0.1898437887430191}}, "episode_reward_mean": 1078.479805795847, "timesteps_this_iter": 43837, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1940>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1a20>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-57-54", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 55.45235055297227}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1412.4468573855977, "node_ip": "10.138.0.2", "timesteps_total": 5994724, "iterations_since_restore": 136, "custom_metrics": {"cost1_max": 511.37254473379994, "cost1_min": 29.114395679302145, "system_level_velocity_mean": 15.648148518998171, "outflow_rate_max": 1406.221881267155, "cost1_mean": 376.6767098789628, "outflow_rate_min": 324.8763846761304, "system_level_velocity_max": 20.299912192917642, "system_level_velocity_min": 12.757781904380717, "cost2_max": -17.47881244758518, "cost2_mean": -100.35936651057999, "outflow_rate_mean": 1140.0599225856295, "cost2_min": -139.05955125600667}, "training_iteration": 136, "episodes_total": 2124, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208700, "time_total_s": 3622.535448074341, "episode_len_mean": 659.56, "pid": 32002, "time_since_restore": 3622.535448074341, "time_this_iter_s": 25.582475423812866, "timesteps_since_restore": 5994724, "info": {"num_steps_trained": 5994724, "load_time_ms": 14.761, "num_steps_sampled": 5994724, "grad_time_ms": 9193.085, "sample_time_ms": 16353.068, "update_time_ms": 8.623, "default": {"vf_explained_var": 0.9822928309440613, "vf_loss": 8.121285438537598, "entropy": 1.3990546464920044, "cur_lr": 0.0005000000237487257, "total_loss": 8.116833686828613, "kl": 0.01810567080974579, "policy_loss": -0.007889117114245892, "cur_kl_coeff": 0.18984375894069672}}, "episode_reward_mean": 1076.5726242008939, "timesteps_this_iter": 42703, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfd68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf2e8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-58-20", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 55.45235055297227}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1412.4468573855977, "node_ip": "10.138.0.2", "timesteps_total": 6038577, "iterations_since_restore": 137, "custom_metrics": {"cost1_max": 497.425100340947, "cost1_min": 29.114395679302145, "system_level_velocity_mean": 15.430169401605063, "outflow_rate_max": 1398.5773408505195, "cost1_mean": 379.2405870916757, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 19.86572520806146, "system_level_velocity_min": 12.757781904380717, "cost2_max": -17.627840908093425, "cost2_mean": -102.28986314682035, "outflow_rate_mean": 1148.3780254351213, "cost2_min": -139.05955125600667}, "training_iteration": 137, "episodes_total": 2137, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208725, "time_total_s": 3648.202840566635, "episode_len_mean": 670.91, "pid": 32002, "time_since_restore": 3648.202840566635, "time_this_iter_s": 25.66739249229431, "timesteps_since_restore": 6038577, "info": {"num_steps_trained": 6038577, "load_time_ms": 14.714, "num_steps_sampled": 6038577, "grad_time_ms": 9128.269, "sample_time_ms": 16518.16, "update_time_ms": 8.368, "default": {"vf_explained_var": 0.9853693842887878, "vf_loss": 6.582496166229248, "entropy": 1.3900421857833862, "cur_lr": 0.0005000000237487257, "total_loss": 6.579141616821289, "kl": 0.014568590559065342, "policy_loss": -0.006120640784502029, "cur_kl_coeff": 0.1898437887430191}}, "episode_reward_mean": 1085.8081717010675, "timesteps_this_iter": 43853, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668657f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668655c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1898>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-58-45", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 55.45235055297227}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1412.4468573855977, "node_ip": "10.138.0.2", "timesteps_total": 6081834, "iterations_since_restore": 138, "custom_metrics": {"cost1_max": 497.425100340947, "cost1_min": 29.114395679302145, "system_level_velocity_mean": 15.458031609288861, "outflow_rate_max": 1440.242526439571, "cost1_mean": 380.14699283423363, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 19.86572520806146, "system_level_velocity_min": 12.757781904380717, "cost2_max": -17.627840908093425, "cost2_mean": -102.54680672240067, "outflow_rate_mean": 1151.0946680929542, "cost2_min": -139.05955125600667}, "training_iteration": 138, "episodes_total": 2153, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208751, "time_total_s": 3673.995264530182, "episode_len_mean": 670.91, "pid": 32002, "time_since_restore": 3673.995264530182, "time_this_iter_s": 25.792423963546753, "timesteps_since_restore": 6081834, "info": {"num_steps_trained": 6081834, "load_time_ms": 14.63, "num_steps_sampled": 6081834, "grad_time_ms": 9130.419, "sample_time_ms": 16426.279, "update_time_ms": 8.425, "default": {"vf_explained_var": 0.9837332963943481, "vf_loss": 7.546403884887695, "entropy": 1.3833221197128296, "cur_lr": 0.0005000000237487257, "total_loss": 7.541688442230225, "kl": 0.016689352691173553, "policy_loss": -0.007884231396019459, "cur_kl_coeff": 0.18984375894069672}}, "episode_reward_mean": 1086.318175841554, "timesteps_this_iter": 43257, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865860>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865240>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-59-11", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 55.45235055297227}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1412.4468573855977, "node_ip": "10.138.0.2", "timesteps_total": 6125821, "iterations_since_restore": 139, "custom_metrics": {"cost1_max": 500.78599409709466, "cost1_min": 29.114395679302145, "system_level_velocity_mean": 15.490218896380725, "outflow_rate_max": 1440.242526439571, "cost1_mean": 382.88867795504166, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 19.86572520806146, "system_level_velocity_min": 12.757781904380717, "cost2_max": -17.627840908093425, "cost2_mean": -102.34413879072845, "outflow_rate_mean": 1156.8246181653005, "cost2_min": -139.05955125600667}, "training_iteration": 139, "episodes_total": 2169, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208778, "time_total_s": 3700.5390038490295, "episode_len_mean": 672.87, "pid": 32002, "time_since_restore": 3700.5390038490295, "time_this_iter_s": 26.543739318847656, "timesteps_since_restore": 6125821, "info": {"num_steps_trained": 6125821, "load_time_ms": 14.575, "num_steps_sampled": 6125821, "grad_time_ms": 9176.894, "sample_time_ms": 16585.607, "update_time_ms": 8.46, "default": {"vf_explained_var": 0.9820764660835266, "vf_loss": 9.103074073791504, "entropy": 1.3987841606140137, "cur_lr": 0.0005000000237487257, "total_loss": 9.09902572631836, "kl": 0.014051737263798714, "policy_loss": -0.006716156844049692, "cur_kl_coeff": 0.18984375894069672}}, "episode_reward_mean": 1094.4511376779947, "timesteps_this_iter": 43987, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865128>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865c18>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-59-38", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 55.45235055297227}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1428.3518465999132, "node_ip": "10.138.0.2", "timesteps_total": 6169106, "iterations_since_restore": 140, "custom_metrics": {"cost1_max": 500.78599409709466, "cost1_min": 79.82851555835967, "system_level_velocity_mean": 15.404865150428007, "outflow_rate_max": 1440.242526439571, "cost1_mean": 389.23559429756506, "outflow_rate_min": 428.09789610700403, "system_level_velocity_max": 19.86572520806146, "system_level_velocity_min": 12.158824015529918, "cost2_max": -27.38511991349681, "cost2_mean": -102.79130492389123, "outflow_rate_mean": 1172.5847327027266, "cost2_min": -130.0703397413174}, "training_iteration": 140, "episodes_total": 2184, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208803, "time_total_s": 3725.8066313266754, "episode_len_mean": 684.45, "pid": 32002, "time_since_restore": 3725.8066313266754, "time_this_iter_s": 25.267627477645874, "timesteps_since_restore": 6169106, "info": {"num_steps_trained": 6169106, "load_time_ms": 14.504, "num_steps_sampled": 6169106, "grad_time_ms": 9127.668, "sample_time_ms": 16480.429, "update_time_ms": 8.566, "default": {"vf_explained_var": 0.9858633875846863, "vf_loss": 6.20686674118042, "entropy": 1.390480399131775, "cur_lr": 0.0005000000237487257, "total_loss": 6.200161933898926, "kl": 0.01648947224020958, "policy_loss": -0.009835246950387955, "cur_kl_coeff": 0.18984375894069672}}, "episode_reward_mean": 1115.9530210049663, "timesteps_this_iter": 43285, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf198>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfe80>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-00-03", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 158.3448525224052}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1428.3518465999132, "node_ip": "10.138.0.2", "timesteps_total": 6211904, "iterations_since_restore": 141, "custom_metrics": {"cost1_max": 500.78599409709466, "cost1_min": 79.82851555835967, "system_level_velocity_mean": 15.377361504849251, "outflow_rate_max": 1440.242526439571, "cost1_mean": 389.1938595758266, "outflow_rate_min": 428.09789610700403, "system_level_velocity_max": 19.86572520806146, "system_level_velocity_min": 12.158824015529918, "cost2_max": -27.38511991349681, "cost2_mean": -102.9408793878142, "outflow_rate_mean": 1173.5217242903573, "cost2_min": -130.0703397413174}, "training_iteration": 141, "episodes_total": 2201, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208829, "time_total_s": 3751.6255600452423, "episode_len_mean": 684.45, "pid": 32002, "time_since_restore": 3751.6255600452423, "time_this_iter_s": 25.818928718566895, "timesteps_since_restore": 6211904, "info": {"num_steps_trained": 6211904, "load_time_ms": 14.516, "num_steps_sampled": 6211904, "grad_time_ms": 9078.261, "sample_time_ms": 16568.926, "update_time_ms": 8.455, "default": {"vf_explained_var": 0.9904277324676514, "vf_loss": 4.458805084228516, "entropy": 1.3745211362838745, "cur_lr": 0.0005000000237487257, "total_loss": 4.45369815826416, "kl": 0.015624099411070347, "policy_loss": -0.008073565550148487, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1119.445890602154, "timesteps_this_iter": 42798, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa6d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cea90>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-00-29", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 158.3448525224052}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1428.3518465999132, "node_ip": "10.138.0.2", "timesteps_total": 6256705, "iterations_since_restore": 142, "custom_metrics": {"cost1_max": 500.78599409709466, "cost1_min": 79.82851555835967, "system_level_velocity_mean": 15.384606402977635, "outflow_rate_max": 1440.242526439571, "cost1_mean": 393.32739824298994, "outflow_rate_min": 428.09789610700403, "system_level_velocity_max": 19.86572520806146, "system_level_velocity_min": 12.158824015529918, "cost2_max": -27.38511991349681, "cost2_mean": -103.61652924186555, "outflow_rate_mean": 1183.5198623425729, "cost2_min": -130.0703397413174}, "training_iteration": 142, "episodes_total": 2213, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208855, "time_total_s": 3777.7115824222565, "episode_len_mean": 689.45, "pid": 32002, "time_since_restore": 3777.7115824222565, "time_this_iter_s": 26.08602237701416, "timesteps_since_restore": 6256705, "info": {"num_steps_trained": 6256705, "load_time_ms": 14.3, "num_steps_sampled": 6256705, "grad_time_ms": 9028.332, "sample_time_ms": 16701.496, "update_time_ms": 8.463, "default": {"vf_explained_var": 0.9902777075767517, "vf_loss": 3.8644731044769287, "entropy": 1.378204345703125, "cur_lr": 0.0005000000237487257, "total_loss": 3.8588993549346924, "kl": 0.01596147008240223, "policy_loss": -0.008603990077972412, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1131.209387133744, "timesteps_this_iter": 44801, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865ef0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865128>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-00-55", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 158.3448525224052}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1428.3518465999132, "node_ip": "10.138.0.2", "timesteps_total": 6300902, "iterations_since_restore": 143, "custom_metrics": {"cost1_max": 500.78599409709466, "cost1_min": 232.91496015472956, "system_level_velocity_mean": 15.351248745061573, "outflow_rate_max": 1440.242526439571, "cost1_mean": 397.2571146365915, "outflow_rate_min": 786.9017200555938, "system_level_velocity_max": 18.985466832244008, "system_level_velocity_min": 12.158824015529918, "cost2_max": -66.27180901351971, "cost2_mean": -104.52421984212916, "outflow_rate_mean": 1195.889124799503, "cost2_min": -130.0703397413174}, "training_iteration": 143, "episodes_total": 2229, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208881, "time_total_s": 3803.945812702179, "episode_len_mean": 695.32, "pid": 32002, "time_since_restore": 3803.945812702179, "time_this_iter_s": 26.234230279922485, "timesteps_since_restore": 6300902, "info": {"num_steps_trained": 6300902, "load_time_ms": 14.568, "num_steps_sampled": 6300902, "grad_time_ms": 9003.597, "sample_time_ms": 16780.852, "update_time_ms": 8.212, "default": {"vf_explained_var": 0.9860197901725769, "vf_loss": 6.16394567489624, "entropy": 1.3809387683868408, "cur_lr": 0.0005000000237487257, "total_loss": 6.16005802154541, "kl": 0.01435132883489132, "policy_loss": -0.0066124750301241875, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1144.2244670710443, "timesteps_this_iter": 44197, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668657f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865a90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1940>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-01-21", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 665.2435968692668}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1428.3518465999132, "node_ip": "10.138.0.2", "timesteps_total": 6343847, "iterations_since_restore": 144, "custom_metrics": {"cost1_max": 507.05943315040554, "cost1_min": 232.91496015472956, "system_level_velocity_mean": 15.29590187467706, "outflow_rate_max": 1440.242526439571, "cost1_mean": 396.53620180356853, "outflow_rate_min": 786.9017200555938, "system_level_velocity_max": 19.05513057140582, "system_level_velocity_min": 12.158824015529918, "cost2_max": -66.27180901351971, "cost2_mean": -102.97726926456417, "outflow_rate_mean": 1192.113316362878, "cost2_min": -130.0703397413174}, "training_iteration": 144, "episodes_total": 2247, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208908, "time_total_s": 3830.434018611908, "episode_len_mean": 696.36, "pid": 32002, "time_since_restore": 3830.434018611908, "time_this_iter_s": 26.488205909729004, "timesteps_since_restore": 6343847, "info": {"num_steps_trained": 6343847, "load_time_ms": 14.592, "num_steps_sampled": 6343847, "grad_time_ms": 8876.72, "sample_time_ms": 16929.904, "update_time_ms": 8.166, "default": {"vf_explained_var": 0.9820203185081482, "vf_loss": 8.414617538452148, "entropy": 1.3597676753997803, "cur_lr": 0.0005000000237487257, "total_loss": 8.410202980041504, "kl": 0.014028646983206272, "policy_loss": -0.007077379152178764, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1143.4783258793018, "timesteps_this_iter": 42945, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668654a8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865860>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-01-48", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 665.2435968692668}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1428.3518465999132, "node_ip": "10.138.0.2", "timesteps_total": 6386898, "iterations_since_restore": 145, "custom_metrics": {"cost1_max": 507.05943315040554, "cost1_min": 234.53464272134323, "system_level_velocity_mean": 15.283999712934339, "outflow_rate_max": 1417.1094675296306, "cost1_mean": 396.0621339941474, "outflow_rate_min": 771.5285817230305, "system_level_velocity_max": 19.05513057140582, "system_level_velocity_min": 12.158824015529918, "cost2_max": -81.0894909431639, "cost2_mean": -102.74474769570678, "outflow_rate_mean": 1188.4928410350183, "cost2_min": -126.48636326526082}, "training_iteration": 145, "episodes_total": 2261, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208934, "time_total_s": 3856.4428346157074, "episode_len_mean": 696.47, "pid": 32002, "time_since_restore": 3856.4428346157074, "time_this_iter_s": 26.00881600379944, "timesteps_since_restore": 6386898, "info": {"num_steps_trained": 6386898, "load_time_ms": 14.434, "num_steps_sampled": 6386898, "grad_time_ms": 8796.275, "sample_time_ms": 17044.286, "update_time_ms": 8.032, "default": {"vf_explained_var": 0.9863530397415161, "vf_loss": 6.127628803253174, "entropy": 1.3852092027664185, "cur_lr": 0.0005000000237487257, "total_loss": 6.122718334197998, "kl": 0.01590219885110855, "policy_loss": -0.00792965292930603, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1139.731766423467, "timesteps_this_iter": 43051, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865f60>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668653c8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-02-14", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 654.7769960249263}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1425.3918906851345, "node_ip": "10.138.0.2", "timesteps_total": 6430376, "iterations_since_restore": 146, "custom_metrics": {"cost1_max": 507.05943315040554, "cost1_min": 91.16974744282452, "system_level_velocity_mean": 15.336030688559246, "outflow_rate_max": 1417.1094675296306, "cost1_mean": 388.7175399288683, "outflow_rate_min": 422.5835673144124, "system_level_velocity_max": 19.509103115582164, "system_level_velocity_min": 12.868956350328268, "cost2_max": -31.527800768720923, "cost2_mean": -103.10055129017806, "outflow_rate_mean": 1173.4361748293584, "cost2_min": -126.63442160138908}, "training_iteration": 146, "episodes_total": 2279, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208960, "time_total_s": 3882.9714171886444, "episode_len_mean": 684.4, "pid": 32002, "time_since_restore": 3882.9714171886444, "time_this_iter_s": 26.52858257293701, "timesteps_since_restore": 6430376, "info": {"num_steps_trained": 6430376, "load_time_ms": 14.651, "num_steps_sampled": 6430376, "grad_time_ms": 8774.946, "sample_time_ms": 17160.923, "update_time_ms": 7.934, "default": {"vf_explained_var": 0.9711503386497498, "vf_loss": 12.166637420654297, "entropy": 1.3661432266235352, "cur_lr": 0.0005000000237487257, "total_loss": 12.16268539428711, "kl": 0.01517490204423666, "policy_loss": -0.006833130028098822, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1121.0480999470763, "timesteps_this_iter": 43478, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668650f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865ef0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-02-40", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 213.33728291162902}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1425.3918906851345, "node_ip": "10.138.0.2", "timesteps_total": 6474420, "iterations_since_restore": 147, "custom_metrics": {"cost1_max": 507.05943315040554, "cost1_min": 91.16974744282452, "system_level_velocity_mean": 15.32953650095053, "outflow_rate_max": 1376.3273286248311, "cost1_mean": 384.33913622824565, "outflow_rate_min": 422.5835673144124, "system_level_velocity_max": 19.74078124330856, "system_level_velocity_min": 12.903108822738178, "cost2_max": -31.527800768720923, "cost2_mean": -103.49953144499642, "outflow_rate_mean": 1163.2052645828012, "cost2_min": -128.9218152907624}, "training_iteration": 147, "episodes_total": 2291, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557208986, "time_total_s": 3908.4167952537537, "episode_len_mean": 679.49, "pid": 32002, "time_since_restore": 3908.4167952537537, "time_this_iter_s": 25.445378065109253, "timesteps_since_restore": 6474420, "info": {"num_steps_trained": 6474420, "load_time_ms": 14.508, "num_steps_sampled": 6474420, "grad_time_ms": 8810.848, "sample_time_ms": 17106.324, "update_time_ms": 7.75, "default": {"vf_explained_var": 0.9816293120384216, "vf_loss": 7.993515968322754, "entropy": 1.354864239692688, "cur_lr": 0.0005000000237487257, "total_loss": 7.988189697265625, "kl": 0.016419103369116783, "policy_loss": -0.008443189784884453, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1109.435632691467, "timesteps_this_iter": 44044, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668654e0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865f98>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-03-06", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 213.33728291162902}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1425.3918906851345, "node_ip": "10.138.0.2", "timesteps_total": 6518020, "iterations_since_restore": 148, "custom_metrics": {"cost1_max": 507.05943315040554, "cost1_min": 32.47991144434695, "system_level_velocity_mean": 15.480103365453463, "outflow_rate_max": 1446.826316482522, "cost1_mean": 383.5054160439371, "outflow_rate_min": 327.87941281053116, "system_level_velocity_max": 19.84682734790623, "system_level_velocity_min": 12.903108822738178, "cost2_max": -19.630348432431045, "cost2_mean": -105.2946734650207, "outflow_rate_mean": 1164.5606262778247, "cost2_min": -135.62133802195336}, "training_iteration": 148, "episodes_total": 2311, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209012, "time_total_s": 3934.4361753463745, "episode_len_mean": 672.96, "pid": 32002, "time_since_restore": 3934.4361753463745, "time_this_iter_s": 26.01938009262085, "timesteps_since_restore": 6518020, "info": {"num_steps_trained": 6518020, "load_time_ms": 14.687, "num_steps_sampled": 6518020, "grad_time_ms": 8783.1, "sample_time_ms": 17157.231, "update_time_ms": 7.449, "default": {"vf_explained_var": 0.9746915102005005, "vf_loss": 10.88370418548584, "entropy": 1.355525255203247, "cur_lr": 0.0005000000237487257, "total_loss": 10.878814697265625, "kl": 0.014804781414568424, "policy_loss": -0.007700073532760143, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1111.9342752631558, "timesteps_this_iter": 43600, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ceda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce470>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cef98>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-03-32", "hostname": "flow-main", "episodes_this_iter": 20, "episode_reward_min": 58.00876528600755}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1390.0256400110118, "node_ip": "10.138.0.2", "timesteps_total": 6560949, "iterations_since_restore": 149, "custom_metrics": {"cost1_max": 482.7841259454355, "cost1_min": 29.105675061959648, "system_level_velocity_mean": 15.454770760960383, "outflow_rate_max": 1446.826316482522, "cost1_mean": 373.30488471768325, "outflow_rate_min": 327.87941281053116, "system_level_velocity_max": 19.957899375077428, "system_level_velocity_min": 12.778891268021338, "cost2_max": -17.706141678360332, "cost2_mean": -104.67747626828992, "outflow_rate_mean": 1137.8211643220366, "cost2_min": -135.62133802195336}, "training_iteration": 149, "episodes_total": 2330, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209038, "time_total_s": 3960.9044983386993, "episode_len_mean": 661.34, "pid": 32002, "time_since_restore": 3960.9044983386993, "time_this_iter_s": 26.46832299232483, "timesteps_since_restore": 6560949, "info": {"num_steps_trained": 6560949, "load_time_ms": 14.722, "num_steps_sampled": 6560949, "grad_time_ms": 8730.822, "sample_time_ms": 17202.93, "update_time_ms": 7.244, "default": {"vf_explained_var": 0.9757464528083801, "vf_loss": 9.88043212890625, "entropy": 1.3782031536102295, "cur_lr": 0.0005000000237487257, "total_loss": 9.87396240234375, "kl": 0.017304468899965286, "policy_loss": -0.009755013510584831, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1081.5502568368133, "timesteps_this_iter": 42929, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865ba8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865a90>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-03-58", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 54.69025624128013}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1390.0256400110118, "node_ip": "10.138.0.2", "timesteps_total": 6605789, "iterations_since_restore": 150, "custom_metrics": {"cost1_max": 482.7841259454355, "cost1_min": 29.105675061959648, "system_level_velocity_mean": 15.503311696422408, "outflow_rate_max": 1446.826316482522, "cost1_mean": 371.3755966762895, "outflow_rate_min": 327.87941281053116, "system_level_velocity_max": 19.957899375077428, "system_level_velocity_min": 12.774336380526385, "cost2_max": -17.706141678360332, "cost2_mean": -105.23984246693607, "outflow_rate_mean": 1133.392256494133, "cost2_min": -135.62133802195336}, "training_iteration": 150, "episodes_total": 2341, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209066, "time_total_s": 3988.1060469150543, "episode_len_mean": 656.69, "pid": 32002, "time_since_restore": 3988.1060469150543, "time_this_iter_s": 27.20154857635498, "timesteps_since_restore": 6605789, "info": {"num_steps_trained": 6605789, "load_time_ms": 14.906, "num_steps_sampled": 6605789, "grad_time_ms": 8790.594, "sample_time_ms": 17337.356, "update_time_ms": 6.865, "default": {"vf_explained_var": 0.9859688878059387, "vf_loss": 6.018369197845459, "entropy": 1.3662880659103394, "cur_lr": 0.0005000000237487257, "total_loss": 6.014650344848633, "kl": 0.014924111776053905, "policy_loss": -0.006552570965141058, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1073.236647128169, "timesteps_this_iter": 44840, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf278>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b94a8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-04-26", "hostname": "flow-main", "episodes_this_iter": 11, "episode_reward_min": 54.69025624128013}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1390.0256400110118, "node_ip": "10.138.0.2", "timesteps_total": 6649272, "iterations_since_restore": 151, "custom_metrics": {"cost1_max": 482.7841259454355, "cost1_min": 29.105675061959648, "system_level_velocity_mean": 15.477592264498309, "outflow_rate_max": 1446.826316482522, "cost1_mean": 372.8769274425216, "outflow_rate_min": 327.87941281053116, "system_level_velocity_max": 19.957899375077428, "system_level_velocity_min": 12.774336380526385, "cost2_max": -17.706141678360332, "cost2_mean": -106.92387075893623, "outflow_rate_mean": 1138.643030396873, "cost2_min": -135.62133802195336}, "training_iteration": 151, "episodes_total": 2359, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209092, "time_total_s": 4014.069724082947, "episode_len_mean": 660.22, "pid": 32002, "time_since_restore": 4014.069724082947, "time_this_iter_s": 25.963677167892456, "timesteps_since_restore": 6649272, "info": {"num_steps_trained": 6649272, "load_time_ms": 14.863, "num_steps_sampled": 6649272, "grad_time_ms": 8752.792, "sample_time_ms": 17390.378, "update_time_ms": 6.694, "default": {"vf_explained_var": 0.9869339466094971, "vf_loss": 5.716985702514648, "entropy": 1.4079827070236206, "cur_lr": 0.0005000000237487257, "total_loss": 5.7119269371032715, "kl": 0.016466191038489342, "policy_loss": -0.008184798061847687, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1083.9364688765595, "timesteps_this_iter": 43483, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668655c0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-04-52", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 54.69025624128013}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1439.093729033612, "node_ip": "10.138.0.2", "timesteps_total": 6693321, "iterations_since_restore": 152, "custom_metrics": {"cost1_max": 525.1513479953948, "cost1_min": 29.105675061959648, "system_level_velocity_mean": 15.41686869773943, "outflow_rate_max": 1446.826316482522, "cost1_mean": 376.31821998570973, "outflow_rate_min": 327.87941281053116, "system_level_velocity_max": 19.957899375077428, "system_level_velocity_min": 12.686021294420907, "cost2_max": -17.706141678360332, "cost2_mean": -107.96797044676897, "outflow_rate_mean": 1144.8865032407705, "cost2_min": -135.62133802195336}, "training_iteration": 152, "episodes_total": 2373, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209118, "time_total_s": 4040.4342951774597, "episode_len_mean": 667.44, "pid": 32002, "time_since_restore": 4040.4342951774597, "time_this_iter_s": 26.36457109451294, "timesteps_since_restore": 6693321, "info": {"num_steps_trained": 6693321, "load_time_ms": 14.977, "num_steps_sampled": 6693321, "grad_time_ms": 8702.151, "sample_time_ms": 17468.929, "update_time_ms": 6.588, "default": {"vf_explained_var": 0.9841839075088501, "vf_loss": 7.299130439758301, "entropy": 1.3922377824783325, "cur_lr": 0.0005000000237487257, "total_loss": 7.294412136077881, "kl": 0.016493625938892365, "policy_loss": -0.007848621346056461, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1093.5374344232043, "timesteps_this_iter": 44049, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1c50>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1be0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-05-18", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 54.69025624128013}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1439.093729033612, "node_ip": "10.138.0.2", "timesteps_total": 6737992, "iterations_since_restore": 153, "custom_metrics": {"cost1_max": 525.1513479953948, "cost1_min": 29.105675061959648, "system_level_velocity_mean": 15.434605503714915, "outflow_rate_max": 1446.826316482522, "cost1_mean": 380.2463261022806, "outflow_rate_min": 327.87941281053116, "system_level_velocity_max": 19.957899375077428, "system_level_velocity_min": 12.686021294420907, "cost2_max": -17.706141678360332, "cost2_mean": -109.62606647119524, "outflow_rate_mean": 1154.647414671467, "cost2_min": -141.52851016348768}, "training_iteration": 153, "episodes_total": 2387, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209145, "time_total_s": 4067.448210954666, "episode_len_mean": 671.82, "pid": 32002, "time_since_restore": 4067.448210954666, "time_this_iter_s": 27.01391577720642, "timesteps_since_restore": 6737992, "info": {"num_steps_trained": 6737992, "load_time_ms": 14.676, "num_steps_sampled": 6737992, "grad_time_ms": 8675.621, "sample_time_ms": 17573.264, "update_time_ms": 6.673, "default": {"vf_explained_var": 0.9838674068450928, "vf_loss": 7.328648567199707, "entropy": 1.4165107011795044, "cur_lr": 0.0005000000237487257, "total_loss": 7.323146820068359, "kl": 0.01895378716289997, "policy_loss": -0.009099556133151054, "cur_kl_coeff": 0.18984375894069672}}, "episode_reward_mean": 1103.5924617486462, "timesteps_this_iter": 44671, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668659e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865358>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865080>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-05-45", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 54.69025624128013}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1439.093729033612, "node_ip": "10.138.0.2", "timesteps_total": 6780653, "iterations_since_restore": 154, "custom_metrics": {"cost1_max": 525.1513479953948, "cost1_min": 29.105675061959648, "system_level_velocity_mean": 15.313832970330706, "outflow_rate_max": 1392.583070964692, "cost1_mean": 381.45200886732425, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 19.957899375077428, "system_level_velocity_min": 12.686021294420907, "cost2_max": -17.706141678360332, "cost2_mean": -109.55417730181216, "outflow_rate_mean": 1152.7135666954828, "cost2_min": -141.52851016348768}, "training_iteration": 154, "episodes_total": 2405, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209172, "time_total_s": 4094.130499124527, "episode_len_mean": 678.35, "pid": 32002, "time_since_restore": 4094.130499124527, "time_this_iter_s": 26.68228816986084, "timesteps_since_restore": 6780653, "info": {"num_steps_trained": 6780653, "load_time_ms": 14.439, "num_steps_sampled": 6780653, "grad_time_ms": 8707.131, "sample_time_ms": 17559.363, "update_time_ms": 6.771, "default": {"vf_explained_var": 0.9868656992912292, "vf_loss": 6.727904319763184, "entropy": 1.4168899059295654, "cur_lr": 0.0005000000237487257, "total_loss": 6.723159313201904, "kl": 0.015915023162961006, "policy_loss": -0.0077655422501266, "cur_kl_coeff": 0.18984375894069672}}, "episode_reward_mean": 1099.5344460854521, "timesteps_this_iter": 42661, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce4e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cea20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ceb70>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-06-12", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 54.69025624128013}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1439.093729033612, "node_ip": "10.138.0.2", "timesteps_total": 6824512, "iterations_since_restore": 155, "custom_metrics": {"cost1_max": 525.1513479953948, "cost1_min": 107.24317914468111, "system_level_velocity_mean": 15.426564108420417, "outflow_rate_max": 1403.2998856581187, "cost1_mean": 385.6603782277638, "outflow_rate_min": 441.22521557309375, "system_level_velocity_max": 19.957899375077428, "system_level_velocity_min": 12.686021294420907, "cost2_max": -38.64585152668158, "cost2_mean": -109.91798449992261, "outflow_rate_mean": 1163.7857268845835, "cost2_min": -141.52851016348768}, "training_iteration": 155, "episodes_total": 2419, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209199, "time_total_s": 4121.395401239395, "episode_len_mean": 679.42, "pid": 32002, "time_since_restore": 4121.395401239395, "time_this_iter_s": 27.264902114868164, "timesteps_since_restore": 6824512, "info": {"num_steps_trained": 6824512, "load_time_ms": 14.215, "num_steps_sampled": 6824512, "grad_time_ms": 8736.067, "sample_time_ms": 17655.649, "update_time_ms": 7.014, "default": {"vf_explained_var": 0.983572244644165, "vf_loss": 6.499552249908447, "entropy": 1.4431794881820679, "cur_lr": 0.0005000000237487257, "total_loss": 6.494110584259033, "kl": 0.016469087451696396, "policy_loss": -0.00856818538159132, "cur_kl_coeff": 0.1898437887430191}}, "episode_reward_mean": 1111.9832657295026, "timesteps_this_iter": 43859, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ceeb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce358>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce908>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-06-39", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 233.1058337412551}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1439.093729033612, "node_ip": "10.138.0.2", "timesteps_total": 6868728, "iterations_since_restore": 156, "custom_metrics": {"cost1_max": 525.1513479953948, "cost1_min": 101.8479478925994, "system_level_velocity_mean": 15.4641459592193, "outflow_rate_max": 1403.2998856581187, "cost1_mean": 382.7401039552753, "outflow_rate_min": 441.22521557309375, "system_level_velocity_max": 19.646903954796176, "system_level_velocity_min": 12.56380012885222, "cost2_max": -38.31856189696875, "cost2_mean": -108.92137282442958, "outflow_rate_mean": 1155.9872538752236, "cost2_min": -141.52851016348768}, "training_iteration": 156, "episodes_total": 2436, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209227, "time_total_s": 4149.633949041367, "episode_len_mean": 673.99, "pid": 32002, "time_since_restore": 4149.633949041367, "time_this_iter_s": 28.238547801971436, "timesteps_since_restore": 6868728, "info": {"num_steps_trained": 6868728, "load_time_ms": 14.037, "num_steps_sampled": 6868728, "grad_time_ms": 8900.434, "sample_time_ms": 17660.819, "update_time_ms": 7.148, "default": {"vf_explained_var": 0.9801610708236694, "vf_loss": 8.914288520812988, "entropy": 1.4194302558898926, "cur_lr": 0.0005000000237487257, "total_loss": 8.908247947692871, "kl": 0.01656576804816723, "policy_loss": -0.009184758178889751, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1101.710348397791, "timesteps_this_iter": 44216, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cef60>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce470>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-07-07", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 233.1058337412551}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1439.093729033612, "node_ip": "10.138.0.2", "timesteps_total": 6911249, "iterations_since_restore": 157, "custom_metrics": {"cost1_max": 525.1513479953948, "cost1_min": 80.62657979051444, "system_level_velocity_mean": 15.474352916708176, "outflow_rate_max": 1403.2998856581187, "cost1_mean": 377.6188024669836, "outflow_rate_min": 408.9676454651081, "system_level_velocity_max": 19.845131953329325, "system_level_velocity_min": 12.386269128264196, "cost2_max": -38.31856189696875, "cost2_mean": -108.64317319540073, "outflow_rate_mean": 1142.602914855374, "cost2_min": -141.52851016348768}, "training_iteration": 157, "episodes_total": 2455, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209256, "time_total_s": 4178.304065465927, "episode_len_mean": 667.36, "pid": 32002, "time_since_restore": 4178.304065465927, "time_this_iter_s": 28.670116424560547, "timesteps_since_restore": 6911249, "info": {"num_steps_trained": 6911249, "load_time_ms": 14.28, "num_steps_sampled": 6911249, "grad_time_ms": 9073.496, "sample_time_ms": 17809.342, "update_time_ms": 7.281, "default": {"vf_explained_var": 0.976445198059082, "vf_loss": 10.515412330627441, "entropy": 1.4276001453399658, "cur_lr": 0.0005000000237487257, "total_loss": 10.511013984680176, "kl": 0.016461128368973732, "policy_loss": -0.0075228107161819935, "cur_kl_coeff": 0.18984375894069672}}, "episode_reward_mean": 1086.4427583400718, "timesteps_this_iter": 42521, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1ef0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1f60>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-07-36", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 174.2471127697839}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1439.093729033612, "node_ip": "10.138.0.2", "timesteps_total": 6955772, "iterations_since_restore": 158, "custom_metrics": {"cost1_max": 525.1513479953948, "cost1_min": 80.62657979051444, "system_level_velocity_mean": 15.476598644259306, "outflow_rate_max": 1431.9309902179766, "cost1_mean": 377.47402996870215, "outflow_rate_min": 408.9676454651081, "system_level_velocity_max": 19.845131953329325, "system_level_velocity_min": 12.386269128264196, "cost2_max": -38.31856189696875, "cost2_mean": -109.23103098488542, "outflow_rate_mean": 1143.0705046814617, "cost2_min": -141.52851016348768}, "training_iteration": 158, "episodes_total": 2467, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209284, "time_total_s": 4205.905605554581, "episode_len_mean": 667.36, "pid": 32002, "time_since_restore": 4205.905605554581, "time_this_iter_s": 27.601540088653564, "timesteps_since_restore": 6955772, "info": {"num_steps_trained": 6955772, "load_time_ms": 14.256, "num_steps_sampled": 6955772, "grad_time_ms": 9205.831, "sample_time_ms": 17834.157, "update_time_ms": 7.573, "default": {"vf_explained_var": 0.9846906661987305, "vf_loss": 6.063797473907471, "entropy": 1.4298185110092163, "cur_lr": 0.0005000000237487257, "total_loss": 6.060147285461426, "kl": 0.016033070161938667, "policy_loss": -0.0066939485259354115, "cur_kl_coeff": 0.18984375894069672}}, "episode_reward_mean": 1085.3702139036102, "timesteps_this_iter": 44523, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9eb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce9e8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-08-04", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 174.2471127697839}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1447.4516080100402, "node_ip": "10.138.0.2", "timesteps_total": 6999925, "iterations_since_restore": 159, "custom_metrics": {"cost1_max": 495.1405136727074, "cost1_min": 80.62657979051444, "system_level_velocity_mean": 15.437422968872648, "outflow_rate_max": 1438.2160337988228, "cost1_mean": 375.7614006676412, "outflow_rate_min": 408.9676454651081, "system_level_velocity_max": 19.845131953329325, "system_level_velocity_min": 12.386269128264196, "cost2_max": -38.31856189696875, "cost2_mean": -109.33771673850886, "outflow_rate_mean": 1137.1266357269878, "cost2_min": -131.47659056275586}, "training_iteration": 159, "episodes_total": 2481, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209309, "time_total_s": 4231.169637203217, "episode_len_mean": 667.36, "pid": 32002, "time_since_restore": 4231.169637203217, "time_this_iter_s": 25.264031648635864, "timesteps_since_restore": 6999925, "info": {"num_steps_trained": 6999925, "load_time_ms": 14.919, "num_steps_sampled": 6999925, "grad_time_ms": 9279.505, "sample_time_ms": 17635.82, "update_time_ms": 7.692, "default": {"vf_explained_var": 0.9828340411186218, "vf_loss": 7.107301712036133, "entropy": 1.4452186822891235, "cur_lr": 0.0005000000237487257, "total_loss": 7.102353096008301, "kl": 0.016965828835964203, "policy_loss": -0.008169802837073803, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1080.0824646770052, "timesteps_this_iter": 44153, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9a90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cef28>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-08-29", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 174.2471127697839}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1447.4516080100402, "node_ip": "10.138.0.2", "timesteps_total": 7041745, "iterations_since_restore": 160, "custom_metrics": {"cost1_max": 495.1405136727074, "cost1_min": 80.62657979051444, "system_level_velocity_mean": 15.407409024805562, "outflow_rate_max": 1438.2160337988228, "cost1_mean": 378.2952346432062, "outflow_rate_min": 408.9676454651081, "system_level_velocity_max": 19.845131953329325, "system_level_velocity_min": 12.386269128264196, "cost2_max": -38.31856189696875, "cost2_mean": -111.03016228144584, "outflow_rate_mean": 1143.2472437815366, "cost2_min": -135.6318863267835}, "training_iteration": 160, "episodes_total": 2499, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209334, "time_total_s": 4255.8816339969635, "episode_len_mean": 672.74, "pid": 32002, "time_since_restore": 4255.8816339969635, "time_this_iter_s": 24.71199679374695, "timesteps_since_restore": 7041745, "info": {"num_steps_trained": 7041745, "load_time_ms": 15.027, "num_steps_sampled": 7041745, "grad_time_ms": 9181.631, "sample_time_ms": 17480.718, "update_time_ms": 7.877, "default": {"vf_explained_var": 0.9834609031677246, "vf_loss": 8.386804580688477, "entropy": 1.4218624830245972, "cur_lr": 0.0005000000237487257, "total_loss": 8.38159465789795, "kl": 0.015415475703775883, "policy_loss": -0.008136087097227573, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1082.2610185918609, "timesteps_this_iter": 41820, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac7b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac0f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aca20>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-08-54", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 174.2471127697839}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1447.4516080100402, "node_ip": "10.138.0.2", "timesteps_total": 7083560, "iterations_since_restore": 161, "custom_metrics": {"cost1_max": 505.01571859874673, "cost1_min": 80.62657979051444, "system_level_velocity_mean": 15.501638224294245, "outflow_rate_max": 1438.2160337988228, "cost1_mean": 381.2487038723494, "outflow_rate_min": 408.9676454651081, "system_level_velocity_max": 19.845131953329325, "system_level_velocity_min": 12.386269128264196, "cost2_max": -38.31856189696875, "cost2_mean": -112.61613041266818, "outflow_rate_mean": 1149.4715139462724, "cost2_min": -139.21073087952493}, "training_iteration": 161, "episodes_total": 2516, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209359, "time_total_s": 4281.2737765312195, "episode_len_mean": 673.72, "pid": 32002, "time_since_restore": 4281.2737765312195, "time_this_iter_s": 25.39214253425598, "timesteps_since_restore": 7083560, "info": {"num_steps_trained": 7083560, "load_time_ms": 14.437, "num_steps_sampled": 7083560, "grad_time_ms": 9218.104, "sample_time_ms": 17386.363, "update_time_ms": 7.893, "default": {"vf_explained_var": 0.9826993346214294, "vf_loss": 8.358380317687988, "entropy": 1.419143795967102, "cur_lr": 0.0005000000237487257, "total_loss": 8.353241920471191, "kl": 0.01581057719886303, "policy_loss": -0.008139301091432571, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1087.5390673329107, "timesteps_this_iter": 41815, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c10f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ceb00>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7978>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-09-19", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 174.2471127697839}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1447.4516080100402, "node_ip": "10.138.0.2", "timesteps_total": 7128312, "iterations_since_restore": 162, "custom_metrics": {"cost1_max": 505.01571859874673, "cost1_min": 80.62657979051444, "system_level_velocity_mean": 15.54991585379579, "outflow_rate_max": 1452.6477661406063, "cost1_mean": 386.89969770712554, "outflow_rate_min": 408.9676454651081, "system_level_velocity_max": 19.845131953329325, "system_level_velocity_min": 12.386269128264196, "cost2_max": -41.206831473449775, "cost2_mean": -114.57493962641976, "outflow_rate_mean": 1163.1518462369559, "cost2_min": -139.21073087952493}, "training_iteration": 162, "episodes_total": 2529, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209385, "time_total_s": 4307.436801195145, "episode_len_mean": 679.3, "pid": 32002, "time_since_restore": 4307.436801195145, "time_this_iter_s": 26.16302466392517, "timesteps_since_restore": 7128312, "info": {"num_steps_trained": 7128312, "load_time_ms": 14.253, "num_steps_sampled": 7128312, "grad_time_ms": 9302.856, "sample_time_ms": 17279.422, "update_time_ms": 8.003, "default": {"vf_explained_var": 0.9858328700065613, "vf_loss": 5.6432881355285645, "entropy": 1.4499776363372803, "cur_lr": 0.0005000000237487257, "total_loss": 5.638543128967285, "kl": 0.016171667724847794, "policy_loss": -0.007815311662852764, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1107.3485865776574, "timesteps_this_iter": 44752, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668acc18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac128>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-09-45", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 174.2471127697839}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1447.4516080100402, "node_ip": "10.138.0.2", "timesteps_total": 7171474, "iterations_since_restore": 163, "custom_metrics": {"cost1_max": 505.01571859874673, "cost1_min": 80.62657979051444, "system_level_velocity_mean": 15.508473098342215, "outflow_rate_max": 1452.6477661406063, "cost1_mean": 389.3577734838691, "outflow_rate_min": 408.9676454651081, "system_level_velocity_max": 19.845131953329325, "system_level_velocity_min": 12.401729535479655, "cost2_max": -41.206831473449775, "cost2_mean": -115.75219045474486, "outflow_rate_mean": 1168.4923494366608, "cost2_min": -139.21073087952493}, "training_iteration": 163, "episodes_total": 2544, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209412, "time_total_s": 4333.8500781059265, "episode_len_mean": 684.2, "pid": 32002, "time_since_restore": 4333.8500781059265, "time_this_iter_s": 26.41327691078186, "timesteps_since_restore": 7171474, "info": {"num_steps_trained": 7171474, "load_time_ms": 14.285, "num_steps_sampled": 7171474, "grad_time_ms": 9380.518, "sample_time_ms": 17141.929, "update_time_ms": 8.068, "default": {"vf_explained_var": 0.9881893396377563, "vf_loss": 5.444182872772217, "entropy": 1.43359375, "cur_lr": 0.0005000000237487257, "total_loss": 5.4392194747924805, "kl": 0.017406268045306206, "policy_loss": -0.008267715573310852, "cur_kl_coeff": 0.18984375894069672}}, "episode_reward_mean": 1113.2579212393314, "timesteps_this_iter": 43162, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668acda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668acf98>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac3c8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-10-12", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 174.2471127697839}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1447.4516080100402, "node_ip": "10.138.0.2", "timesteps_total": 7214612, "iterations_since_restore": 164, "custom_metrics": {"cost1_max": 505.01571859874673, "cost1_min": 177.93807809053754, "system_level_velocity_mean": 15.461019506822646, "outflow_rate_max": 1452.6477661406063, "cost1_mean": 396.4910634017688, "outflow_rate_min": 629.1018869562902, "system_level_velocity_max": 19.26400582421624, "system_level_velocity_min": 12.511588580363057, "cost2_max": -63.48082943596657, "cost2_mean": -117.69028103769116, "outflow_rate_mean": 1185.3745819858282, "cost2_min": -139.21073087952493}, "training_iteration": 164, "episodes_total": 2557, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209437, "time_total_s": 4359.4948987960815, "episode_len_mean": 695.48, "pid": 32002, "time_since_restore": 4359.4948987960815, "time_this_iter_s": 25.64482069015503, "timesteps_since_restore": 7214612, "info": {"num_steps_trained": 7214612, "load_time_ms": 13.986, "num_steps_sampled": 7214612, "grad_time_ms": 9355.616, "sample_time_ms": 17062.412, "update_time_ms": 8.328, "default": {"vf_explained_var": 0.9865210056304932, "vf_loss": 5.57573127746582, "entropy": 1.4499069452285767, "cur_lr": 0.0005000000237487257, "total_loss": 5.56953239440918, "kl": 0.015310686081647873, "policy_loss": -0.009105048142373562, "cur_kl_coeff": 0.18984375894069672}}, "episode_reward_mean": 1136.6628058255696, "timesteps_this_iter": 43138, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ace80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac780>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac748>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-10-37", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 482.96162382873}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1396.9600911223877, "node_ip": "10.138.0.2", "timesteps_total": 7257733, "iterations_since_restore": 165, "custom_metrics": {"cost1_max": 505.01571859874673, "cost1_min": 177.93807809053754, "system_level_velocity_mean": 15.345720883693778, "outflow_rate_max": 1452.6477661406063, "cost1_mean": 393.2037268083765, "outflow_rate_min": 629.1018869562902, "system_level_velocity_max": 19.26400582421624, "system_level_velocity_min": 12.13412050928545, "cost2_max": -63.48082943596657, "cost2_mean": -117.39195128437595, "outflow_rate_mean": 1179.2369458522235, "cost2_min": -139.21073087952493}, "training_iteration": 165, "episodes_total": 2573, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209463, "time_total_s": 4385.469166278839, "episode_len_mean": 695.48, "pid": 32002, "time_since_restore": 4385.469166278839, "time_this_iter_s": 25.97426748275757, "timesteps_since_restore": 7257733, "info": {"num_steps_trained": 7257733, "load_time_ms": 14.303, "num_steps_sampled": 7257733, "grad_time_ms": 9341.486, "sample_time_ms": 16946.765, "update_time_ms": 8.248, "default": {"vf_explained_var": 0.9809878468513489, "vf_loss": 8.042793273925781, "entropy": 1.444252610206604, "cur_lr": 0.0005000000237487257, "total_loss": 8.038768768310547, "kl": 0.017268110066652298, "policy_loss": -0.007301311939954758, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1125.027618692023, "timesteps_this_iter": 43121, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aca20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac198>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-11-03", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 482.96162382873}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1386.064584629484, "node_ip": "10.138.0.2", "timesteps_total": 7299438, "iterations_since_restore": 166, "custom_metrics": {"cost1_max": 505.01571859874673, "cost1_min": 177.93807809053754, "system_level_velocity_mean": 15.325004381154848, "outflow_rate_max": 1452.6477661406063, "cost1_mean": 393.17102521301837, "outflow_rate_min": 629.1018869562902, "system_level_velocity_max": 19.26400582421624, "system_level_velocity_min": 12.13412050928545, "cost2_max": -63.48082943596657, "cost2_mean": -117.7980356516605, "outflow_rate_mean": 1178.1539391732422, "cost2_min": -150.12053828920847}, "training_iteration": 166, "episodes_total": 2590, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209488, "time_total_s": 4409.842390298843, "episode_len_mean": 695.48, "pid": 32002, "time_since_restore": 4409.842390298843, "time_this_iter_s": 24.373224020004272, "timesteps_since_restore": 7299438, "info": {"num_steps_trained": 7299438, "load_time_ms": 13.904, "num_steps_sampled": 7299438, "grad_time_ms": 9094.888, "sample_time_ms": 16809.257, "update_time_ms": 8.175, "default": {"vf_explained_var": 0.9853241443634033, "vf_loss": 6.786098480224609, "entropy": 1.4611091613769531, "cur_lr": 0.0005000000237487257, "total_loss": 6.780428409576416, "kl": 0.01579454354941845, "policy_loss": -0.008668631315231323, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1129.5243773387876, "timesteps_this_iter": 41705, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ace10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac208>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668acc88>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-11-28", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 482.96162382873}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1386.064584629484, "node_ip": "10.138.0.2", "timesteps_total": 7343459, "iterations_since_restore": 167, "custom_metrics": {"cost1_max": 505.01571859874673, "cost1_min": 114.17652857013957, "system_level_velocity_mean": 15.35969168535441, "outflow_rate_max": 1452.6477661406063, "cost1_mean": 389.8716798373197, "outflow_rate_min": 489.66426653498104, "system_level_velocity_max": 19.70329755453718, "system_level_velocity_min": 12.13412050928545, "cost2_max": -40.11095491550984, "cost2_mean": -116.17564031228643, "outflow_rate_mean": 1170.0873339421246, "cost2_min": -150.12053828920847}, "training_iteration": 167, "episodes_total": 2603, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209513, "time_total_s": 4435.522794246674, "episode_len_mean": 689.82, "pid": 32002, "time_since_restore": 4435.522794246674, "time_this_iter_s": 25.6804039478302, "timesteps_since_restore": 7343459, "info": {"num_steps_trained": 7343459, "load_time_ms": 13.863, "num_steps_sampled": 7343459, "grad_time_ms": 8845.78, "sample_time_ms": 16760.087, "update_time_ms": 8.081, "default": {"vf_explained_var": 0.9748473167419434, "vf_loss": 9.85305404663086, "entropy": 1.4556903839111328, "cur_lr": 0.0005000000237487257, "total_loss": 9.848627090454102, "kl": 0.01765415444970131, "policy_loss": -0.007779042702168226, "cur_kl_coeff": 0.18984375894069672}}, "episode_reward_mean": 1118.9409147114973, "timesteps_this_iter": 44021, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668acf28>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac278>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-11-53", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 266.8624491958896}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1386.064584629484, "node_ip": "10.138.0.2", "timesteps_total": 7387727, "iterations_since_restore": 168, "custom_metrics": {"cost1_max": 489.2623387409562, "cost1_min": 107.78875257141391, "system_level_velocity_mean": 15.237609820362579, "outflow_rate_max": 1452.6477661406063, "cost1_mean": 385.8494077998242, "outflow_rate_min": 477.9221918364057, "system_level_velocity_max": 19.84938895546595, "system_level_velocity_min": 12.13412050928545, "cost2_max": -40.11095491550984, "cost2_mean": -116.34816636909314, "outflow_rate_mean": 1162.3958040724317, "cost2_min": -150.12053828920847}, "training_iteration": 168, "episodes_total": 2619, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209540, "time_total_s": 4461.854794025421, "episode_len_mean": 688.84, "pid": 32002, "time_since_restore": 4461.854794025421, "time_this_iter_s": 26.33199977874756, "timesteps_since_restore": 7387727, "info": {"num_steps_trained": 7387727, "load_time_ms": 13.939, "num_steps_sampled": 7387727, "grad_time_ms": 8639.926, "sample_time_ms": 16840.444, "update_time_ms": 7.773, "default": {"vf_explained_var": 0.980344295501709, "vf_loss": 8.81489086151123, "entropy": 1.4869110584259033, "cur_lr": 0.0005000000237487257, "total_loss": 8.8096923828125, "kl": 0.0176911111921072, "policy_loss": -0.00855761207640171, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1108.8801061075662, "timesteps_this_iter": 44268, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668655f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668acac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865a90>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-12-20", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 258.0675205425586}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1386.064584629484, "node_ip": "10.138.0.2", "timesteps_total": 7430315, "iterations_since_restore": 169, "custom_metrics": {"cost1_max": 492.17346836662045, "cost1_min": 107.78875257141391, "system_level_velocity_mean": 15.23160173931913, "outflow_rate_max": 1419.271170812633, "cost1_mean": 385.6547020015646, "outflow_rate_min": 477.9221918364057, "system_level_velocity_max": 19.84938895546595, "system_level_velocity_min": 12.13412050928545, "cost2_max": -40.11095491550984, "cost2_mean": -116.38293337222589, "outflow_rate_mean": 1162.2964670273823, "cost2_min": -150.12053828920847}, "training_iteration": 169, "episodes_total": 2635, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209566, "time_total_s": 4488.004421472549, "episode_len_mean": 688.84, "pid": 32002, "time_since_restore": 4488.004421472549, "time_this_iter_s": 26.149627447128296, "timesteps_since_restore": 7430315, "info": {"num_steps_trained": 7430315, "load_time_ms": 13.306, "num_steps_sampled": 7430315, "grad_time_ms": 8667.043, "sample_time_ms": 16905.778, "update_time_ms": 7.608, "default": {"vf_explained_var": 0.9831393361091614, "vf_loss": 7.986658096313477, "entropy": 1.4691722393035889, "cur_lr": 0.0005000000237487257, "total_loss": 7.982170581817627, "kl": 0.015634123235940933, "policy_loss": -0.007456253748387098, "cur_kl_coeff": 0.18984375894069672}}, "episode_reward_mean": 1108.4310231397162, "timesteps_this_iter": 42588, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ace80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668acd30>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aca20>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-12-46", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 258.0675205425586}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1413.9631540940152, "node_ip": "10.138.0.2", "timesteps_total": 7473447, "iterations_since_restore": 170, "custom_metrics": {"cost1_max": 492.17346836662045, "cost1_min": 75.95554981017953, "system_level_velocity_mean": 15.452516528696332, "outflow_rate_max": 1419.271170812633, "cost1_mean": 387.2451682362958, "outflow_rate_min": 407.8678591816843, "system_level_velocity_max": 19.84938895546595, "system_level_velocity_min": 12.13412050928545, "cost2_max": -27.01016838064695, "cost2_mean": -115.09110832440952, "outflow_rate_mean": 1163.5913884739691, "cost2_min": -150.12053828920847}, "training_iteration": 170, "episodes_total": 2653, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209592, "time_total_s": 4513.578941345215, "episode_len_mean": 682.91, "pid": 32002, "time_since_restore": 4513.578941345215, "time_this_iter_s": 25.574519872665405, "timesteps_since_restore": 7473447, "info": {"num_steps_trained": 7473447, "load_time_ms": 13.338, "num_steps_sampled": 7473447, "grad_time_ms": 8688.279, "sample_time_ms": 16975.203, "update_time_ms": 7.493, "default": {"vf_explained_var": 0.9771332740783691, "vf_loss": 10.120083808898926, "entropy": 1.5058181285858154, "cur_lr": 0.0005000000237487257, "total_loss": 10.115625381469727, "kl": 0.016684038564562798, "policy_loss": -0.007625993341207504, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1105.1305113257858, "timesteps_this_iter": 43132, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac3c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac7b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac208>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-13-12", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 179.92306891793191}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1413.9631540940152, "node_ip": "10.138.0.2", "timesteps_total": 7516797, "iterations_since_restore": 171, "custom_metrics": {"cost1_max": 492.17346836662045, "cost1_min": 75.95554981017953, "system_level_velocity_mean": 15.617135498636936, "outflow_rate_max": 1419.271170812633, "cost1_mean": 383.0407946895413, "outflow_rate_min": 407.8678591816843, "system_level_velocity_max": 19.84938895546595, "system_level_velocity_min": 12.156919634497681, "cost2_max": -27.01016838064695, "cost2_mean": -113.48500267429998, "outflow_rate_mean": 1151.092794817868, "cost2_min": -150.12053828920847}, "training_iteration": 171, "episodes_total": 2671, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209617, "time_total_s": 4539.159332275391, "episode_len_mean": 669.93, "pid": 32002, "time_since_restore": 4539.159332275391, "time_this_iter_s": 25.58039093017578, "timesteps_since_restore": 7516797, "info": {"num_steps_trained": 7516797, "load_time_ms": 13.978, "num_steps_sampled": 7516797, "grad_time_ms": 8621.739, "sample_time_ms": 17061.181, "update_time_ms": 7.394, "default": {"vf_explained_var": 0.9734060764312744, "vf_loss": 12.421730995178223, "entropy": 1.5081818103790283, "cur_lr": 0.0005000000237487257, "total_loss": 12.418208122253418, "kl": 0.015297314152121544, "policy_loss": -0.00642490154132247, "cur_kl_coeff": 0.18984375894069672}}, "episode_reward_mean": 1090.9772237718007, "timesteps_this_iter": 43350, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668accf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac5c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668acf28>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-13-37", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 179.92306891793191}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1413.9631540940152, "node_ip": "10.138.0.2", "timesteps_total": 7561400, "iterations_since_restore": 172, "custom_metrics": {"cost1_max": 492.17346836662045, "cost1_min": 34.36136313258339, "system_level_velocity_mean": 15.734023467895149, "outflow_rate_max": 1419.271170812633, "cost1_mean": 381.4797492787226, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.84938895546595, "system_level_velocity_min": 12.156919634497681, "cost2_max": -18.366770008724988, "cost2_mean": -112.5989974993769, "outflow_rate_mean": 1146.817328336619, "cost2_min": -150.12053828920847}, "training_iteration": 172, "episodes_total": 2684, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209643, "time_total_s": 4565.267826318741, "episode_len_mean": 663.43, "pid": 32002, "time_since_restore": 4565.267826318741, "time_this_iter_s": 26.10849404335022, "timesteps_since_restore": 7561400, "info": {"num_steps_trained": 7561400, "load_time_ms": 14.418, "num_steps_sampled": 7561400, "grad_time_ms": 8567.146, "sample_time_ms": 17110.876, "update_time_ms": 7.275, "default": {"vf_explained_var": 0.9841876029968262, "vf_loss": 6.658140182495117, "entropy": 1.5004642009735107, "cur_lr": 0.0005000000237487257, "total_loss": 6.652680397033691, "kl": 0.0162836704403162, "policy_loss": -0.008550995029509068, "cur_kl_coeff": 0.18984375894069672}}, "episode_reward_mean": 1081.972718470526, "timesteps_this_iter": 44603, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668acbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac630>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac908>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-14-03", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 61.95199754403228}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1413.9631540940152, "node_ip": "10.138.0.2", "timesteps_total": 7607145, "iterations_since_restore": 173, "custom_metrics": {"cost1_max": 512.1633921259779, "cost1_min": 34.36136313258339, "system_level_velocity_mean": 15.706722356567104, "outflow_rate_max": 1419.271170812633, "cost1_mean": 377.0163260164643, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.84938895546595, "system_level_velocity_min": 12.156919634497681, "cost2_max": -18.366770008724988, "cost2_mean": -111.8204055673165, "outflow_rate_mean": 1137.3727553890685, "cost2_min": -151.27783850277348}, "training_iteration": 173, "episodes_total": 2699, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209669, "time_total_s": 4591.206424951553, "episode_len_mean": 658.22, "pid": 32002, "time_since_restore": 4591.206424951553, "time_this_iter_s": 25.9385986328125, "timesteps_since_restore": 7607145, "info": {"num_steps_trained": 7607145, "load_time_ms": 14.558, "num_steps_sampled": 7607145, "grad_time_ms": 8526.224, "sample_time_ms": 17105.322, "update_time_ms": 7.04, "default": {"vf_explained_var": 0.9784513711929321, "vf_loss": 9.009170532226562, "entropy": 1.500388741493225, "cur_lr": 0.0005000000237487257, "total_loss": 9.00451374053955, "kl": 0.018045904114842415, "policy_loss": -0.00808223057538271, "cur_kl_coeff": 0.1898437887430191}}, "episode_reward_mean": 1068.3272339616435, "timesteps_this_iter": 45745, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668654a8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668659e8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-14-29", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 61.95199754403228}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1413.9631540940152, "node_ip": "10.138.0.2", "timesteps_total": 7649855, "iterations_since_restore": 174, "custom_metrics": {"cost1_max": 512.1633921259779, "cost1_min": 34.36136313258339, "system_level_velocity_mean": 15.593566857739589, "outflow_rate_max": 1419.271170812633, "cost1_mean": 382.27778030874384, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.66286259233233, "system_level_velocity_min": 12.156919634497681, "cost2_max": -18.366770008724988, "cost2_mean": -113.61381079006567, "outflow_rate_mean": 1150.7655560410003, "cost2_min": -151.27783850277348}, "training_iteration": 174, "episodes_total": 2716, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209694, "time_total_s": 4616.047222614288, "episode_len_mean": 669.12, "pid": 32002, "time_since_restore": 4616.047222614288, "time_this_iter_s": 24.840797662734985, "timesteps_since_restore": 7649855, "info": {"num_steps_trained": 7649855, "load_time_ms": 15.066, "num_steps_sampled": 7649855, "grad_time_ms": 8578.192, "sample_time_ms": 16975.273, "update_time_ms": 6.526, "default": {"vf_explained_var": 0.9832901358604431, "vf_loss": 8.070852279663086, "entropy": 1.4922478199005127, "cur_lr": 0.0005000000237487257, "total_loss": 8.063898086547852, "kl": 0.01840289682149887, "policy_loss": -0.010447395034134388, "cur_kl_coeff": 0.18984375894069672}}, "episode_reward_mean": 1079.9353911203377, "timesteps_this_iter": 42710, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac550>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668acac8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-14-54", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 61.95199754403228}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1413.9631540940152, "node_ip": "10.138.0.2", "timesteps_total": 7693820, "iterations_since_restore": 175, "custom_metrics": {"cost1_max": 512.1633921259779, "cost1_min": 34.36136313258339, "system_level_velocity_mean": 15.677238812510216, "outflow_rate_max": 1395.3241327946416, "cost1_mean": 384.46583980954455, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.66286259233233, "system_level_velocity_min": 12.156919634497681, "cost2_max": -18.366770008724988, "cost2_mean": -113.61276735625104, "outflow_rate_mean": 1155.535707726035, "cost2_min": -151.27783850277348}, "training_iteration": 175, "episodes_total": 2732, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209720, "time_total_s": 4641.338550329208, "episode_len_mean": 669.12, "pid": 32002, "time_since_restore": 4641.338550329208, "time_this_iter_s": 25.291327714920044, "timesteps_since_restore": 7693820, "info": {"num_steps_trained": 7693820, "load_time_ms": 15.143, "num_steps_sampled": 7693820, "grad_time_ms": 8681.998, "sample_time_ms": 16803.37, "update_time_ms": 6.484, "default": {"vf_explained_var": 0.9824820160865784, "vf_loss": 7.135382652282715, "entropy": 1.4961421489715576, "cur_lr": 0.0005000000237487257, "total_loss": 7.12962532043457, "kl": 0.017474716529250145, "policy_loss": -0.009075222536921501, "cur_kl_coeff": 0.18984375894069672}}, "episode_reward_mean": 1086.6962357006933, "timesteps_this_iter": 43965, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac9b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac860>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668acc88>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-15-20", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 61.95199754403228}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1365.9510664577947, "node_ip": "10.138.0.2", "timesteps_total": 7736417, "iterations_since_restore": 176, "custom_metrics": {"cost1_max": 512.1633921259779, "cost1_min": 34.36136313258339, "system_level_velocity_mean": 15.488252289496803, "outflow_rate_max": 1395.3241327946416, "cost1_mean": 379.33107937257364, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.66286259233233, "system_level_velocity_min": 12.156919634497681, "cost2_max": -18.366770008724988, "cost2_mean": -114.37831595878482, "outflow_rate_mean": 1147.1970958555457, "cost2_min": -151.27783850277348}, "training_iteration": 176, "episodes_total": 2748, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209745, "time_total_s": 4667.1273946762085, "episode_len_mean": 669.12, "pid": 32002, "time_since_restore": 4667.1273946762085, "time_this_iter_s": 25.788844347000122, "timesteps_since_restore": 7736417, "info": {"num_steps_trained": 7736417, "load_time_ms": 15.774, "num_steps_sampled": 7736417, "grad_time_ms": 8884.931, "sample_time_ms": 16740.351, "update_time_ms": 6.367, "default": {"vf_explained_var": 0.9839469194412231, "vf_loss": 6.730393886566162, "entropy": 1.494065523147583, "cur_lr": 0.0005000000237487257, "total_loss": 6.724789619445801, "kl": 0.01592865027487278, "policy_loss": -0.008627626113593578, "cur_kl_coeff": 0.18984375894069672}}, "episode_reward_mean": 1080.7003536616605, "timesteps_this_iter": 42597, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4080>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd160>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-15-45", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 61.95199754403228}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1398.5415990865256, "node_ip": "10.138.0.2", "timesteps_total": 7780120, "iterations_since_restore": 177, "custom_metrics": {"cost1_max": 525.4645855875643, "cost1_min": 34.36136313258339, "system_level_velocity_mean": 15.470106754896978, "outflow_rate_max": 1395.3241327946416, "cost1_mean": 381.1039144712728, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.81007459929068, "system_level_velocity_min": 12.32811591618876, "cost2_max": -18.366770008724988, "cost2_mean": -114.78928004356978, "outflow_rate_mean": 1150.700881367034, "cost2_min": -151.27783850277348}, "training_iteration": 177, "episodes_total": 2762, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209771, "time_total_s": 4692.424127817154, "episode_len_mean": 672.59, "pid": 32002, "time_since_restore": 4692.424127817154, "time_this_iter_s": 25.296733140945435, "timesteps_since_restore": 7780120, "info": {"num_steps_trained": 7780120, "load_time_ms": 15.684, "num_steps_sampled": 7780120, "grad_time_ms": 9064.456, "sample_time_ms": 16521.978, "update_time_ms": 6.339, "default": {"vf_explained_var": 0.9776909947395325, "vf_loss": 9.861226081848145, "entropy": 1.4885377883911133, "cur_lr": 0.0005000000237487257, "total_loss": 9.857062339782715, "kl": 0.01612989418208599, "policy_loss": -0.007226104848086834, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1086.4247055319881, "timesteps_this_iter": 43703, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdfd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd358>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd630>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-16-11", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 61.95199754403228}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1442.5153990918789, "node_ip": "10.138.0.2", "timesteps_total": 7822166, "iterations_since_restore": 178, "custom_metrics": {"cost1_max": 525.4645855875643, "cost1_min": 76.88320079030318, "system_level_velocity_mean": 15.606422992080725, "outflow_rate_max": 1395.3241327946416, "cost1_mean": 381.54555983680905, "outflow_rate_min": 399.0412577446136, "system_level_velocity_max": 19.81007459929068, "system_level_velocity_min": 12.32811591618876, "cost2_max": -35.41090360655325, "cost2_mean": -116.18308211354183, "outflow_rate_mean": 1154.2653666009119, "cost2_min": -153.59767326596932}, "training_iteration": 178, "episodes_total": 2782, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209795, "time_total_s": 4716.985417366028, "episode_len_mean": 668.09, "pid": 32002, "time_since_restore": 4716.985417366028, "time_this_iter_s": 24.5612895488739, "timesteps_since_restore": 7822166, "info": {"num_steps_trained": 7822166, "load_time_ms": 15.792, "num_steps_sampled": 7822166, "grad_time_ms": 9230.315, "sample_time_ms": 16177.19, "update_time_ms": 6.393, "default": {"vf_explained_var": 0.9575923085212708, "vf_loss": 18.534324645996094, "entropy": 1.5178883075714111, "cur_lr": 0.0005000000237487257, "total_loss": 18.529802322387695, "kl": 0.016613373532891273, "policy_loss": -0.007677228190004826, "cur_kl_coeff": 0.18984375894069672}}, "episode_reward_mean": 1089.7772721942695, "timesteps_this_iter": 42046, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668652e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfe80>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865828>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-16-35", "hostname": "flow-main", "episodes_this_iter": 20, "episode_reward_min": 187.72698753419078}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1442.5153990918789, "node_ip": "10.138.0.2", "timesteps_total": 7865108, "iterations_since_restore": 179, "custom_metrics": {"cost1_max": 525.4645855875643, "cost1_min": 76.88320079030318, "system_level_velocity_mean": 15.66287342628445, "outflow_rate_max": 1395.3241327946416, "cost1_mean": 382.83370171511336, "outflow_rate_min": 399.0412577446136, "system_level_velocity_max": 19.81007459929068, "system_level_velocity_min": 12.32811591618876, "cost2_max": -35.41090360655325, "cost2_mean": -116.78327749194632, "outflow_rate_mean": 1156.627554770994, "cost2_min": -153.59767326596932}, "training_iteration": 179, "episodes_total": 2796, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209819, "time_total_s": 4741.171007156372, "episode_len_mean": 668.09, "pid": 32002, "time_since_restore": 4741.171007156372, "time_this_iter_s": 24.18558979034424, "timesteps_since_restore": 7865108, "info": {"num_steps_trained": 7865108, "load_time_ms": 15.692, "num_steps_sampled": 7865108, "grad_time_ms": 9342.754, "sample_time_ms": 15867.118, "update_time_ms": 6.522, "default": {"vf_explained_var": 0.9793371558189392, "vf_loss": 8.568805694580078, "entropy": 1.5011072158813477, "cur_lr": 0.0005000000237487257, "total_loss": 8.563029289245605, "kl": 0.016327058896422386, "policy_loss": -0.008877086453139782, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1088.7445184936164, "timesteps_this_iter": 42942, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf4e0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bff28>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-16-59", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 187.72698753419078}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1442.5153990918789, "node_ip": "10.138.0.2", "timesteps_total": 7908529, "iterations_since_restore": 180, "custom_metrics": {"cost1_max": 530.5646469539622, "cost1_min": 76.88320079030318, "system_level_velocity_mean": 15.69425933798259, "outflow_rate_max": 1383.2741676519188, "cost1_mean": 383.92471163134906, "outflow_rate_min": 399.0412577446136, "system_level_velocity_max": 20.232773987421123, "system_level_velocity_min": 12.58561563831979, "cost2_max": -35.41090360655325, "cost2_mean": -116.36334749926007, "outflow_rate_mean": 1154.2763975247956, "cost2_min": -153.59767326596932}, "training_iteration": 180, "episodes_total": 2812, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209845, "time_total_s": 4766.25671172142, "episode_len_mean": 668.55, "pid": 32002, "time_since_restore": 4766.25671172142, "time_this_iter_s": 25.085704565048218, "timesteps_since_restore": 7908529, "info": {"num_steps_trained": 7908529, "load_time_ms": 15.482, "num_steps_sampled": 7908529, "grad_time_ms": 9531.604, "sample_time_ms": 15628.192, "update_time_ms": 6.835, "default": {"vf_explained_var": 0.9755052924156189, "vf_loss": 11.437986373901367, "entropy": 1.4997714757919312, "cur_lr": 0.0005000000237487257, "total_loss": 11.434416770935059, "kl": 0.018087266013026237, "policy_loss": -0.007003771606832743, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1087.4529763536925, "timesteps_this_iter": 43421, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac8d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668acb38>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-17-25", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 187.72698753419078}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1442.5153990918789, "node_ip": "10.138.0.2", "timesteps_total": 7951300, "iterations_since_restore": 181, "custom_metrics": {"cost1_max": 530.5646469539622, "cost1_min": 76.88320079030318, "system_level_velocity_mean": 15.614153239073792, "outflow_rate_max": 1383.2741676519188, "cost1_mean": 381.66492686676014, "outflow_rate_min": 399.0412577446136, "system_level_velocity_max": 20.232773987421123, "system_level_velocity_min": 12.58561563831979, "cost2_max": -35.41090360655325, "cost2_mean": -115.81947306634625, "outflow_rate_mean": 1151.25523020479, "cost2_min": -153.59767326596932}, "training_iteration": 181, "episodes_total": 2827, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209872, "time_total_s": 4793.740433692932, "episode_len_mean": 668.55, "pid": 32002, "time_since_restore": 4793.740433692932, "time_this_iter_s": 27.48372197151184, "timesteps_since_restore": 7951300, "info": {"num_steps_trained": 7951300, "load_time_ms": 15.836, "num_steps_sampled": 7951300, "grad_time_ms": 9873.776, "sample_time_ms": 15474.92, "update_time_ms": 7.172, "default": {"vf_explained_var": 0.9814789295196533, "vf_loss": 8.57451343536377, "entropy": 1.521410346031189, "cur_lr": 0.0005000000237487257, "total_loss": 8.5703706741333, "kl": 0.015303820371627808, "policy_loss": -0.007048965431749821, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1084.6295123718605, "timesteps_this_iter": 42771, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf5c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac438>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-17-52", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 187.72698753419078}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1442.5153990918789, "node_ip": "10.138.0.2", "timesteps_total": 7994458, "iterations_since_restore": 182, "custom_metrics": {"cost1_max": 530.5646469539622, "cost1_min": 76.88320079030318, "system_level_velocity_mean": 15.717468913165396, "outflow_rate_max": 1412.3489192904844, "cost1_mean": 384.17732747430915, "outflow_rate_min": 399.0412577446136, "system_level_velocity_max": 20.232773987421123, "system_level_velocity_min": 12.191055906925062, "cost2_max": -35.41090360655325, "cost2_mean": -115.66358455709005, "outflow_rate_mean": 1152.9565265652684, "cost2_min": -153.59767326596932}, "training_iteration": 182, "episodes_total": 2844, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209898, "time_total_s": 4819.296163082123, "episode_len_mean": 668.55, "pid": 32002, "time_since_restore": 4819.296163082123, "time_this_iter_s": 25.555729389190674, "timesteps_since_restore": 7994458, "info": {"num_steps_trained": 7994458, "load_time_ms": 15.431, "num_steps_sampled": 7994458, "grad_time_ms": 10102.269, "sample_time_ms": 15191.323, "update_time_ms": 7.457, "default": {"vf_explained_var": 0.9780374765396118, "vf_loss": 9.401588439941406, "entropy": 1.5089821815490723, "cur_lr": 0.0005000000237487257, "total_loss": 9.395922660827637, "kl": 0.017532063648104668, "policy_loss": -0.00899482797831297, "cur_kl_coeff": 0.18984375894069672}}, "episode_reward_mean": 1085.9687481235494, "timesteps_this_iter": 43158, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668654a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875da0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865128>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-18-18", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 187.72698753419078}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1442.5153990918789, "node_ip": "10.138.0.2", "timesteps_total": 8038352, "iterations_since_restore": 183, "custom_metrics": {"cost1_max": 530.5646469539622, "cost1_min": 76.88320079030318, "system_level_velocity_mean": 15.622063749678603, "outflow_rate_max": 1412.3489192904844, "cost1_mean": 381.52626778510995, "outflow_rate_min": 399.0412577446136, "system_level_velocity_max": 20.232773987421123, "system_level_velocity_min": 12.191055906925062, "cost2_max": -35.41090360655325, "cost2_mean": -116.8481367869511, "outflow_rate_mean": 1149.9476501884014, "cost2_min": -153.59767326596932}, "training_iteration": 183, "episodes_total": 2859, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209924, "time_total_s": 4845.523357629776, "episode_len_mean": 668.55, "pid": 32002, "time_since_restore": 4845.523357629776, "time_this_iter_s": 26.2271945476532, "timesteps_since_restore": 8038352, "info": {"num_steps_trained": 8038352, "load_time_ms": 15.208, "num_steps_sampled": 8038352, "grad_time_ms": 10268.521, "sample_time_ms": 15050.118, "update_time_ms": 7.829, "default": {"vf_explained_var": 0.9829528331756592, "vf_loss": 7.052027702331543, "entropy": 1.4857909679412842, "cur_lr": 0.0005000000237487257, "total_loss": 7.0479841232299805, "kl": 0.01840308867394924, "policy_loss": -0.007537417113780975, "cur_kl_coeff": 0.1898437887430191}}, "episode_reward_mean": 1083.091394470666, "timesteps_this_iter": 43894, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfd30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf2b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfef0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-18-44", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 187.72698753419078}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1386.4485036679146, "node_ip": "10.138.0.2", "timesteps_total": 8083149, "iterations_since_restore": 184, "custom_metrics": {"cost1_max": 530.5646469539622, "cost1_min": 76.88320079030318, "system_level_velocity_mean": 15.542003675554245, "outflow_rate_max": 1412.3489192904844, "cost1_mean": 387.4052993856165, "outflow_rate_min": 399.0412577446136, "system_level_velocity_max": 20.232773987421123, "system_level_velocity_min": 12.191055906925062, "cost2_max": -35.41090360655325, "cost2_mean": -118.31069906597618, "outflow_rate_mean": 1163.1638037409546, "cost2_min": -146.90878050336664}, "training_iteration": 184, "episodes_total": 2873, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209950, "time_total_s": 4871.331812143326, "episode_len_mean": 679.54, "pid": 32002, "time_since_restore": 4871.331812143326, "time_this_iter_s": 25.808454513549805, "timesteps_since_restore": 8083149, "info": {"num_steps_trained": 8083149, "load_time_ms": 15.231, "num_steps_sampled": 8083149, "grad_time_ms": 10469.761, "sample_time_ms": 14941.4, "update_time_ms": 8.036, "default": {"vf_explained_var": 0.9819145202636719, "vf_loss": 7.43754243850708, "entropy": 1.4759985208511353, "cur_lr": 0.0005000000237487257, "total_loss": 7.431979179382324, "kl": 0.017188183963298798, "policy_loss": -0.008826513774693012, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1094.3206428167998, "timesteps_this_iter": 44797, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875d68>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668759e8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-19-10", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 187.72698753419078}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1386.4485036679146, "node_ip": "10.138.0.2", "timesteps_total": 8125481, "iterations_since_restore": 185, "custom_metrics": {"cost1_max": 530.5646469539622, "cost1_min": 93.24440514638582, "system_level_velocity_mean": 15.495476395588604, "outflow_rate_max": 1412.3489192904844, "cost1_mean": 379.0036664695193, "outflow_rate_min": 429.0465059211946, "system_level_velocity_max": 20.232773987421123, "system_level_velocity_min": 12.191055906925062, "cost2_max": -44.66219911442923, "cost2_mean": -118.66830677962312, "outflow_rate_mean": 1145.351350223279, "cost2_min": -165.1303888182121}, "training_iteration": 185, "episodes_total": 2892, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557209975, "time_total_s": 4896.578437805176, "episode_len_mean": 670.13, "pid": 32002, "time_since_restore": 4896.578437805176, "time_this_iter_s": 25.246625661849976, "timesteps_since_restore": 8125481, "info": {"num_steps_trained": 8125481, "load_time_ms": 15.13, "num_steps_sampled": 8125481, "grad_time_ms": 10586.248, "sample_time_ms": 14820.149, "update_time_ms": 8.165, "default": {"vf_explained_var": 0.9737589359283447, "vf_loss": 11.643628120422363, "entropy": 1.487076997756958, "cur_lr": 0.0005000000237487257, "total_loss": 11.63945484161377, "kl": 0.014297273941338062, "policy_loss": -0.00688743032515049, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1077.138104886062, "timesteps_this_iter": 42332, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf4e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875198>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfcc0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-19-35", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 221.20295133709723}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1386.4485036679146, "node_ip": "10.138.0.2", "timesteps_total": 8168619, "iterations_since_restore": 186, "custom_metrics": {"cost1_max": 511.21407572454143, "cost1_min": 93.24440514638582, "system_level_velocity_mean": 15.441491243473335, "outflow_rate_max": 1412.3489192904844, "cost1_mean": 380.5317845660798, "outflow_rate_min": 429.0465059211946, "system_level_velocity_max": 19.988648824112865, "system_level_velocity_min": 12.191055906925062, "cost2_max": -44.66219911442923, "cost2_mean": -121.29836903199107, "outflow_rate_mean": 1149.331741475783, "cost2_min": -165.1303888182121}, "training_iteration": 186, "episodes_total": 2906, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557210001, "time_total_s": 4922.215038061142, "episode_len_mean": 675.14, "pid": 32002, "time_since_restore": 4922.215038061142, "time_this_iter_s": 25.636600255966187, "timesteps_since_restore": 8168619, "info": {"num_steps_trained": 8168619, "load_time_ms": 14.989, "num_steps_sampled": 8168619, "grad_time_ms": 10748.302, "sample_time_ms": 14639.566, "update_time_ms": 8.501, "default": {"vf_explained_var": 0.9794207215309143, "vf_loss": 8.208532333374023, "entropy": 1.4855108261108398, "cur_lr": 0.0005000000237487257, "total_loss": 8.20371150970459, "kl": 0.017667030915617943, "policy_loss": -0.008175207301974297, "cur_kl_coeff": 0.18984375894069672}}, "episode_reward_mean": 1082.15512082747, "timesteps_this_iter": 43138, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b94a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668751d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ceeb8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-20-01", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 221.20295133709723}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1337.2313610610568, "node_ip": "10.138.0.2", "timesteps_total": 8211009, "iterations_since_restore": 187, "custom_metrics": {"cost1_max": 502.0839486118517, "cost1_min": 93.24440514638582, "system_level_velocity_mean": 15.309053254177616, "outflow_rate_max": 1412.3489192904844, "cost1_mean": 376.3193298029284, "outflow_rate_min": 429.0465059211946, "system_level_velocity_max": 19.988648824112865, "system_level_velocity_min": 12.191055906925062, "cost2_max": -44.66219911442923, "cost2_mean": -123.71271157377961, "outflow_rate_mean": 1144.2977991529324, "cost2_min": -165.1303888182121}, "training_iteration": 187, "episodes_total": 2921, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557210026, "time_total_s": 4947.878124952316, "episode_len_mean": 675.14, "pid": 32002, "time_since_restore": 4947.878124952316, "time_this_iter_s": 25.663086891174316, "timesteps_since_restore": 8211009, "info": {"num_steps_trained": 8211009, "load_time_ms": 15.159, "num_steps_sampled": 8211009, "grad_time_ms": 10842.209, "sample_time_ms": 14581.845, "update_time_ms": 8.728, "default": {"vf_explained_var": 0.9795770049095154, "vf_loss": 9.361652374267578, "entropy": 1.4613041877746582, "cur_lr": 0.0005000000237487257, "total_loss": 9.356756210327148, "kl": 0.01815630868077278, "policy_loss": -0.008342950604856014, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1070.5376266862777, "timesteps_this_iter": 42390, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668752e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668754a8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf5c0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-20-26", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 221.20295133709723}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1369.5148823638328, "node_ip": "10.138.0.2", "timesteps_total": 8254013, "iterations_since_restore": 188, "custom_metrics": {"cost1_max": 490.08085980288115, "cost1_min": 93.24440514638582, "system_level_velocity_mean": 15.505772409248014, "outflow_rate_max": 1415.712153888973, "cost1_mean": 378.86637080903824, "outflow_rate_min": 429.0465059211946, "system_level_velocity_max": 19.988648824112865, "system_level_velocity_min": 12.191055906925062, "cost2_max": -44.66219911442923, "cost2_mean": -127.11647902312511, "outflow_rate_mean": 1151.5957538299458, "cost2_min": -165.1303888182121}, "training_iteration": 188, "episodes_total": 2940, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557210052, "time_total_s": 4973.882736682892, "episode_len_mean": 671.73, "pid": 32002, "time_since_restore": 4973.882736682892, "time_this_iter_s": 26.00461173057556, "timesteps_since_restore": 8254013, "info": {"num_steps_trained": 8254013, "load_time_ms": 15.024, "num_steps_sampled": 8254013, "grad_time_ms": 10926.949, "sample_time_ms": 14642.174, "update_time_ms": 8.962, "default": {"vf_explained_var": 0.9716062545776367, "vf_loss": 12.253837585449219, "entropy": 1.467527151107788, "cur_lr": 0.0005000000237487257, "total_loss": 12.249125480651855, "kl": 0.02120264619588852, "policy_loss": -0.008737912401556969, "cur_kl_coeff": 0.1898437738418579}}, "episode_reward_mean": 1073.046506870765, "timesteps_this_iter": 43004, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875d68>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-20-52", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 221.20295133709723}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1369.5148823638328, "node_ip": "10.138.0.2", "timesteps_total": 8297459, "iterations_since_restore": 189, "custom_metrics": {"cost1_max": 490.08085980288115, "cost1_min": 93.24440514638582, "system_level_velocity_mean": 15.568824114222455, "outflow_rate_max": 1415.712153888973, "cost1_mean": 380.21505135775266, "outflow_rate_min": 429.0465059211946, "system_level_velocity_max": 19.988648824112865, "system_level_velocity_min": 13.136426290191165, "cost2_max": -44.66219911442923, "cost2_mean": -128.83819994993684, "outflow_rate_mean": 1154.7076550942766, "cost2_min": -165.1303888182121}, "training_iteration": 189, "episodes_total": 2952, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557210079, "time_total_s": 5000.508759975433, "episode_len_mean": 671.73, "pid": 32002, "time_since_restore": 5000.508759975433, "time_this_iter_s": 26.626023292541504, "timesteps_since_restore": 8297459, "info": {"num_steps_trained": 8297459, "load_time_ms": 15.077, "num_steps_sampled": 8297459, "grad_time_ms": 10943.351, "sample_time_ms": 14867.303, "update_time_ms": 9.132, "default": {"vf_explained_var": 0.9807942509651184, "vf_loss": 7.892400741577148, "entropy": 1.4797484874725342, "cur_lr": 0.0005000000237487257, "total_loss": 7.887162208557129, "kl": 0.013878414407372475, "policy_loss": -0.009190952405333519, "cur_kl_coeff": 0.2847656309604645}}, "episode_reward_mean": 1073.9348756411498, "timesteps_this_iter": 43446, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668756a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875b70>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875438>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-21-19", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 221.20295133709723}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1369.5148823638328, "node_ip": "10.138.0.2", "timesteps_total": 8342019, "iterations_since_restore": 190, "custom_metrics": {"cost1_max": 490.08085980288115, "cost1_min": 93.24440514638582, "system_level_velocity_mean": 15.57983723714903, "outflow_rate_max": 1415.712153888973, "cost1_mean": 379.08801930643074, "outflow_rate_min": 423.6825919732324, "system_level_velocity_max": 19.988648824112865, "system_level_velocity_min": 12.40672527387996, "cost2_max": -44.66219911442923, "cost2_mean": -131.5503858648105, "outflow_rate_mean": 1151.2879340347727, "cost2_min": -165.1303888182121}, "training_iteration": 190, "episodes_total": 2969, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557210105, "time_total_s": 5026.001397609711, "episode_len_mean": 670.21, "pid": 32002, "time_since_restore": 5026.001397609711, "time_this_iter_s": 25.492637634277344, "timesteps_since_restore": 8342019, "info": {"num_steps_trained": 8342019, "load_time_ms": 14.984, "num_steps_sampled": 8342019, "grad_time_ms": 10995.099, "sample_time_ms": 14856.171, "update_time_ms": 8.844, "default": {"vf_explained_var": 0.9752570986747742, "vf_loss": 10.089441299438477, "entropy": 1.4936366081237793, "cur_lr": 0.0005000000237487257, "total_loss": 10.084877967834473, "kl": 0.014351928606629372, "policy_loss": -0.008649615570902824, "cur_kl_coeff": 0.28476566076278687}}, "episode_reward_mean": 1072.9534881317932, "timesteps_this_iter": 44560, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac240>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-21-45", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 221.20295133709723}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1369.5148823638328, "node_ip": "10.138.0.2", "timesteps_total": 8384431, "iterations_since_restore": 191, "custom_metrics": {"cost1_max": 490.08085980288115, "cost1_min": 92.66923312230699, "system_level_velocity_mean": 15.582960159254036, "outflow_rate_max": 1415.712153888973, "cost1_mean": 381.49537166109496, "outflow_rate_min": 423.6825919732324, "system_level_velocity_max": 20.01926901829774, "system_level_velocity_min": 12.396008348395158, "cost2_max": -44.66219911442923, "cost2_mean": -133.88622398391593, "outflow_rate_mean": 1158.6791478285772, "cost2_min": -166.21756687664225}, "training_iteration": 191, "episodes_total": 2985, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557210130, "time_total_s": 5051.451188087463, "episode_len_mean": 674.34, "pid": 32002, "time_since_restore": 5051.451188087463, "time_this_iter_s": 25.449790477752686, "timesteps_since_restore": 8384431, "info": {"num_steps_trained": 8384431, "load_time_ms": 14.742, "num_steps_sampled": 8384431, "grad_time_ms": 10907.556, "sample_time_ms": 14739.871, "update_time_ms": 8.709, "default": {"vf_explained_var": 0.967937707901001, "vf_loss": 15.387226104736328, "entropy": 1.4440256357192993, "cur_lr": 0.0005000000237487257, "total_loss": 15.385016441345215, "kl": 0.01403753086924553, "policy_loss": -0.006207040976732969, "cur_kl_coeff": 0.28476566076278687}}, "episode_reward_mean": 1072.4424379990237, "timesteps_this_iter": 42412, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875fd0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875a58>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-22-10", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 209.93188042365756}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1369.5148823638328, "node_ip": "10.138.0.2", "timesteps_total": 8427499, "iterations_since_restore": 192, "custom_metrics": {"cost1_max": 537.7136659051516, "cost1_min": 29.768619227907898, "system_level_velocity_mean": 15.835997891207011, "outflow_rate_max": 1443.8884242233528, "cost1_mean": 375.26127508448684, "outflow_rate_min": 326.2713828205716, "system_level_velocity_max": 20.46204338158451, "system_level_velocity_min": 12.396008348395158, "cost2_max": -19.743883481645618, "cost2_mean": -131.4860796331787, "outflow_rate_mean": 1142.9072455126068, "cost2_min": -166.21756687664225}, "training_iteration": 192, "episodes_total": 3006, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557210155, "time_total_s": 5076.78928399086, "episode_len_mean": 657.08, "pid": 32002, "time_since_restore": 5076.78928399086, "time_this_iter_s": 25.338095903396606, "timesteps_since_restore": 8427499, "info": {"num_steps_trained": 8427499, "load_time_ms": 14.786, "num_steps_sampled": 8427499, "grad_time_ms": 10907.065, "sample_time_ms": 14718.812, "update_time_ms": 8.748, "default": {"vf_explained_var": 0.9520211815834045, "vf_loss": 20.850692749023438, "entropy": 1.4681825637817383, "cur_lr": 0.0005000000237487257, "total_loss": 20.84572982788086, "kl": 0.014296619221568108, "policy_loss": -0.009036155417561531, "cur_kl_coeff": 0.28476566076278687}}, "episode_reward_mean": 1040.3066684358562, "timesteps_this_iter": 43068, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668758d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875c18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875978>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-22-35", "hostname": "flow-main", "episodes_this_iter": 21, "episode_reward_min": 51.82319210270923}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1369.5148823638328, "node_ip": "10.138.0.2", "timesteps_total": 8469970, "iterations_since_restore": 193, "custom_metrics": {"cost1_max": 537.7136659051516, "cost1_min": 29.768619227907898, "system_level_velocity_mean": 15.90673728526387, "outflow_rate_max": 1443.8884242233528, "cost1_mean": 376.92967539049874, "outflow_rate_min": 326.2713828205716, "system_level_velocity_max": 20.46204338158451, "system_level_velocity_min": 12.396008348395158, "cost2_max": -19.743883481645618, "cost2_mean": -132.44023280868802, "outflow_rate_mean": 1145.7898070869232, "cost2_min": -166.21756687664225}, "training_iteration": 193, "episodes_total": 3023, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557210183, "time_total_s": 5103.798453807831, "episode_len_mean": 657.08, "pid": 32002, "time_since_restore": 5103.798453807831, "time_this_iter_s": 27.009169816970825, "timesteps_since_restore": 8469970, "info": {"num_steps_trained": 8469970, "load_time_ms": 14.815, "num_steps_sampled": 8469970, "grad_time_ms": 10976.253, "sample_time_ms": 14727.802, "update_time_ms": 8.656, "default": {"vf_explained_var": 0.9764295220375061, "vf_loss": 9.45413875579834, "entropy": 1.4948363304138184, "cur_lr": 0.0005000000237487257, "total_loss": 9.449563026428223, "kl": 0.013675961643457413, "policy_loss": -0.008470065891742706, "cur_kl_coeff": 0.28476566076278687}}, "episode_reward_mean": 1043.9150551497735, "timesteps_this_iter": 42471, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668756a0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875710>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-23-03", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 51.82319210270923}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1328.1691863340586, "node_ip": "10.138.0.2", "timesteps_total": 8514697, "iterations_since_restore": 194, "custom_metrics": {"cost1_max": 537.7136659051516, "cost1_min": 29.768619227907898, "system_level_velocity_mean": 15.836481960428907, "outflow_rate_max": 1447.638869781414, "cost1_mean": 374.9553288094852, "outflow_rate_min": 326.2713828205716, "system_level_velocity_max": 20.46204338158451, "system_level_velocity_min": 12.251653324761264, "cost2_max": -19.743883481645618, "cost2_mean": -131.21275632740208, "outflow_rate_mean": 1139.8895734686812, "cost2_min": -166.21756687664225}, "training_iteration": 194, "episodes_total": 3035, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557210209, "time_total_s": 5130.005610704422, "episode_len_mean": 657.08, "pid": 32002, "time_since_restore": 5130.005610704422, "time_this_iter_s": 26.207156896591187, "timesteps_since_restore": 8514697, "info": {"num_steps_trained": 8514697, "load_time_ms": 15.213, "num_steps_sampled": 8514697, "grad_time_ms": 10952.417, "sample_time_ms": 14794.337, "update_time_ms": 8.829, "default": {"vf_explained_var": 0.9821086525917053, "vf_loss": 7.832880020141602, "entropy": 1.4673019647598267, "cur_lr": 0.0005000000237487257, "total_loss": 7.8293137550354, "kl": 0.012393719516694546, "policy_loss": -0.0070953164249658585, "cur_kl_coeff": 0.2847656309604645}}, "episode_reward_mean": 1038.6139851083744, "timesteps_this_iter": 44727, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce358>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce4e0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-23-29", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 51.82319210270923}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1331.2365623718574, "node_ip": "10.138.0.2", "timesteps_total": 8558224, "iterations_since_restore": 195, "custom_metrics": {"cost1_max": 537.7136659051516, "cost1_min": 29.768619227907898, "system_level_velocity_mean": 15.820925855125534, "outflow_rate_max": 1465.6954319718407, "cost1_mean": 374.16638203527015, "outflow_rate_min": 326.2713828205716, "system_level_velocity_max": 20.46204338158451, "system_level_velocity_min": 12.251653324761264, "cost2_max": -19.743883481645618, "cost2_mean": -131.05193420840283, "outflow_rate_mean": 1137.4722919063215, "cost2_min": -166.21756687664225}, "training_iteration": 195, "episodes_total": 3051, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557210234, "time_total_s": 5155.269335031509, "episode_len_mean": 657.2, "pid": 32002, "time_since_restore": 5155.269335031509, "time_this_iter_s": 25.263724327087402, "timesteps_since_restore": 8558224, "info": {"num_steps_trained": 8558224, "load_time_ms": 14.945, "num_steps_sampled": 8558224, "grad_time_ms": 10943.355, "sample_time_ms": 14805.552, "update_time_ms": 8.901, "default": {"vf_explained_var": 0.9721395969390869, "vf_loss": 12.217052459716797, "entropy": 1.466820478439331, "cur_lr": 0.0005000000237487257, "total_loss": 12.213103294372559, "kl": 0.013132056221365929, "policy_loss": -0.007687469013035297, "cur_kl_coeff": 0.28476566076278687}}, "episode_reward_mean": 1030.4701678730976, "timesteps_this_iter": 43527, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668751d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875198>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-23-54", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 51.82319210270923}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1331.2365623718574, "node_ip": "10.138.0.2", "timesteps_total": 8600640, "iterations_since_restore": 196, "custom_metrics": {"cost1_max": 537.7136659051516, "cost1_min": 29.768619227907898, "system_level_velocity_mean": 15.823113894841919, "outflow_rate_max": 1465.6954319718407, "cost1_mean": 377.89929447341973, "outflow_rate_min": 326.2713828205716, "system_level_velocity_max": 20.46204338158451, "system_level_velocity_min": 12.251653324761264, "cost2_max": -19.743883481645618, "cost2_mean": -131.73182119036485, "outflow_rate_mean": 1146.981589863695, "cost2_min": -166.404441128643}, "training_iteration": 196, "episodes_total": 3069, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557210259, "time_total_s": 5180.170274972916, "episode_len_mean": 662.66, "pid": 32002, "time_since_restore": 5180.170274972916, "time_this_iter_s": 24.90093994140625, "timesteps_since_restore": 8600640, "info": {"num_steps_trained": 8600640, "load_time_ms": 14.685, "num_steps_sampled": 8600640, "grad_time_ms": 10828.195, "sample_time_ms": 14849.859, "update_time_ms": 8.851, "default": {"vf_explained_var": 0.9785469770431519, "vf_loss": 9.81987476348877, "entropy": 1.4884958267211914, "cur_lr": 0.0005000000237487257, "total_loss": 9.81539249420166, "kl": 0.013456501998007298, "policy_loss": -0.008313978090882301, "cur_kl_coeff": 0.28476566076278687}}, "episode_reward_mean": 1036.4933541623836, "timesteps_this_iter": 42416, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668750b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875908>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875c18>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-24-19", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 51.82319210270923}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1331.2365623718574, "node_ip": "10.138.0.2", "timesteps_total": 8643504, "iterations_since_restore": 197, "custom_metrics": {"cost1_max": 537.7136659051516, "cost1_min": 29.768619227907898, "system_level_velocity_mean": 15.779405969462866, "outflow_rate_max": 1472.3328301019308, "cost1_mean": 380.5025027138028, "outflow_rate_min": 326.2713828205716, "system_level_velocity_max": 20.46204338158451, "system_level_velocity_min": 12.251653324761264, "cost2_max": -19.743883481645618, "cost2_mean": -131.31800006798082, "outflow_rate_mean": 1151.6179128205542, "cost2_min": -166.404441128643}, "training_iteration": 197, "episodes_total": 3085, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557210285, "time_total_s": 5206.247419834137, "episode_len_mean": 668.02, "pid": 32002, "time_since_restore": 5206.247419834137, "time_this_iter_s": 26.077144861221313, "timesteps_since_restore": 8643504, "info": {"num_steps_trained": 8643504, "load_time_ms": 14.727, "num_steps_sampled": 8643504, "grad_time_ms": 10732.931, "sample_time_ms": 14985.323, "update_time_ms": 8.965, "default": {"vf_explained_var": 0.9672572016716003, "vf_loss": 12.710270881652832, "entropy": 1.512926697731018, "cur_lr": 0.0005000000237487257, "total_loss": 12.705148696899414, "kl": 0.013830249197781086, "policy_loss": -0.009061931632459164, "cur_kl_coeff": 0.2847656309604645}}, "episode_reward_mean": 1046.3256754691042, "timesteps_this_iter": 42864, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875550>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-24-45", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 51.82319210270923}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1331.2365623718574, "node_ip": "10.138.0.2", "timesteps_total": 8687436, "iterations_since_restore": 198, "custom_metrics": {"cost1_max": 526.8346061761472, "cost1_min": 29.768619227907898, "system_level_velocity_mean": 15.695224404369723, "outflow_rate_max": 1472.3328301019308, "cost1_mean": 382.0518009740991, "outflow_rate_min": 326.2713828205716, "system_level_velocity_max": 20.349908818308176, "system_level_velocity_min": 12.251653324761264, "cost2_max": -19.743883481645618, "cost2_mean": -132.3795834608072, "outflow_rate_mean": 1156.877830862679, "cost2_min": -168.35670791871758}, "training_iteration": 198, "episodes_total": 3098, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557210317, "time_total_s": 5238.399245977402, "episode_len_mean": 672.76, "pid": 32002, "time_since_restore": 5238.399245977402, "time_this_iter_s": 32.15182614326477, "timesteps_since_restore": 8687436, "info": {"num_steps_trained": 8687436, "load_time_ms": 14.406, "num_steps_sampled": 8687436, "grad_time_ms": 11215.466, "sample_time_ms": 15098.664, "update_time_ms": 8.73, "default": {"vf_explained_var": 0.9794327616691589, "vf_loss": 8.406094551086426, "entropy": 1.5145249366760254, "cur_lr": 0.0005000000237487257, "total_loss": 8.40222454071045, "kl": 0.013144521042704582, "policy_loss": -0.007613564375787973, "cur_kl_coeff": 0.2847656309604645}}, "episode_reward_mean": 1059.8976944627852, "timesteps_this_iter": 43932, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668759b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875780>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-25-17", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 51.82319210270923}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1383.4964660126475, "node_ip": "10.138.0.2", "timesteps_total": 8731667, "iterations_since_restore": 199, "custom_metrics": {"cost1_max": 526.8346061761472, "cost1_min": 29.658750918720834, "system_level_velocity_mean": 15.676250712016028, "outflow_rate_max": 1475.6777413669686, "cost1_mean": 386.6531804802583, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.38113913125163, "system_level_velocity_min": 12.251653324761264, "cost2_max": -19.71402321237056, "cost2_mean": -133.11906022552654, "outflow_rate_mean": 1170.7561802089083, "cost2_min": -168.35670791871758}, "training_iteration": 199, "episodes_total": 3114, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557210360, "time_total_s": 5281.392019271851, "episode_len_mean": 679.31, "pid": 32002, "time_since_restore": 5281.392019271851, "time_this_iter_s": 42.99277329444885, "timesteps_since_restore": 8731667, "info": {"num_steps_trained": 8731667, "load_time_ms": 17.104, "num_steps_sampled": 8731667, "grad_time_ms": 11213.879, "sample_time_ms": 16731.309, "update_time_ms": 9.216, "default": {"vf_explained_var": 0.963123619556427, "vf_loss": 14.472062110900879, "entropy": 1.512933611869812, "cur_lr": 0.0005000000237487257, "total_loss": 14.46732234954834, "kl": 0.014411069452762604, "policy_loss": -0.008842544630169868, "cur_kl_coeff": 0.28476566076278687}}, "episode_reward_mean": 1073.0149456425609, "timesteps_this_iter": 44231, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66af94e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668755c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66af9358>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-26-00", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 52.356858900852785}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": true, "episode_reward_max": 1383.4964660126475, "node_ip": "10.138.0.2", "timesteps_total": 8773430, "iterations_since_restore": 200, "custom_metrics": {"cost1_max": 506.145528795722, "cost1_min": 29.658750918720834, "system_level_velocity_mean": 15.53264427350761, "outflow_rate_max": 1475.6777413669686, "cost1_mean": 382.78657944413584, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.38113913125163, "system_level_velocity_min": 12.251653324761264, "cost2_max": -19.71402321237056, "cost2_mean": -131.68145981577666, "outflow_rate_mean": 1164.3877070127974, "cost2_min": -168.35670791871758}, "training_iteration": 200, "episodes_total": 3130, "experiment_id": "f1a5e434ac70437fa9969fc75e2d3f85", "timestamp": 1557210385, "time_total_s": 5306.460287332535, "episode_len_mean": 679.31, "pid": 32002, "time_since_restore": 5306.460287332535, "time_this_iter_s": 25.068268060684204, "timesteps_since_restore": 8773430, "info": {"num_steps_trained": 8773430, "load_time_ms": 17.094, "num_steps_sampled": 8773430, "grad_time_ms": 11020.59, "sample_time_ms": 16880.487, "update_time_ms": 9.295, "default": {"vf_explained_var": 0.9775987863540649, "vf_loss": 9.879319190979004, "entropy": 1.5234966278076172, "cur_lr": 0.0005000000237487257, "total_loss": 9.875019073486328, "kl": 0.014529600739479065, "policy_loss": -0.008437813259661198, "cur_kl_coeff": 0.28476566076278687}}, "episode_reward_mean": 1070.2580868761318, "timesteps_this_iter": 41763, "config": {"log_level": "INFO", "num_gpus": 0, "compress_observations": false, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668754a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875b38>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875550>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"dim": 84, "squash_to_range": false, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "lstm_cell_size": 256, "conv_activation": "relu", "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "use_lstm": false}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "horizon": 1500, "clip_param": 0.3, "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "num_workers": 20, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_share_layers": false, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "clip_rewards": null, "kl_coeff": 0.2, "collect_metrics_timeout": 180, "synchronize_filters": true, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "lr_schedule": null, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "vf_loss_coeff": 1.0, "num_sgd_iter": 10, "batch_mode": "truncate_episodes", "kl_target": 0.01, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "monitor": false, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "preprocessor_pref": "deepmind", "sample_batch_size": 200, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-26-25", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 52.356858900852785}

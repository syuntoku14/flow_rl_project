{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 559.222522779855, "node_ip": "10.138.0.2", "timesteps_total": 50827, "iterations_since_restore": 1, "episode_reward_mean": 559.222522779855, "custom_metrics": {"cost1_min": 240.9469090475273, "cost1_max": 240.9469090475273, "cost1_mean": 240.9469090475273, "system_level_velocity_mean": 9.189417702638309, "cost2_max": -114.9678374361176, "outflow_rate_min": 569.3828775510204, "system_level_velocity_max": 9.189417702638309, "system_level_velocity_min": 9.189417702638309, "outflow_rate_max": 569.3828775510204, "cost2_mean": -114.9678374361176, "outflow_rate_mean": 569.3828775510204, "cost2_min": -114.9678374361176}, "training_iteration": 1, "episodes_total": 1, "episode_len_mean": 700.0, "timestamp": 1557205125, "time_total_s": 51.137715339660645, "pid": 31998, "info": {"num_steps_trained": 50827, "load_time_ms": 63.966, "num_steps_sampled": 50827, "grad_time_ms": 10025.64, "sample_time_ms": 39599.72, "update_time_ms": 1314.427, "default": {"vf_explained_var": 0.9067979454994202, "vf_loss": 1.9611337184906006, "cur_kl_coeff": 0.20000001788139343, "cur_lr": 0.0005000000237487257, "total_loss": 1.9611284732818604, "kl": 0.0007436228333972394, "policy_loss": -0.00015397186507470906, "entropy": 1.4188930988311768}}, "time_this_iter_s": 51.137715339660645, "timesteps_since_restore": 50827, "time_since_restore": 51.137715339660645, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 50827, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66af9a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66af99e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66af9a20>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_04-58-45", "hostname": "flow-main", "episodes_this_iter": 1, "episode_reward_min": 559.222522779855}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 932.482836150841, "node_ip": "10.138.0.2", "timesteps_total": 96949, "iterations_since_restore": 2, "episode_reward_mean": 621.5931312481204, "custom_metrics": {"cost1_min": 185.25996945227695, "cost1_max": 305.9598864965809, "cost1_mean": 238.0856383764661, "system_level_velocity_mean": 9.06470964286262, "cost2_max": -95.58349521092029, "outflow_rate_min": 249.07021779859483, "system_level_velocity_max": 11.456505413850747, "system_level_velocity_min": 7.13540029373728, "outflow_rate_max": 874.1896523988831, "cost2_mean": -135.21093924844595, "outflow_rate_mean": 562.0505443949107, "cost2_min": -179.7525477836249}, "training_iteration": 2, "episodes_total": 20, "episode_len_mean": 700.0, "timestamp": 1557205152, "time_total_s": 78.44251441955566, "pid": 31998, "info": {"num_steps_trained": 96949, "load_time_ms": 37.637, "num_steps_sampled": 96949, "grad_time_ms": 9885.88, "sample_time_ms": 28520.564, "update_time_ms": 660.446, "default": {"vf_explained_var": 0.9741770625114441, "vf_loss": 1.4384833574295044, "cur_kl_coeff": 0.10000000894069672, "cur_lr": 0.0005000000237487257, "total_loss": 1.4381943941116333, "kl": 0.0022900619078427553, "policy_loss": -0.0005180610460229218, "entropy": 1.4181196689605713}}, "time_this_iter_s": 27.30479907989502, "timesteps_since_restore": 96949, "time_since_restore": 78.44251441955566, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 46122, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a71d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7208>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_04-59-12", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 441.7205075540725}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 932.482836150841, "node_ip": "10.138.0.2", "timesteps_total": 145015, "iterations_since_restore": 3, "episode_reward_mean": 659.2954144620251, "custom_metrics": {"cost1_min": 181.7277768436585, "cost1_max": 376.8232914292809, "cost1_mean": 249.3861228490827, "system_level_velocity_mean": 9.473605502576735, "cost2_max": -95.58349521092029, "outflow_rate_min": 249.07021779859483, "system_level_velocity_max": 14.120352055611253, "system_level_velocity_min": 7.107381225549881, "outflow_rate_max": 1162.3461149888365, "cost2_mean": -138.23814287947627, "outflow_rate_mean": 624.1778605631578, "cost2_min": -188.544056202762}, "training_iteration": 3, "episodes_total": 36, "episode_len_mean": 700.0, "timestamp": 1557205180, "time_total_s": 105.93207168579102, "pid": 31998, "info": {"num_steps_trained": 145015, "load_time_ms": 30.12, "num_steps_sampled": 145015, "grad_time_ms": 9611.298, "sample_time_ms": 25119.949, "update_time_ms": 443.322, "default": {"vf_explained_var": 0.980853259563446, "vf_loss": 1.2390071153640747, "cur_kl_coeff": 0.050000011920928955, "cur_lr": 0.0005000000237487257, "total_loss": 1.238483190536499, "kl": 0.00236058933660388, "policy_loss": -0.0006419625133275986, "entropy": 1.407500982284546}}, "time_this_iter_s": 27.48955726623535, "timesteps_since_restore": 145015, "time_since_restore": 105.93207168579102, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 48066, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e860>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e400>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_04-59-40", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 441.7205075540725}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 935.3630698733361, "node_ip": "10.138.0.2", "timesteps_total": 195435, "iterations_since_restore": 4, "episode_reward_mean": 672.3576892374409, "custom_metrics": {"cost1_min": 181.7277768436585, "cost1_max": 376.8232914292809, "cost1_mean": 253.08898285325404, "system_level_velocity_mean": 9.609559173681367, "cost2_max": -95.58349521092029, "outflow_rate_min": 249.07021779859483, "system_level_velocity_max": 14.120352055611253, "system_level_velocity_min": 7.107381225549881, "outflow_rate_max": 1162.3461149888365, "cost2_mean": -140.2640398485941, "outflow_rate_mean": 633.4881949644546, "cost2_min": -188.544056202762}, "training_iteration": 4, "episodes_total": 40, "episode_len_mean": 700.0, "timestamp": 1557205209, "time_total_s": 135.19019055366516, "pid": 31998, "info": {"num_steps_trained": 195435, "load_time_ms": 25.853, "num_steps_sampled": 195435, "grad_time_ms": 10151.293, "sample_time_ms": 23182.317, "update_time_ms": 335.004, "default": {"vf_explained_var": 0.9844928979873657, "vf_loss": 1.4100115299224854, "cur_kl_coeff": 0.02500000223517418, "cur_lr": 0.0005000000237487257, "total_loss": 1.408968210220337, "kl": 0.004406973719596863, "policy_loss": -0.0011534887598827481, "entropy": 1.4004265069961548}}, "time_this_iter_s": 29.258118867874146, "timesteps_since_restore": 195435, "time_since_restore": 135.19019055366516, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 50420, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aad30>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa8d0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-00-09", "hostname": "flow-main", "episodes_this_iter": 4, "episode_reward_min": 441.7205075540725}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 935.3630698733361, "node_ip": "10.138.0.2", "timesteps_total": 241586, "iterations_since_restore": 5, "episode_reward_mean": 693.5399037483195, "custom_metrics": {"cost1_min": 181.7277768436585, "cost1_max": 376.8232914292809, "cost1_mean": 256.1108541286921, "system_level_velocity_mean": 9.708522590934072, "cost2_max": -82.08931076447493, "outflow_rate_min": 249.07021779859483, "system_level_velocity_max": 14.120352055611253, "system_level_velocity_min": 7.107381225549881, "outflow_rate_max": 1162.3461149888365, "cost2_mean": -142.72010389793772, "outflow_rate_mean": 656.9239223508678, "cost2_min": -190.86345303106978}, "training_iteration": 5, "episodes_total": 56, "episode_len_mean": 700.0, "timestamp": 1557205236, "time_total_s": 162.5089249610901, "pid": 31998, "info": {"num_steps_trained": 241586, "load_time_ms": 23.114, "num_steps_sampled": 241586, "grad_time_ms": 10156.753, "sample_time_ms": 21953.01, "update_time_ms": 269.911, "default": {"vf_explained_var": 0.983475923538208, "vf_loss": 2.036745548248291, "cur_kl_coeff": 0.01250000111758709, "cur_lr": 0.0005000000237487257, "total_loss": 2.0342774391174316, "kl": 0.008615877479314804, "policy_loss": -0.002575850812718272, "entropy": 1.3943769931793213}}, "time_this_iter_s": 27.318734407424927, "timesteps_since_restore": 241586, "time_since_restore": 162.5089249610901, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 46151, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a76a0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7908>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-00-36", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 441.7205075540725}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 966.907193910017, "node_ip": "10.138.0.2", "timesteps_total": 286239, "iterations_since_restore": 6, "episode_reward_mean": 726.9892893591232, "custom_metrics": {"cost1_min": 181.7277768436585, "cost1_max": 376.8232914292809, "cost1_mean": 262.11485640294194, "system_level_velocity_mean": 9.903974264954268, "cost2_max": -82.08931076447493, "outflow_rate_min": 249.07021779859483, "system_level_velocity_max": 14.120352055611253, "system_level_velocity_min": 7.107381225549881, "outflow_rate_max": 1162.3461149888365, "cost2_mean": -143.49234553507748, "outflow_rate_mean": 702.701266173648, "cost2_min": -190.86345303106978}, "training_iteration": 6, "episodes_total": 76, "episode_len_mean": 700.0, "timestamp": 1557205263, "time_total_s": 189.09680914878845, "pid": 31998, "info": {"num_steps_trained": 286239, "load_time_ms": 21.508, "num_steps_sampled": 286239, "grad_time_ms": 10176.642, "sample_time_ms": 20995.059, "update_time_ms": 226.418, "default": {"vf_explained_var": 0.9564130902290344, "vf_loss": 4.465108394622803, "cur_kl_coeff": 0.012500002048909664, "cur_lr": 0.0005000000237487257, "total_loss": 4.463916301727295, "kl": 0.006700817961245775, "policy_loss": -0.001275641960091889, "entropy": 1.3910834789276123}}, "time_this_iter_s": 26.587884187698364, "timesteps_since_restore": 286239, "time_since_restore": 189.09680914878845, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44653, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aac18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66b13588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aaa20>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-01-03", "hostname": "flow-main", "episodes_this_iter": 20, "episode_reward_min": 441.7205075540725}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1076.7307691553715, "node_ip": "10.138.0.2", "timesteps_total": 334879, "iterations_since_restore": 7, "episode_reward_mean": 745.6789034638035, "custom_metrics": {"cost1_min": 181.7277768436585, "cost1_max": 376.8232914292809, "cost1_mean": 265.8168076750957, "system_level_velocity_mean": 10.031705887462405, "cost2_max": -82.08931076447493, "outflow_rate_min": 249.07021779859483, "system_level_velocity_max": 14.120352055611253, "system_level_velocity_min": 7.107381225549881, "outflow_rate_max": 1162.3461149888365, "cost2_mean": -146.94161652460065, "outflow_rate_mean": 722.8745030057418, "cost2_min": -204.7626175317335}, "training_iteration": 7, "episodes_total": 83, "episode_len_mean": 700.0, "timestamp": 1557205289, "time_total_s": 215.14930653572083, "pid": 31998, "info": {"num_steps_trained": 334879, "load_time_ms": 20.388, "num_steps_sampled": 334879, "grad_time_ms": 10476.963, "sample_time_ms": 19947.803, "update_time_ms": 195.095, "default": {"vf_explained_var": 0.9837511777877808, "vf_loss": 1.7818478345870972, "cur_kl_coeff": 0.012500002048909664, "cur_lr": 0.0005000000237487257, "total_loss": 1.7798678874969482, "kl": 0.006527787074446678, "policy_loss": -0.0020616978872567415, "entropy": 1.3961435556411743}}, "time_this_iter_s": 26.052497386932373, "timesteps_since_restore": 334879, "time_since_restore": 215.14930653572083, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 48640, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689eb38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e0f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e160>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-01-29", "hostname": "flow-main", "episodes_this_iter": 7, "episode_reward_min": 441.7205075540725}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1100.745593198084, "node_ip": "10.138.0.2", "timesteps_total": 378147, "iterations_since_restore": 8, "episode_reward_mean": 779.469975588576, "custom_metrics": {"cost1_min": 181.7277768436585, "cost1_max": 376.8232914292809, "cost1_mean": 271.5287996065127, "system_level_velocity_mean": 10.229003722405526, "cost2_max": -82.08931076447493, "outflow_rate_min": 249.07021779859483, "system_level_velocity_max": 14.120352055611253, "system_level_velocity_min": 7.107381225549881, "outflow_rate_max": 1162.3461149888365, "cost2_mean": -150.90294712268212, "outflow_rate_mean": 764.4388444939046, "cost2_min": -217.34990870436727}, "training_iteration": 8, "episodes_total": 101, "episode_len_mean": 700.0, "timestamp": 1557205315, "time_total_s": 241.03924036026, "pid": 31998, "info": {"num_steps_trained": 378147, "load_time_ms": 19.318, "num_steps_sampled": 378147, "grad_time_ms": 10516.612, "sample_time_ms": 19327.744, "update_time_ms": 171.715, "default": {"vf_explained_var": 0.9677830934524536, "vf_loss": 4.289426803588867, "cur_kl_coeff": 0.012500002980232239, "cur_lr": 0.0005000000237487257, "total_loss": 4.287863254547119, "kl": 0.006881712470203638, "policy_loss": -0.0016498269978910685, "entropy": 1.3747540712356567}}, "time_this_iter_s": 25.889933824539185, "timesteps_since_restore": 378147, "time_since_restore": 241.03924036026, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43268, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa5f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa438>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa358>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-01-55", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 441.7205075540725}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1100.745593198084, "node_ip": "10.138.0.2", "timesteps_total": 423661, "iterations_since_restore": 9, "episode_reward_mean": 821.1803276742856, "custom_metrics": {"cost1_min": 181.7277768436585, "cost1_max": 376.8232914292809, "cost1_mean": 279.4926359615855, "system_level_velocity_mean": 10.484781537796428, "cost2_max": -82.08931076447493, "outflow_rate_min": 370.7852979805535, "system_level_velocity_max": 14.120352055611253, "system_level_velocity_min": 7.107381225549881, "outflow_rate_max": 1162.3461149888365, "cost2_mean": -150.08353960033918, "outflow_rate_mean": 822.9579384894474, "cost2_min": -217.34990870436727}, "training_iteration": 9, "episodes_total": 117, "episode_len_mean": 700.0, "timestamp": 1557205342, "time_total_s": 268.2317934036255, "pid": 31998, "info": {"num_steps_trained": 423661, "load_time_ms": 18.362, "num_steps_sampled": 423661, "grad_time_ms": 10618.909, "sample_time_ms": 18918.759, "update_time_ms": 153.731, "default": {"vf_explained_var": 0.9228898882865906, "vf_loss": 5.773128032684326, "cur_kl_coeff": 0.012500002980232239, "cur_lr": 0.0005000000237487257, "total_loss": 5.770859241485596, "kl": 0.008223429322242737, "policy_loss": -0.0023715391289442778, "entropy": 1.3527612686157227}}, "time_this_iter_s": 27.19255304336548, "timesteps_since_restore": 423661, "time_since_restore": 268.2317934036255, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45514, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7da0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7470>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-02-22", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 469.9165122331783}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1100.745593198084, "node_ip": "10.138.0.2", "timesteps_total": 469505, "iterations_since_restore": 10, "episode_reward_mean": 837.220320829683, "custom_metrics": {"cost1_min": 28.93726886207723, "cost1_max": 342.63560784241326, "cost1_mean": 281.08803214911563, "system_level_velocity_mean": 10.712410400260127, "cost2_max": -23.905072379042544, "outflow_rate_min": 324.6102532524653, "system_level_velocity_max": 19.46614742030628, "system_level_velocity_min": 7.107381225549881, "outflow_rate_max": 1120.4654749057395, "cost2_mean": -150.02387213824173, "outflow_rate_mean": 844.4147216834155, "cost2_min": -217.34990870436727}, "training_iteration": 10, "episodes_total": 126, "episode_len_mean": 693.43, "timestamp": 1557205368, "time_total_s": 294.0687561035156, "pid": 31998, "info": {"num_steps_trained": 469505, "load_time_ms": 17.541, "num_steps_sampled": 469505, "grad_time_ms": 10653.6, "sample_time_ms": 18501.288, "update_time_ms": 139.349, "default": {"vf_explained_var": 0.9651277661323547, "vf_loss": 4.518643379211426, "cur_kl_coeff": 0.012500002048909664, "cur_lr": 0.0005000000237487257, "total_loss": 4.517460346221924, "kl": 0.0051247188821434975, "policy_loss": -0.0012468291679397225, "entropy": 1.3685184717178345}}, "time_this_iter_s": 25.836962699890137, "timesteps_since_restore": 469505, "time_since_restore": 294.0687561035156, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45844, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a70f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7eb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7a58>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-02-48", "hostname": "flow-main", "episodes_this_iter": 9, "episode_reward_min": 53.13920112162092}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1251.3439210119166, "node_ip": "10.138.0.2", "timesteps_total": 514756, "iterations_since_restore": 11, "episode_reward_mean": 887.281113777485, "custom_metrics": {"cost1_min": 28.93726886207723, "cost1_max": 362.06607140995686, "cost1_mean": 289.54090079919456, "system_level_velocity_mean": 10.990543379852262, "cost2_max": -23.905072379042544, "outflow_rate_min": 324.6102532524653, "system_level_velocity_max": 19.46614742030628, "system_level_velocity_min": 7.448677744378037, "outflow_rate_max": 1212.663996124255, "cost2_mean": -156.91549112930824, "outflow_rate_mean": 898.5606369682137, "cost2_min": -224.54510395483226}, "training_iteration": 11, "episodes_total": 144, "episode_len_mean": 693.43, "timestamp": 1557205397, "time_total_s": 322.48461723327637, "pid": 31998, "info": {"num_steps_trained": 514756, "load_time_ms": 12.568, "num_steps_sampled": 514756, "grad_time_ms": 10753.981, "sample_time_ms": 16268.351, "update_time_ms": 8.731, "default": {"vf_explained_var": 0.9534208178520203, "vf_loss": 5.379617691040039, "cur_kl_coeff": 0.01250000111758709, "cur_lr": 0.0005000000237487257, "total_loss": 5.378815650939941, "kl": 0.006241121795028448, "policy_loss": -0.0008799604256637394, "entropy": 1.3528796434402466}}, "time_this_iter_s": 28.415861129760742, "timesteps_since_restore": 514756, "time_since_restore": 322.48461723327637, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45251, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e630>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e588>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-03-17", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 53.13920112162092}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1251.3439210119166, "node_ip": "10.138.0.2", "timesteps_total": 560406, "iterations_since_restore": 12, "episode_reward_mean": 915.6249331494145, "custom_metrics": {"cost1_min": 28.872212145850092, "cost1_max": 362.06607140995686, "cost1_mean": 291.48636318681224, "system_level_velocity_mean": 11.227498247801257, "cost2_max": -23.905072379042544, "outflow_rate_min": 324.6102532524653, "system_level_velocity_max": 19.578892586297556, "system_level_velocity_min": 8.909686658415795, "outflow_rate_max": 1212.663996124255, "cost2_mean": -162.63255733287713, "outflow_rate_mean": 930.3893856376474, "cost2_min": -224.54510395483226}, "training_iteration": 12, "episodes_total": 159, "episode_len_mean": 686.86, "timestamp": 1557205424, "time_total_s": 349.7334110736847, "pid": 31998, "info": {"num_steps_trained": 560406, "load_time_ms": 12.707, "num_steps_sampled": 560406, "grad_time_ms": 10856.033, "sample_time_ms": 16161.692, "update_time_ms": 8.746, "default": {"vf_explained_var": 0.937491774559021, "vf_loss": 5.876038074493408, "cur_kl_coeff": 0.012500002048909664, "cur_lr": 0.0005000000237487257, "total_loss": 5.874266147613525, "kl": 0.008432697504758835, "policy_loss": -0.0018781408434733748, "entropy": 1.3342777490615845}}, "time_this_iter_s": 27.248793840408325, "timesteps_since_restore": 560406, "time_since_restore": 349.7334110736847, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45650, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa780>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa978>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-03-44", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 52.851018553064925}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1251.3439210119166, "node_ip": "10.138.0.2", "timesteps_total": 605064, "iterations_since_restore": 13, "episode_reward_mean": 934.6148345487188, "custom_metrics": {"cost1_min": 28.872212145850092, "cost1_max": 362.06607140995686, "cost1_mean": 293.6410523468753, "system_level_velocity_mean": 11.292366306295392, "cost2_max": -23.905072379042544, "outflow_rate_min": 324.6102532524653, "system_level_velocity_max": 19.578892586297556, "system_level_velocity_min": 8.909686658415795, "outflow_rate_max": 1212.663996124255, "cost2_mean": -164.2140111522306, "outflow_rate_mean": 945.2865433861915, "cost2_min": -224.54510395483226}, "training_iteration": 13, "episodes_total": 169, "episode_len_mean": 686.86, "timestamp": 1557205451, "time_total_s": 376.4900896549225, "pid": 31998, "info": {"num_steps_trained": 605064, "load_time_ms": 12.497, "num_steps_sampled": 605064, "grad_time_ms": 11008.825, "sample_time_ms": 15935.895, "update_time_ms": 8.648, "default": {"vf_explained_var": 0.962578535079956, "vf_loss": 4.1889753341674805, "cur_kl_coeff": 0.012500002048909664, "cur_lr": 0.0005000000237487257, "total_loss": 4.187520503997803, "kl": 0.009224306792020798, "policy_loss": -0.0015706587582826614, "entropy": 1.3309918642044067}}, "time_this_iter_s": 26.756678581237793, "timesteps_since_restore": 605064, "time_since_restore": 376.4900896549225, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44658, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7b00>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7668>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-04-11", "hostname": "flow-main", "episodes_this_iter": 10, "episode_reward_min": 52.851018553064925}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1251.3439210119166, "node_ip": "10.138.0.2", "timesteps_total": 650247, "iterations_since_restore": 14, "episode_reward_mean": 969.3266984548603, "custom_metrics": {"cost1_min": 28.872212145850092, "cost1_max": 376.0629021605459, "cost1_mean": 300.4993583402146, "system_level_velocity_mean": 11.517479982214939, "cost2_max": -23.905072379042544, "outflow_rate_min": 324.6102532524653, "system_level_velocity_max": 19.578892586297556, "system_level_velocity_min": 9.347668279285829, "outflow_rate_max": 1228.545870880778, "cost2_mean": -166.05826643470525, "outflow_rate_mean": 976.3113531961037, "cost2_min": -224.54510395483226}, "training_iteration": 14, "episodes_total": 187, "episode_len_mean": 686.86, "timestamp": 1557205478, "time_total_s": 403.6946029663086, "pid": 31998, "info": {"num_steps_trained": 650247, "load_time_ms": 12.804, "num_steps_sampled": 650247, "grad_time_ms": 10846.393, "sample_time_ms": 15892.724, "update_time_ms": 8.436, "default": {"vf_explained_var": 0.9487226605415344, "vf_loss": 6.71712064743042, "cur_kl_coeff": 0.012500002048909664, "cur_lr": 0.0005000000237487257, "total_loss": 6.7150983810424805, "kl": 0.00873397197574377, "policy_loss": -0.0021316742058843374, "entropy": 1.3177279233932495}}, "time_this_iter_s": 27.20451331138611, "timesteps_since_restore": 650247, "time_since_restore": 403.6946029663086, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45183, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689eac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e0f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e8d0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-04-38", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 52.851018553064925}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1251.3439210119166, "node_ip": "10.138.0.2", "timesteps_total": 695503, "iterations_since_restore": 15, "episode_reward_mean": 973.9211973792401, "custom_metrics": {"cost1_min": 28.872212145850092, "cost1_max": 376.0629021605459, "cost1_mean": 301.9716199705557, "system_level_velocity_mean": 11.750431073021073, "cost2_max": -23.905072379042544, "outflow_rate_min": 324.6102532524653, "system_level_velocity_max": 19.578892586297556, "system_level_velocity_min": 9.656168293597789, "outflow_rate_max": 1228.545870880778, "cost2_mean": -168.05141488627686, "outflow_rate_mean": 985.1902981666904, "cost2_min": -224.54510395483226}, "training_iteration": 15, "episodes_total": 200, "episode_len_mean": 680.36, "timestamp": 1557205505, "time_total_s": 431.0361406803131, "pid": 31998, "info": {"num_steps_trained": 695503, "load_time_ms": 12.879, "num_steps_sampled": 695503, "grad_time_ms": 10836.516, "sample_time_ms": 15903.504, "update_time_ms": 8.093, "default": {"vf_explained_var": 0.9738882184028625, "vf_loss": 4.083532333374023, "cur_kl_coeff": 0.01250000111758709, "cur_lr": 0.0005000000237487257, "total_loss": 4.081708908081055, "kl": 0.007664453703910112, "policy_loss": -0.001919264206662774, "entropy": 1.3298591375350952}}, "time_this_iter_s": 27.341537714004517, "timesteps_since_restore": 695503, "time_since_restore": 431.0361406803131, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45256, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aadd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa9b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aabe0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-05-05", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 52.851018553064925}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1251.3439210119166, "node_ip": "10.138.0.2", "timesteps_total": 742231, "iterations_since_restore": 16, "episode_reward_mean": 983.9259682134472, "custom_metrics": {"cost1_min": 28.872212145850092, "cost1_max": 391.3467539732251, "cost1_mean": 304.82710961649724, "system_level_velocity_mean": 12.066993242413814, "cost2_max": -23.905072379042544, "outflow_rate_min": 324.6102532524653, "system_level_velocity_max": 19.578892586297556, "system_level_velocity_min": 9.920606318814823, "outflow_rate_max": 1293.946783983181, "cost2_mean": -175.35640716466932, "outflow_rate_mean": 996.2950668766296, "cost2_min": -225.4172753863318}, "training_iteration": 16, "episodes_total": 214, "episode_len_mean": 673.86, "timestamp": 1557205533, "time_total_s": 458.86248207092285, "pid": 31998, "info": {"num_steps_trained": 742231, "load_time_ms": 12.836, "num_steps_sampled": 742231, "grad_time_ms": 10894.037, "sample_time_ms": 15969.847, "update_time_ms": 7.825, "default": {"vf_explained_var": 0.9762184619903564, "vf_loss": 4.021289825439453, "cur_kl_coeff": 0.012500002980232239, "cur_lr": 0.0005000000237487257, "total_loss": 4.019633769989014, "kl": 0.0053574563935399055, "policy_loss": -0.0017234939150512218, "entropy": 1.308680534362793}}, "time_this_iter_s": 27.82634139060974, "timesteps_since_restore": 742231, "time_since_restore": 458.86248207092285, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 46728, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa470>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa6a0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-05-33", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 52.851018553064925}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1248.3360201746098, "node_ip": "10.138.0.2", "timesteps_total": 791222, "iterations_since_restore": 17, "episode_reward_mean": 994.0293262861787, "custom_metrics": {"cost1_min": 28.872212145850092, "cost1_max": 391.3467539732251, "cost1_mean": 308.70896248194947, "system_level_velocity_mean": 12.0587937036609, "cost2_max": -24.69806223562556, "outflow_rate_min": 325.8735011719416, "system_level_velocity_max": 19.578892586297556, "system_level_velocity_min": 9.63638471061208, "outflow_rate_max": 1293.946783983181, "cost2_mean": -181.74139291586246, "outflow_rate_mean": 1004.2089848784874, "cost2_min": -225.4172753863318}, "training_iteration": 17, "episodes_total": 231, "episode_len_mean": 680.43, "timestamp": 1557205563, "time_total_s": 489.2978858947754, "pid": 31998, "info": {"num_steps_trained": 791222, "load_time_ms": 12.641, "num_steps_sampled": 791222, "grad_time_ms": 10759.983, "sample_time_ms": 16541.808, "update_time_ms": 7.757, "default": {"vf_explained_var": 0.9840742349624634, "vf_loss": 2.730527639389038, "cur_kl_coeff": 0.01250000111758709, "cur_lr": 0.0005000000237487257, "total_loss": 2.7275819778442383, "kl": 0.009536867029964924, "policy_loss": -0.003064570017158985, "entropy": 1.3003284931182861}}, "time_this_iter_s": 30.43540382385254, "timesteps_since_restore": 791222, "time_since_restore": 489.2978858947754, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 48991, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689ef60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689eeb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e9b0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-06-03", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 52.851018553064925}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1248.3360201746098, "node_ip": "10.138.0.2", "timesteps_total": 839872, "iterations_since_restore": 18, "episode_reward_mean": 987.6126914862189, "custom_metrics": {"cost1_min": 28.872212145850092, "cost1_max": 391.3467539732251, "cost1_mean": 309.01587345310185, "system_level_velocity_mean": 12.092009195681385, "cost2_max": -24.69806223562556, "outflow_rate_min": 325.8735011719416, "system_level_velocity_max": 19.578892586297556, "system_level_velocity_min": 9.63638471061208, "outflow_rate_max": 1293.946783983181, "cost2_mean": -181.35643483595678, "outflow_rate_mean": 1000.7630882181787, "cost2_min": -225.4172753863318}, "training_iteration": 18, "episodes_total": 241, "episode_len_mean": 680.43, "timestamp": 1557205590, "time_total_s": 516.1468827724457, "pid": 31998, "info": {"num_steps_trained": 839872, "load_time_ms": 12.629, "num_steps_sampled": 839872, "grad_time_ms": 10708.748, "sample_time_ms": 16688.764, "update_time_ms": 7.956, "default": {"vf_explained_var": 0.9897426962852478, "vf_loss": 1.8848822116851807, "cur_kl_coeff": 0.012500002048909664, "cur_lr": 0.0005000000237487257, "total_loss": 1.8832961320877075, "kl": 0.007770722731947899, "policy_loss": -0.0016831435495987535, "entropy": 1.266371250152588}}, "time_this_iter_s": 26.848996877670288, "timesteps_since_restore": 839872, "time_since_restore": 516.1468827724457, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 48650, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689ea58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689ecc0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689eb38>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-06-30", "hostname": "flow-main", "episodes_this_iter": 10, "episode_reward_min": 52.851018553064925}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1248.3360201746098, "node_ip": "10.138.0.2", "timesteps_total": 887773, "iterations_since_restore": 19, "episode_reward_mean": 992.18418099477, "custom_metrics": {"cost1_min": 34.13323708322726, "cost1_max": 391.3467539732251, "cost1_mean": 312.1093764847605, "system_level_velocity_mean": 12.046312650068081, "cost2_max": -28.287451595208836, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.096635036560002, "system_level_velocity_min": 9.63638471061208, "outflow_rate_max": 1293.946783983181, "cost2_mean": -181.57969281277659, "outflow_rate_mean": 1001.8329055497277, "cost2_min": -225.4172753863318}, "training_iteration": 19, "episodes_total": 253, "episode_len_mean": 687.0, "timestamp": 1557205618, "time_total_s": 544.0893769264221, "pid": 31998, "info": {"num_steps_trained": 887773, "load_time_ms": 13.102, "num_steps_sampled": 887773, "grad_time_ms": 10628.435, "sample_time_ms": 16843.285, "update_time_ms": 7.663, "default": {"vf_explained_var": 0.9848890900611877, "vf_loss": 2.8133385181427, "cur_kl_coeff": 0.012500002048909664, "cur_lr": 0.0005000000237487257, "total_loss": 2.8110952377319336, "kl": 0.008728370070457458, "policy_loss": -0.002352743409574032, "entropy": 1.246961236000061}}, "time_this_iter_s": 27.94249415397644, "timesteps_since_restore": 887773, "time_since_restore": 544.0893769264221, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 47901, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aacc0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa978>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-06-58", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 59.343530868768106}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1248.3360201746098, "node_ip": "10.138.0.2", "timesteps_total": 933866, "iterations_since_restore": 20, "episode_reward_mean": 984.650376943852, "custom_metrics": {"cost1_min": 34.13323708322726, "cost1_max": 391.3467539732251, "cost1_mean": 311.97029523682755, "system_level_velocity_mean": 12.068795551903934, "cost2_max": -28.287451595208836, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.096635036560002, "system_level_velocity_min": 9.63638471061208, "outflow_rate_max": 1293.946783983181, "cost2_mean": -185.05570878709412, "outflow_rate_mean": 995.0131870368948, "cost2_min": -225.4172753863318}, "training_iteration": 20, "episodes_total": 271, "episode_len_mean": 687.0, "timestamp": 1557205647, "time_total_s": 572.4707493782043, "pid": 31998, "info": {"num_steps_trained": 933866, "load_time_ms": 13.389, "num_steps_sampled": 933866, "grad_time_ms": 10678.214, "sample_time_ms": 17047.658, "update_time_ms": 7.406, "default": {"vf_explained_var": 0.9767393469810486, "vf_loss": 4.784902572631836, "cur_kl_coeff": 0.01250000111758709, "cur_lr": 0.0005000000237487257, "total_loss": 4.78292989730835, "kl": 0.0074904244393110275, "policy_loss": -0.002066731220111251, "entropy": 1.2567781209945679}}, "time_this_iter_s": 28.381372451782227, "timesteps_since_restore": 933866, "time_since_restore": 572.4707493782043, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 46093, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b40b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4518>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-07-27", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 59.343530868768106}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1302.6842276107216, "node_ip": "10.138.0.2", "timesteps_total": 980415, "iterations_since_restore": 21, "episode_reward_mean": 985.2001293938655, "custom_metrics": {"cost1_min": 34.13323708322726, "cost1_max": 391.3467539732251, "cost1_mean": 312.53290794164946, "system_level_velocity_mean": 12.098828752555326, "cost2_max": -28.287451595208836, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.096635036560002, "system_level_velocity_min": 9.63638471061208, "outflow_rate_max": 1293.946783983181, "cost2_mean": -187.673884056606, "outflow_rate_mean": 993.8609409874741, "cost2_min": -225.4172753863318}, "training_iteration": 21, "episodes_total": 282, "episode_len_mean": 687.0, "timestamp": 1557205673, "time_total_s": 599.1992828845978, "pid": 31998, "info": {"num_steps_trained": 980415, "load_time_ms": 13.192, "num_steps_sampled": 980415, "grad_time_ms": 10587.803, "sample_time_ms": 16969.282, "update_time_ms": 7.424, "default": {"vf_explained_var": 0.9823647141456604, "vf_loss": 3.1364524364471436, "cur_kl_coeff": 0.012500002048909664, "cur_lr": 0.0005000000237487257, "total_loss": 3.132145881652832, "kl": 0.014353099279105663, "policy_loss": -0.004485828336328268, "entropy": 1.2578080892562866}}, "time_this_iter_s": 26.728533506393433, "timesteps_since_restore": 980415, "time_since_restore": 599.1992828845978, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 46549, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a72e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7cc0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a70f0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-07-53", "hostname": "flow-main", "episodes_this_iter": 11, "episode_reward_min": 59.343530868768106}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1302.6842276107216, "node_ip": "10.138.0.2", "timesteps_total": 1028518, "iterations_since_restore": 22, "episode_reward_mean": 978.3061172955245, "custom_metrics": {"cost1_min": 34.13323708322726, "cost1_max": 391.3467539732251, "cost1_mean": 310.7664152480079, "system_level_velocity_mean": 12.038408626941946, "cost2_max": -28.287451595208836, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.096635036560002, "system_level_velocity_min": 9.53509632168594, "outflow_rate_max": 1293.946783983181, "cost2_mean": -187.99299703509266, "outflow_rate_mean": 986.6673162381871, "cost2_min": -225.4172753863318}, "training_iteration": 22, "episodes_total": 294, "episode_len_mean": 687.0, "timestamp": 1557205702, "time_total_s": 627.2161364555359, "pid": 31998, "info": {"num_steps_trained": 1028518, "load_time_ms": 13.553, "num_steps_sampled": 1028518, "grad_time_ms": 10585.628, "sample_time_ms": 17046.837, "update_time_ms": 7.521, "default": {"vf_explained_var": 0.9825006723403931, "vf_loss": 3.1035046577453613, "cur_kl_coeff": 0.012500002980232239, "cur_lr": 0.0005000000237487257, "total_loss": 3.1016435623168945, "kl": 0.007967852056026459, "policy_loss": -0.0019603045657277107, "entropy": 1.2581088542938232}}, "time_this_iter_s": 28.01685357093811, "timesteps_since_restore": 1028518, "time_since_restore": 627.2161364555359, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 48103, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4dd8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4240>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-08-22", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 59.343530868768106}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1302.6842276107216, "node_ip": "10.138.0.2", "timesteps_total": 1072400, "iterations_since_restore": 23, "episode_reward_mean": 992.8346454505548, "custom_metrics": {"cost1_min": 249.42713321263426, "cost1_max": 377.0447590539968, "cost1_mean": 314.7188789938199, "system_level_velocity_mean": 11.81332786418814, "cost2_max": -146.691140704008, "outflow_rate_min": 659.7904114039806, "system_level_velocity_max": 13.87950848138462, "system_level_velocity_min": 9.374633592103095, "outflow_rate_max": 1269.0015953692325, "cost2_mean": -189.9759759847258, "outflow_rate_mean": 987.9791050791889, "cost2_min": -220.8122462759968}, "training_iteration": 23, "episodes_total": 312, "episode_len_mean": 700.0, "timestamp": 1557205730, "time_total_s": 655.3838477134705, "pid": 31998, "info": {"num_steps_trained": 1072400, "load_time_ms": 13.587, "num_steps_sampled": 1072400, "grad_time_ms": 10542.053, "sample_time_ms": 17230.188, "update_time_ms": 7.472, "default": {"vf_explained_var": 0.9849013686180115, "vf_loss": 3.8090038299560547, "cur_kl_coeff": 0.012500002980232239, "cur_lr": 0.0005000000237487257, "total_loss": 3.806790590286255, "kl": 0.010037112981081009, "policy_loss": -0.002338588470593095, "entropy": 1.2607430219650269}}, "time_this_iter_s": 28.16771125793457, "timesteps_since_restore": 1072400, "time_since_restore": 655.3838477134705, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43882, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa4e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa8d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa6a0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-08-50", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 765.3317102569538}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1302.6842276107216, "node_ip": "10.138.0.2", "timesteps_total": 1119940, "iterations_since_restore": 24, "episode_reward_mean": 1007.8239235387316, "custom_metrics": {"cost1_min": 249.42713321263426, "cost1_max": 386.77282508296776, "cost1_mean": 320.32683308573417, "system_level_velocity_mean": 11.995906220618696, "cost2_max": -152.80234155128414, "outflow_rate_min": 659.7904114039806, "system_level_velocity_max": 14.297631175875116, "system_level_velocity_min": 9.374633592103095, "outflow_rate_max": 1269.0015953692325, "cost2_mean": -191.13761546365876, "outflow_rate_mean": 998.7467868671251, "cost2_min": -220.88308266301908}, "training_iteration": 24, "episodes_total": 323, "episode_len_mean": 700.0, "timestamp": 1557205758, "time_total_s": 683.3424792289734, "pid": 31998, "info": {"num_steps_trained": 1119940, "load_time_ms": 13.457, "num_steps_sampled": 1119940, "grad_time_ms": 10613.69, "sample_time_ms": 17233.653, "update_time_ms": 7.66, "default": {"vf_explained_var": 0.9889445900917053, "vf_loss": 2.110785484313965, "cur_kl_coeff": 0.012500002048909664, "cur_lr": 0.0005000000237487257, "total_loss": 2.107930898666382, "kl": 0.010172482579946518, "policy_loss": -0.0029819542542099953, "entropy": 1.2494680881500244}}, "time_this_iter_s": 27.95863151550293, "timesteps_since_restore": 1119940, "time_since_restore": 683.3424792289734, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 47540, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b49e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4898>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b44a8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-09-18", "hostname": "flow-main", "episodes_this_iter": 11, "episode_reward_min": 811.9054418823591}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1302.6842276107216, "node_ip": "10.138.0.2", "timesteps_total": 1165486, "iterations_since_restore": 25, "episode_reward_mean": 1018.9107469897832, "custom_metrics": {"cost1_min": 249.42713321263426, "cost1_max": 386.77282508296776, "cost1_mean": 324.8620718281436, "system_level_velocity_mean": 12.131579602577567, "cost2_max": -152.80234155128414, "outflow_rate_min": 659.7904114039806, "system_level_velocity_max": 14.297631175875116, "system_level_velocity_min": 9.374633592103095, "outflow_rate_max": 1269.0015953692325, "cost2_mean": -192.68336157949128, "outflow_rate_mean": 1007.25466331597, "cost2_min": -220.88308266301908}, "training_iteration": 25, "episodes_total": 338, "episode_len_mean": 700.0, "timestamp": 1557205785, "time_total_s": 711.0702815055847, "pid": 31998, "info": {"num_steps_trained": 1165486, "load_time_ms": 13.762, "num_steps_sampled": 1165486, "grad_time_ms": 10626.909, "sample_time_ms": 17258.186, "update_time_ms": 7.91, "default": {"vf_explained_var": 0.9898809790611267, "vf_loss": 2.487485885620117, "cur_kl_coeff": 0.012500002980232239, "cur_lr": 0.0005000000237487257, "total_loss": 2.4849135875701904, "kl": 0.013536959886550903, "policy_loss": -0.0027416516095399857, "entropy": 1.2183191776275635}}, "time_this_iter_s": 27.727802276611328, "timesteps_since_restore": 1165486, "time_since_restore": 711.0702815055847, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45546, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e6d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e4a8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689ee10>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-09-45", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 811.9054418823591}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1302.6842276107216, "node_ip": "10.138.0.2", "timesteps_total": 1211325, "iterations_since_restore": 26, "episode_reward_mean": 1016.9059255771524, "custom_metrics": {"cost1_min": 94.62383029393436, "cost1_max": 411.70966302144313, "cost1_mean": 326.2835430025712, "system_level_velocity_mean": 12.468269157462103, "cost2_max": -61.949035752350945, "outflow_rate_min": 441.87561342168163, "system_level_velocity_max": 19.196928759858658, "system_level_velocity_min": 9.374633592103095, "outflow_rate_max": 1317.0166363232397, "cost2_mean": -190.59218589244577, "outflow_rate_mean": 1007.7207452354934, "cost2_min": -220.88308266301908}, "training_iteration": 26, "episodes_total": 355, "episode_len_mean": 688.85, "timestamp": 1557205813, "time_total_s": 738.8904249668121, "pid": 31998, "info": {"num_steps_trained": 1211325, "load_time_ms": 14.132, "num_steps_sampled": 1211325, "grad_time_ms": 10565.083, "sample_time_ms": 17318.495, "update_time_ms": 8.131, "default": {"vf_explained_var": 0.9758298397064209, "vf_loss": 6.687129020690918, "cur_kl_coeff": 0.012500002048909664, "cur_lr": 0.0005000000237487257, "total_loss": 6.6853790283203125, "kl": 0.009926269762217999, "policy_loss": -0.0018734711920842528, "entropy": 1.2240769863128662}}, "time_this_iter_s": 27.820143461227417, "timesteps_since_restore": 1211325, "time_since_restore": 738.8904249668121, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45839, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b41d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4dd8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-10-13", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 225.17224385270794}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1302.6842276107216, "node_ip": "10.138.0.2", "timesteps_total": 1256830, "iterations_since_restore": 27, "episode_reward_mean": 1026.2240445451987, "custom_metrics": {"cost1_min": 94.62383029393436, "cost1_max": 411.70966302144313, "cost1_mean": 333.8586099610634, "system_level_velocity_mean": 12.74230816959914, "cost2_max": -61.949035752350945, "outflow_rate_min": 441.87561342168163, "system_level_velocity_max": 19.196928759858658, "system_level_velocity_min": 9.374633592103095, "outflow_rate_max": 1317.0166363232397, "cost2_mean": -190.4465081109329, "outflow_rate_mean": 1017.3045642766654, "cost2_min": -220.88308266301908}, "training_iteration": 27, "episodes_total": 367, "episode_len_mean": 688.85, "timestamp": 1557205840, "time_total_s": 766.008118391037, "pid": 31998, "info": {"num_steps_trained": 1256830, "load_time_ms": 14.625, "num_steps_sampled": 1256830, "grad_time_ms": 10571.477, "sample_time_ms": 16979.667, "update_time_ms": 8.225, "default": {"vf_explained_var": 0.992443323135376, "vf_loss": 2.429093360900879, "cur_kl_coeff": 0.012500002980232239, "cur_lr": 0.0005000000237487257, "total_loss": 2.4259166717529297, "kl": 0.010851575061678886, "policy_loss": -0.0033120864536613226, "entropy": 1.2132374048233032}}, "time_this_iter_s": 27.117693424224854, "timesteps_since_restore": 1256830, "time_since_restore": 766.008118391037, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45505, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c15c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c15f8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-10-40", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 225.17224385270794}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1288.159514686922, "node_ip": "10.138.0.2", "timesteps_total": 1300241, "iterations_since_restore": 28, "episode_reward_mean": 1025.924283557078, "custom_metrics": {"cost1_min": 29.4578234553411, "cost1_max": 435.035599332535, "cost1_mean": 339.83386951183195, "system_level_velocity_mean": 13.180467416519164, "cost2_max": -29.014211415930898, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.12991723247819, "system_level_velocity_min": 9.374633592103095, "outflow_rate_max": 1317.0166363232397, "cost2_mean": -188.14681271812907, "outflow_rate_mean": 1023.6727796592138, "cost2_min": -223.19926299491527}, "training_iteration": 28, "episodes_total": 386, "episode_len_mean": 682.28, "timestamp": 1557205866, "time_total_s": 791.8563022613525, "pid": 31998, "info": {"num_steps_trained": 1300241, "load_time_ms": 14.754, "num_steps_sampled": 1300241, "grad_time_ms": 10483.89, "sample_time_ms": 16967.781, "update_time_ms": 8.073, "default": {"vf_explained_var": 0.9829514026641846, "vf_loss": 5.303051948547363, "cur_kl_coeff": 0.012500002048909664, "cur_lr": 0.0005000000237487257, "total_loss": 5.29982328414917, "kl": 0.013116276822984219, "policy_loss": -0.003392455168068409, "entropy": 1.2167129516601562}}, "time_this_iter_s": 25.84818387031555, "timesteps_since_restore": 1300241, "time_since_restore": 791.8563022613525, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43411, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b40b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4898>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-11-06", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 50.23726441354068}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1288.159514686922, "node_ip": "10.138.0.2", "timesteps_total": 1346350, "iterations_since_restore": 29, "episode_reward_mean": 1035.2824494433817, "custom_metrics": {"cost1_min": 29.4578234553411, "cost1_max": 435.035599332535, "cost1_mean": 345.61123500612723, "system_level_velocity_mean": 13.404241544258078, "cost2_max": -29.014211415930898, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.12991723247819, "system_level_velocity_min": 9.374633592103095, "outflow_rate_max": 1317.0166363232397, "cost2_mean": -187.6235695075856, "outflow_rate_mean": 1035.5710330011088, "cost2_min": -223.19926299491527}, "training_iteration": 29, "episodes_total": 400, "episode_len_mean": 682.28, "timestamp": 1557205894, "time_total_s": 819.5104243755341, "pid": 31998, "info": {"num_steps_trained": 1346350, "load_time_ms": 14.624, "num_steps_sampled": 1346350, "grad_time_ms": 10359.738, "sample_time_ms": 17064.797, "update_time_ms": 8.077, "default": {"vf_explained_var": 0.986818790435791, "vf_loss": 3.177833318710327, "cur_kl_coeff": 0.01250000111758709, "cur_lr": 0.0005000000237487257, "total_loss": 3.175243854522705, "kl": 0.011682730168104172, "policy_loss": -0.0027356420177966356, "entropy": 1.2388502359390259}}, "time_this_iter_s": 27.65412211418152, "timesteps_since_restore": 1346350, "time_since_restore": 819.5104243755341, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 46109, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4be0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7b70>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-11-34", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 50.23726441354068}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1288.159514686922, "node_ip": "10.138.0.2", "timesteps_total": 1393138, "iterations_since_restore": 30, "episode_reward_mean": 1038.6905472559652, "custom_metrics": {"cost1_min": 29.4578234553411, "cost1_max": 435.035599332535, "cost1_mean": 351.3470676482492, "system_level_velocity_mean": 13.617180874683234, "cost2_max": -29.014211415930898, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.12991723247819, "system_level_velocity_min": 10.98342643849882, "outflow_rate_max": 1317.0166363232397, "cost2_mean": -187.61064040280027, "outflow_rate_mean": 1050.1743044012953, "cost2_min": -223.19926299491527}, "training_iteration": 30, "episodes_total": 411, "episode_len_mean": 682.28, "timestamp": 1557205921, "time_total_s": 846.0082998275757, "pid": 31998, "info": {"num_steps_trained": 1393138, "load_time_ms": 14.623, "num_steps_sampled": 1393138, "grad_time_ms": 10207.452, "sample_time_ms": 17031.837, "update_time_ms": 7.917, "default": {"vf_explained_var": 0.9851910471916199, "vf_loss": 3.6290440559387207, "cur_kl_coeff": 0.012500002980232239, "cur_lr": 0.0005000000237487257, "total_loss": 3.625779151916504, "kl": 0.017547251656651497, "policy_loss": -0.00348376901820302, "entropy": 1.1996726989746094}}, "time_this_iter_s": 26.497875452041626, "timesteps_since_restore": 1393138, "time_since_restore": 846.0082998275757, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 46788, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b40f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b46a0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b49b0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-12-01", "hostname": "flow-main", "episodes_this_iter": 11, "episode_reward_min": 50.23726441354068}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1288.159514686922, "node_ip": "10.138.0.2", "timesteps_total": 1437182, "iterations_since_restore": 31, "episode_reward_mean": 1028.4867248418739, "custom_metrics": {"cost1_min": 29.4578234553411, "cost1_max": 435.035599332535, "cost1_mean": 348.4013621135905, "system_level_velocity_mean": 13.534225024444154, "cost2_max": -29.014211415930898, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.12991723247819, "system_level_velocity_min": 10.98342643849882, "outflow_rate_max": 1317.0166363232397, "cost2_mean": -185.431923507928, "outflow_rate_mean": 1042.5456296932916, "cost2_min": -223.19926299491527}, "training_iteration": 31, "episodes_total": 427, "episode_len_mean": 682.28, "timestamp": 1557205947, "time_total_s": 872.3796501159668, "pid": 31998, "info": {"num_steps_trained": 1437182, "load_time_ms": 14.647, "num_steps_sampled": 1437182, "grad_time_ms": 10122.348, "sample_time_ms": 17081.721, "update_time_ms": 7.742, "default": {"vf_explained_var": 0.9872843027114868, "vf_loss": 4.023482799530029, "cur_kl_coeff": 0.012500002048909664, "cur_lr": 0.0005000000237487257, "total_loss": 4.019242763519287, "kl": 0.013467150740325451, "policy_loss": -0.004408462438732386, "entropy": 1.1938786506652832}}, "time_this_iter_s": 26.371350288391113, "timesteps_since_restore": 1437182, "time_since_restore": 872.3796501159668, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44044, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c15c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1978>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-12-27", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 50.23726441354068}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1288.159514686922, "node_ip": "10.138.0.2", "timesteps_total": 1483014, "iterations_since_restore": 32, "episode_reward_mean": 1038.3155804168957, "custom_metrics": {"cost1_min": 29.4578234553411, "cost1_max": 435.035599332535, "cost1_mean": 353.55021731376127, "system_level_velocity_mean": 13.59370512582476, "cost2_max": -29.014211415930898, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.12991723247819, "system_level_velocity_min": 10.494329388553309, "outflow_rate_max": 1317.0166363232397, "cost2_mean": -185.12266905037907, "outflow_rate_mean": 1054.247160666322, "cost2_min": -223.19926299491527}, "training_iteration": 32, "episodes_total": 441, "episode_len_mean": 687.93, "timestamp": 1557205973, "time_total_s": 898.6575627326965, "pid": 31998, "info": {"num_steps_trained": 1483014, "load_time_ms": 14.547, "num_steps_sampled": 1483014, "grad_time_ms": 10055.306, "sample_time_ms": 16975.644, "update_time_ms": 7.781, "default": {"vf_explained_var": 0.9839493036270142, "vf_loss": 3.8294622898101807, "cur_kl_coeff": 0.012500002048909664, "cur_lr": 0.0005000000237487257, "total_loss": 3.8267393112182617, "kl": 0.010956873185932636, "policy_loss": -0.0028597991913557053, "entropy": 1.184303879737854}}, "time_this_iter_s": 26.277912616729736, "timesteps_since_restore": 1483014, "time_since_restore": 898.6575627326965, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45832, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa780>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e748>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-12-53", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 50.23726441354068}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1288.159514686922, "node_ip": "10.138.0.2", "timesteps_total": 1524861, "iterations_since_restore": 33, "episode_reward_mean": 1028.3980035327666, "custom_metrics": {"cost1_min": 29.001733693170806, "cost1_max": 435.035599332535, "cost1_mean": 350.59015578458855, "system_level_velocity_mean": 13.694650190115812, "cost2_max": -28.687863470114674, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.12991723247819, "system_level_velocity_min": 10.494329388553309, "outflow_rate_max": 1282.1821128326217, "cost2_mean": -181.79316281881296, "outflow_rate_mean": 1053.552782869941, "cost2_min": -223.19926299491527}, "training_iteration": 33, "episodes_total": 459, "episode_len_mean": 681.25, "timestamp": 1557206000, "time_total_s": 925.1027417182922, "pid": 31998, "info": {"num_steps_trained": 1524861, "load_time_ms": 14.628, "num_steps_sampled": 1524861, "grad_time_ms": 9894.365, "sample_time_ms": 16966.68, "update_time_ms": 7.764, "default": {"vf_explained_var": 0.9694209098815918, "vf_loss": 8.552813529968262, "cur_kl_coeff": 0.012500002048909664, "cur_lr": 0.0005000000237487257, "total_loss": 8.550098419189453, "kl": 0.011295397765934467, "policy_loss": -0.0028572005685418844, "entropy": 1.1612141132354736}}, "time_this_iter_s": 26.445178985595703, "timesteps_since_restore": 1524861, "time_since_restore": 925.1027417182922, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 41847, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9c88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9dd8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9a20>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-13-20", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 50.23726441354068}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1266.67841987134, "node_ip": "10.138.0.2", "timesteps_total": 1569717, "iterations_since_restore": 34, "episode_reward_mean": 1025.8953816612707, "custom_metrics": {"cost1_min": 29.001733693170806, "cost1_max": 431.1889425986315, "cost1_mean": 348.7085855509964, "system_level_velocity_mean": 13.62827530857869, "cost2_max": -28.687863470114674, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.12991723247819, "system_level_velocity_min": 10.494329388553309, "outflow_rate_max": 1294.1191453219155, "cost2_mean": -179.11148690434072, "outflow_rate_mean": 1052.2548832981502, "cost2_min": -219.4333624016511}, "training_iteration": 34, "episodes_total": 476, "episode_len_mean": 681.25, "timestamp": 1557206027, "time_total_s": 952.4519009590149, "pid": 31998, "info": {"num_steps_trained": 1569717, "load_time_ms": 14.464, "num_steps_sampled": 1569717, "grad_time_ms": 9764.524, "sample_time_ms": 17037.951, "update_time_ms": 7.389, "default": {"vf_explained_var": 0.9831998348236084, "vf_loss": 4.360320568084717, "cur_kl_coeff": 0.012500002980232239, "cur_lr": 0.0005000000237487257, "total_loss": 4.357051849365234, "kl": 0.010494702495634556, "policy_loss": -0.003400139044970274, "entropy": 1.1834062337875366}}, "time_this_iter_s": 27.349159240722656, "timesteps_since_restore": 1569717, "time_since_restore": 952.4519009590149, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44856, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa5c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4fd0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-13-47", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 50.23726441354068}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1251.5682252166814, "node_ip": "10.138.0.2", "timesteps_total": 1614093, "iterations_since_restore": 35, "episode_reward_mean": 1028.530351159884, "custom_metrics": {"cost1_min": 29.001733693170806, "cost1_max": 428.40381390873335, "cost1_mean": 348.8465729882752, "system_level_velocity_mean": 13.572466142424949, "cost2_max": -28.687863470114674, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 19.775093236845365, "system_level_velocity_min": 10.494329388553309, "outflow_rate_max": 1294.1191453219155, "cost2_mean": -177.98051757270906, "outflow_rate_mean": 1053.0760541201507, "cost2_min": -219.4333624016511}, "training_iteration": 35, "episodes_total": 489, "episode_len_mean": 682.97, "timestamp": 1557206054, "time_total_s": 978.9591658115387, "pid": 31998, "info": {"num_steps_trained": 1614093, "load_time_ms": 14.153, "num_steps_sampled": 1614093, "grad_time_ms": 9628.469, "sample_time_ms": 17051.454, "update_time_ms": 7.285, "default": {"vf_explained_var": 0.9827449321746826, "vf_loss": 4.928616046905518, "cur_kl_coeff": 0.012500002048909664, "cur_lr": 0.0005000000237487257, "total_loss": 4.926034450531006, "kl": 0.01112571731209755, "policy_loss": -0.002720803953707218, "entropy": 1.1657425165176392}}, "time_this_iter_s": 26.507264852523804, "timesteps_since_restore": 1614093, "time_since_restore": 978.9591658115387, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44376, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4ef0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b45c0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-14-14", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 52.36558210094029}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1301.1605335221502, "node_ip": "10.138.0.2", "timesteps_total": 1659188, "iterations_since_restore": 36, "episode_reward_mean": 1025.7343040527762, "custom_metrics": {"cost1_min": 29.001733693170806, "cost1_max": 428.40381390873335, "cost1_mean": 348.26688869178804, "system_level_velocity_mean": 13.719972655128636, "cost2_max": -28.62550267041258, "outflow_rate_min": 312.05223236515843, "system_level_velocity_max": 19.775093236845365, "system_level_velocity_min": 10.494329388553309, "outflow_rate_max": 1294.1191453219155, "cost2_mean": -174.78732953619223, "outflow_rate_mean": 1053.3725914987476, "cost2_min": -207.12852296776316}, "training_iteration": 36, "episodes_total": 505, "episode_len_mean": 676.48, "timestamp": 1557206081, "time_total_s": 1006.0994975566864, "pid": 31998, "info": {"num_steps_trained": 1659188, "load_time_ms": 14.114, "num_steps_sampled": 1659188, "grad_time_ms": 9560.834, "sample_time_ms": 17048.814, "update_time_ms": 7.145, "default": {"vf_explained_var": 0.9701060652732849, "vf_loss": 6.996067523956299, "cur_kl_coeff": 0.012500002048909664, "cur_lr": 0.0005000000237487257, "total_loss": 6.993021011352539, "kl": 0.013619279488921165, "policy_loss": -0.003215728560462594, "entropy": 1.1693978309631348}}, "time_this_iter_s": 27.140331745147705, "timesteps_since_restore": 1659188, "time_since_restore": 1006.0994975566864, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45095, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cddd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd748>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd7b8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-14-41", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 52.36558210094029}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1301.1605335221502, "node_ip": "10.138.0.2", "timesteps_total": 1703325, "iterations_since_restore": 37, "episode_reward_mean": 1032.082396062763, "custom_metrics": {"cost1_min": 29.001733693170806, "cost1_max": 428.40381390873335, "cost1_mean": 348.2397426368658, "system_level_velocity_mean": 13.707959307487654, "cost2_max": -28.62550267041258, "outflow_rate_min": 312.05223236515843, "system_level_velocity_max": 19.775093236845365, "system_level_velocity_min": 10.494329388553309, "outflow_rate_max": 1294.1191453219155, "cost2_mean": -172.5983016859609, "outflow_rate_mean": 1054.2981215987325, "cost2_min": -203.72312461694247}, "training_iteration": 37, "episodes_total": 520, "episode_len_mean": 676.48, "timestamp": 1557206107, "time_total_s": 1032.3167366981506, "pid": 31998, "info": {"num_steps_trained": 1703325, "load_time_ms": 14.105, "num_steps_sampled": 1703325, "grad_time_ms": 9359.07, "sample_time_ms": 17160.974, "update_time_ms": 7.327, "default": {"vf_explained_var": 0.9797154068946838, "vf_loss": 5.14407205581665, "cur_kl_coeff": 0.012500002048909664, "cur_lr": 0.0005000000237487257, "total_loss": 5.1402482986450195, "kl": 0.016195746138691902, "policy_loss": -0.004026045091450214, "entropy": 1.161455512046814}}, "time_this_iter_s": 26.217239141464233, "timesteps_since_restore": 1703325, "time_since_restore": 1032.3167366981506, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44137, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9da0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9c18>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-15-07", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 52.36558210094029}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1301.1605335221502, "node_ip": "10.138.0.2", "timesteps_total": 1746659, "iterations_since_restore": 38, "episode_reward_mean": 1030.6653697957613, "custom_metrics": {"cost1_min": 29.001733693170806, "cost1_max": 428.40381390873335, "cost1_mean": 348.56303293657044, "system_level_velocity_mean": 13.71180083153459, "cost2_max": -28.62550267041258, "outflow_rate_min": 312.05223236515843, "system_level_velocity_max": 19.775093236845365, "system_level_velocity_min": 10.494329388553309, "outflow_rate_max": 1294.1191453219155, "cost2_mean": -168.3250838886615, "outflow_rate_mean": 1056.1638979414386, "cost2_min": -203.72312461694247}, "training_iteration": 38, "episodes_total": 533, "episode_len_mean": 676.48, "timestamp": 1557206134, "time_total_s": 1058.8741776943207, "pid": 31998, "info": {"num_steps_trained": 1746659, "load_time_ms": 14.012, "num_steps_sampled": 1746659, "grad_time_ms": 9347.972, "sample_time_ms": 17243.164, "update_time_ms": 7.435, "default": {"vf_explained_var": 0.9688801765441895, "vf_loss": 7.533565521240234, "cur_kl_coeff": 0.012500002980232239, "cur_lr": 0.0005000000237487257, "total_loss": 7.530035018920898, "kl": 0.016380004584789276, "policy_loss": -0.003735228441655636, "entropy": 1.1913506984710693}}, "time_this_iter_s": 26.557440996170044, "timesteps_since_restore": 1746659, "time_since_restore": 1058.8741776943207, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43334, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdf98>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd128>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-15-34", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 52.36558210094029}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1301.1605335221502, "node_ip": "10.138.0.2", "timesteps_total": 1790156, "iterations_since_restore": 39, "episode_reward_mean": 1040.0831224471765, "custom_metrics": {"cost1_min": 34.663899696106114, "cost1_max": 428.40381390873335, "cost1_mean": 351.0785534636874, "system_level_velocity_mean": 13.61136766159661, "cost2_max": -28.62550267041258, "outflow_rate_min": 312.05223236515843, "system_level_velocity_max": 19.553544099079165, "system_level_velocity_min": 10.81614153913543, "outflow_rate_max": 1294.1191453219155, "cost2_mean": -165.7677388919482, "outflow_rate_mean": 1061.8471639928623, "cost2_min": -203.72312461694247}, "training_iteration": 39, "episodes_total": 549, "episode_len_mean": 683.05, "timestamp": 1557206160, "time_total_s": 1085.6370177268982, "pid": 31998, "info": {"num_steps_trained": 1790156, "load_time_ms": 14.037, "num_steps_sampled": 1790156, "grad_time_ms": 9335.523, "sample_time_ms": 17165.961, "update_time_ms": 7.422, "default": {"vf_explained_var": 0.96574467420578, "vf_loss": 7.7486138343811035, "cur_kl_coeff": 0.012500002048909664, "cur_lr": 0.0005000000237487257, "total_loss": 7.744623184204102, "kl": 0.017522171139717102, "policy_loss": -0.004209371283650398, "entropy": 1.1690939664840698}}, "time_this_iter_s": 26.762840032577515, "timesteps_since_restore": 1790156, "time_since_restore": 1085.6370177268982, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43497, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9908>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9978>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-16-00", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 58.200789186006325}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1301.1605335221502, "node_ip": "10.138.0.2", "timesteps_total": 1833978, "iterations_since_restore": 40, "episode_reward_mean": 1045.771101932605, "custom_metrics": {"cost1_min": 34.663899696106114, "cost1_max": 428.40381390873335, "cost1_mean": 353.0866341889219, "system_level_velocity_mean": 13.514107543533617, "cost2_max": -28.62550267041258, "outflow_rate_min": 312.05223236515843, "system_level_velocity_max": 18.58559339720254, "system_level_velocity_min": 10.81614153913543, "outflow_rate_max": 1294.1191453219155, "cost2_mean": -164.22117918029278, "outflow_rate_mean": 1064.5135095020016, "cost2_min": -197.604546231763}, "training_iteration": 40, "episodes_total": 566, "episode_len_mean": 688.66, "timestamp": 1557206187, "time_total_s": 1112.082885980606, "pid": 31998, "info": {"num_steps_trained": 1833978, "load_time_ms": 14.008, "num_steps_sampled": 1833978, "grad_time_ms": 9274.078, "sample_time_ms": 17219.818, "update_time_ms": 7.583, "default": {"vf_explained_var": 0.9828978180885315, "vf_loss": 4.273411273956299, "cur_kl_coeff": 0.012500002980232239, "cur_lr": 0.0005000000237487257, "total_loss": 4.269128799438477, "kl": 0.014566940255463123, "policy_loss": -0.004464567638933659, "entropy": 1.1851929426193237}}, "time_this_iter_s": 26.445868253707886, "timesteps_since_restore": 1833978, "time_since_restore": 1112.082885980606, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43822, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd7b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdd30>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-16-27", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 58.200789186006325}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1301.1605335221502, "node_ip": "10.138.0.2", "timesteps_total": 1877670, "iterations_since_restore": 41, "episode_reward_mean": 1054.2122207952157, "custom_metrics": {"cost1_min": 34.663899696106114, "cost1_max": 423.9146296459644, "cost1_mean": 354.45294388278364, "system_level_velocity_mean": 13.42736243992343, "cost2_max": -28.62550267041258, "outflow_rate_min": 312.05223236515843, "system_level_velocity_max": 18.58559339720254, "system_level_velocity_min": 10.81614153913543, "outflow_rate_max": 1196.0448142667678, "cost2_mean": -163.43923715441525, "outflow_rate_mean": 1069.617274362356, "cost2_min": -197.604546231763}, "training_iteration": 41, "episodes_total": 581, "episode_len_mean": 693.51, "timestamp": 1557206214, "time_total_s": 1138.7865071296692, "pid": 31998, "info": {"num_steps_trained": 1877670, "load_time_ms": 14.267, "num_steps_sampled": 1877670, "grad_time_ms": 9276.448, "sample_time_ms": 17250.36, "update_time_ms": 7.704, "default": {"vf_explained_var": 0.971176028251648, "vf_loss": 6.610365390777588, "cur_kl_coeff": 0.012500002048909664, "cur_lr": 0.0005000000237487257, "total_loss": 6.605916976928711, "kl": 0.02637314423918724, "policy_loss": -0.004778415895998478, "entropy": 1.1823359727859497}}, "time_this_iter_s": 26.70362114906311, "timesteps_since_restore": 1877670, "time_since_restore": 1138.7865071296692, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43692, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1c50>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1a58>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-16-54", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 58.200789186006325}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1258.0046008117959, "node_ip": "10.138.0.2", "timesteps_total": 1921648, "iterations_since_restore": 42, "episode_reward_mean": 1052.7192275784803, "custom_metrics": {"cost1_min": 34.663899696106114, "cost1_max": 423.9146296459644, "cost1_mean": 354.67562579865347, "system_level_velocity_mean": 13.44461270002869, "cost2_max": -28.62550267041258, "outflow_rate_min": 312.05223236515843, "system_level_velocity_max": 18.58559339720254, "system_level_velocity_min": 10.81614153913543, "outflow_rate_max": 1193.118828317714, "cost2_mean": -161.02042026101222, "outflow_rate_mean": 1070.1919557824167, "cost2_min": -194.64650621679516}, "training_iteration": 42, "episodes_total": 594, "episode_len_mean": 693.51, "timestamp": 1557206240, "time_total_s": 1165.2616803646088, "pid": 31998, "info": {"num_steps_trained": 1921648, "load_time_ms": 14.102, "num_steps_sampled": 1921648, "grad_time_ms": 9219.246, "sample_time_ms": 17327.611, "update_time_ms": 7.753, "default": {"vf_explained_var": 0.9639963507652283, "vf_loss": 7.789005756378174, "cur_kl_coeff": 0.01874999701976776, "cur_lr": 0.0005000000237487257, "total_loss": 7.7867021560668945, "kl": 0.01653239130973816, "policy_loss": -0.0026132597122341394, "entropy": 1.1736609935760498}}, "time_this_iter_s": 26.475173234939575, "timesteps_since_restore": 1921648, "time_since_restore": 1165.2616803646088, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43978, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdb38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdba8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdf28>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-17-20", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 58.200789186006325}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1211.0253836612628, "node_ip": "10.138.0.2", "timesteps_total": 1966368, "iterations_since_restore": 43, "episode_reward_mean": 1061.3586579266212, "custom_metrics": {"cost1_min": 283.9141395276339, "cost1_max": 423.9146296459644, "cost1_mean": 356.69745502460296, "system_level_velocity_mean": 13.350345839562904, "cost2_max": -128.1446745930364, "outflow_rate_min": 859.072096793003, "system_level_velocity_max": 15.78525583476073, "system_level_velocity_min": 10.81614153913543, "outflow_rate_max": 1193.118828317714, "cost2_mean": -160.82071772761313, "outflow_rate_mean": 1075.7727210293292, "cost2_min": -187.5361680839269}, "training_iteration": 43, "episodes_total": 608, "episode_len_mean": 700.0, "timestamp": 1557206266, "time_total_s": 1190.9880707263947, "pid": 31998, "info": {"num_steps_trained": 1966368, "load_time_ms": 14.043, "num_steps_sampled": 1966368, "grad_time_ms": 9338.565, "sample_time_ms": 17135.354, "update_time_ms": 7.949, "default": {"vf_explained_var": 0.9767895936965942, "vf_loss": 5.706471920013428, "cur_kl_coeff": 0.01874999701976776, "cur_lr": 0.0005000000237487257, "total_loss": 5.703087329864502, "kl": 0.015667250379920006, "policy_loss": -0.003678683890029788, "entropy": 1.1778525114059448}}, "time_this_iter_s": 25.72639036178589, "timesteps_since_restore": 1966368, "time_since_restore": 1190.9880707263947, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44720, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9ef0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9cf8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-17-46", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 875.9994811655723}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1211.0253836612628, "node_ip": "10.138.0.2", "timesteps_total": 2008933, "iterations_since_restore": 44, "episode_reward_mean": 1063.6655427128965, "custom_metrics": {"cost1_min": 283.9141395276339, "cost1_max": 423.9146296459644, "cost1_mean": 357.4406338824808, "system_level_velocity_mean": 13.393393791595372, "cost2_max": -133.96793937037086, "outflow_rate_min": 859.072096793003, "system_level_velocity_max": 15.78525583476073, "system_level_velocity_min": 10.81614153913543, "outflow_rate_max": 1193.118828317714, "cost2_mean": -162.6619004276736, "outflow_rate_mean": 1077.6663993679251, "cost2_min": -192.23536137943705}, "training_iteration": 44, "episodes_total": 624, "episode_len_mean": 700.0, "timestamp": 1557206291, "time_total_s": 1216.2912752628326, "pid": 31998, "info": {"num_steps_trained": 2008933, "load_time_ms": 14.16, "num_steps_sampled": 2008933, "grad_time_ms": 9318.441, "sample_time_ms": 16949.554, "update_time_ms": 8.112, "default": {"vf_explained_var": 0.9851574301719666, "vf_loss": 4.477569103240967, "cur_kl_coeff": 0.01874999888241291, "cur_lr": 0.0005000000237487257, "total_loss": 4.472299098968506, "kl": 0.012972122058272362, "policy_loss": -0.005513170268386602, "entropy": 1.1758686304092407}}, "time_this_iter_s": 25.30320453643799, "timesteps_since_restore": 2008933, "time_since_restore": 1216.2912752628326, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 42565, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdd68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd6a0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd400>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-18-11", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 875.9994811655723}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1211.0253836612628, "node_ip": "10.138.0.2", "timesteps_total": 2053235, "iterations_since_restore": 45, "episode_reward_mean": 1066.2696200167793, "custom_metrics": {"cost1_min": 283.9141395276339, "cost1_max": 423.9146296459644, "cost1_mean": 359.1737305868841, "system_level_velocity_mean": 13.470050814723955, "cost2_max": -137.5766429234358, "outflow_rate_min": 859.072096793003, "system_level_velocity_max": 15.78525583476073, "system_level_velocity_min": 10.81614153913543, "outflow_rate_max": 1193.118828317714, "cost2_mean": -167.74368936778993, "outflow_rate_mean": 1083.338287203844, "cost2_min": -196.88323867596648}, "training_iteration": 45, "episodes_total": 639, "episode_len_mean": 700.0, "timestamp": 1557206318, "time_total_s": 1243.27925491333, "pid": 31998, "info": {"num_steps_trained": 2053235, "load_time_ms": 14.426, "num_steps_sampled": 2053235, "grad_time_ms": 9429.0, "sample_time_ms": 16887.943, "update_time_ms": 8.141, "default": {"vf_explained_var": 0.988835334777832, "vf_loss": 3.112520217895508, "cur_kl_coeff": 0.01874999701976776, "cur_lr": 0.0005000000237487257, "total_loss": 3.107025384902954, "kl": 0.016138551756739616, "policy_loss": -0.005797639023512602, "entropy": 1.1697826385498047}}, "time_this_iter_s": 26.987979650497437, "timesteps_since_restore": 2053235, "time_since_restore": 1243.27925491333, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44302, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66b4cb38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdf98>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-18-38", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 864.3827067600492}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1281.4377382331, "node_ip": "10.138.0.2", "timesteps_total": 2096075, "iterations_since_restore": 46, "episode_reward_mean": 1059.2514035458646, "custom_metrics": {"cost1_min": 33.71619252024454, "cost1_max": 423.9146296459644, "cost1_mean": 357.253435194847, "system_level_velocity_mean": 13.586553020004432, "cost2_max": -31.070418462244803, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.039262729509275, "system_level_velocity_min": 10.824607667088117, "outflow_rate_max": 1268.7287068152764, "cost2_mean": -169.16955361210944, "outflow_rate_mean": 1082.5004899993369, "cost2_min": -198.93082094326314}, "training_iteration": 46, "episodes_total": 655, "episode_len_mean": 693.5, "timestamp": 1557206343, "time_total_s": 1268.3843154907227, "pid": 31998, "info": {"num_steps_trained": 2096075, "load_time_ms": 14.164, "num_steps_sampled": 2096075, "grad_time_ms": 9445.778, "sample_time_ms": 16670.934, "update_time_ms": 8.177, "default": {"vf_explained_var": 0.9713606238365173, "vf_loss": 8.050642013549805, "cur_kl_coeff": 0.01874999701976776, "cur_lr": 0.0005000000237487257, "total_loss": 8.047374725341797, "kl": 0.016271259635686874, "policy_loss": -0.0035726167261600494, "entropy": 1.147216558456421}}, "time_this_iter_s": 25.105060577392578, "timesteps_since_restore": 2096075, "time_since_restore": 1268.3843154907227, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 42840, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9e80>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b98d0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-19-03", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 66.47247820378337}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1281.4377382331, "node_ip": "10.138.0.2", "timesteps_total": 2139105, "iterations_since_restore": 47, "episode_reward_mean": 1065.1472385823167, "custom_metrics": {"cost1_min": 33.71619252024454, "cost1_max": 422.30185236369095, "cost1_mean": 358.394500510312, "system_level_velocity_mean": 13.637966241956256, "cost2_max": -31.070418462244803, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.039262729509275, "system_level_velocity_min": 10.824607667088117, "outflow_rate_max": 1268.7287068152764, "cost2_mean": -171.86650226619224, "outflow_rate_mean": 1086.399286196286, "cost2_min": -203.58711321475315}, "training_iteration": 47, "episodes_total": 671, "episode_len_mean": 693.5, "timestamp": 1557206369, "time_total_s": 1294.4162590503693, "pid": 31998, "info": {"num_steps_trained": 2139105, "load_time_ms": 14.004, "num_steps_sampled": 2139105, "grad_time_ms": 9540.961, "sample_time_ms": 16557.059, "update_time_ms": 8.026, "default": {"vf_explained_var": 0.9644522666931152, "vf_loss": 7.88253927230835, "cur_kl_coeff": 0.01874999701976776, "cur_lr": 0.0005000000237487257, "total_loss": 7.879526615142822, "kl": 0.0160846970975399, "policy_loss": -0.00331410625949502, "entropy": 1.1346467733383179}}, "time_this_iter_s": 26.031943559646606, "timesteps_since_restore": 2139105, "time_since_restore": 1294.4162590503693, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43030, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd3c8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd978>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-19-29", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 66.47247820378337}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1281.4377382331, "node_ip": "10.138.0.2", "timesteps_total": 2186088, "iterations_since_restore": 48, "episode_reward_mean": 1062.7026624919902, "custom_metrics": {"cost1_min": 33.71619252024454, "cost1_max": 422.30185236369095, "cost1_mean": 356.94844769356166, "system_level_velocity_mean": 13.579545119840922, "cost2_max": -31.070418462244803, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.039262729509275, "system_level_velocity_min": 11.178613514637545, "outflow_rate_max": 1268.7287068152764, "cost2_mean": -174.20997288380642, "outflow_rate_mean": 1084.730423899876, "cost2_min": -203.58711321475315}, "training_iteration": 48, "episodes_total": 680, "episode_len_mean": 693.5, "timestamp": 1557206397, "time_total_s": 1322.093167066574, "pid": 31998, "info": {"num_steps_trained": 2186088, "load_time_ms": 14.249, "num_steps_sampled": 2186088, "grad_time_ms": 9663.445, "sample_time_ms": 16545.646, "update_time_ms": 7.81, "default": {"vf_explained_var": 0.981896162033081, "vf_loss": 3.6400694847106934, "cur_kl_coeff": 0.01874999701976776, "cur_lr": 0.0005000000237487257, "total_loss": 3.637026309967041, "kl": 0.013204902410507202, "policy_loss": -0.00329073378816247, "entropy": 1.1385711431503296}}, "time_this_iter_s": 27.676908016204834, "timesteps_since_restore": 2186088, "time_since_restore": 1322.093167066574, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 46983, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa5c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd5c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdcc0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-19-57", "hostname": "flow-main", "episodes_this_iter": 9, "episode_reward_min": 66.47247820378337}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1281.4377382331, "node_ip": "10.138.0.2", "timesteps_total": 2229538, "iterations_since_restore": 49, "episode_reward_mean": 1059.0929700051813, "custom_metrics": {"cost1_min": 33.71619252024454, "cost1_max": 422.30185236369095, "cost1_mean": 353.9213894681714, "system_level_velocity_mean": 13.449035114639644, "cost2_max": -31.070418462244803, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.039262729509275, "system_level_velocity_min": 11.178613514637545, "outflow_rate_max": 1268.7287068152764, "cost2_mean": -178.86249202419702, "outflow_rate_mean": 1080.1945805218963, "cost2_min": -205.8836796814259}, "training_iteration": 49, "episodes_total": 697, "episode_len_mean": 693.5, "timestamp": 1557206423, "time_total_s": 1347.606641292572, "pid": 31998, "info": {"num_steps_trained": 2229538, "load_time_ms": 14.308, "num_steps_sampled": 2229538, "grad_time_ms": 9717.008, "sample_time_ms": 16366.903, "update_time_ms": 8.041, "default": {"vf_explained_var": 0.9821363091468811, "vf_loss": 5.018486976623535, "cur_kl_coeff": 0.01874999888241291, "cur_lr": 0.0005000000237487257, "total_loss": 5.0134124755859375, "kl": 0.01689870096743107, "policy_loss": -0.005391908343881369, "entropy": 1.1100642681121826}}, "time_this_iter_s": 25.513474225997925, "timesteps_since_restore": 2229538, "time_since_restore": 1347.606641292572, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43450, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd0f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cde80>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdfd0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-20-23", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 66.47247820378337}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1281.4377382331, "node_ip": "10.138.0.2", "timesteps_total": 2273891, "iterations_since_restore": 50, "episode_reward_mean": 1053.320307175813, "custom_metrics": {"cost1_min": 28.796800959218267, "cost1_max": 422.30185236369095, "cost1_mean": 350.1476378244381, "system_level_velocity_mean": 13.488424686587054, "cost2_max": -26.23739748575805, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.57760566385819, "system_level_velocity_min": 10.948038605733458, "outflow_rate_max": 1283.2131848232532, "cost2_mean": -180.67637087350877, "outflow_rate_mean": 1075.9384115843482, "cost2_min": -211.30806835175315}, "training_iteration": 50, "episodes_total": 714, "episode_len_mean": 686.93, "timestamp": 1557206449, "time_total_s": 1373.743292093277, "pid": 31998, "info": {"num_steps_trained": 2273891, "load_time_ms": 14.514, "num_steps_sampled": 2273891, "grad_time_ms": 9816.61, "sample_time_ms": 16237.472, "update_time_ms": 7.939, "default": {"vf_explained_var": 0.9720074534416199, "vf_loss": 8.280019760131836, "cur_kl_coeff": 0.01874999701976776, "cur_lr": 0.0005000000237487257, "total_loss": 8.273852348327637, "kl": 0.019168658182024956, "policy_loss": -0.006526792887598276, "entropy": 1.1328855752944946}}, "time_this_iter_s": 26.136650800704956, "timesteps_since_restore": 2273891, "time_since_restore": 1373.743292093277, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44353, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1ef0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c13c8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-20-49", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 53.08617639700821}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1281.4377382331, "node_ip": "10.138.0.2", "timesteps_total": 2317000, "iterations_since_restore": 51, "episode_reward_mean": 1037.1005764771064, "custom_metrics": {"cost1_min": 28.796800959218267, "cost1_max": 422.30185236369095, "cost1_mean": 348.66491977919367, "system_level_velocity_mean": 13.622687817347687, "cost2_max": -26.23739748575805, "outflow_rate_min": 326.2713828205716, "system_level_velocity_max": 19.966916566348488, "system_level_velocity_min": 10.948038605733458, "outflow_rate_max": 1283.2131848232532, "cost2_mean": -180.4735156004235, "outflow_rate_mean": 1072.5578447331013, "cost2_min": -212.33544972152993}, "training_iteration": 51, "episodes_total": 729, "episode_len_mean": 680.36, "timestamp": 1557206475, "time_total_s": 1399.7715108394623, "pid": 31998, "info": {"num_steps_trained": 2317000, "load_time_ms": 14.609, "num_steps_sampled": 2317000, "grad_time_ms": 9898.192, "sample_time_ms": 16089.187, "update_time_ms": 7.835, "default": {"vf_explained_var": 0.9797093272209167, "vf_loss": 5.9610276222229, "cur_kl_coeff": 0.01874999701976776, "cur_lr": 0.0005000000237487257, "total_loss": 5.957805633544922, "kl": 0.016014082357287407, "policy_loss": -0.003521961160004139, "entropy": 1.1053191423416138}}, "time_this_iter_s": 26.028218746185303, "timesteps_since_restore": 2317000, "time_since_restore": 1399.7715108394623, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43109, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9eb8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-21-15", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 53.08617639700821}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1287.335200753165, "node_ip": "10.138.0.2", "timesteps_total": 2360514, "iterations_since_restore": 52, "episode_reward_mean": 1055.1841483934095, "custom_metrics": {"cost1_min": 28.796800959218267, "cost1_max": 446.24635168644124, "cost1_mean": 352.99226010953237, "system_level_velocity_mean": 13.781505579530052, "cost2_max": -26.23739748575805, "outflow_rate_min": 326.2713828205716, "system_level_velocity_max": 19.966916566348488, "system_level_velocity_min": 10.948038605733458, "outflow_rate_max": 1283.2131848232532, "cost2_mean": -183.43860686356336, "outflow_rate_mean": 1081.7127456153983, "cost2_min": -214.28291216497598}, "training_iteration": 52, "episodes_total": 746, "episode_len_mean": 680.36, "timestamp": 1557206502, "time_total_s": 1426.387977361679, "pid": 31998, "info": {"num_steps_trained": 2360514, "load_time_ms": 14.807, "num_steps_sampled": 2360514, "grad_time_ms": 9965.127, "sample_time_ms": 16036.314, "update_time_ms": 7.752, "default": {"vf_explained_var": 0.986920177936554, "vf_loss": 4.268760681152344, "cur_kl_coeff": 0.01874999888241291, "cur_lr": 0.0005000000237487257, "total_loss": 4.265527248382568, "kl": 0.013731520622968674, "policy_loss": -0.0034910556860268116, "entropy": 1.0869914293289185}}, "time_this_iter_s": 26.616466522216797, "timesteps_since_restore": 2360514, "time_since_restore": 1426.387977361679, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43514, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1a58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4e80>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-21-42", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 53.08617639700821}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1287.335200753165, "node_ip": "10.138.0.2", "timesteps_total": 2405900, "iterations_since_restore": 53, "episode_reward_mean": 1065.8612345878216, "custom_metrics": {"cost1_min": 28.796800959218267, "cost1_max": 446.24635168644124, "cost1_mean": 358.55045834931735, "system_level_velocity_mean": 13.825554763950064, "cost2_max": -26.23739748575805, "outflow_rate_min": 326.2713828205716, "system_level_velocity_max": 19.966916566348488, "system_level_velocity_min": 10.948038605733458, "outflow_rate_max": 1283.2131848232532, "cost2_mean": -187.11893707735607, "outflow_rate_mean": 1094.72379789599, "cost2_min": -217.53649397810685}, "training_iteration": 53, "episodes_total": 758, "episode_len_mean": 686.86, "timestamp": 1557206527, "time_total_s": 1451.7772359848022, "pid": 31998, "info": {"num_steps_trained": 2405900, "load_time_ms": 14.823, "num_steps_sampled": 2405900, "grad_time_ms": 10073.951, "sample_time_ms": 15893.155, "update_time_ms": 7.441, "default": {"vf_explained_var": 0.9911514520645142, "vf_loss": 3.0125391483306885, "cur_kl_coeff": 0.01874999888241291, "cur_lr": 0.0005000000237487257, "total_loss": 3.0100483894348145, "kl": 0.014620010741055012, "policy_loss": -0.0027649125549942255, "entropy": 1.0781679153442383}}, "time_this_iter_s": 25.38925862312317, "timesteps_since_restore": 2405900, "time_since_restore": 1451.7772359848022, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45386, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cda90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cda20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd5c0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-22-07", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 53.08617639700821}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1312.50959453803, "node_ip": "10.138.0.2", "timesteps_total": 2451117, "iterations_since_restore": 54, "episode_reward_mean": 1061.3003024918257, "custom_metrics": {"cost1_min": 28.796800959218267, "cost1_max": 446.24635168644124, "cost1_mean": 359.78860802124393, "system_level_velocity_mean": 14.055026831966341, "cost2_max": -26.23739748575805, "outflow_rate_min": 326.2713828205716, "system_level_velocity_max": 20.102130997943988, "system_level_velocity_min": 10.948038605733458, "outflow_rate_max": 1293.8659645715122, "cost2_mean": -188.39143831245926, "outflow_rate_mean": 1095.5461749172946, "cost2_min": -219.48090326215376}, "training_iteration": 54, "episodes_total": 773, "episode_len_mean": 681.27, "timestamp": 1557206553, "time_total_s": 1477.647741317749, "pid": 31998, "info": {"num_steps_trained": 2451117, "load_time_ms": 15.142, "num_steps_sampled": 2451117, "grad_time_ms": 10243.098, "sample_time_ms": 15779.693, "update_time_ms": 7.278, "default": {"vf_explained_var": 0.9871261715888977, "vf_loss": 4.895170211791992, "cur_kl_coeff": 0.01874999888241291, "cur_lr": 0.0005000000237487257, "total_loss": 4.891039848327637, "kl": 0.01917855255305767, "policy_loss": -0.004490036983042955, "entropy": 1.08187997341156}}, "time_this_iter_s": 25.870505332946777, "timesteps_since_restore": 2451117, "time_since_restore": 1477.647741317749, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45217, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9b38>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9dd8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-22-33", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 53.08617639700821}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1312.50959453803, "node_ip": "10.138.0.2", "timesteps_total": 2494091, "iterations_since_restore": 55, "episode_reward_mean": 1068.3335317537194, "custom_metrics": {"cost1_min": 28.796800959218267, "cost1_max": 463.65105521258766, "cost1_mean": 366.9854914606734, "system_level_velocity_mean": 14.359347827080716, "cost2_max": -26.23739748575805, "outflow_rate_min": 326.2713828205716, "system_level_velocity_max": 20.102130997943988, "system_level_velocity_min": 10.948038605733458, "outflow_rate_max": 1293.8659645715122, "cost2_mean": -190.55635014634797, "outflow_rate_mean": 1107.903212238541, "cost2_min": -249.20060937007833}, "training_iteration": 55, "episodes_total": 790, "episode_len_mean": 681.27, "timestamp": 1557206579, "time_total_s": 1503.6916048526764, "pid": 31998, "info": {"num_steps_trained": 2494091, "load_time_ms": 14.97, "num_steps_sampled": 2494091, "grad_time_ms": 10318.546, "sample_time_ms": 15608.498, "update_time_ms": 7.28, "default": {"vf_explained_var": 0.9898959398269653, "vf_loss": 4.293590068817139, "cur_kl_coeff": 0.01874999701976776, "cur_lr": 0.0005000000237487257, "total_loss": 4.28867244720459, "kl": 0.01640843041241169, "policy_loss": -0.005224925931543112, "entropy": 1.0710200071334839}}, "time_this_iter_s": 26.043863534927368, "timesteps_since_restore": 2494091, "time_since_restore": 1503.6916048526764, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 42974, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa6a0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aae10>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-22-59", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 53.08617639700821}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1312.50959453803, "node_ip": "10.138.0.2", "timesteps_total": 2539395, "iterations_since_restore": 56, "episode_reward_mean": 1079.60646086804, "custom_metrics": {"cost1_min": 29.181617218113125, "cost1_max": 463.65105521258766, "cost1_mean": 375.5701951479921, "system_level_velocity_mean": 14.530161432500176, "cost2_max": -29.149955921533152, "outflow_rate_min": 326.2713828205716, "system_level_velocity_max": 20.102130997943988, "system_level_velocity_min": 11.957928286331818, "outflow_rate_max": 1293.8659645715122, "cost2_mean": -194.76153568738874, "outflow_rate_mean": 1122.8396861492768, "cost2_min": -249.20060937007833}, "training_iteration": 56, "episodes_total": 805, "episode_len_mean": 687.84, "timestamp": 1557206605, "time_total_s": 1529.6145927906036, "pid": 31998, "info": {"num_steps_trained": 2539395, "load_time_ms": 15.177, "num_steps_sampled": 2539395, "grad_time_ms": 10487.817, "sample_time_ms": 15519.614, "update_time_ms": 7.223, "default": {"vf_explained_var": 0.9909128546714783, "vf_loss": 3.0778815746307373, "cur_kl_coeff": 0.01874999888241291, "cur_lr": 0.0005000000237487257, "total_loss": 3.0732645988464355, "kl": 0.017056571319699287, "policy_loss": -0.004936673678457737, "entropy": 1.0653631687164307}}, "time_this_iter_s": 25.922987937927246, "timesteps_since_restore": 2539395, "time_since_restore": 1529.6145927906036, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45304, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4550>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-23-25", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 53.29890327684128}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1312.50959453803, "node_ip": "10.138.0.2", "timesteps_total": 2583737, "iterations_since_restore": 57, "episode_reward_mean": 1090.4116600338205, "custom_metrics": {"cost1_min": 101.22242969277139, "cost1_max": 463.65105521258766, "cost1_mean": 380.09160064056846, "system_level_velocity_mean": 14.665308001319916, "cost2_max": -73.4597986062976, "outflow_rate_min": 420.75230049378786, "system_level_velocity_max": 20.102130997943988, "system_level_velocity_min": 11.213761123991649, "outflow_rate_max": 1293.8659645715122, "cost2_mean": -198.5288095760433, "outflow_rate_mean": 1131.4982464506966, "cost2_min": -249.20060937007833}, "training_iteration": 57, "episodes_total": 822, "episode_len_mean": 689.02, "timestamp": 1557206631, "time_total_s": 1555.6255300045013, "pid": 31998, "info": {"num_steps_trained": 2583737, "load_time_ms": 15.261, "num_steps_sampled": 2583737, "grad_time_ms": 10593.291, "sample_time_ms": 15412.514, "update_time_ms": 7.111, "default": {"vf_explained_var": 0.9874265789985657, "vf_loss": 5.086709976196289, "cur_kl_coeff": 0.01874999701976776, "cur_lr": 0.0005000000237487257, "total_loss": 5.082441806793213, "kl": 0.01676388643682003, "policy_loss": -0.004582699853926897, "entropy": 1.0647469758987427}}, "time_this_iter_s": 26.010937213897705, "timesteps_since_restore": 2583737, "time_since_restore": 1555.6255300045013, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44342, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a72b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7c50>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7c18>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-23-51", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 218.31590806007168}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1312.50959453803, "node_ip": "10.138.0.2", "timesteps_total": 2630639, "iterations_since_restore": 58, "episode_reward_mean": 1085.1773385571453, "custom_metrics": {"cost1_min": 34.469436480166415, "cost1_max": 463.65105521258766, "cost1_mean": 378.59494958111, "system_level_velocity_mean": 14.80241323995802, "cost2_max": -37.68044176469714, "outflow_rate_min": 326.3480644689883, "system_level_velocity_max": 20.102130997943988, "system_level_velocity_min": 11.213761123991649, "outflow_rate_max": 1307.5933871540954, "cost2_mean": -198.82707814111788, "outflow_rate_mean": 1127.8513034297364, "cost2_min": -249.20060937007833}, "training_iteration": 58, "episodes_total": 833, "episode_len_mean": 682.52, "timestamp": 1557206658, "time_total_s": 1582.8263792991638, "pid": 31998, "info": {"num_steps_trained": 2630639, "load_time_ms": 15.353, "num_steps_sampled": 2630639, "grad_time_ms": 10665.414, "sample_time_ms": 15291.983, "update_time_ms": 7.384, "default": {"vf_explained_var": 0.9863492846488953, "vf_loss": 4.388296127319336, "cur_kl_coeff": 0.01874999701976776, "cur_lr": 0.0005000000237487257, "total_loss": 4.385833740234375, "kl": 0.01791476458311081, "policy_loss": -0.002799093956127763, "entropy": 1.0357402563095093}}, "time_this_iter_s": 27.200849294662476, "timesteps_since_restore": 2630639, "time_since_restore": 1582.8263792991638, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 46902, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689eeb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c15f8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e198>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-24-18", "hostname": "flow-main", "episodes_this_iter": 11, "episode_reward_min": 56.14508484609412}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1329.7932432533894, "node_ip": "10.138.0.2", "timesteps_total": 2675735, "iterations_since_restore": 59, "episode_reward_mean": 1078.5025202366678, "custom_metrics": {"cost1_min": 34.469436480166415, "cost1_max": 463.65105521258766, "cost1_mean": 375.578284104593, "system_level_velocity_mean": 14.783032056558232, "cost2_max": -37.68044176469714, "outflow_rate_min": 326.3480644689883, "system_level_velocity_max": 20.102130997943988, "system_level_velocity_min": 11.213761123991649, "outflow_rate_max": 1307.5933871540954, "cost2_mean": -200.64317725519416, "outflow_rate_mean": 1124.106276789195, "cost2_min": -249.20060937007833}, "training_iteration": 59, "episodes_total": 849, "episode_len_mean": 679.19, "timestamp": 1557206684, "time_total_s": 1608.236732006073, "pid": 31998, "info": {"num_steps_trained": 2675735, "load_time_ms": 15.424, "num_steps_sampled": 2675735, "grad_time_ms": 10827.929, "sample_time_ms": 15117.908, "update_time_ms": 7.088, "default": {"vf_explained_var": 0.9852012395858765, "vf_loss": 5.312606334686279, "cur_kl_coeff": 0.01874999888241291, "cur_lr": 0.0005000000237487257, "total_loss": 5.308111190795898, "kl": 0.01475841086357832, "policy_loss": -0.004771687556058168, "entropy": 1.032406210899353}}, "time_this_iter_s": 25.41035270690918, "timesteps_since_restore": 2675735, "time_since_restore": 1608.236732006073, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45096, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1240>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1748>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-24-44", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 56.14508484609412}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1329.7932432533894, "node_ip": "10.138.0.2", "timesteps_total": 2718144, "iterations_since_restore": 60, "episode_reward_mean": 1068.7324960908027, "custom_metrics": {"cost1_min": 29.61663250224059, "cost1_max": 463.65105521258766, "cost1_mean": 372.29821359479473, "system_level_velocity_mean": 14.845333349953485, "cost2_max": -32.080501108340194, "outflow_rate_min": 326.3480644689883, "system_level_velocity_max": 20.50104737578304, "system_level_velocity_min": 11.213761123991649, "outflow_rate_max": 1307.5933871540954, "cost2_mean": -199.6977562665127, "outflow_rate_mean": 1115.605762007806, "cost2_min": -251.86094663356045}, "training_iteration": 60, "episodes_total": 866, "episode_len_mean": 672.62, "timestamp": 1557206709, "time_total_s": 1633.3979074954987, "pid": 31998, "info": {"num_steps_trained": 2718144, "load_time_ms": 15.486, "num_steps_sampled": 2718144, "grad_time_ms": 10842.908, "sample_time_ms": 15003.227, "update_time_ms": 7.362, "default": {"vf_explained_var": 0.9888272285461426, "vf_loss": 4.533018112182617, "cur_kl_coeff": 0.01874999701976776, "cur_lr": 0.0005000000237487257, "total_loss": 4.527651786804199, "kl": 0.01823400892317295, "policy_loss": -0.0057081189006567, "entropy": 1.048820972442627}}, "time_this_iter_s": 25.16117548942566, "timesteps_since_restore": 2718144, "time_since_restore": 1633.3979074954987, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 42409, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4a20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4828>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-25-09", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 49.98316983059991}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1329.7932432533894, "node_ip": "10.138.0.2", "timesteps_total": 2764330, "iterations_since_restore": 61, "episode_reward_mean": 1063.0602236767415, "custom_metrics": {"cost1_min": 29.61663250224059, "cost1_max": 463.65105521258766, "cost1_mean": 368.2698531804277, "system_level_velocity_mean": 14.673560946000356, "cost2_max": -32.080501108340194, "outflow_rate_min": 326.3480644689883, "system_level_velocity_max": 20.50104737578304, "system_level_velocity_min": 11.213761123991649, "outflow_rate_max": 1307.5933871540954, "cost2_mean": -200.07564563330757, "outflow_rate_mean": 1106.847280502444, "cost2_min": -251.86094663356045}, "training_iteration": 61, "episodes_total": 880, "episode_len_mean": 672.71, "timestamp": 1557206735, "time_total_s": 1659.8476893901825, "pid": 31998, "info": {"num_steps_trained": 2764330, "load_time_ms": 15.455, "num_steps_sampled": 2764330, "grad_time_ms": 10951.838, "sample_time_ms": 14936.46, "update_time_ms": 7.464, "default": {"vf_explained_var": 0.9848253130912781, "vf_loss": 4.4716057777404785, "cur_kl_coeff": 0.01874999888241291, "cur_lr": 0.0005000000237487257, "total_loss": 4.466725826263428, "kl": 0.020977862179279327, "policy_loss": -0.005273122806102037, "entropy": 1.0451107025146484}}, "time_this_iter_s": 26.449781894683838, "timesteps_since_restore": 2764330, "time_since_restore": 1659.8476893901825, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 46186, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c15f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1fd0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1438>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-25-35", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 49.98316983059991}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1329.7932432533894, "node_ip": "10.138.0.2", "timesteps_total": 2810367, "iterations_since_restore": 62, "episode_reward_mean": 1068.0510605709817, "custom_metrics": {"cost1_min": 29.61663250224059, "cost1_max": 449.27088052505326, "cost1_mean": 364.4650252516501, "system_level_velocity_mean": 14.497325760447785, "cost2_max": -32.080501108340194, "outflow_rate_min": 326.3480644689883, "system_level_velocity_max": 20.50104737578304, "system_level_velocity_min": 11.213761123991649, "outflow_rate_max": 1307.5933871540954, "cost2_mean": -201.09184806754746, "outflow_rate_mean": 1101.9805190227466, "cost2_min": -251.86094663356045}, "training_iteration": 62, "episodes_total": 896, "episode_len_mean": 672.71, "timestamp": 1557206762, "time_total_s": 1686.46799659729, "pid": 31998, "info": {"num_steps_trained": 2810367, "load_time_ms": 15.478, "num_steps_sampled": 2810367, "grad_time_ms": 11077.246, "sample_time_ms": 14811.483, "update_time_ms": 7.408, "default": {"vf_explained_var": 0.9901952743530273, "vf_loss": 2.68774676322937, "cur_kl_coeff": 0.02812500111758709, "cur_lr": 0.0005000000237487257, "total_loss": 2.6832752227783203, "kl": 0.01720285229384899, "policy_loss": -0.004955432377755642, "entropy": 1.04084050655365}}, "time_this_iter_s": 26.620307207107544, "timesteps_since_restore": 2810367, "time_since_restore": 1686.46799659729, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 46037, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd0f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd6a0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-26-02", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 49.98316983059991}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1329.7932432533894, "node_ip": "10.138.0.2", "timesteps_total": 2859386, "iterations_since_restore": 63, "episode_reward_mean": 1063.8015117676603, "custom_metrics": {"cost1_min": 29.61663250224059, "cost1_max": 446.1155479114612, "cost1_mean": 358.53474154173585, "system_level_velocity_mean": 14.248825177338137, "cost2_max": -32.080501108340194, "outflow_rate_min": 326.3480644689883, "system_level_velocity_max": 20.50104737578304, "system_level_velocity_min": 11.006709457569405, "outflow_rate_max": 1307.5933871540954, "cost2_mean": -200.7089154330561, "outflow_rate_mean": 1089.6831885018826, "cost2_min": -251.86094663356045}, "training_iteration": 63, "episodes_total": 909, "episode_len_mean": 672.71, "timestamp": 1557206790, "time_total_s": 1714.415804862976, "pid": 31998, "info": {"num_steps_trained": 2859386, "load_time_ms": 15.744, "num_steps_sampled": 2859386, "grad_time_ms": 11149.447, "sample_time_ms": 14995.373, "update_time_ms": 7.577, "default": {"vf_explained_var": 0.9936168789863586, "vf_loss": 1.5764390230178833, "cur_kl_coeff": 0.02812499925494194, "cur_lr": 0.0005000000237487257, "total_loss": 1.572467565536499, "kl": 0.014368082396686077, "policy_loss": -0.004375700373202562, "entropy": 1.0542446374893188}}, "time_this_iter_s": 27.947808265686035, "timesteps_since_restore": 2859386, "time_since_restore": 1714.415804862976, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 49019, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1208>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1518>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-26-30", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 49.98316983059991}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1329.7932432533894, "node_ip": "10.138.0.2", "timesteps_total": 2905889, "iterations_since_restore": 64, "episode_reward_mean": 1051.2065750190338, "custom_metrics": {"cost1_min": 29.61663250224059, "cost1_max": 432.42510931952074, "cost1_mean": 351.7397102872375, "system_level_velocity_mean": 13.977011704486234, "cost2_max": -32.080501108340194, "outflow_rate_min": 326.3480644689883, "system_level_velocity_max": 20.50104737578304, "system_level_velocity_min": 10.823244478537035, "outflow_rate_max": 1307.5933871540954, "cost2_mean": -200.2258287775198, "outflow_rate_mean": 1074.0554461166707, "cost2_min": -251.86094663356045}, "training_iteration": 64, "episodes_total": 920, "episode_len_mean": 672.71, "timestamp": 1557206816, "time_total_s": 1740.4124794006348, "pid": 31998, "info": {"num_steps_trained": 2905889, "load_time_ms": 15.594, "num_steps_sampled": 2905889, "grad_time_ms": 11115.397, "sample_time_ms": 15043.05, "update_time_ms": 7.655, "default": {"vf_explained_var": 0.9946482181549072, "vf_loss": 1.481845498085022, "cur_kl_coeff": 0.02812499925494194, "cur_lr": 0.0005000000237487257, "total_loss": 1.4774129390716553, "kl": 0.01807969994843006, "policy_loss": -0.004941034130752087, "entropy": 1.0244637727737427}}, "time_this_iter_s": 25.99667453765869, "timesteps_since_restore": 2905889, "time_since_restore": 1740.4124794006348, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 46503, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4c18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4748>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-26-56", "hostname": "flow-main", "episodes_this_iter": 11, "episode_reward_min": 49.98316983059991}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1329.7932432533894, "node_ip": "10.138.0.2", "timesteps_total": 2952289, "iterations_since_restore": 65, "episode_reward_mean": 1056.9722067141813, "custom_metrics": {"cost1_min": 29.61663250224059, "cost1_max": 432.07562266564025, "cost1_mean": 350.44081732261037, "system_level_velocity_mean": 13.500199485041191, "cost2_max": -32.080501108340194, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.50104737578304, "system_level_velocity_min": 10.823244478537035, "outflow_rate_max": 1293.7192714060243, "cost2_mean": -202.54413971834262, "outflow_rate_mean": 1072.4953920849805, "cost2_min": -251.86094663356045}, "training_iteration": 65, "episodes_total": 936, "episode_len_mean": 687.93, "timestamp": 1557206842, "time_total_s": 1766.8051414489746, "pid": 31998, "info": {"num_steps_trained": 2952289, "load_time_ms": 15.618, "num_steps_sampled": 2952289, "grad_time_ms": 11107.075, "sample_time_ms": 15089.375, "update_time_ms": 7.499, "default": {"vf_explained_var": 0.9945363998413086, "vf_loss": 1.6985098123550415, "cur_kl_coeff": 0.02812499925494194, "cur_lr": 0.0005000000237487257, "total_loss": 1.6955766677856445, "kl": 0.014785799197852612, "policy_loss": -0.003348867641761899, "entropy": 1.034075379371643}}, "time_this_iter_s": 26.392662048339844, "timesteps_since_restore": 2952289, "time_since_restore": 1766.8051414489746, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 46400, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1668>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1be0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-27-22", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 49.98316983059991}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1284.0729614007691, "node_ip": "10.138.0.2", "timesteps_total": 2997616, "iterations_since_restore": 66, "episode_reward_mean": 1058.888685843242, "custom_metrics": {"cost1_min": 29.61663250224059, "cost1_max": 424.9613309390227, "cost1_mean": 347.4006516478428, "system_level_velocity_mean": 13.3662886761509, "cost2_max": -32.080501108340194, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.50104737578304, "system_level_velocity_min": 10.823244478537035, "outflow_rate_max": 1264.8710983960118, "cost2_mean": -203.6906302654975, "outflow_rate_mean": 1066.5317817041282, "cost2_min": -251.86094663356045}, "training_iteration": 66, "episodes_total": 950, "episode_len_mean": 687.93, "timestamp": 1557206868, "time_total_s": 1792.8800847530365, "pid": 31998, "info": {"num_steps_trained": 2997616, "load_time_ms": 15.633, "num_steps_sampled": 2997616, "grad_time_ms": 10988.916, "sample_time_ms": 15223.061, "update_time_ms": 7.536, "default": {"vf_explained_var": 0.9915903210639954, "vf_loss": 2.4297189712524414, "cur_kl_coeff": 0.02812499739229679, "cur_lr": 0.0005000000237487257, "total_loss": 2.42451810836792, "kl": 0.01660558581352234, "policy_loss": -0.005667662248015404, "entropy": 0.9997062087059021}}, "time_this_iter_s": 26.07494330406189, "timesteps_since_restore": 2997616, "time_since_restore": 1792.8800847530365, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45327, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa4e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa6a0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-27-48", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 49.98316983059991}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1284.0729614007691, "node_ip": "10.138.0.2", "timesteps_total": 3044950, "iterations_since_restore": 67, "episode_reward_mean": 1060.4917218573914, "custom_metrics": {"cost1_min": 29.78271878394065, "cost1_max": 412.80391468094285, "cost1_mean": 344.15612122533867, "system_level_velocity_mean": 13.211254284852714, "cost2_max": -29.614706067408708, "outflow_rate_min": 329.21922607834034, "system_level_velocity_max": 19.515003777356636, "system_level_velocity_min": 10.823244478537035, "outflow_rate_max": 1235.6212676304397, "cost2_mean": -204.15231297072253, "outflow_rate_mean": 1062.1712236626645, "cost2_min": -243.5212914553385}, "training_iteration": 67, "episodes_total": 963, "episode_len_mean": 687.94, "timestamp": 1557206895, "time_total_s": 1819.802039861679, "pid": 31998, "info": {"num_steps_trained": 3044950, "load_time_ms": 15.623, "num_steps_sampled": 3044950, "grad_time_ms": 10868.72, "sample_time_ms": 15435.566, "update_time_ms": 7.479, "default": {"vf_explained_var": 0.9882228374481201, "vf_loss": 3.4879825115203857, "cur_kl_coeff": 0.02812499739229679, "cur_lr": 0.0005000000237487257, "total_loss": 3.484039783477783, "kl": 0.015634674578905106, "policy_loss": -0.004382055718451738, "entropy": 0.9686285853385925}}, "time_this_iter_s": 26.921955108642578, "timesteps_since_restore": 3044950, "time_since_restore": 1819.802039861679, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 47334, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1c50>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d10b8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-28-15", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 53.747794893981876}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1284.0729614007691, "node_ip": "10.138.0.2", "timesteps_total": 3089619, "iterations_since_restore": 68, "episode_reward_mean": 1073.12942124791, "custom_metrics": {"cost1_min": 29.78271878394065, "cost1_max": 404.25253390242057, "cost1_mean": 343.8829211325522, "system_level_velocity_mean": 13.03502152459945, "cost2_max": -29.614706067408708, "outflow_rate_min": 329.21922607834034, "system_level_velocity_max": 19.515003777356636, "system_level_velocity_min": 10.823244478537035, "outflow_rate_max": 1224.6170174381514, "cost2_mean": -206.75455128369273, "outflow_rate_mean": 1065.4391230906874, "cost2_min": -243.5212914553385}, "training_iteration": 68, "episodes_total": 980, "episode_len_mean": 693.44, "timestamp": 1557206921, "time_total_s": 1845.6368699073792, "pid": 31998, "info": {"num_steps_trained": 3089619, "load_time_ms": 15.428, "num_steps_sampled": 3089619, "grad_time_ms": 10696.761, "sample_time_ms": 15472.489, "update_time_ms": 7.043, "default": {"vf_explained_var": 0.9926400780677795, "vf_loss": 2.220346450805664, "cur_kl_coeff": 0.02812500111758709, "cur_lr": 0.0005000000237487257, "total_loss": 2.214961528778076, "kl": 0.02066497690975666, "policy_loss": -0.00596616743132472, "entropy": 0.945090115070343}}, "time_this_iter_s": 25.834830045700073, "timesteps_since_restore": 3089619, "time_since_restore": 1845.6368699073792, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44669, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4160>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4828>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-28-41", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 53.747794893981876}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1271.8721528158446, "node_ip": "10.138.0.2", "timesteps_total": 3134960, "iterations_since_restore": 69, "episode_reward_mean": 1073.3013111337666, "custom_metrics": {"cost1_min": 29.78271878394065, "cost1_max": 404.25253390242057, "cost1_mean": 343.8180398826812, "system_level_velocity_mean": 13.037108075535228, "cost2_max": -29.614706067408708, "outflow_rate_min": 329.21922607834034, "system_level_velocity_max": 19.515003777356636, "system_level_velocity_min": 10.823244478537035, "outflow_rate_max": 1241.9518385031604, "cost2_mean": -206.6302253288656, "outflow_rate_mean": 1066.343512410773, "cost2_min": -243.5212914553385}, "training_iteration": 69, "episodes_total": 996, "episode_len_mean": 693.44, "timestamp": 1557206947, "time_total_s": 1871.6244320869446, "pid": 31998, "info": {"num_steps_trained": 3134960, "load_time_ms": 15.295, "num_steps_sampled": 3134960, "grad_time_ms": 10525.228, "sample_time_ms": 15703.681, "update_time_ms": 7.111, "default": {"vf_explained_var": 0.9919667840003967, "vf_loss": 2.3687350749969482, "cur_kl_coeff": 0.04218750819563866, "cur_lr": 0.0005000000237487257, "total_loss": 2.364536762237549, "kl": 0.017772963270545006, "policy_loss": -0.004948355257511139, "entropy": 0.9299221634864807}}, "time_this_iter_s": 25.98756217956543, "timesteps_since_restore": 3134960, "time_since_restore": 1871.6244320869446, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45341, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d14e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d16d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1908>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-29-07", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 53.747794893981876}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1271.8721528158446, "node_ip": "10.138.0.2", "timesteps_total": 3181206, "iterations_since_restore": 70, "episode_reward_mean": 1073.4363836999898, "custom_metrics": {"cost1_min": 29.39507040808135, "cost1_max": 419.69497761628134, "cost1_mean": 344.7362176189797, "system_level_velocity_mean": 13.262937456893884, "cost2_max": -29.614706067408708, "outflow_rate_min": 327.9458014252228, "system_level_velocity_max": 20.34279882572973, "system_level_velocity_min": 10.823244478537035, "outflow_rate_max": 1241.9518385031604, "cost2_mean": -206.576377886484, "outflow_rate_mean": 1070.236991026426, "cost2_min": -243.5212914553385}, "training_iteration": 70, "episodes_total": 1007, "episode_len_mean": 686.87, "timestamp": 1557206974, "time_total_s": 1898.640466928482, "pid": 31998, "info": {"num_steps_trained": 3181206, "load_time_ms": 15.312, "num_steps_sampled": 3181206, "grad_time_ms": 10443.822, "sample_time_ms": 15973.995, "update_time_ms": 6.869, "default": {"vf_explained_var": 0.9890673756599426, "vf_loss": 3.5201916694641113, "cur_kl_coeff": 0.04218750819563866, "cur_lr": 0.0005000000237487257, "total_loss": 3.5160672664642334, "kl": 0.0205076914280653, "policy_loss": -0.0049898638390004635, "entropy": 0.9176934957504272}}, "time_this_iter_s": 27.016034841537476, "timesteps_since_restore": 3181206, "time_since_restore": 1898.640466928482, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 46246, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd6a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cda58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdf28>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-29-34", "hostname": "flow-main", "episodes_this_iter": 11, "episode_reward_min": 49.44786275013971}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1368.3110198825711, "node_ip": "10.138.0.2", "timesteps_total": 3224822, "iterations_since_restore": 71, "episode_reward_mean": 1079.1729534354592, "custom_metrics": {"cost1_min": 29.39507040808135, "cost1_max": 420.17062528478016, "cost1_mean": 348.81491111562457, "system_level_velocity_mean": 13.57395114692738, "cost2_max": -29.614706067408708, "outflow_rate_min": 327.9458014252228, "system_level_velocity_max": 20.34279882572973, "system_level_velocity_min": 10.320277680702704, "outflow_rate_max": 1254.9153942541568, "cost2_mean": -206.3052650596957, "outflow_rate_mean": 1079.7751118344504, "cost2_min": -243.5212914553385}, "training_iteration": 71, "episodes_total": 1024, "episode_len_mean": 681.81, "timestamp": 1557207000, "time_total_s": 1924.2063546180725, "pid": 31998, "info": {"num_steps_trained": 3224822, "load_time_ms": 15.253, "num_steps_sampled": 3224822, "grad_time_ms": 10232.004, "sample_time_ms": 16097.269, "update_time_ms": 6.722, "default": {"vf_explained_var": 0.9840286374092102, "vf_loss": 5.261287689208984, "cur_kl_coeff": 0.06328123807907104, "cur_lr": 0.0005000000237487257, "total_loss": 5.257232666015625, "kl": 0.01769711636006832, "policy_loss": -0.005174472462385893, "entropy": 0.9150452613830566}}, "time_this_iter_s": 25.565887689590454, "timesteps_since_restore": 3224822, "time_since_restore": 1924.2063546180725, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43616, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d19b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1b00>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1f98>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-30-00", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 49.44786275013971}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1368.3110198825711, "node_ip": "10.138.0.2", "timesteps_total": 3270562, "iterations_since_restore": 72, "episode_reward_mean": 1100.2023376230181, "custom_metrics": {"cost1_min": 29.39507040808135, "cost1_max": 420.17062528478016, "cost1_mean": 354.2196523101295, "system_level_velocity_mean": 13.779395048095417, "cost2_max": -29.614706067408708, "outflow_rate_min": 327.9458014252228, "system_level_velocity_max": 20.34279882572973, "system_level_velocity_min": 10.320277680702704, "outflow_rate_max": 1254.9153942541568, "cost2_mean": -208.621523277705, "outflow_rate_mean": 1093.8860196870824, "cost2_min": -243.5212914553385}, "training_iteration": 72, "episodes_total": 1040, "episode_len_mean": 681.81, "timestamp": 1557207027, "time_total_s": 1951.7984085083008, "pid": 31998, "info": {"num_steps_trained": 3270562, "load_time_ms": 15.421, "num_steps_sampled": 3270562, "grad_time_ms": 10003.991, "sample_time_ms": 16420.916, "update_time_ms": 6.653, "default": {"vf_explained_var": 0.9915977716445923, "vf_loss": 2.500566005706787, "cur_kl_coeff": 0.06328124552965164, "cur_lr": 0.0005000000237487257, "total_loss": 2.4960830211639404, "kl": 0.015815967693924904, "policy_loss": -0.005483927670866251, "entropy": 0.9100285172462463}}, "time_this_iter_s": 27.59205389022827, "timesteps_since_restore": 3270562, "time_since_restore": 1951.7984085083008, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45740, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd6d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd2b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd5c0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-30-27", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 49.44786275013971}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1368.3110198825711, "node_ip": "10.138.0.2", "timesteps_total": 3316046, "iterations_since_restore": 73, "episode_reward_mean": 1111.3594022982363, "custom_metrics": {"cost1_min": 29.39507040808135, "cost1_max": 420.17062528478016, "cost1_mean": 358.9133527548238, "system_level_velocity_mean": 13.773928093066393, "cost2_max": -32.62107216051399, "outflow_rate_min": 327.9458014252228, "system_level_velocity_max": 20.34279882572973, "system_level_velocity_min": 10.320277680702704, "outflow_rate_max": 1254.9153942541568, "cost2_mean": -209.95920024027077, "outflow_rate_mean": 1107.4686394101598, "cost2_min": -243.5212914553385}, "training_iteration": 73, "episodes_total": 1053, "episode_len_mean": 688.37, "timestamp": 1557207054, "time_total_s": 1978.6469609737396, "pid": 31998, "info": {"num_steps_trained": 3316046, "load_time_ms": 15.243, "num_steps_sampled": 3316046, "grad_time_ms": 9801.164, "sample_time_ms": 16510.647, "update_time_ms": 6.773, "default": {"vf_explained_var": 0.9919126629829407, "vf_loss": 2.584476947784424, "cur_kl_coeff": 0.06328123807907104, "cur_lr": 0.0005000000237487257, "total_loss": 2.5807461738586426, "kl": 0.014969381503760815, "policy_loss": -0.004678081255406141, "entropy": 0.9047428369522095}}, "time_this_iter_s": 26.848552465438843, "timesteps_since_restore": 3316046, "time_since_restore": 1978.6469609737396, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45484, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd438>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdc18>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-30-54", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 49.44786275013971}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1368.3110198825711, "node_ip": "10.138.0.2", "timesteps_total": 3361524, "iterations_since_restore": 74, "episode_reward_mean": 1111.9351603958537, "custom_metrics": {"cost1_min": 29.39507040808135, "cost1_max": 421.03246581593686, "cost1_mean": 360.71356539823705, "system_level_velocity_mean": 13.860658550316348, "cost2_max": -32.62107216051399, "outflow_rate_min": 327.9458014252228, "system_level_velocity_max": 20.34279882572973, "system_level_velocity_min": 10.320277680702704, "outflow_rate_max": 1254.9153942541568, "cost2_mean": -208.8466776966847, "outflow_rate_mean": 1111.4875754238317, "cost2_min": -241.46632318210476}, "training_iteration": 74, "episodes_total": 1066, "episode_len_mean": 688.37, "timestamp": 1557207084, "time_total_s": 2007.7512567043304, "pid": 31998, "info": {"num_steps_trained": 3361524, "load_time_ms": 14.615, "num_steps_sampled": 3361524, "grad_time_ms": 9764.683, "sample_time_ms": 16858.629, "update_time_ms": 6.957, "default": {"vf_explained_var": 0.9931709170341492, "vf_loss": 2.334937810897827, "cur_kl_coeff": 0.06328123807907104, "cur_lr": 0.0005000000237487257, "total_loss": 2.3307323455810547, "kl": 0.01730852574110031, "policy_loss": -0.005300991702824831, "entropy": 0.8869554996490479}}, "time_this_iter_s": 29.10429573059082, "timesteps_since_restore": 3361524, "time_since_restore": 2007.7512567043304, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45478, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1c50>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1748>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-31-24", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 49.44786275013971}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1368.3110198825711, "node_ip": "10.138.0.2", "timesteps_total": 3403850, "iterations_since_restore": 75, "episode_reward_mean": 1111.8119232897798, "custom_metrics": {"cost1_min": 29.39507040808135, "cost1_max": 449.5629170655237, "cost1_mean": 363.87768891294564, "system_level_velocity_mean": 13.990633628128121, "cost2_max": -32.62107216051399, "outflow_rate_min": 327.9458014252228, "system_level_velocity_max": 20.34279882572973, "system_level_velocity_min": 10.320277680702704, "outflow_rate_max": 1254.9153942541568, "cost2_mean": -207.7915701353799, "outflow_rate_mean": 1117.659820191064, "cost2_min": -241.46632318210476}, "training_iteration": 75, "episodes_total": 1080, "episode_len_mean": 688.37, "timestamp": 1557207109, "time_total_s": 2033.394897222519, "pid": 31998, "info": {"num_steps_trained": 3403850, "load_time_ms": 14.828, "num_steps_sampled": 3403850, "grad_time_ms": 9579.398, "sample_time_ms": 16966.066, "update_time_ms": 7.191, "default": {"vf_explained_var": 0.9923473000526428, "vf_loss": 2.8398427963256836, "cur_kl_coeff": 0.06328123807907104, "cur_lr": 0.0005000000237487257, "total_loss": 2.834188222885132, "kl": 0.019516123458743095, "policy_loss": -0.006889739073812962, "entropy": 0.8986119031906128}}, "time_this_iter_s": 25.643640518188477, "timesteps_since_restore": 3403850, "time_since_restore": 2033.394897222519, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 42326, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd5f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4c88>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd7b8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-31-49", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 49.44786275013971}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1368.3110198825711, "node_ip": "10.138.0.2", "timesteps_total": 3445409, "iterations_since_restore": 76, "episode_reward_mean": 1083.5362864574167, "custom_metrics": {"cost1_min": 28.93189569176157, "cost1_max": 457.38926779455574, "cost1_mean": 359.70366788071425, "system_level_velocity_mean": 14.359232417001609, "cost2_max": -30.616381678505803, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 19.935336887414394, "system_level_velocity_min": 10.320277680702704, "outflow_rate_max": 1254.9153942541568, "cost2_mean": -202.70413684365553, "outflow_rate_mean": 1104.2429925000479, "cost2_min": -241.46632318210476}, "training_iteration": 76, "episodes_total": 1101, "episode_len_mean": 668.77, "timestamp": 1557207136, "time_total_s": 2060.18496632576, "pid": 31998, "info": {"num_steps_trained": 3445409, "load_time_ms": 14.415, "num_steps_sampled": 3445409, "grad_time_ms": 9451.243, "sample_time_ms": 17167.264, "update_time_ms": 7.165, "default": {"vf_explained_var": 0.9641578793525696, "vf_loss": 13.390894889831543, "cur_kl_coeff": 0.06328123807907104, "cur_lr": 0.0005000000237487257, "total_loss": 13.383332252502441, "kl": 0.0237629022449255, "policy_loss": -0.009066208265721798, "entropy": 0.9198095202445984}}, "time_this_iter_s": 26.790069103240967, "timesteps_since_restore": 3445409, "time_since_restore": 2060.18496632576, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 41559, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b43c8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b44e0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-32-16", "hostname": "flow-main", "episodes_this_iter": 21, "episode_reward_min": 48.91939928513624}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1321.9492817677108, "node_ip": "10.138.0.2", "timesteps_total": 3489309, "iterations_since_restore": 77, "episode_reward_mean": 1079.516714143804, "custom_metrics": {"cost1_min": 28.93189569176157, "cost1_max": 458.3993398707812, "cost1_mean": 361.0868685146768, "system_level_velocity_mean": 14.482803547150437, "cost2_max": -30.616381678505803, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.39513945482173, "system_level_velocity_min": 10.320277680702704, "outflow_rate_max": 1269.6687656168006, "cost2_mean": -201.31428505364812, "outflow_rate_mean": 1105.471981279584, "cost2_min": -241.46632318210476}, "training_iteration": 77, "episodes_total": 1117, "episode_len_mean": 667.26, "timestamp": 1557207163, "time_total_s": 2087.6387639045715, "pid": 31998, "info": {"num_steps_trained": 3489309, "load_time_ms": 14.268, "num_steps_sampled": 3489309, "grad_time_ms": 9429.446, "sample_time_ms": 17238.286, "update_time_ms": 7.302, "default": {"vf_explained_var": 0.9842893481254578, "vf_loss": 5.704690933227539, "cur_kl_coeff": 0.09492189437150955, "cur_lr": 0.0005000000237487257, "total_loss": 5.6975202560424805, "kl": 0.020036954432725906, "policy_loss": -0.00907230470329523, "entropy": 0.9289242029190063}}, "time_this_iter_s": 27.453797578811646, "timesteps_since_restore": 3489309, "time_since_restore": 2087.6387639045715, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43900, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdf98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdb38>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdba8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-32-43", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 48.91939928513624}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1290.182086123063, "node_ip": "10.138.0.2", "timesteps_total": 3535257, "iterations_since_restore": 78, "episode_reward_mean": 1067.393761305559, "custom_metrics": {"cost1_min": 28.93189569176157, "cost1_max": 458.3993398707812, "cost1_mean": 360.33931066508694, "system_level_velocity_mean": 14.618901854285467, "cost2_max": -30.616381678505803, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.39513945482173, "system_level_velocity_min": 11.801410550630058, "outflow_rate_max": 1269.6687656168006, "cost2_mean": -197.9707215644331, "outflow_rate_mean": 1101.2825378786192, "cost2_min": -240.33149588414142}, "training_iteration": 78, "episodes_total": 1132, "episode_len_mean": 661.65, "timestamp": 1557207191, "time_total_s": 2114.8016641139984, "pid": 31998, "info": {"num_steps_trained": 3535257, "load_time_ms": 14.313, "num_steps_sampled": 3535257, "grad_time_ms": 9498.552, "sample_time_ms": 17301.684, "update_time_ms": 7.72, "default": {"vf_explained_var": 0.9881900548934937, "vf_loss": 3.7673168182373047, "cur_kl_coeff": 0.14238283038139343, "cur_lr": 0.0005000000237487257, "total_loss": 3.7642099857330322, "kl": 0.01356318686157465, "policy_loss": -0.005038258153945208, "entropy": 0.9246596097946167}}, "time_this_iter_s": 27.16290020942688, "timesteps_since_restore": 3535257, "time_since_restore": 2114.8016641139984, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45948, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1ac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1748>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-33-11", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 48.91939928513624}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1290.182086123063, "node_ip": "10.138.0.2", "timesteps_total": 3580971, "iterations_since_restore": 79, "episode_reward_mean": 1065.0384971518465, "custom_metrics": {"cost1_min": 28.93189569176157, "cost1_max": 458.3993398707812, "cost1_mean": 361.7028646031046, "system_level_velocity_mean": 14.68108396156991, "cost2_max": -30.616381678505803, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.39513945482173, "system_level_velocity_min": 11.801410550630058, "outflow_rate_max": 1269.6687656168006, "cost2_mean": -197.07128638837028, "outflow_rate_mean": 1102.717069432416, "cost2_min": -237.628516502585}, "training_iteration": 79, "episodes_total": 1145, "episode_len_mean": 661.65, "timestamp": 1557207217, "time_total_s": 2141.0838479995728, "pid": 31998, "info": {"num_steps_trained": 3580971, "load_time_ms": 14.256, "num_steps_sampled": 3580971, "grad_time_ms": 9533.379, "sample_time_ms": 17295.78, "update_time_ms": 7.755, "default": {"vf_explained_var": 0.9922517538070679, "vf_loss": 2.357483386993408, "cur_kl_coeff": 0.14238281548023224, "cur_lr": 0.0005000000237487257, "total_loss": 2.354243040084839, "kl": 0.013927220366895199, "policy_loss": -0.005223194137215614, "entropy": 0.8811662793159485}}, "time_this_iter_s": 26.28218388557434, "timesteps_since_restore": 3580971, "time_since_restore": 2141.0838479995728, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45714, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd0f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd9e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdb70>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-33-37", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 48.91939928513624}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1290.182086123063, "node_ip": "10.138.0.2", "timesteps_total": 3626220, "iterations_since_restore": 80, "episode_reward_mean": 1060.3132452310792, "custom_metrics": {"cost1_min": 28.93189569176157, "cost1_max": 458.3993398707812, "cost1_mean": 360.1832696001747, "system_level_velocity_mean": 14.76453012422419, "cost2_max": -30.616381678505803, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.39513945482173, "system_level_velocity_min": 11.801410550630058, "outflow_rate_max": 1269.6687656168006, "cost2_mean": -196.13715191251902, "outflow_rate_mean": 1097.0729739379206, "cost2_min": -237.628516502585}, "training_iteration": 80, "episodes_total": 1159, "episode_len_mean": 656.64, "timestamp": 1557207244, "time_total_s": 2167.775712966919, "pid": 31998, "info": {"num_steps_trained": 3626220, "load_time_ms": 13.951, "num_steps_sampled": 3626220, "grad_time_ms": 9546.306, "sample_time_ms": 17249.283, "update_time_ms": 7.876, "default": {"vf_explained_var": 0.9890909790992737, "vf_loss": 3.831859827041626, "cur_kl_coeff": 0.14238283038139343, "cur_lr": 0.0005000000237487257, "total_loss": 3.828932762145996, "kl": 0.015292869880795479, "policy_loss": -0.005104321055114269, "entropy": 0.8856857419013977}}, "time_this_iter_s": 26.69186496734619, "timesteps_since_restore": 3626220, "time_since_restore": 2167.775712966919, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45249, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a78d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7fd0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-34-04", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 48.91939928513624}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1331.221405438773, "node_ip": "10.138.0.2", "timesteps_total": 3670903, "iterations_since_restore": 81, "episode_reward_mean": 1061.8728925776395, "custom_metrics": {"cost1_min": 28.93189569176157, "cost1_max": 458.3993398707812, "cost1_mean": 359.187492294495, "system_level_velocity_mean": 14.72308761649938, "cost2_max": -30.616381678505803, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.39513945482173, "system_level_velocity_min": 11.330884015549197, "outflow_rate_max": 1269.6687656168006, "cost2_mean": -196.5456820896503, "outflow_rate_mean": 1096.0742139806814, "cost2_min": -237.628516502585}, "training_iteration": 81, "episodes_total": 1174, "episode_len_mean": 656.64, "timestamp": 1557207270, "time_total_s": 2193.581763267517, "pid": 31998, "info": {"num_steps_trained": 3670903, "load_time_ms": 13.855, "num_steps_sampled": 3670903, "grad_time_ms": 9619.83, "sample_time_ms": 17198.77, "update_time_ms": 7.905, "default": {"vf_explained_var": 0.9888642430305481, "vf_loss": 3.3436241149902344, "cur_kl_coeff": 0.14238281548023224, "cur_lr": 0.0005000000237487257, "total_loss": 3.3402082920074463, "kl": 0.0135020911693573, "policy_loss": -0.0053385356441140175, "entropy": 0.8472391366958618}}, "time_this_iter_s": 25.806050300598145, "timesteps_since_restore": 3670903, "time_since_restore": 2193.581763267517, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44683, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd4a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd908>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd278>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-34-30", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 48.91939928513624}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1331.221405438773, "node_ip": "10.138.0.2", "timesteps_total": 3714644, "iterations_since_restore": 82, "episode_reward_mean": 1082.5457216609186, "custom_metrics": {"cost1_min": 28.524109057066052, "cost1_max": 458.3993398707812, "cost1_mean": 363.8315175147327, "system_level_velocity_mean": 14.5519359426143, "cost2_max": -29.834604264963776, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.39513945482173, "system_level_velocity_min": 11.330884015549197, "outflow_rate_max": 1269.6687656168006, "cost2_mean": -200.86906956561995, "outflow_rate_mean": 1110.8334259000094, "cost2_min": -236.9962229314313}, "training_iteration": 82, "episodes_total": 1192, "episode_len_mean": 669.67, "timestamp": 1557207297, "time_total_s": 2221.0164515972137, "pid": 31998, "info": {"num_steps_trained": 3714644, "load_time_ms": 13.416, "num_steps_sampled": 3714644, "grad_time_ms": 9758.696, "sample_time_ms": 17045.989, "update_time_ms": 8.09, "default": {"vf_explained_var": 0.987366259098053, "vf_loss": 4.20446252822876, "cur_kl_coeff": 0.14238283038139343, "cur_lr": 0.0005000000237487257, "total_loss": 4.202080249786377, "kl": 0.012873448431491852, "policy_loss": -0.004215288907289505, "entropy": 0.8870620727539062}}, "time_this_iter_s": 27.434688329696655, "timesteps_since_restore": 3714644, "time_since_restore": 2221.0164515972137, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43741, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d14e0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1cc0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-34-57", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 48.29429150808055}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1331.221405438773, "node_ip": "10.138.0.2", "timesteps_total": 3759098, "iterations_since_restore": 83, "episode_reward_mean": 1091.270116652563, "custom_metrics": {"cost1_min": 28.524109057066052, "cost1_max": 456.58856448286474, "cost1_mean": 363.7220200561138, "system_level_velocity_mean": 14.350610205358253, "cost2_max": -29.834604264963776, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.39513945482173, "system_level_velocity_min": 11.330884015549197, "outflow_rate_max": 1269.6687656168006, "cost2_mean": -203.76737817174725, "outflow_rate_mean": 1113.8880516369438, "cost2_min": -236.9962229314313}, "training_iteration": 83, "episodes_total": 1206, "episode_len_mean": 676.24, "timestamp": 1557207325, "time_total_s": 2248.7214725017548, "pid": 31998, "info": {"num_steps_trained": 3759098, "load_time_ms": 13.458, "num_steps_sampled": 3759098, "grad_time_ms": 9809.095, "sample_time_ms": 17083.724, "update_time_ms": 7.939, "default": {"vf_explained_var": 0.992746114730835, "vf_loss": 2.186173439025879, "cur_kl_coeff": 0.14238283038139343, "cur_lr": 0.0005000000237487257, "total_loss": 2.1829285621643066, "kl": 0.014101742766797543, "policy_loss": -0.005252547562122345, "entropy": 0.881840705871582}}, "time_this_iter_s": 27.705020904541016, "timesteps_since_restore": 3759098, "time_since_restore": 2248.7214725017548, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44454, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b95f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa080>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-35-25", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 48.29429150808055}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1331.221405438773, "node_ip": "10.138.0.2", "timesteps_total": 3806267, "iterations_since_restore": 84, "episode_reward_mean": 1105.4161900600657, "custom_metrics": {"cost1_min": 28.524109057066052, "cost1_max": 456.58856448286474, "cost1_mean": 366.6510755744583, "system_level_velocity_mean": 14.252161975803876, "cost2_max": -29.834604264963776, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 19.190843834235146, "system_level_velocity_min": 11.330884015549197, "outflow_rate_max": 1264.2631206751792, "cost2_mean": -206.45194865908536, "outflow_rate_mean": 1122.590058548605, "cost2_min": -236.9962229314313}, "training_iteration": 84, "episodes_total": 1218, "episode_len_mean": 682.81, "timestamp": 1557207353, "time_total_s": 2276.9938745498657, "pid": 31998, "info": {"num_steps_trained": 3806267, "load_time_ms": 14.026, "num_steps_sampled": 3806267, "grad_time_ms": 9791.401, "sample_time_ms": 17015.771, "update_time_ms": 8.031, "default": {"vf_explained_var": 0.9923574924468994, "vf_loss": 2.013747453689575, "cur_kl_coeff": 0.14238283038139343, "cur_lr": 0.0005000000237487257, "total_loss": 2.0095059871673584, "kl": 0.014758921228349209, "policy_loss": -0.006343227811157703, "entropy": 0.8637465834617615}}, "time_this_iter_s": 28.272402048110962, "timesteps_since_restore": 3806267, "time_since_restore": 2276.9938745498657, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 47169, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d16d8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-35-53", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 48.29429150808055}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1331.221405438773, "node_ip": "10.138.0.2", "timesteps_total": 3850946, "iterations_since_restore": 85, "episode_reward_mean": 1117.3340534091897, "custom_metrics": {"cost1_min": 28.524109057066052, "cost1_max": 456.58856448286474, "cost1_mean": 368.94284526377623, "system_level_velocity_mean": 14.161944746137001, "cost2_max": -29.834604264963776, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 19.190843834235146, "system_level_velocity_min": 11.330884015549197, "outflow_rate_max": 1264.2631206751792, "cost2_mean": -209.51463968872133, "outflow_rate_mean": 1132.6255245480977, "cost2_min": -236.9962229314313}, "training_iteration": 85, "episodes_total": 1234, "episode_len_mean": 688.42, "timestamp": 1557207379, "time_total_s": 2303.1661727428436, "pid": 31998, "info": {"num_steps_trained": 3850946, "load_time_ms": 13.892, "num_steps_sampled": 3850946, "grad_time_ms": 9900.603, "sample_time_ms": 16960.566, "update_time_ms": 8.01, "default": {"vf_explained_var": 0.9930601716041565, "vf_loss": 2.6152188777923584, "cur_kl_coeff": 0.14238281548023224, "cur_lr": 0.0005000000237487257, "total_loss": 2.6113462448120117, "kl": 0.013741882517933846, "policy_loss": -0.00582899060100317, "entropy": 0.8835809230804443}}, "time_this_iter_s": 26.172298192977905, "timesteps_since_restore": 3850946, "time_since_restore": 2303.1661727428436, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44679, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d19b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1c88>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1cf8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-36-19", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 48.29429150808055}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1331.221405438773, "node_ip": "10.138.0.2", "timesteps_total": 3895011, "iterations_since_restore": 86, "episode_reward_mean": 1122.4006818160287, "custom_metrics": {"cost1_min": 28.524109057066052, "cost1_max": 427.89251629808837, "cost1_mean": 369.3202441401621, "system_level_velocity_mean": 14.17510967556027, "cost2_max": -29.834604264963776, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 19.190843834235146, "system_level_velocity_min": 11.330884015549197, "outflow_rate_max": 1264.2631206751792, "cost2_mean": -210.46287354780182, "outflow_rate_mean": 1131.731699135968, "cost2_min": -240.57943223367016}, "training_iteration": 86, "episodes_total": 1250, "episode_len_mean": 688.42, "timestamp": 1557207406, "time_total_s": 2330.0418281555176, "pid": 31998, "info": {"num_steps_trained": 3895011, "load_time_ms": 14.358, "num_steps_sampled": 3895011, "grad_time_ms": 10003.747, "sample_time_ms": 16864.731, "update_time_ms": 8.229, "default": {"vf_explained_var": 0.9929715394973755, "vf_loss": 2.306347370147705, "cur_kl_coeff": 0.14238281548023224, "cur_lr": 0.0005000000237487257, "total_loss": 2.3013672828674316, "kl": 0.015484540723264217, "policy_loss": -0.007184785325080156, "entropy": 0.8984731435775757}}, "time_this_iter_s": 26.87565541267395, "timesteps_since_restore": 3895011, "time_since_restore": 2330.0418281555176, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44065, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d15c0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-36-46", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 48.29429150808055}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1331.221405438773, "node_ip": "10.138.0.2", "timesteps_total": 3939729, "iterations_since_restore": 87, "episode_reward_mean": 1123.9030658809224, "custom_metrics": {"cost1_min": 28.524109057066052, "cost1_max": 419.85771548847083, "cost1_mean": 369.376081873868, "system_level_velocity_mean": 14.201747387783138, "cost2_max": -29.834604264963776, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 19.285494622398883, "system_level_velocity_min": 11.415603680152874, "outflow_rate_max": 1264.2631206751792, "cost2_mean": -211.22884241912726, "outflow_rate_mean": 1132.888779080241, "cost2_min": -240.57943223367016}, "training_iteration": 87, "episodes_total": 1264, "episode_len_mean": 687.71, "timestamp": 1557207433, "time_total_s": 2356.432290315628, "pid": 31998, "info": {"num_steps_trained": 3939729, "load_time_ms": 14.562, "num_steps_sampled": 3939729, "grad_time_ms": 10037.904, "sample_time_ms": 16726.662, "update_time_ms": 8.19, "default": {"vf_explained_var": 0.9833467602729797, "vf_loss": 5.207597732543945, "cur_kl_coeff": 0.14238281548023224, "cur_lr": 0.0005000000237487257, "total_loss": 5.205593109130859, "kl": 0.015648948028683662, "policy_loss": -0.004233209881931543, "entropy": 0.8884151577949524}}, "time_this_iter_s": 26.390462160110474, "timesteps_since_restore": 3939729, "time_since_restore": 2356.432290315628, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44718, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdb38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd4a8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd128>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-37-13", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 48.29429150808055}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1302.042792780631, "node_ip": "10.138.0.2", "timesteps_total": 3984932, "iterations_since_restore": 88, "episode_reward_mean": 1118.7358548351858, "custom_metrics": {"cost1_min": 28.524109057066052, "cost1_max": 419.85771548847083, "cost1_mean": 368.09370951788105, "system_level_velocity_mean": 14.14972275614938, "cost2_max": -29.834604264963776, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 19.285494622398883, "system_level_velocity_min": 11.42450091607609, "outflow_rate_max": 1249.5857092572903, "cost2_mean": -211.78106258890745, "outflow_rate_mean": 1127.949653072554, "cost2_min": -246.83007089281364}, "training_iteration": 88, "episodes_total": 1279, "episode_len_mean": 687.71, "timestamp": 1557207460, "time_total_s": 2384.2072813510895, "pid": 31998, "info": {"num_steps_trained": 3984932, "load_time_ms": 14.787, "num_steps_sampled": 3984932, "grad_time_ms": 10017.872, "sample_time_ms": 16806.361, "update_time_ms": 7.915, "default": {"vf_explained_var": 0.9901189804077148, "vf_loss": 3.174809455871582, "cur_kl_coeff": 0.14238283038139343, "cur_lr": 0.0005000000237487257, "total_loss": 3.1700117588043213, "kl": 0.01624811813235283, "policy_loss": -0.007111192215234041, "entropy": 0.9137970805168152}}, "time_this_iter_s": 27.774991035461426, "timesteps_since_restore": 3984932, "time_since_restore": 2384.2072813510895, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45203, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d16d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1dd8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a78d0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-37-40", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 48.29429150808055}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1302.042792780631, "node_ip": "10.138.0.2", "timesteps_total": 4029400, "iterations_since_restore": 89, "episode_reward_mean": 1123.9080184818445, "custom_metrics": {"cost1_min": 89.41464340012124, "cost1_max": 419.85771548847083, "cost1_mean": 372.4390192082472, "system_level_velocity_mean": 14.130226325863848, "cost2_max": -55.69954457304708, "outflow_rate_min": 451.40321386938103, "system_level_velocity_max": 19.285494622398883, "system_level_velocity_min": 11.42450091607609, "outflow_rate_max": 1249.5857092572903, "cost2_mean": -213.02003601568683, "outflow_rate_mean": 1135.2339542421428, "cost2_min": -246.83007089281364}, "training_iteration": 89, "episodes_total": 1293, "episode_len_mean": 694.28, "timestamp": 1557207486, "time_total_s": 2410.26970243454, "pid": 31998, "info": {"num_steps_trained": 4029400, "load_time_ms": 14.996, "num_steps_sampled": 4029400, "grad_time_ms": 9987.884, "sample_time_ms": 16813.007, "update_time_ms": 8.185, "default": {"vf_explained_var": 0.9870982766151428, "vf_loss": 3.79716420173645, "cur_kl_coeff": 0.14238283038139343, "cur_lr": 0.0005000000237487257, "total_loss": 3.7936272621154785, "kl": 0.013358998112380505, "policy_loss": -0.005438762251287699, "entropy": 0.9064223170280457}}, "time_this_iter_s": 26.062421083450317, "timesteps_since_restore": 4029400, "time_since_restore": 2410.26970243454, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44468, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b90f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1b00>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1c88>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-38-06", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 206.11626632931103}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1302.042792780631, "node_ip": "10.138.0.2", "timesteps_total": 4074467, "iterations_since_restore": 90, "episode_reward_mean": 1121.7592007182188, "custom_metrics": {"cost1_min": 89.41464340012124, "cost1_max": 419.85771548847083, "cost1_mean": 372.0248274130793, "system_level_velocity_mean": 14.168221685319985, "cost2_max": -55.69954457304708, "outflow_rate_min": 451.40321386938103, "system_level_velocity_max": 19.285494622398883, "system_level_velocity_min": 11.390394039686738, "outflow_rate_max": 1249.5857092572903, "cost2_mean": -211.8105188103509, "outflow_rate_mean": 1130.347755191535, "cost2_min": -246.83007089281364}, "training_iteration": 90, "episodes_total": 1307, "episode_len_mean": 691.83, "timestamp": 1557207513, "time_total_s": 2436.5061190128326, "pid": 31998, "info": {"num_steps_trained": 4074467, "load_time_ms": 15.222, "num_steps_sampled": 4074467, "grad_time_ms": 9987.119, "sample_time_ms": 16767.391, "update_time_ms": 8.311, "default": {"vf_explained_var": 0.9902696013450623, "vf_loss": 3.0810844898223877, "cur_kl_coeff": 0.14238283038139343, "cur_lr": 0.0005000000237487257, "total_loss": 3.0775835514068604, "kl": 0.01428257767111063, "policy_loss": -0.005534232594072819, "entropy": 0.8967907428741455}}, "time_this_iter_s": 26.236416578292847, "timesteps_since_restore": 4074467, "time_since_restore": 2436.5061190128326, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45067, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d10b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d14e0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-38-33", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 206.11626632931103}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1302.042792780631, "node_ip": "10.138.0.2", "timesteps_total": 4118423, "iterations_since_restore": 91, "episode_reward_mean": 1118.261601312779, "custom_metrics": {"cost1_min": 89.41464340012124, "cost1_max": 419.85771548847083, "cost1_mean": 372.4000802280308, "system_level_velocity_mean": 14.186701519784394, "cost2_max": -55.69954457304708, "outflow_rate_min": 451.40321386938103, "system_level_velocity_max": 19.285494622398883, "system_level_velocity_min": 11.390394039686738, "outflow_rate_max": 1306.3218790634862, "cost2_mean": -210.29032889171245, "outflow_rate_mean": 1129.0848970286725, "cost2_min": -246.83007089281364}, "training_iteration": 91, "episodes_total": 1321, "episode_len_mean": 691.83, "timestamp": 1557207539, "time_total_s": 2462.5130999088287, "pid": 31998, "info": {"num_steps_trained": 4118423, "load_time_ms": 15.472, "num_steps_sampled": 4118423, "grad_time_ms": 9992.206, "sample_time_ms": 16783.192, "update_time_ms": 8.375, "default": {"vf_explained_var": 0.9904582500457764, "vf_loss": 3.266852855682373, "cur_kl_coeff": 0.14238281548023224, "cur_lr": 0.0005000000237487257, "total_loss": 3.263554096221924, "kl": 0.013727704994380474, "policy_loss": -0.0052535030990839005, "entropy": 0.8811997771263123}}, "time_this_iter_s": 26.006980895996094, "timesteps_since_restore": 4118423, "time_since_restore": 2462.5130999088287, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43956, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd940>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e518>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-38-59", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 206.11626632931103}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1302.1022181037574, "node_ip": "10.138.0.2", "timesteps_total": 4163565, "iterations_since_restore": 92, "episode_reward_mean": 1123.5931711743578, "custom_metrics": {"cost1_min": 89.41464340012124, "cost1_max": 419.51385693705765, "cost1_mean": 371.79762122230466, "system_level_velocity_mean": 14.158419260318759, "cost2_max": -55.69954457304708, "outflow_rate_min": 451.40321386938103, "system_level_velocity_max": 19.285494622398883, "system_level_velocity_min": 11.390394039686738, "outflow_rate_max": 1306.3218790634862, "cost2_mean": -209.19889075894008, "outflow_rate_mean": 1128.5526968167753, "cost2_min": -246.83007089281364}, "training_iteration": 92, "episodes_total": 1337, "episode_len_mean": 691.83, "timestamp": 1557207565, "time_total_s": 2488.497409105301, "pid": 31998, "info": {"num_steps_trained": 4163565, "load_time_ms": 15.438, "num_steps_sampled": 4163565, "grad_time_ms": 9934.017, "sample_time_ms": 16696.382, "update_time_ms": 8.25, "default": {"vf_explained_var": 0.9902231097221375, "vf_loss": 3.116473436355591, "cur_kl_coeff": 0.14238283038139343, "cur_lr": 0.0005000000237487257, "total_loss": 3.1125123500823975, "kl": 0.015495285391807556, "policy_loss": -0.006167455110698938, "entropy": 0.882202684879303}}, "time_this_iter_s": 25.984309196472168, "timesteps_since_restore": 4163565, "time_since_restore": 2488.497409105301, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45142, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd8d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdda0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-39-25", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 206.11626632931103}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1302.1022181037574, "node_ip": "10.138.0.2", "timesteps_total": 4206735, "iterations_since_restore": 93, "episode_reward_mean": 1110.601995617256, "custom_metrics": {"cost1_min": 89.41464340012124, "cost1_max": 421.67352672600344, "cost1_mean": 371.8750563062165, "system_level_velocity_mean": 14.166642390159744, "cost2_max": -55.69954457304708, "outflow_rate_min": 451.40321386938103, "system_level_velocity_max": 19.285494622398883, "system_level_velocity_min": 11.390394039686738, "outflow_rate_max": 1306.3218790634862, "cost2_mean": -206.75409795506, "outflow_rate_mean": 1125.9036448997074, "cost2_min": -246.83007089281364}, "training_iteration": 93, "episodes_total": 1354, "episode_len_mean": 691.83, "timestamp": 1557207592, "time_total_s": 2515.960237264633, "pid": 31998, "info": {"num_steps_trained": 4206735, "load_time_ms": 15.299, "num_steps_sampled": 4206735, "grad_time_ms": 9927.815, "sample_time_ms": 16679.253, "update_time_ms": 8.415, "default": {"vf_explained_var": 0.9935166239738464, "vf_loss": 2.4132297039031982, "cur_kl_coeff": 0.14238283038139343, "cur_lr": 0.0005000000237487257, "total_loss": 2.4095306396484375, "kl": 0.01498402375727892, "policy_loss": -0.005832481663674116, "entropy": 0.8837593793869019}}, "time_this_iter_s": 27.462828159332275, "timesteps_since_restore": 4206735, "time_since_restore": 2515.960237264633, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43170, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfc50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfcc0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf4e0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-39-52", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 206.11626632931103}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1302.1022181037574, "node_ip": "10.138.0.2", "timesteps_total": 4253912, "iterations_since_restore": 94, "episode_reward_mean": 1113.1177294436666, "custom_metrics": {"cost1_min": 140.42350504370472, "cost1_max": 421.67352672600344, "cost1_mean": 371.5455682446598, "system_level_velocity_mean": 14.110848457517365, "cost2_max": -78.85796634288693, "outflow_rate_min": 549.3567857971999, "system_level_velocity_max": 18.479973508686836, "system_level_velocity_min": 11.390394039686738, "outflow_rate_max": 1306.3218790634862, "cost2_mean": -207.15598653055406, "outflow_rate_mean": 1127.9904249410815, "cost2_min": -246.83007089281364}, "training_iteration": 94, "episodes_total": 1368, "episode_len_mean": 692.58, "timestamp": 1557207622, "time_total_s": 2545.7019867897034, "pid": 31998, "info": {"num_steps_trained": 4253912, "load_time_ms": 15.192, "num_steps_sampled": 4253912, "grad_time_ms": 10071.354, "sample_time_ms": 16683.923, "update_time_ms": 8.227, "default": {"vf_explained_var": 0.9859496355056763, "vf_loss": 4.252518177032471, "cur_kl_coeff": 0.14238283038139343, "cur_lr": 0.0005000000237487257, "total_loss": 4.250319957733154, "kl": 0.014960000291466713, "policy_loss": -0.004327845294028521, "entropy": 0.8931659460067749}}, "time_this_iter_s": 29.74174952507019, "timesteps_since_restore": 4253912, "time_since_restore": 2545.7019867897034, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 47177, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1d30>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1320>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-40-22", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 328.2484964331226}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1341.0360821140443, "node_ip": "10.138.0.2", "timesteps_total": 4299379, "iterations_since_restore": 95, "episode_reward_mean": 1121.1316894088916, "custom_metrics": {"cost1_min": 140.42350504370472, "cost1_max": 421.67352672600344, "cost1_mean": 371.63711340798733, "system_level_velocity_mean": 14.115421456332044, "cost2_max": -78.85796634288693, "outflow_rate_min": 549.3567857971999, "system_level_velocity_max": 18.479973508686836, "system_level_velocity_min": 11.390394039686738, "outflow_rate_max": 1306.3218790634862, "cost2_mean": -206.19302484119717, "outflow_rate_mean": 1125.9659091773203, "cost2_min": -241.0654396160491}, "training_iteration": 95, "episodes_total": 1379, "episode_len_mean": 692.58, "timestamp": 1557207650, "time_total_s": 2573.230094909668, "pid": 31998, "info": {"num_steps_trained": 4299379, "load_time_ms": 15.309, "num_steps_sampled": 4299379, "grad_time_ms": 10085.304, "sample_time_ms": 16805.327, "update_time_ms": 8.41, "default": {"vf_explained_var": 0.9938858151435852, "vf_loss": 1.9590421915054321, "cur_kl_coeff": 0.14238283038139343, "cur_lr": 0.0005000000237487257, "total_loss": 1.955339789390564, "kl": 0.014768308959901333, "policy_loss": -0.005805046297609806, "entropy": 0.858691394329071}}, "time_this_iter_s": 27.5281081199646, "timesteps_since_restore": 4299379, "time_since_restore": 2573.230094909668, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45467, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf4a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf9b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bff98>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-40-50", "hostname": "flow-main", "episodes_this_iter": 11, "episode_reward_min": 328.2484964331226}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1341.0360821140443, "node_ip": "10.138.0.2", "timesteps_total": 4344675, "iterations_since_restore": 96, "episode_reward_mean": 1120.1811496916832, "custom_metrics": {"cost1_min": 140.42350504370472, "cost1_max": 421.67352672600344, "cost1_mean": 370.01190144420815, "system_level_velocity_mean": 14.122910839486778, "cost2_max": -78.85796634288693, "outflow_rate_min": 549.3567857971999, "system_level_velocity_max": 18.722489822305626, "system_level_velocity_min": 11.390394039686738, "outflow_rate_max": 1306.3218790634862, "cost2_mean": -205.18714523433562, "outflow_rate_mean": 1123.414800424802, "cost2_min": -236.7911344536139}, "training_iteration": 96, "episodes_total": 1397, "episode_len_mean": 690.11, "timestamp": 1557207676, "time_total_s": 2599.908750295639, "pid": 31998, "info": {"num_steps_trained": 4344675, "load_time_ms": 15.13, "num_steps_sampled": 4344675, "grad_time_ms": 10081.975, "sample_time_ms": 16786.722, "update_time_ms": 8.218, "default": {"vf_explained_var": 0.9886959791183472, "vf_loss": 3.9579079151153564, "cur_kl_coeff": 0.14238283038139343, "cur_lr": 0.0005000000237487257, "total_loss": 3.953951597213745, "kl": 0.014475204981863499, "policy_loss": -0.00601742509752512, "entropy": 0.877606987953186}}, "time_this_iter_s": 26.67865538597107, "timesteps_since_restore": 4344675, "time_since_restore": 2599.908750295639, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45296, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdf60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdf98>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd128>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-41-16", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 328.2484964331226}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1341.0360821140443, "node_ip": "10.138.0.2", "timesteps_total": 4388247, "iterations_since_restore": 97, "episode_reward_mean": 1103.5399702354014, "custom_metrics": {"cost1_min": 34.26404833731614, "cost1_max": 421.67352672600344, "cost1_mean": 364.66806613252527, "system_level_velocity_mean": 14.175706709829845, "cost2_max": -32.741089629684105, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.200880015837818, "system_level_velocity_min": 11.44560986261014, "outflow_rate_max": 1306.3218790634862, "cost2_mean": -201.75936977914245, "outflow_rate_mean": 1108.209613158374, "cost2_min": -235.0945648877191}, "training_iteration": 97, "episodes_total": 1412, "episode_len_mean": 680.38, "timestamp": 1557207703, "time_total_s": 2626.7085494995117, "pid": 31998, "info": {"num_steps_trained": 4388247, "load_time_ms": 14.928, "num_steps_sampled": 4388247, "grad_time_ms": 10136.645, "sample_time_ms": 16773.553, "update_time_ms": 8.318, "default": {"vf_explained_var": 0.9843838214874268, "vf_loss": 5.767001628875732, "cur_kl_coeff": 0.14238283038139343, "cur_lr": 0.0005000000237487257, "total_loss": 5.762112140655518, "kl": 0.0188826285302639, "policy_loss": -0.007578209508210421, "entropy": 0.8942391872406006}}, "time_this_iter_s": 26.79979920387268, "timesteps_since_restore": 4388247, "time_since_restore": 2626.7085494995117, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43572, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4d68>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4b00>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-41-43", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 59.06089193823891}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1341.0360821140443, "node_ip": "10.138.0.2", "timesteps_total": 4432853, "iterations_since_restore": 98, "episode_reward_mean": 1107.9014823680657, "custom_metrics": {"cost1_min": 34.26404833731614, "cost1_max": 433.6927838064164, "cost1_mean": 366.44348998451983, "system_level_velocity_mean": 14.238615179761643, "cost2_max": -32.741089629684105, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.200880015837818, "system_level_velocity_min": 11.44560986261014, "outflow_rate_max": 1258.030109330438, "cost2_mean": -202.05383305146847, "outflow_rate_mean": 1111.7870596593978, "cost2_min": -235.0945648877191}, "training_iteration": 98, "episodes_total": 1427, "episode_len_mean": 680.38, "timestamp": 1557207730, "time_total_s": 2653.3508999347687, "pid": 31998, "info": {"num_steps_trained": 4432853, "load_time_ms": 14.808, "num_steps_sampled": 4432853, "grad_time_ms": 10093.276, "sample_time_ms": 16704.758, "update_time_ms": 8.35, "default": {"vf_explained_var": 0.9912161827087402, "vf_loss": 3.1038804054260254, "cur_kl_coeff": 0.14238283038139343, "cur_lr": 0.0005000000237487257, "total_loss": 3.0996289253234863, "kl": 0.014869569800794125, "policy_loss": -0.006368298549205065, "entropy": 0.914319634437561}}, "time_this_iter_s": 26.642350435256958, "timesteps_since_restore": 4432853, "time_since_restore": 2653.3508999347687, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44606, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfe48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfb70>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfeb8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-42-10", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 59.06089193823891}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1341.0360821140443, "node_ip": "10.138.0.2", "timesteps_total": 4477180, "iterations_since_restore": 99, "episode_reward_mean": 1079.426171547337, "custom_metrics": {"cost1_min": 32.425541742714216, "cost1_max": 433.6927838064164, "cost1_mean": 358.4660200897628, "system_level_velocity_mean": 14.222540929089115, "cost2_max": -32.63837954822436, "outflow_rate_min": 323.3057015323488, "system_level_velocity_max": 19.779991949819074, "system_level_velocity_min": 8.961869096092807, "outflow_rate_max": 1247.1767823416812, "cost2_mean": -199.04135869790872, "outflow_rate_mean": 1092.3156478421602, "cost2_min": -235.0945648877191}, "training_iteration": 99, "episodes_total": 1444, "episode_len_mean": 670.25, "timestamp": 1557207757, "time_total_s": 2680.253480195999, "pid": 31998, "info": {"num_steps_trained": 4477180, "load_time_ms": 14.277, "num_steps_sampled": 4477180, "grad_time_ms": 10123.09, "sample_time_ms": 16760.472, "update_time_ms": 8.293, "default": {"vf_explained_var": 0.9846792221069336, "vf_loss": 5.257380485534668, "cur_kl_coeff": 0.14238283038139343, "cur_lr": 0.0005000000237487257, "total_loss": 5.251290321350098, "kl": 0.01695777103304863, "policy_loss": -0.008504522033035755, "entropy": 0.8967629075050354}}, "time_this_iter_s": 26.90258026123047, "timesteps_since_restore": 4477180, "time_since_restore": 2680.253480195999, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44327, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1dd8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1be0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-42-37", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 59.06089193823891}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1341.0360821140443, "node_ip": "10.138.0.2", "timesteps_total": 4520604, "iterations_since_restore": 100, "episode_reward_mean": 1065.6460829976966, "custom_metrics": {"cost1_min": 31.697268868855225, "cost1_max": 433.6927838064164, "cost1_mean": 352.45151001248104, "system_level_velocity_mean": 14.350602381290068, "cost2_max": -32.371817481497224, "outflow_rate_min": 323.3057015323488, "system_level_velocity_max": 19.98350267095611, "system_level_velocity_min": 8.961869096092807, "outflow_rate_max": 1247.1767823416812, "cost2_mean": -195.57906654418701, "outflow_rate_mean": 1079.7619294930223, "cost2_min": -235.0945648877191}, "training_iteration": 100, "episodes_total": 1461, "episode_len_mean": 656.26, "timestamp": 1557207782, "time_total_s": 2705.224873304367, "pid": 31998, "info": {"num_steps_trained": 4520604, "load_time_ms": 14.151, "num_steps_sampled": 4520604, "grad_time_ms": 10079.278, "sample_time_ms": 16677.026, "update_time_ms": 8.071, "default": {"vf_explained_var": 0.9699233770370483, "vf_loss": 9.645127296447754, "cur_kl_coeff": 0.14238281548023224, "cur_lr": 0.0005000000237487257, "total_loss": 9.640768051147461, "kl": 0.01850966550409794, "policy_loss": -0.006994692143052816, "entropy": 0.8954683542251587}}, "time_this_iter_s": 24.97139310836792, "timesteps_since_restore": 4520604, "time_since_restore": 2705.224873304367, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43424, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9550>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9eb8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-43-02", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 51.644237702096206}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1304.7148072916707, "node_ip": "10.138.0.2", "timesteps_total": 4563668, "iterations_since_restore": 101, "episode_reward_mean": 1037.7116195612568, "custom_metrics": {"cost1_min": 29.331038805200865, "cost1_max": 433.6927838064164, "cost1_mean": 347.68965533581087, "system_level_velocity_mean": 14.529116994101082, "cost2_max": -28.1986440618941, "outflow_rate_min": 323.3057015323488, "system_level_velocity_max": 19.98350267095611, "system_level_velocity_min": 8.961869096092807, "outflow_rate_max": 1247.1767823416812, "cost2_mean": -190.8264629797817, "outflow_rate_mean": 1068.253237247692, "cost2_min": -233.37683942130084}, "training_iteration": 101, "episodes_total": 1480, "episode_len_mean": 643.81, "timestamp": 1557207809, "time_total_s": 2732.026793241501, "pid": 31998, "info": {"num_steps_trained": 4563668, "load_time_ms": 13.909, "num_steps_sampled": 4563668, "grad_time_ms": 10048.556, "sample_time_ms": 16787.454, "update_time_ms": 8.187, "default": {"vf_explained_var": 0.980566143989563, "vf_loss": 6.392622947692871, "cur_kl_coeff": 0.14238283038139343, "cur_lr": 0.0005000000237487257, "total_loss": 6.389178276062012, "kl": 0.015346664935350418, "policy_loss": -0.005629361607134342, "entropy": 0.8949151039123535}}, "time_this_iter_s": 26.80191993713379, "timesteps_since_restore": 4563668, "time_since_restore": 2732.026793241501, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43064, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c14e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1d68>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1f98>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-43-29", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 51.644237702096206}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1304.7148072916707, "node_ip": "10.138.0.2", "timesteps_total": 4608706, "iterations_since_restore": 102, "episode_reward_mean": 1044.1223952690023, "custom_metrics": {"cost1_min": 29.331038805200865, "cost1_max": 433.6927838064164, "cost1_mean": 348.5959658559997, "system_level_velocity_mean": 14.438233298114213, "cost2_max": -28.1986440618941, "outflow_rate_min": 323.3057015323488, "system_level_velocity_max": 19.98350267095611, "system_level_velocity_min": 8.961869096092807, "outflow_rate_max": 1247.1767823416812, "cost2_mean": -191.6078561001557, "outflow_rate_mean": 1072.1012395547054, "cost2_min": -233.37683942130084}, "training_iteration": 102, "episodes_total": 1492, "episode_len_mean": 648.73, "timestamp": 1557207835, "time_total_s": 2758.4919521808624, "pid": 31998, "info": {"num_steps_trained": 4608706, "load_time_ms": 14.333, "num_steps_sampled": 4608706, "grad_time_ms": 10065.186, "sample_time_ms": 16817.594, "update_time_ms": 8.22, "default": {"vf_explained_var": 0.9941377639770508, "vf_loss": 1.8403593301773071, "cur_kl_coeff": 0.14238283038139343, "cur_lr": 0.0005000000237487257, "total_loss": 1.8362104892730713, "kl": 0.014453577809035778, "policy_loss": -0.0062069371342659, "entropy": 0.8898646831512451}}, "time_this_iter_s": 26.465158939361572, "timesteps_since_restore": 4608706, "time_since_restore": 2758.4919521808624, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45038, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4160>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b47f0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-43-55", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 51.644237702096206}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1304.7148072916707, "node_ip": "10.138.0.2", "timesteps_total": 4654050, "iterations_since_restore": 103, "episode_reward_mean": 1038.2220166100828, "custom_metrics": {"cost1_min": 29.331038805200865, "cost1_max": 433.6927838064164, "cost1_mean": 346.44818241066037, "system_level_velocity_mean": 14.459951612308219, "cost2_max": -28.1986440618941, "outflow_rate_min": 323.3057015323488, "system_level_velocity_max": 19.98350267095611, "system_level_velocity_min": 8.961869096092807, "outflow_rate_max": 1247.1767823416812, "cost2_mean": -190.28774241528225, "outflow_rate_mean": 1069.4233217199862, "cost2_min": -233.37683942130084}, "training_iteration": 103, "episodes_total": 1507, "episode_len_mean": 644.55, "timestamp": 1557207862, "time_total_s": 2785.4594526290894, "pid": 31998, "info": {"num_steps_trained": 4654050, "load_time_ms": 14.184, "num_steps_sampled": 4654050, "grad_time_ms": 10092.559, "sample_time_ms": 16739.69, "update_time_ms": 8.15, "default": {"vf_explained_var": 0.9795549511909485, "vf_loss": 5.806144714355469, "cur_kl_coeff": 0.14238281548023224, "cur_lr": 0.0005000000237487257, "total_loss": 5.803704738616943, "kl": 0.014591965824365616, "policy_loss": -0.0045173936523497105, "entropy": 0.8503423929214478}}, "time_this_iter_s": 26.96750044822693, "timesteps_since_restore": 4654050, "time_since_restore": 2785.4594526290894, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45344, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d14a8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1a58>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-44-22", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 51.644237702096206}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1304.7148072916707, "node_ip": "10.138.0.2", "timesteps_total": 4697938, "iterations_since_restore": 104, "episode_reward_mean": 1030.0734527006198, "custom_metrics": {"cost1_min": 29.331038805200865, "cost1_max": 428.7045587188468, "cost1_mean": 343.16133202868326, "system_level_velocity_mean": 14.454116736892196, "cost2_max": -28.1986440618941, "outflow_rate_min": 323.3057015323488, "system_level_velocity_max": 20.05157688465181, "system_level_velocity_min": 8.961869096092807, "outflow_rate_max": 1240.1870680001505, "cost2_mean": -188.70741390223174, "outflow_rate_mean": 1062.1470603372782, "cost2_min": -234.59154609937744}, "training_iteration": 104, "episodes_total": 1524, "episode_len_mean": 641.21, "timestamp": 1557207887, "time_total_s": 2810.8403584957123, "pid": 31998, "info": {"num_steps_trained": 4697938, "load_time_ms": 14.089, "num_steps_sampled": 4697938, "grad_time_ms": 9902.245, "sample_time_ms": 16495.188, "update_time_ms": 8.262, "default": {"vf_explained_var": 0.9873217940330505, "vf_loss": 4.45689582824707, "cur_kl_coeff": 0.14238281548023224, "cur_lr": 0.0005000000237487257, "total_loss": 4.453364372253418, "kl": 0.014316522516310215, "policy_loss": -0.005569850094616413, "entropy": 0.8837578296661377}}, "time_this_iter_s": 25.380905866622925, "timesteps_since_restore": 4697938, "time_since_restore": 2810.8403584957123, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43888, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfbe0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf7b8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-44-47", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 51.644237702096206}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1313.6908566172729, "node_ip": "10.138.0.2", "timesteps_total": 4741468, "iterations_since_restore": 105, "episode_reward_mean": 1033.7355311972365, "custom_metrics": {"cost1_min": 29.331038805200865, "cost1_max": 428.7045587188468, "cost1_mean": 344.89412773609513, "system_level_velocity_mean": 14.583664298640434, "cost2_max": -28.1986440618941, "outflow_rate_min": 323.3057015323488, "system_level_velocity_max": 20.05157688465181, "system_level_velocity_min": 11.654263026467767, "outflow_rate_max": 1248.019050094894, "cost2_mean": -188.43763338361725, "outflow_rate_mean": 1067.577679501471, "cost2_min": -234.59154609937744}, "training_iteration": 105, "episodes_total": 1539, "episode_len_mean": 637.98, "timestamp": 1557207913, "time_total_s": 2836.038336992264, "pid": 31998, "info": {"num_steps_trained": 4741468, "load_time_ms": 14.027, "num_steps_sampled": 4741468, "grad_time_ms": 9858.976, "sample_time_ms": 16306.875, "update_time_ms": 7.91, "default": {"vf_explained_var": 0.9853618144989014, "vf_loss": 4.90922737121582, "cur_kl_coeff": 0.14238283038139343, "cur_lr": 0.0005000000237487257, "total_loss": 4.906113624572754, "kl": 0.017377009615302086, "policy_loss": -0.005587663035839796, "entropy": 0.8789445757865906}}, "time_this_iter_s": 25.197978496551514, "timesteps_since_restore": 4741468, "time_since_restore": 2836.038336992264, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43530, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c14e0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1198>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-45-13", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 51.644237702096206}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1313.6908566172729, "node_ip": "10.138.0.2", "timesteps_total": 4785162, "iterations_since_restore": 106, "episode_reward_mean": 1070.780190941421, "custom_metrics": {"cost1_min": 29.331038805200865, "cost1_max": 428.7045587188468, "cost1_mean": 354.95463666930874, "system_level_velocity_mean": 14.34069103058913, "cost2_max": -28.1986440618941, "outflow_rate_min": 326.2713828205716, "system_level_velocity_max": 20.05157688465181, "system_level_velocity_min": 11.654263026467767, "outflow_rate_max": 1248.019050094894, "cost2_mean": -194.17908016692508, "outflow_rate_mean": 1093.0523004125614, "cost2_min": -234.59154609937744}, "training_iteration": 106, "episodes_total": 1557, "episode_len_mean": 661.51, "timestamp": 1557207938, "time_total_s": 2861.737139940262, "pid": 31998, "info": {"num_steps_trained": 4785162, "load_time_ms": 13.984, "num_steps_sampled": 4785162, "grad_time_ms": 9843.308, "sample_time_ms": 16224.363, "update_time_ms": 7.979, "default": {"vf_explained_var": 0.9901074767112732, "vf_loss": 3.3279342651367188, "cur_kl_coeff": 0.14238283038139343, "cur_lr": 0.0005000000237487257, "total_loss": 3.3241167068481445, "kl": 0.013211610727012157, "policy_loss": -0.005698587745428085, "entropy": 0.9012757539749146}}, "time_this_iter_s": 25.698802947998047, "timesteps_since_restore": 4785162, "time_since_restore": 2861.737139940262, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43694, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b92b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b94a8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-45-38", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 53.278640581128066}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1313.6908566172729, "node_ip": "10.138.0.2", "timesteps_total": 4831034, "iterations_since_restore": 107, "episode_reward_mean": 1092.158179010141, "custom_metrics": {"cost1_min": 29.438029104702142, "cost1_max": 428.7045587188468, "cost1_mean": 360.2597358845695, "system_level_velocity_mean": 14.19726760432561, "cost2_max": -28.50064339466976, "outflow_rate_min": 326.2713828205716, "system_level_velocity_max": 20.05157688465181, "system_level_velocity_min": 11.654263026467767, "outflow_rate_max": 1248.019050094894, "cost2_mean": -197.6501537817468, "outflow_rate_mean": 1105.5018729595236, "cost2_min": -234.59154609937744}, "training_iteration": 107, "episodes_total": 1567, "episode_len_mean": 673.64, "timestamp": 1557207965, "time_total_s": 2887.873746395111, "pid": 31998, "info": {"num_steps_trained": 4831034, "load_time_ms": 14.391, "num_steps_sampled": 4831034, "grad_time_ms": 9807.385, "sample_time_ms": 16192.471, "update_time_ms": 7.831, "default": {"vf_explained_var": 0.990516185760498, "vf_loss": 2.642224073410034, "cur_kl_coeff": 0.14238283038139343, "cur_lr": 0.0005000000237487257, "total_loss": 2.6405086517333984, "kl": 0.013737929984927177, "policy_loss": -0.0036718063056468964, "entropy": 0.880652904510498}}, "time_this_iter_s": 26.136606454849243, "timesteps_since_restore": 4831034, "time_since_restore": 2887.873746395111, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45872, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c10f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd7b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd588>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-46-05", "hostname": "flow-main", "episodes_this_iter": 10, "episode_reward_min": 53.278640581128066}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1315.796355343508, "node_ip": "10.138.0.2", "timesteps_total": 4876992, "iterations_since_restore": 108, "episode_reward_mean": 1109.1758044400895, "custom_metrics": {"cost1_min": 29.438029104702142, "cost1_max": 428.7045587188468, "cost1_mean": 362.40209970754654, "system_level_velocity_mean": 14.113964933946114, "cost2_max": -28.50064339466976, "outflow_rate_min": 326.2713828205716, "system_level_velocity_max": 20.05157688465181, "system_level_velocity_min": 12.209563378929035, "outflow_rate_max": 1248.019050094894, "cost2_mean": -199.22350885020577, "outflow_rate_mean": 1110.5858780960161, "cost2_min": -234.59154609937744}, "training_iteration": 108, "episodes_total": 1580, "episode_len_mean": 679.52, "timestamp": 1557207991, "time_total_s": 2913.9149091243744, "pid": 31998, "info": {"num_steps_trained": 4876992, "load_time_ms": 14.251, "num_steps_sampled": 4876992, "grad_time_ms": 9870.56, "sample_time_ms": 16067.124, "update_time_ms": 7.998, "default": {"vf_explained_var": 0.9898051619529724, "vf_loss": 3.277458429336548, "cur_kl_coeff": 0.14238281548023224, "cur_lr": 0.0005000000237487257, "total_loss": 3.2737367153167725, "kl": 0.0157359279692173, "policy_loss": -0.005961838643997908, "entropy": 0.8859326839447021}}, "time_this_iter_s": 26.041162729263306, "timesteps_since_restore": 4876992, "time_since_restore": 2913.9149091243744, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45958, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1c18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1ef0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-46-31", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 53.278640581128066}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1319.788747700062, "node_ip": "10.138.0.2", "timesteps_total": 4922290, "iterations_since_restore": 109, "episode_reward_mean": 1119.3167370513202, "custom_metrics": {"cost1_min": 29.438029104702142, "cost1_max": 428.7045587188468, "cost1_mean": 366.99848506894807, "system_level_velocity_mean": 14.099663367966752, "cost2_max": -28.50064339466976, "outflow_rate_min": 326.2713828205716, "system_level_velocity_max": 20.05157688465181, "system_level_velocity_min": 12.209563378929035, "outflow_rate_max": 1248.019050094894, "cost2_mean": -200.71800560712447, "outflow_rate_mean": 1119.0856540553207, "cost2_min": -234.59154609937744}, "training_iteration": 109, "episodes_total": 1598, "episode_len_mean": 685.97, "timestamp": 1557208017, "time_total_s": 2940.335663318634, "pid": 31998, "info": {"num_steps_trained": 4922290, "load_time_ms": 14.707, "num_steps_sampled": 4922290, "grad_time_ms": 9885.511, "sample_time_ms": 16002.755, "update_time_ms": 7.884, "default": {"vf_explained_var": 0.9863206744194031, "vf_loss": 5.0490827560424805, "cur_kl_coeff": 0.14238283038139343, "cur_lr": 0.0005000000237487257, "total_loss": 5.0452561378479, "kl": 0.01562781259417534, "policy_loss": -0.006051761098206043, "entropy": 0.9188262820243835}}, "time_this_iter_s": 26.420754194259644, "timesteps_since_restore": 4922290, "time_since_restore": 2940.335663318634, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45298, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1160>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a72b0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-46-57", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 53.278640581128066}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1319.788747700062, "node_ip": "10.138.0.2", "timesteps_total": 4965932, "iterations_since_restore": 110, "episode_reward_mean": 1116.4881916801312, "custom_metrics": {"cost1_min": 29.438029104702142, "cost1_max": 424.1691313704387, "cost1_mean": 365.64951131037384, "system_level_velocity_mean": 14.052544931775378, "cost2_max": -28.50064339466976, "outflow_rate_min": 326.2713828205716, "system_level_velocity_max": 20.05157688465181, "system_level_velocity_min": 9.745843337540402, "outflow_rate_max": 1248.019050094894, "cost2_mean": -201.20236168757936, "outflow_rate_mean": 1115.5248196521209, "cost2_min": -234.59154609937744}, "training_iteration": 110, "episodes_total": 1613, "episode_len_mean": 685.97, "timestamp": 1557208043, "time_total_s": 2966.303356409073, "pid": 31998, "info": {"num_steps_trained": 4965932, "load_time_ms": 14.659, "num_steps_sampled": 4965932, "grad_time_ms": 9929.285, "sample_time_ms": 16060.459, "update_time_ms": 8.095, "default": {"vf_explained_var": 0.9941202402114868, "vf_loss": 2.415343999862671, "cur_kl_coeff": 0.14238283038139343, "cur_lr": 0.0005000000237487257, "total_loss": 2.411849021911621, "kl": 0.014013304375112057, "policy_loss": -0.0054899645037949085, "entropy": 0.9469396471977234}}, "time_this_iter_s": 25.967693090438843, "timesteps_since_restore": 4965932, "time_since_restore": 2966.303356409073, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43642, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b47f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4c88>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-47-23", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 53.278640581128066}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1319.788747700062, "node_ip": "10.138.0.2", "timesteps_total": 5009399, "iterations_since_restore": 111, "episode_reward_mean": 1115.4410235642647, "custom_metrics": {"cost1_min": 135.0383183097843, "cost1_max": 424.1691313704387, "cost1_mean": 366.56550521033836, "system_level_velocity_mean": 13.965818516922958, "cost2_max": -76.12340117081926, "outflow_rate_min": 562.230314741229, "system_level_velocity_max": 18.62912747817498, "system_level_velocity_min": 9.745843337540402, "outflow_rate_max": 1224.625311629037, "cost2_mean": -201.2816286934703, "outflow_rate_mean": 1113.558138491775, "cost2_min": -230.00643518890627}, "training_iteration": 111, "episodes_total": 1630, "episode_len_mean": 690.75, "timestamp": 1557208070, "time_total_s": 2992.848002433777, "pid": 31998, "info": {"num_steps_trained": 5009399, "load_time_ms": 14.614, "num_steps_sampled": 5009399, "grad_time_ms": 9984.31, "sample_time_ms": 15979.017, "update_time_ms": 7.887, "default": {"vf_explained_var": 0.9841182827949524, "vf_loss": 5.362010955810547, "cur_kl_coeff": 0.14238281548023224, "cur_lr": 0.0005000000237487257, "total_loss": 5.3575005531311035, "kl": 0.01586652174592018, "policy_loss": -0.006769669242203236, "entropy": 0.8826812505722046}}, "time_this_iter_s": 26.54464602470398, "timesteps_since_restore": 5009399, "time_since_restore": 2992.848002433777, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43467, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf0f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfdd8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-47-50", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 318.7869761768328}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1319.788747700062, "node_ip": "10.138.0.2", "timesteps_total": 5055549, "iterations_since_restore": 112, "episode_reward_mean": 1093.2698570056057, "custom_metrics": {"cost1_min": 29.313364007274874, "cost1_max": 424.1691313704387, "cost1_mean": 358.8878957942431, "system_level_velocity_mean": 14.050239319110101, "cost2_max": -29.92268119268071, "outflow_rate_min": 327.9458014252228, "system_level_velocity_max": 20.160626748153465, "system_level_velocity_min": 9.745843337540402, "outflow_rate_max": 1227.9770520258419, "cost2_mean": -197.78471402998392, "outflow_rate_mean": 1095.466344760476, "cost2_min": -230.00643518890627}, "training_iteration": 112, "episodes_total": 1642, "episode_len_mean": 677.01, "timestamp": 1557208098, "time_total_s": 3021.07994389534, "pid": 31998, "info": {"num_steps_trained": 5055549, "load_time_ms": 14.684, "num_steps_sampled": 5055549, "grad_time_ms": 10047.118, "sample_time_ms": 16093.824, "update_time_ms": 7.966, "default": {"vf_explained_var": 0.9781062006950378, "vf_loss": 7.187912464141846, "cur_kl_coeff": 0.14238283038139343, "cur_lr": 0.0005000000237487257, "total_loss": 7.1845011711120605, "kl": 0.019295480102300644, "policy_loss": -0.006159062497317791, "entropy": 0.8702243566513062}}, "time_this_iter_s": 28.23194146156311, "timesteps_since_restore": 5055549, "time_since_restore": 3021.07994389534, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 46150, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1198>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1518>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-48-18", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 49.78110055703523}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1319.788747700062, "node_ip": "10.138.0.2", "timesteps_total": 5101335, "iterations_since_restore": 113, "episode_reward_mean": 1077.858761911022, "custom_metrics": {"cost1_min": 29.313364007274874, "cost1_max": 442.27178576070213, "cost1_mean": 355.89056518130803, "system_level_velocity_mean": 14.126057847634252, "cost2_max": -29.92268119268071, "outflow_rate_min": 325.2012645303821, "system_level_velocity_max": 20.160626748153465, "system_level_velocity_min": 9.745843337540402, "outflow_rate_max": 1250.4146449719422, "cost2_mean": -194.70401888310724, "outflow_rate_mean": 1084.7708278399984, "cost2_min": -230.00643518890627}, "training_iteration": 113, "episodes_total": 1658, "episode_len_mean": 670.53, "timestamp": 1557208124, "time_total_s": 3047.515367746353, "pid": 31998, "info": {"num_steps_trained": 5101335, "load_time_ms": 14.73, "num_steps_sampled": 5101335, "grad_time_ms": 9999.403, "sample_time_ms": 16086.604, "update_time_ms": 7.863, "default": {"vf_explained_var": 0.9843114018440247, "vf_loss": 5.418470859527588, "cur_kl_coeff": 0.14238281548023224, "cur_lr": 0.0005000000237487257, "total_loss": 5.413857936859131, "kl": 0.014936049468815327, "policy_loss": -0.006739305332303047, "entropy": 0.8905975818634033}}, "time_this_iter_s": 26.435423851013184, "timesteps_since_restore": 5101335, "time_since_restore": 3047.515367746353, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45786, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e0f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1eb8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-48-44", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 49.78110055703523}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1321.5685520931247, "node_ip": "10.138.0.2", "timesteps_total": 5144784, "iterations_since_restore": 114, "episode_reward_mean": 1056.4020090426206, "custom_metrics": {"cost1_min": 29.313364007274874, "cost1_max": 442.27178576070213, "cost1_mean": 351.6377762832341, "system_level_velocity_mean": 14.169572212959741, "cost2_max": -29.553409829342595, "outflow_rate_min": 325.2012645303821, "system_level_velocity_max": 20.160626748153465, "system_level_velocity_min": 9.745843337540402, "outflow_rate_max": 1250.4146449719422, "cost2_mean": -192.6902655345626, "outflow_rate_mean": 1071.8053444532195, "cost2_min": -229.85297221731417}, "training_iteration": 114, "episodes_total": 1675, "episode_len_mean": 663.96, "timestamp": 1557208150, "time_total_s": 3072.5914220809937, "pid": 31998, "info": {"num_steps_trained": 5144784, "load_time_ms": 14.693, "num_steps_sampled": 5144784, "grad_time_ms": 9939.596, "sample_time_ms": 16116.187, "update_time_ms": 7.957, "default": {"vf_explained_var": 0.9906024932861328, "vf_loss": 3.8152377605438232, "cur_kl_coeff": 0.14238281548023224, "cur_lr": 0.0005000000237487257, "total_loss": 3.8104214668273926, "kl": 0.015836896374821663, "policy_loss": -0.007070973049849272, "entropy": 0.9004743695259094}}, "time_this_iter_s": 25.076054334640503, "timesteps_since_restore": 5144784, "time_since_restore": 3072.5914220809937, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43449, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9a58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b94a8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-49-10", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 49.78110055703523}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1321.5685520931247, "node_ip": "10.138.0.2", "timesteps_total": 5188802, "iterations_since_restore": 115, "episode_reward_mean": 1068.2028415286907, "custom_metrics": {"cost1_min": 29.313364007274874, "cost1_max": 442.27178576070213, "cost1_mean": 356.5877873649499, "system_level_velocity_mean": 14.254483981661558, "cost2_max": -29.553409829342595, "outflow_rate_min": 325.2012645303821, "system_level_velocity_max": 20.160626748153465, "system_level_velocity_min": 9.745843337540402, "outflow_rate_max": 1250.4146449719422, "cost2_mean": -193.76913479700582, "outflow_rate_mean": 1083.8266194221642, "cost2_min": -229.85297221731417}, "training_iteration": 115, "episodes_total": 1692, "episode_len_mean": 668.19, "timestamp": 1557208177, "time_total_s": 3099.662396669388, "pid": 31998, "info": {"num_steps_trained": 5188802, "load_time_ms": 14.576, "num_steps_sampled": 5188802, "grad_time_ms": 9911.302, "sample_time_ms": 16332.167, "update_time_ms": 8.247, "default": {"vf_explained_var": 0.9881938695907593, "vf_loss": 3.978245258331299, "cur_kl_coeff": 0.14238281548023224, "cur_lr": 0.0005000000237487257, "total_loss": 3.9758105278015137, "kl": 0.0160524845123291, "policy_loss": -0.004719912074506283, "entropy": 0.86676025390625}}, "time_this_iter_s": 27.070974588394165, "timesteps_since_restore": 5188802, "time_since_restore": 3099.662396669388, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44018, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4080>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b46a0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-49-37", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 49.78110055703523}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1321.5685520931247, "node_ip": "10.138.0.2", "timesteps_total": 5233576, "iterations_since_restore": 116, "episode_reward_mean": 1071.2647495150638, "custom_metrics": {"cost1_min": 29.313364007274874, "cost1_max": 442.27178576070213, "cost1_mean": 357.1291898175282, "system_level_velocity_mean": 14.273344240099572, "cost2_max": -29.553409829342595, "outflow_rate_min": 325.2012645303821, "system_level_velocity_max": 20.160626748153465, "system_level_velocity_min": 9.745843337540402, "outflow_rate_max": 1251.7744187651695, "cost2_mean": -193.70654638767036, "outflow_rate_mean": 1086.750437757357, "cost2_min": -229.85297221731417}, "training_iteration": 116, "episodes_total": 1705, "episode_len_mean": 668.19, "timestamp": 1557208203, "time_total_s": 3125.971874475479, "pid": 31998, "info": {"num_steps_trained": 5233576, "load_time_ms": 14.381, "num_steps_sampled": 5233576, "grad_time_ms": 9822.881, "sample_time_ms": 16485.535, "update_time_ms": 8.174, "default": {"vf_explained_var": 0.9873051047325134, "vf_loss": 4.739684581756592, "cur_kl_coeff": 0.14238281548023224, "cur_lr": 0.0005000000237487257, "total_loss": 4.7378830909729, "kl": 0.014991809614002705, "policy_loss": -0.0039357529021799564, "entropy": 0.9036305546760559}}, "time_this_iter_s": 26.30947780609131, "timesteps_since_restore": 5233576, "time_since_restore": 3125.971874475479, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44774, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1e48>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1860>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-50-03", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 49.78110055703523}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1321.5685520931247, "node_ip": "10.138.0.2", "timesteps_total": 5278212, "iterations_since_restore": 117, "episode_reward_mean": 1082.3531358019957, "custom_metrics": {"cost1_min": 29.313364007274874, "cost1_max": 442.27178576070213, "cost1_mean": 359.6416691164754, "system_level_velocity_mean": 14.360222948978869, "cost2_max": -29.553409829342595, "outflow_rate_min": 325.2012645303821, "system_level_velocity_max": 20.160626748153465, "system_level_velocity_min": 11.779115899912556, "outflow_rate_max": 1251.7744187651695, "cost2_mean": -194.04655755118648, "outflow_rate_mean": 1094.348039625197, "cost2_min": -227.98875994767144}, "training_iteration": 117, "episodes_total": 1717, "episode_len_mean": 668.19, "timestamp": 1557208230, "time_total_s": 3152.5740070343018, "pid": 31998, "info": {"num_steps_trained": 5278212, "load_time_ms": 14.085, "num_steps_sampled": 5278212, "grad_time_ms": 9735.022, "sample_time_ms": 16622.064, "update_time_ms": 8.172, "default": {"vf_explained_var": 0.9913278222084045, "vf_loss": 3.053560733795166, "cur_kl_coeff": 0.14238283038139343, "cur_lr": 0.0005000000237487257, "total_loss": 3.0496888160705566, "kl": 0.014410161413252354, "policy_loss": -0.005923605524003506, "entropy": 0.8710401058197021}}, "time_this_iter_s": 26.602132558822632, "timesteps_since_restore": 5278212, "time_since_restore": 3152.5740070343018, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44636, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce0f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ced68>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cebe0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-50-30", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 49.78110055703523}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1321.5685520931247, "node_ip": "10.138.0.2", "timesteps_total": 5321749, "iterations_since_restore": 118, "episode_reward_mean": 1088.4288288262956, "custom_metrics": {"cost1_min": 29.385526564236034, "cost1_max": 442.27178576070213, "cost1_mean": 363.03035295251516, "system_level_velocity_mean": 14.57678536653053, "cost2_max": -28.01087940847857, "outflow_rate_min": 317.9670165501775, "system_level_velocity_max": 19.948442602557762, "system_level_velocity_min": 12.067281190057063, "outflow_rate_max": 1251.7744187651695, "cost2_mean": -193.9168897734909, "outflow_rate_mean": 1101.5981570739157, "cost2_min": -227.93299313353754}, "training_iteration": 118, "episodes_total": 1736, "episode_len_mean": 665.25, "timestamp": 1557208256, "time_total_s": 3179.236871957779, "pid": 31998, "info": {"num_steps_trained": 5321749, "load_time_ms": 13.836, "num_steps_sampled": 5321749, "grad_time_ms": 9630.365, "sample_time_ms": 16791.808, "update_time_ms": 7.917, "default": {"vf_explained_var": 0.9626452922821045, "vf_loss": 12.564826965332031, "cur_kl_coeff": 0.14238283038139343, "cur_lr": 0.0005000000237487257, "total_loss": 12.560229301452637, "kl": 0.02200235240161419, "policy_loss": -0.0077306125313043594, "entropy": 0.8949448466300964}}, "time_this_iter_s": 26.662864923477173, "timesteps_since_restore": 5321749, "time_since_restore": 3179.236871957779, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43537, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce978>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-50-56", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 50.018928999508276}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1321.5685520931247, "node_ip": "10.138.0.2", "timesteps_total": 5363638, "iterations_since_restore": 119, "episode_reward_mean": 1091.0215983148928, "custom_metrics": {"cost1_min": 29.385526564236034, "cost1_max": 436.9930891993085, "cost1_mean": 366.16640604393945, "system_level_velocity_mean": 14.611722416040022, "cost2_max": -28.01087940847857, "outflow_rate_min": 317.9670165501775, "system_level_velocity_max": 20.128602882046437, "system_level_velocity_min": 12.067281190057063, "outflow_rate_max": 1251.7744187651695, "cost2_mean": -193.71615851975378, "outflow_rate_mean": 1105.5190731192044, "cost2_min": -229.36654185504267}, "training_iteration": 119, "episodes_total": 1754, "episode_len_mean": 668.93, "timestamp": 1557208282, "time_total_s": 3204.4872398376465, "pid": 31998, "info": {"num_steps_trained": 5363638, "load_time_ms": 13.582, "num_steps_sampled": 5363638, "grad_time_ms": 9391.67, "sample_time_ms": 16915.169, "update_time_ms": 7.916, "default": {"vf_explained_var": 0.9782053232192993, "vf_loss": 9.26264762878418, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 9.258362770080566, "kl": 0.015448134392499924, "policy_loss": -0.0075842030346393585, "entropy": 0.9495951533317566}}, "time_this_iter_s": 25.250367879867554, "timesteps_since_restore": 5363638, "time_since_restore": 3204.4872398376465, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 41889, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b6689e9b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd7b8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-51-22", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 47.64370420136067}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1321.5685520931247, "node_ip": "10.138.0.2", "timesteps_total": 5407593, "iterations_since_restore": 120, "episode_reward_mean": 1107.6250148711622, "custom_metrics": {"cost1_min": 29.46987911937861, "cost1_max": 436.9930891993085, "cost1_mean": 374.9673978548682, "system_level_velocity_mean": 14.757046668774374, "cost2_max": -28.01087940847857, "outflow_rate_min": 317.9670165501775, "system_level_velocity_max": 20.128602882046437, "system_level_velocity_min": 12.067281190057063, "outflow_rate_max": 1258.0700982285327, "cost2_mean": -195.02227765123817, "outflow_rate_mean": 1128.2536636419454, "cost2_min": -229.36654185504267}, "training_iteration": 120, "episodes_total": 1769, "episode_len_mean": 675.5, "timestamp": 1557208308, "time_total_s": 3230.587438583374, "pid": 31998, "info": {"num_steps_trained": 5407593, "load_time_ms": 14.148, "num_steps_sampled": 5407593, "grad_time_ms": 9267.168, "sample_time_ms": 17052.831, "update_time_ms": 7.618, "default": {"vf_explained_var": 0.9837149977684021, "vf_loss": 5.276663780212402, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 5.273657321929932, "kl": 0.01375457365065813, "policy_loss": -0.005944358184933662, "entropy": 0.9042015671730042}}, "time_this_iter_s": 26.10019874572754, "timesteps_since_restore": 5407593, "time_since_restore": 3230.587438583374, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43955, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cebe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce080>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cecf8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-51-48", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 47.64370420136067}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1313.4334526199832, "node_ip": "10.138.0.2", "timesteps_total": 5451848, "iterations_since_restore": 121, "episode_reward_mean": 1099.655080552477, "custom_metrics": {"cost1_min": 29.46987911937861, "cost1_max": 436.9930891993085, "cost1_mean": 373.6001262208283, "system_level_velocity_mean": 14.715287083715621, "cost2_max": -28.01087940847857, "outflow_rate_min": 317.9670165501775, "system_level_velocity_max": 20.128602882046437, "system_level_velocity_min": 12.05833129163646, "outflow_rate_max": 1260.0019225899832, "cost2_mean": -194.0006860324901, "outflow_rate_mean": 1124.55486559355, "cost2_min": -229.36654185504267}, "training_iteration": 121, "episodes_total": 1784, "episode_len_mean": 675.5, "timestamp": 1557208334, "time_total_s": 3257.393192052841, "pid": 31998, "info": {"num_steps_trained": 5451848, "load_time_ms": 14.435, "num_steps_sampled": 5451848, "grad_time_ms": 9196.308, "sample_time_ms": 17151.021, "update_time_ms": 7.575, "default": {"vf_explained_var": 0.989782452583313, "vf_loss": 3.640047311782837, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 3.6372318267822266, "kl": 0.01271967962384224, "policy_loss": -0.005532161798328161, "entropy": 0.9228870272636414}}, "time_this_iter_s": 26.805753469467163, "timesteps_since_restore": 5451848, "time_since_restore": 3257.393192052841, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44255, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d12b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1518>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-52-14", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 47.64370420136067}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1313.4334526199832, "node_ip": "10.138.0.2", "timesteps_total": 5495315, "iterations_since_restore": 122, "episode_reward_mean": 1079.2324036104492, "custom_metrics": {"cost1_min": 29.272838603208644, "cost1_max": 436.9930891993085, "cost1_mean": 368.29282403348566, "system_level_velocity_mean": 14.865265636859652, "cost2_max": -28.01087940847857, "outflow_rate_min": 317.9670165501775, "system_level_velocity_max": 20.128602882046437, "system_level_velocity_min": 12.05833129163646, "outflow_rate_max": 1269.1677745012535, "cost2_mean": -191.63473078082686, "outflow_rate_mean": 1112.9156225491956, "cost2_min": -229.36654185504267}, "training_iteration": 122, "episodes_total": 1800, "episode_len_mean": 663.26, "timestamp": 1557208360, "time_total_s": 3283.0185437202454, "pid": 31998, "info": {"num_steps_trained": 5495315, "load_time_ms": 14.041, "num_steps_sampled": 5495315, "grad_time_ms": 8978.799, "sample_time_ms": 17109.183, "update_time_ms": 7.377, "default": {"vf_explained_var": 0.9747570157051086, "vf_loss": 9.455465316772461, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 9.451687812805176, "kl": 0.013535235077142715, "policy_loss": -0.006668135058134794, "entropy": 0.929116427898407}}, "time_this_iter_s": 25.625351667404175, "timesteps_since_restore": 5495315, "time_since_restore": 3283.0185437202454, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43467, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c10f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1e10>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-52-40", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 47.64370420136067}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1319.1157922604268, "node_ip": "10.138.0.2", "timesteps_total": 5539384, "iterations_since_restore": 123, "episode_reward_mean": 1057.177022475181, "custom_metrics": {"cost1_min": 29.272838603208644, "cost1_max": 445.23724579618624, "cost1_mean": 363.6837909508784, "system_level_velocity_mean": 14.946720634439886, "cost2_max": -28.01087940847857, "outflow_rate_min": 317.9670165501775, "system_level_velocity_max": 20.128602882046437, "system_level_velocity_min": 11.507416153242774, "outflow_rate_max": 1269.1677745012535, "cost2_mean": -188.95543419753466, "outflow_rate_mean": 1099.9421689849476, "cost2_min": -229.36654185504267}, "training_iteration": 123, "episodes_total": 1816, "episode_len_mean": 654.57, "timestamp": 1557208386, "time_total_s": 3308.471851348877, "pid": 31998, "info": {"num_steps_trained": 5539384, "load_time_ms": 14.304, "num_steps_sampled": 5539384, "grad_time_ms": 8915.301, "sample_time_ms": 17078.029, "update_time_ms": 7.217, "default": {"vf_explained_var": 0.9781401753425598, "vf_loss": 8.807686805725098, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 8.804800033569336, "kl": 0.01714116334915161, "policy_loss": -0.006546040065586567, "entropy": 0.9488736391067505}}, "time_this_iter_s": 25.453307628631592, "timesteps_since_restore": 5539384, "time_since_restore": 3308.471851348877, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44069, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ceef0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce4e0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-53-06", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 47.64370420136067}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1319.1157922604268, "node_ip": "10.138.0.2", "timesteps_total": 5582210, "iterations_since_restore": 124, "episode_reward_mean": 1079.821363786762, "custom_metrics": {"cost1_min": 29.272838603208644, "cost1_max": 445.23724579618624, "cost1_mean": 372.10488838187223, "system_level_velocity_mean": 14.775724330164174, "cost2_max": -29.228000832968988, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.128602882046437, "system_level_velocity_min": 11.507416153242774, "outflow_rate_max": 1273.6763833997236, "cost2_mean": -193.22090818914626, "outflow_rate_mean": 1120.3436194744784, "cost2_min": -229.36654185504267}, "training_iteration": 124, "episodes_total": 1832, "episode_len_mean": 672.5, "timestamp": 1557208412, "time_total_s": 3334.594526529312, "pid": 31998, "info": {"num_steps_trained": 5582210, "load_time_ms": 14.22, "num_steps_sampled": 5582210, "grad_time_ms": 8891.869, "sample_time_ms": 17206.997, "update_time_ms": 7.049, "default": {"vf_explained_var": 0.9887352585792542, "vf_loss": 4.547649383544922, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 4.545394420623779, "kl": 0.013273986987769604, "policy_loss": -0.005089662969112396, "entropy": 0.9322847127914429}}, "time_this_iter_s": 26.12267518043518, "timesteps_since_restore": 5582210, "time_since_restore": 3334.594526529312, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 42826, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c12b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668c1400>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-53-32", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 47.64370420136067}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1319.1157922604268, "node_ip": "10.138.0.2", "timesteps_total": 5625179, "iterations_since_restore": 125, "episode_reward_mean": 1066.2362940814228, "custom_metrics": {"cost1_min": 29.272838603208644, "cost1_max": 445.23724579618624, "cost1_mean": 368.29014171060044, "system_level_velocity_mean": 14.893332605287869, "cost2_max": -29.228000832968988, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.128602882046437, "system_level_velocity_min": 11.507416153242774, "outflow_rate_max": 1289.2856646803878, "cost2_mean": -191.1463228855858, "outflow_rate_mean": 1110.9870271938248, "cost2_min": -234.54074590948025}, "training_iteration": 125, "episodes_total": 1847, "episode_len_mean": 663.15, "timestamp": 1557208437, "time_total_s": 3359.337859392166, "pid": 31998, "info": {"num_steps_trained": 5625179, "load_time_ms": 14.167, "num_steps_sampled": 5625179, "grad_time_ms": 8895.932, "sample_time_ms": 16968.983, "update_time_ms": 6.633, "default": {"vf_explained_var": 0.9691139459609985, "vf_loss": 10.070221900939941, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 10.066624641418457, "kl": 0.013600553385913372, "policy_loss": -0.006502015516161919, "entropy": 0.8886578679084778}}, "time_this_iter_s": 24.743332862854004, "timesteps_since_restore": 5625179, "time_since_restore": 3359.337859392166, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 42969, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d13c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1e10>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1c18>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-53-57", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 47.64370420136067}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1319.1157922604268, "node_ip": "10.138.0.2", "timesteps_total": 5668907, "iterations_since_restore": 126, "episode_reward_mean": 1066.129215688827, "custom_metrics": {"cost1_min": 29.272838603208644, "cost1_max": 459.9359732983612, "cost1_mean": 365.97490773032075, "system_level_velocity_mean": 14.765223361890222, "cost2_max": -29.228000832968988, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.108414762791465, "system_level_velocity_min": 11.507416153242774, "outflow_rate_max": 1289.2856646803878, "cost2_mean": -193.17588695020538, "outflow_rate_mean": 1110.8311628405268, "cost2_min": -234.54074590948025}, "training_iteration": 126, "episodes_total": 1864, "episode_len_mean": 664.07, "timestamp": 1557208462, "time_total_s": 3384.5440764427185, "pid": 31998, "info": {"num_steps_trained": 5668907, "load_time_ms": 14.378, "num_steps_sampled": 5668907, "grad_time_ms": 8966.378, "sample_time_ms": 16787.622, "update_time_ms": 6.682, "default": {"vf_explained_var": 0.9735674858093262, "vf_loss": 8.818814277648926, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 8.815276145935059, "kl": 0.012639613822102547, "policy_loss": -0.006237158551812172, "entropy": 0.9033098220825195}}, "time_this_iter_s": 25.206217050552368, "timesteps_since_restore": 5668907, "time_since_restore": 3384.5440764427185, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43728, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf8d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfba8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-54-22", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 53.48019641507832}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1319.1157922604268, "node_ip": "10.138.0.2", "timesteps_total": 5714086, "iterations_since_restore": 127, "episode_reward_mean": 1076.0252081753265, "custom_metrics": {"cost1_min": 29.272838603208644, "cost1_max": 459.9359732983612, "cost1_mean": 365.5761005572949, "system_level_velocity_mean": 14.740453777672965, "cost2_max": -29.228000832968988, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.108414762791465, "system_level_velocity_min": 11.507416153242774, "outflow_rate_max": 1289.2856646803878, "cost2_mean": -195.12544489217925, "outflow_rate_mean": 1112.0179295046516, "cost2_min": -242.14725995266167}, "training_iteration": 127, "episodes_total": 1876, "episode_len_mean": 664.07, "timestamp": 1557208488, "time_total_s": 3410.9410347938538, "pid": 31998, "info": {"num_steps_trained": 5714086, "load_time_ms": 14.421, "num_steps_sampled": 5714086, "grad_time_ms": 8995.444, "sample_time_ms": 16737.108, "update_time_ms": 6.634, "default": {"vf_explained_var": 0.992448627948761, "vf_loss": 2.5666520595550537, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 2.5630431175231934, "kl": 0.012770932167768478, "policy_loss": -0.006336674559861422, "entropy": 0.9181528687477112}}, "time_this_iter_s": 26.396958351135254, "timesteps_since_restore": 5714086, "time_since_restore": 3410.9410347938538, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45179, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1a20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdcf8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-54-48", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 53.48019641507832}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1319.1157922604268, "node_ip": "10.138.0.2", "timesteps_total": 5758955, "iterations_since_restore": 128, "episode_reward_mean": 1079.4132774185662, "custom_metrics": {"cost1_min": 29.272838603208644, "cost1_max": 459.9359732983612, "cost1_mean": 367.51079283530356, "system_level_velocity_mean": 14.802680296564413, "cost2_max": -29.228000832968988, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.108414762791465, "system_level_velocity_min": 11.507416153242774, "outflow_rate_max": 1289.2856646803878, "cost2_mean": -195.6330248647519, "outflow_rate_mean": 1116.4152523284674, "cost2_min": -242.14725995266167}, "training_iteration": 128, "episodes_total": 1892, "episode_len_mean": 664.07, "timestamp": 1557208514, "time_total_s": 3437.0136375427246, "pid": 31998, "info": {"num_steps_trained": 5758955, "load_time_ms": 14.867, "num_steps_sampled": 5758955, "grad_time_ms": 9081.779, "sample_time_ms": 16590.97, "update_time_ms": 6.618, "default": {"vf_explained_var": 0.9902108907699585, "vf_loss": 3.4331297874450684, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 3.4304704666137695, "kl": 0.013264176435768604, "policy_loss": -0.0054924217984080315, "entropy": 0.9238715767860413}}, "time_this_iter_s": 26.07260274887085, "timesteps_since_restore": 5758955, "time_since_restore": 3437.0136375427246, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44869, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdf98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd940>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cda20>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-55-14", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 53.48019641507832}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1311.3676180159464, "node_ip": "10.138.0.2", "timesteps_total": 5802238, "iterations_since_restore": 129, "episode_reward_mean": 1098.8381367886514, "custom_metrics": {"cost1_min": 77.2451312329815, "cost1_max": 459.9359732983612, "cost1_mean": 373.41021056664357, "system_level_velocity_mean": 14.593946336600812, "cost2_max": -57.84080216188238, "outflow_rate_min": 414.9196873625535, "system_level_velocity_max": 19.759933849106226, "system_level_velocity_min": 11.418629232970597, "outflow_rate_max": 1289.2856646803878, "cost2_mean": -199.44920461990733, "outflow_rate_mean": 1128.6207145362705, "cost2_min": -242.14725995266167}, "training_iteration": 129, "episodes_total": 1908, "episode_len_mean": 679.45, "timestamp": 1557208540, "time_total_s": 3462.290403842926, "pid": 31998, "info": {"num_steps_trained": 5802238, "load_time_ms": 15.064, "num_steps_sampled": 5802238, "grad_time_ms": 9216.995, "sample_time_ms": 16458.257, "update_time_ms": 6.54, "default": {"vf_explained_var": 0.9923548698425293, "vf_loss": 3.0459706783294678, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 3.0426342487335205, "kl": 0.01460360363125801, "policy_loss": -0.006455462891608477, "entropy": 0.9451400637626648}}, "time_this_iter_s": 25.276766300201416, "timesteps_since_restore": 5802238, "time_since_restore": 3462.290403842926, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43283, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce048>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce208>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-55-40", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 163.14774132816123}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1311.3676180159464, "node_ip": "10.138.0.2", "timesteps_total": 5848240, "iterations_since_restore": 130, "episode_reward_mean": 1114.623621169317, "custom_metrics": {"cost1_min": 77.2451312329815, "cost1_max": 459.9359732983612, "cost1_mean": 375.87243903723413, "system_level_velocity_mean": 14.527992632732467, "cost2_max": -57.84080216188238, "outflow_rate_min": 414.9196873625535, "system_level_velocity_max": 19.759933849106226, "system_level_velocity_min": 11.418629232970597, "outflow_rate_max": 1289.2856646803878, "cost2_mean": -202.97180245945455, "outflow_rate_mean": 1138.124425414875, "cost2_min": -242.14725995266167}, "training_iteration": 130, "episodes_total": 1921, "episode_len_mean": 685.0, "timestamp": 1557208565, "time_total_s": 3487.920322418213, "pid": 31998, "info": {"num_steps_trained": 5848240, "load_time_ms": 15.001, "num_steps_sampled": 5848240, "grad_time_ms": 9319.626, "sample_time_ms": 16308.063, "update_time_ms": 6.635, "default": {"vf_explained_var": 0.9870957136154175, "vf_loss": 4.085306167602539, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 4.083354473114014, "kl": 0.012607784010469913, "policy_loss": -0.004644498694688082, "entropy": 0.9228456020355225}}, "time_this_iter_s": 25.629918575286865, "timesteps_since_restore": 5848240, "time_since_restore": 3487.920322418213, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 46002, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf908>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfba8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-56-05", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 163.14774132816123}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1311.3676180159464, "node_ip": "10.138.0.2", "timesteps_total": 5892996, "iterations_since_restore": 131, "episode_reward_mean": 1103.8673354588489, "custom_metrics": {"cost1_min": 77.2451312329815, "cost1_max": 459.9359732983612, "cost1_mean": 370.55521715001976, "system_level_velocity_mean": 14.486282983494029, "cost2_max": -57.84080216188238, "outflow_rate_min": 414.9196873625535, "system_level_velocity_max": 19.759933849106226, "system_level_velocity_min": 11.418629232970597, "outflow_rate_max": 1289.2856646803878, "cost2_mean": -202.08863751885744, "outflow_rate_mean": 1124.7938025119217, "cost2_min": -242.14725995266167}, "training_iteration": 131, "episodes_total": 1937, "episode_len_mean": 679.34, "timestamp": 1557208591, "time_total_s": 3513.863029718399, "pid": 31998, "info": {"num_steps_trained": 5892996, "load_time_ms": 14.891, "num_steps_sampled": 5892996, "grad_time_ms": 9341.88, "sample_time_ms": 16199.535, "update_time_ms": 6.694, "default": {"vf_explained_var": 0.982749879360199, "vf_loss": 5.993891716003418, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 5.991072654724121, "kl": 0.013714604079723358, "policy_loss": -0.005748697556555271, "entropy": 0.9313085079193115}}, "time_this_iter_s": 25.942707300186157, "timesteps_since_restore": 5892996, "time_since_restore": 3513.863029718399, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44756, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cecf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce2b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce278>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-56-31", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 163.14774132816123}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1305.113091733797, "node_ip": "10.138.0.2", "timesteps_total": 5938235, "iterations_since_restore": 132, "episode_reward_mean": 1112.5246499994819, "custom_metrics": {"cost1_min": 94.33939024462191, "cost1_max": 459.9359732983612, "cost1_mean": 373.10487630657155, "system_level_velocity_mean": 14.332403490677127, "cost2_max": -63.34742444951382, "outflow_rate_min": 437.7825407461703, "system_level_velocity_max": 19.400662338331177, "system_level_velocity_min": 11.418629232970597, "outflow_rate_max": 1261.152608543993, "cost2_mean": -205.2827155909876, "outflow_rate_mean": 1129.8350566867305, "cost2_min": -242.14725995266167}, "training_iteration": 132, "episodes_total": 1951, "episode_len_mean": 688.69, "timestamp": 1557208618, "time_total_s": 3540.181486606598, "pid": 31998, "info": {"num_steps_trained": 5938235, "load_time_ms": 14.862, "num_steps_sampled": 5938235, "grad_time_ms": 9460.206, "sample_time_ms": 16150.522, "update_time_ms": 6.751, "default": {"vf_explained_var": 0.9919871687889099, "vf_loss": 2.766245126724243, "cur_kl_coeff": 0.21357420086860657, "cur_lr": 0.0005000000237487257, "total_loss": 2.7640836238861084, "kl": 0.012698078528046608, "policy_loss": -0.0048733726143836975, "entropy": 0.9155765175819397}}, "time_this_iter_s": 26.318456888198853, "timesteps_since_restore": 5938235, "time_since_restore": 3540.181486606598, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45239, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cec50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cedd8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce940>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-56-58", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 208.3313965689152}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1317.062975414323, "node_ip": "10.138.0.2", "timesteps_total": 5983177, "iterations_since_restore": 133, "episode_reward_mean": 1123.3984405548774, "custom_metrics": {"cost1_min": 94.6369287772915, "cost1_max": 427.2989942271979, "cost1_mean": 376.01680098303837, "system_level_velocity_mean": 14.282051615284768, "cost2_max": -63.34742444951382, "outflow_rate_min": 451.2590164794116, "system_level_velocity_max": 19.400662338331177, "system_level_velocity_min": 11.418629232970597, "outflow_rate_max": 1261.152608543993, "cost2_mean": -207.51966905365617, "outflow_rate_mean": 1138.6797209720642, "cost2_min": -242.14725995266167}, "training_iteration": 133, "episodes_total": 1966, "episode_len_mean": 694.34, "timestamp": 1557208644, "time_total_s": 3566.5969371795654, "pid": 31998, "info": {"num_steps_trained": 5983177, "load_time_ms": 14.76, "num_steps_sampled": 5983177, "grad_time_ms": 9569.44, "sample_time_ms": 16135.672, "update_time_ms": 6.731, "default": {"vf_explained_var": 0.9922176003456116, "vf_loss": 2.8869194984436035, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 2.8826253414154053, "kl": 0.014632823877036572, "policy_loss": -0.007419226691126823, "entropy": 0.940893292427063}}, "time_this_iter_s": 26.41545057296753, "timesteps_since_restore": 5983177, "time_since_restore": 3566.5969371795654, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44942, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf5f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf940>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfd30>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-57-24", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 220.84843610693713}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1317.062975414323, "node_ip": "10.138.0.2", "timesteps_total": 6029007, "iterations_since_restore": 134, "episode_reward_mean": 1107.05914379013, "custom_metrics": {"cost1_min": 94.6369287772915, "cost1_max": 442.673208308695, "cost1_mean": 370.54022520189176, "system_level_velocity_mean": 14.245554762731981, "cost2_max": -63.34742444951382, "outflow_rate_min": 451.2590164794116, "system_level_velocity_max": 19.472194484282866, "system_level_velocity_min": 11.418629232970597, "outflow_rate_max": 1261.152608543993, "cost2_mean": -204.97268794591508, "outflow_rate_mean": 1123.3387152283117, "cost2_min": -233.22823848718332}, "training_iteration": 134, "episodes_total": 1981, "episode_len_mean": 688.78, "timestamp": 1557208671, "time_total_s": 3593.302266359329, "pid": 31998, "info": {"num_steps_trained": 6029007, "load_time_ms": 15.121, "num_steps_sampled": 6029007, "grad_time_ms": 9637.911, "sample_time_ms": 16122.532, "update_time_ms": 6.655, "default": {"vf_explained_var": 0.9914119243621826, "vf_loss": 3.5134799480438232, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 3.509734630584717, "kl": 0.014262347482144833, "policy_loss": -0.006791406311094761, "entropy": 0.9785968661308289}}, "time_this_iter_s": 26.705329179763794, "timesteps_since_restore": 6029007, "time_since_restore": 3593.302266359329, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45830, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfb38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf9e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf2b0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-57-51", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 220.84843610693713}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1317.062975414323, "node_ip": "10.138.0.2", "timesteps_total": 6072217, "iterations_since_restore": 135, "episode_reward_mean": 1095.011332547807, "custom_metrics": {"cost1_min": 94.6369287772915, "cost1_max": 442.673208308695, "cost1_mean": 365.9977607143165, "system_level_velocity_mean": 14.335259996324606, "cost2_max": -63.34742444951382, "outflow_rate_min": 451.2590164794116, "system_level_velocity_max": 19.472194484282866, "system_level_velocity_min": 11.418629232970597, "outflow_rate_max": 1261.152608543993, "cost2_mean": -201.6016746311226, "outflow_rate_mean": 1110.4971756275231, "cost2_min": -233.22823848718332}, "training_iteration": 135, "episodes_total": 1997, "episode_len_mean": 679.26, "timestamp": 1557208696, "time_total_s": 3618.245370864868, "pid": 31998, "info": {"num_steps_trained": 6072217, "load_time_ms": 15.303, "num_steps_sampled": 6072217, "grad_time_ms": 9618.699, "sample_time_ms": 16163.445, "update_time_ms": 6.997, "default": {"vf_explained_var": 0.9830297827720642, "vf_loss": 6.2611002922058105, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 6.2564802169799805, "kl": 0.015910470858216286, "policy_loss": -0.008018079213798046, "entropy": 0.9888628125190735}}, "time_this_iter_s": 24.94310450553894, "timesteps_since_restore": 6072217, "time_since_restore": 3618.245370864868, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43210, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdf60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9a90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9550>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-58-16", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 220.84843610693713}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1317.062975414323, "node_ip": "10.138.0.2", "timesteps_total": 6117490, "iterations_since_restore": 136, "episode_reward_mean": 1062.4195339365024, "custom_metrics": {"cost1_min": 29.52346728788322, "cost1_max": 442.673208308695, "cost1_mean": 355.77050361452876, "system_level_velocity_mean": 14.433326448851906, "cost2_max": -29.83085871796943, "outflow_rate_min": 327.9458014252228, "system_level_velocity_max": 20.281001077482266, "system_level_velocity_min": 11.620483471386988, "outflow_rate_max": 1251.5504707117216, "cost2_mean": -198.01379349129, "outflow_rate_mean": 1085.5961464033785, "cost2_min": -247.31272873610047}, "training_iteration": 136, "episodes_total": 2015, "episode_len_mean": 661.65, "timestamp": 1557208723, "time_total_s": 3645.1653876304626, "pid": 31998, "info": {"num_steps_trained": 6117490, "load_time_ms": 15.331, "num_steps_sampled": 6117490, "grad_time_ms": 9582.8, "sample_time_ms": 16371.097, "update_time_ms": 6.908, "default": {"vf_explained_var": 0.9692411422729492, "vf_loss": 10.027315139770508, "cur_kl_coeff": 0.21357420086860657, "cur_lr": 0.0005000000237487257, "total_loss": 10.02385425567627, "kl": 0.01518451701849699, "policy_loss": -0.006703411228954792, "entropy": 0.9976460933685303}}, "time_this_iter_s": 26.920016765594482, "timesteps_since_restore": 6117490, "time_since_restore": 3645.1653876304626, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45273, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cda58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdb38>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd128>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-58-43", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 50.8229547436048}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1317.062975414323, "node_ip": "10.138.0.2", "timesteps_total": 6162273, "iterations_since_restore": 137, "episode_reward_mean": 1050.6466584007433, "custom_metrics": {"cost1_min": 29.52346728788322, "cost1_max": 442.9545695450068, "cost1_mean": 353.0421566605991, "system_level_velocity_mean": 14.466573495730957, "cost2_max": -29.83085871796943, "outflow_rate_min": 327.9458014252228, "system_level_velocity_max": 20.281001077482266, "system_level_velocity_min": 11.620483471386988, "outflow_rate_max": 1251.5504707117216, "cost2_mean": -195.82917019908965, "outflow_rate_mean": 1077.6966831697641, "cost2_min": -247.31272873610047}, "training_iteration": 137, "episodes_total": 2028, "episode_len_mean": 656.73, "timestamp": 1557208749, "time_total_s": 3671.3332512378693, "pid": 31998, "info": {"num_steps_trained": 6162273, "load_time_ms": 15.473, "num_steps_sampled": 6162273, "grad_time_ms": 9568.66, "sample_time_ms": 16362.636, "update_time_ms": 6.951, "default": {"vf_explained_var": 0.97357177734375, "vf_loss": 8.627455711364746, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 8.62500286102295, "kl": 0.014777813106775284, "policy_loss": -0.005609139800071716, "entropy": 1.013529658317566}}, "time_this_iter_s": 26.167863607406616, "timesteps_since_restore": 6162273, "time_since_restore": 3671.3332512378693, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44783, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce550>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce630>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-59-09", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 50.8229547436048}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1317.062975414323, "node_ip": "10.138.0.2", "timesteps_total": 6205188, "iterations_since_restore": 138, "episode_reward_mean": 1027.0956837899994, "custom_metrics": {"cost1_min": 29.52346728788322, "cost1_max": 448.08353616872546, "cost1_mean": 346.8257675152768, "system_level_velocity_mean": 14.545720906913663, "cost2_max": -29.83085871796943, "outflow_rate_min": 327.9458014252228, "system_level_velocity_max": 20.281001077482266, "system_level_velocity_min": 11.620483471386988, "outflow_rate_max": 1251.5504707117216, "cost2_mean": -190.99183158748826, "outflow_rate_mean": 1064.1581717684674, "cost2_min": -247.31272873610047}, "training_iteration": 138, "episodes_total": 2048, "episode_len_mean": 645.47, "timestamp": 1557208774, "time_total_s": 3696.4325935840607, "pid": 31998, "info": {"num_steps_trained": 6205188, "load_time_ms": 15.233, "num_steps_sampled": 6205188, "grad_time_ms": 9437.895, "sample_time_ms": 16397.606, "update_time_ms": 6.908, "default": {"vf_explained_var": 0.9748659133911133, "vf_loss": 10.031414985656738, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 10.02700424194336, "kl": 0.01592889241874218, "policy_loss": -0.007812361232936382, "entropy": 1.0548237562179565}}, "time_this_iter_s": 25.099342346191406, "timesteps_since_restore": 6205188, "time_since_restore": 3696.4325935840607, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 42915, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfe48>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf470>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_05-59-34", "hostname": "flow-main", "episodes_this_iter": 20, "episode_reward_min": 50.8229547436048}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1317.062975414323, "node_ip": "10.138.0.2", "timesteps_total": 6249888, "iterations_since_restore": 139, "episode_reward_mean": 1028.2898385724202, "custom_metrics": {"cost1_min": 29.52346728788322, "cost1_max": 448.08353616872546, "cost1_mean": 348.29232865821797, "system_level_velocity_mean": 14.60734590738953, "cost2_max": -29.83085871796943, "outflow_rate_min": 327.9458014252228, "system_level_velocity_max": 20.281001077482266, "system_level_velocity_min": 11.620483471386988, "outflow_rate_max": 1290.9200830415832, "cost2_mean": -190.3256121564983, "outflow_rate_mean": 1064.9186199406938, "cost2_min": -247.31272873610047}, "training_iteration": 139, "episodes_total": 2062, "episode_len_mean": 645.47, "timestamp": 1557208800, "time_total_s": 3722.5540170669556, "pid": 31998, "info": {"num_steps_trained": 6249888, "load_time_ms": 15.185, "num_steps_sampled": 6249888, "grad_time_ms": 9440.655, "sample_time_ms": 16477.921, "update_time_ms": 6.849, "default": {"vf_explained_var": 0.9842035174369812, "vf_loss": 5.183984279632568, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 5.179087162017822, "kl": 0.014104416593909264, "policy_loss": -0.00790992472320795, "entropy": 1.0246117115020752}}, "time_this_iter_s": 26.121423482894897, "timesteps_since_restore": 6249888, "time_since_restore": 3722.5540170669556, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44700, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aae10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1e48>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aa6d8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-00-00", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 50.8229547436048}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1315.9425396496604, "node_ip": "10.138.0.2", "timesteps_total": 6295624, "iterations_since_restore": 140, "episode_reward_mean": 1003.7599547265313, "custom_metrics": {"cost1_min": 29.269659562590867, "cost1_max": 448.08353616872546, "cost1_mean": 340.60301945174353, "system_level_velocity_mean": 14.548196488579084, "cost2_max": -29.325213978460056, "outflow_rate_min": 327.9458014252228, "system_level_velocity_max": 20.281001077482266, "system_level_velocity_min": 11.374052849556758, "outflow_rate_max": 1290.9200830415832, "cost2_mean": -187.54208524806174, "outflow_rate_mean": 1047.3165833921378, "cost2_min": -247.31272873610047}, "training_iteration": 140, "episodes_total": 2076, "episode_len_mean": 637.89, "timestamp": 1557208827, "time_total_s": 3749.7258603572845, "pid": 31998, "info": {"num_steps_trained": 6295624, "load_time_ms": 14.887, "num_steps_sampled": 6295624, "grad_time_ms": 9429.698, "sample_time_ms": 16641.105, "update_time_ms": 6.73, "default": {"vf_explained_var": 0.9794110059738159, "vf_loss": 7.507876873016357, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 7.501875400543213, "kl": 0.014302009716629982, "policy_loss": -0.009056145325303078, "entropy": 1.052797794342041}}, "time_this_iter_s": 27.17184329032898, "timesteps_since_restore": 6295624, "time_since_restore": 3749.7258603572845, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45736, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668655f8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865358>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-00-27", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 49.65388746313856}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1315.9425396496604, "node_ip": "10.138.0.2", "timesteps_total": 6341443, "iterations_since_restore": 141, "episode_reward_mean": 980.3250021483627, "custom_metrics": {"cost1_min": 29.269659562590867, "cost1_max": 448.08353616872546, "cost1_mean": 335.1474452689293, "system_level_velocity_mean": 14.551922532296633, "cost2_max": -29.325213978460056, "outflow_rate_min": 325.2012645303821, "system_level_velocity_max": 20.281001077482266, "system_level_velocity_min": 11.374052849556758, "outflow_rate_max": 1290.9200830415832, "cost2_mean": -186.37652154473952, "outflow_rate_mean": 1038.4703332531403, "cost2_min": -247.31272873610047}, "training_iteration": 141, "episodes_total": 2094, "episode_len_mean": 630.71, "timestamp": 1557208856, "time_total_s": 3778.140242576599, "pid": 31998, "info": {"num_steps_trained": 6341443, "load_time_ms": 14.123, "num_steps_sampled": 6341443, "grad_time_ms": 9394.79, "sample_time_ms": 16922.485, "update_time_ms": 6.904, "default": {"vf_explained_var": 0.973239004611969, "vf_loss": 8.578176498413086, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 8.574007987976074, "kl": 0.013918763026595116, "policy_loss": -0.007140468806028366, "entropy": 1.0101516246795654}}, "time_this_iter_s": 28.414382219314575, "timesteps_since_restore": 6341443, "time_since_restore": 3778.140242576599, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45819, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd2b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdfd0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-00-56", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 49.65388746313856}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1315.9425396496604, "node_ip": "10.138.0.2", "timesteps_total": 6386834, "iterations_since_restore": 142, "episode_reward_mean": 994.6044144633313, "custom_metrics": {"cost1_min": 29.269659562590867, "cost1_max": 448.08353616872546, "cost1_mean": 339.1246790094532, "system_level_velocity_mean": 14.429412904492454, "cost2_max": -29.325213978460056, "outflow_rate_min": 325.2012645303821, "system_level_velocity_max": 20.281001077482266, "system_level_velocity_min": 11.374052849556758, "outflow_rate_max": 1290.9200830415832, "cost2_mean": -188.2424907895617, "outflow_rate_mean": 1047.4746857330001, "cost2_min": -247.31272873610047}, "training_iteration": 142, "episodes_total": 2108, "episode_len_mean": 641.49, "timestamp": 1557208882, "time_total_s": 3804.661271095276, "pid": 31998, "info": {"num_steps_trained": 6386834, "load_time_ms": 14.03, "num_steps_sampled": 6386834, "grad_time_ms": 9295.194, "sample_time_ms": 17041.036, "update_time_ms": 7.112, "default": {"vf_explained_var": 0.9897007346153259, "vf_loss": 3.6125504970550537, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 3.6090288162231445, "kl": 0.014711673371493816, "policy_loss": -0.006663958076387644, "entropy": 0.9944092631340027}}, "time_this_iter_s": 26.521028518676758, "timesteps_since_restore": 6386834, "time_since_restore": 3804.661271095276, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45391, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668aad30>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865c18>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-01-22", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 49.65388746313856}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1315.9425396496604, "node_ip": "10.138.0.2", "timesteps_total": 6432395, "iterations_since_restore": 143, "episode_reward_mean": 1020.5515738585325, "custom_metrics": {"cost1_min": 29.269659562590867, "cost1_max": 448.08353616872546, "cost1_mean": 347.4567173308203, "system_level_velocity_mean": 14.222880698639496, "cost2_max": -29.325213978460056, "outflow_rate_min": 325.2012645303821, "system_level_velocity_max": 20.126061253567176, "system_level_velocity_min": 11.374052849556758, "outflow_rate_max": 1290.9200830415832, "cost2_mean": -192.2239570541751, "outflow_rate_mean": 1066.4981466025217, "cost2_min": -242.10903671968882}, "training_iteration": 143, "episodes_total": 2119, "episode_len_mean": 659.54, "timestamp": 1557208909, "time_total_s": 3831.098252773285, "pid": 31998, "info": {"num_steps_trained": 6432395, "load_time_ms": 13.67, "num_steps_sampled": 6432395, "grad_time_ms": 9198.0, "sample_time_ms": 17140.453, "update_time_ms": 7.457, "default": {"vf_explained_var": 0.9908179640769958, "vf_loss": 2.9804508686065674, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 2.9753992557525635, "kl": 0.01490525808185339, "policy_loss": -0.008235014043748379, "entropy": 0.9498025178909302}}, "time_this_iter_s": 26.436981678009033, "timesteps_since_restore": 6432395, "time_since_restore": 3831.098252773285, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45561, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfef0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfcf8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-01-49", "hostname": "flow-main", "episodes_this_iter": 11, "episode_reward_min": 49.65388746313856}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1315.9425396496604, "node_ip": "10.138.0.2", "timesteps_total": 6476799, "iterations_since_restore": 144, "episode_reward_mean": 1026.7079138665474, "custom_metrics": {"cost1_min": 29.269659562590867, "cost1_max": 448.08353616872546, "cost1_mean": 348.5730672730188, "system_level_velocity_mean": 14.252729151038821, "cost2_max": -24.98506125474493, "outflow_rate_min": 317.9670165501775, "system_level_velocity_max": 20.126061253567176, "system_level_velocity_min": 11.374052849556758, "outflow_rate_max": 1290.9200830415832, "cost2_mean": -194.10790854423533, "outflow_rate_mean": 1072.757294775326, "cost2_min": -247.24601805269464}, "training_iteration": 144, "episodes_total": 2137, "episode_len_mean": 659.38, "timestamp": 1557208935, "time_total_s": 3857.623924255371, "pid": 31998, "info": {"num_steps_trained": 6476799, "load_time_ms": 13.252, "num_steps_sampled": 6476799, "grad_time_ms": 9147.794, "sample_time_ms": 17173.548, "update_time_ms": 7.609, "default": {"vf_explained_var": 0.9827088117599487, "vf_loss": 6.850147724151611, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 6.847721099853516, "kl": 0.01365785114467144, "policy_loss": -0.005343572236597538, "entropy": 0.9945120215415955}}, "time_this_iter_s": 26.52567148208618, "timesteps_since_restore": 6476799, "time_since_restore": 3857.623924255371, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44404, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ceb38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce438>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cec50>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-02-15", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 49.65388746313856}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1311.1858030039089, "node_ip": "10.138.0.2", "timesteps_total": 6519015, "iterations_since_restore": 145, "episode_reward_mean": 1034.2297431762374, "custom_metrics": {"cost1_min": 29.269659562590867, "cost1_max": 431.84049201403093, "cost1_mean": 351.13444398810526, "system_level_velocity_mean": 14.189809162130178, "cost2_max": -24.98506125474493, "outflow_rate_min": 317.9670165501775, "system_level_velocity_max": 20.126061253567176, "system_level_velocity_min": 11.187445426670024, "outflow_rate_max": 1290.9200830415832, "cost2_mean": -196.27437558292135, "outflow_rate_mean": 1078.5509759048782, "cost2_min": -247.24601805269464}, "training_iteration": 145, "episodes_total": 2156, "episode_len_mean": 665.16, "timestamp": 1557208961, "time_total_s": 3883.4651927948, "pid": 31998, "info": {"num_steps_trained": 6519015, "load_time_ms": 12.816, "num_steps_sampled": 6519015, "grad_time_ms": 9097.909, "sample_time_ms": 17312.368, "update_time_ms": 7.736, "default": {"vf_explained_var": 0.9900919198989868, "vf_loss": 4.015214920043945, "cur_kl_coeff": 0.21357421576976776, "cur_lr": 0.0005000000237487257, "total_loss": 4.011851787567139, "kl": 0.013913237489759922, "policy_loss": -0.006334695499390364, "entropy": 0.981829822063446}}, "time_this_iter_s": 25.84126853942871, "timesteps_since_restore": 6519015, "time_since_restore": 3883.4651927948, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 42216, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf8d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd7f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b46a0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-02-41", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 49.65388746313856}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1352.6622058545443, "node_ip": "10.138.0.2", "timesteps_total": 6564110, "iterations_since_restore": 146, "episode_reward_mean": 1022.4378865786003, "custom_metrics": {"cost1_min": 29.269659562590867, "cost1_max": 431.84049201403093, "cost1_mean": 347.30555050395327, "system_level_velocity_mean": 14.380316510158945, "cost2_max": -24.98506125474493, "outflow_rate_min": 317.9670165501775, "system_level_velocity_max": 20.126061253567176, "system_level_velocity_min": 11.187445426670024, "outflow_rate_max": 1289.2736527086356, "cost2_mean": -194.80684719700443, "outflow_rate_mean": 1071.1130087349943, "cost2_min": -247.24601805269464}, "training_iteration": 146, "episodes_total": 2170, "episode_len_mean": 653.05, "timestamp": 1557208988, "time_total_s": 3910.449385881424, "pid": 31998, "info": {"num_steps_trained": 6564110, "load_time_ms": 12.838, "num_steps_sampled": 6564110, "grad_time_ms": 9088.024, "sample_time_ms": 17327.685, "update_time_ms": 7.751, "default": {"vf_explained_var": 0.9757163524627686, "vf_loss": 7.23206901550293, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 7.227186679840088, "kl": 0.01435854472219944, "policy_loss": -0.00794920977205038, "entropy": 0.934473991394043}}, "time_this_iter_s": 26.984193086624146, "timesteps_since_restore": 6564110, "time_since_restore": 3910.449385881424, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45095, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865c18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865128>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-03-08", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 49.65388746313856}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1352.6622058545443, "node_ip": "10.138.0.2", "timesteps_total": 6610600, "iterations_since_restore": 147, "episode_reward_mean": 1049.425561210711, "custom_metrics": {"cost1_min": 29.675102647797694, "cost1_max": 450.00938068389326, "cost1_mean": 355.37302811215955, "system_level_velocity_mean": 14.394212697007424, "cost2_max": -24.98506125474493, "outflow_rate_min": 317.9670165501775, "system_level_velocity_max": 19.749163285981982, "system_level_velocity_min": 11.187445426670024, "outflow_rate_max": 1274.7566196519276, "cost2_mean": -199.31924678649722, "outflow_rate_mean": 1090.4497712707366, "cost2_min": -247.24601805269464}, "training_iteration": 147, "episodes_total": 2183, "episode_len_mean": 662.33, "timestamp": 1557209015, "time_total_s": 3937.1171481609344, "pid": 31998, "info": {"num_steps_trained": 6610600, "load_time_ms": 12.643, "num_steps_sampled": 6610600, "grad_time_ms": 9061.248, "sample_time_ms": 17404.375, "update_time_ms": 8.096, "default": {"vf_explained_var": 0.9784352779388428, "vf_loss": 7.909599304199219, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 7.906615257263184, "kl": 0.013418305665254593, "policy_loss": -0.005849781911820173, "entropy": 0.9871323704719543}}, "time_this_iter_s": 26.667762279510498, "timesteps_since_restore": 6610600, "time_since_restore": 3937.1171481609344, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 46490, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfe80>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf080>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-03-35", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 54.1046491060447}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1359.8030790762962, "node_ip": "10.138.0.2", "timesteps_total": 6654603, "iterations_since_restore": 148, "episode_reward_mean": 1054.5972616729696, "custom_metrics": {"cost1_min": 29.675102647797694, "cost1_max": 455.67615366018094, "cost1_mean": 357.8393513872289, "system_level_velocity_mean": 14.582618784203273, "cost2_max": -24.98506125474493, "outflow_rate_min": 317.9670165501775, "system_level_velocity_max": 19.749163285981982, "system_level_velocity_min": 11.187445426670024, "outflow_rate_max": 1344.9409111202126, "cost2_mean": -200.17571766395028, "outflow_rate_mean": 1097.3935115083689, "cost2_min": -250.78337859851567}, "training_iteration": 148, "episodes_total": 2201, "episode_len_mean": 658.89, "timestamp": 1557209040, "time_total_s": 3962.4472074508667, "pid": 31998, "info": {"num_steps_trained": 6654603, "load_time_ms": 13.118, "num_steps_sampled": 6654603, "grad_time_ms": 9078.143, "sample_time_ms": 17407.563, "update_time_ms": 8.141, "default": {"vf_explained_var": 0.9860707521438599, "vf_loss": 5.909958362579346, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 5.9059739112854, "kl": 0.015711482614278793, "policy_loss": -0.0073407781310379505, "entropy": 0.9908141493797302}}, "time_this_iter_s": 25.33005928993225, "timesteps_since_restore": 6654603, "time_since_restore": 3962.4472074508667, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44003, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b47f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4ba8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b47b8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-04-00", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 54.1046491060447}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1359.8030790762962, "node_ip": "10.138.0.2", "timesteps_total": 6700170, "iterations_since_restore": 149, "episode_reward_mean": 1056.4592320054307, "custom_metrics": {"cost1_min": 29.52962115974824, "cost1_max": 455.67615366018094, "cost1_mean": 358.002010801786, "system_level_velocity_mean": 14.778190700158508, "cost2_max": -24.98506125474493, "outflow_rate_min": 317.9670165501775, "system_level_velocity_max": 20.302232404400424, "system_level_velocity_min": 11.187445426670024, "outflow_rate_max": 1344.9409111202126, "cost2_mean": -200.88822250913086, "outflow_rate_mean": 1101.0547850569114, "cost2_min": -250.78337859851567}, "training_iteration": 149, "episodes_total": 2218, "episode_len_mean": 652.32, "timestamp": 1557209066, "time_total_s": 3988.5316009521484, "pid": 31998, "info": {"num_steps_trained": 6700170, "load_time_ms": 13.31, "num_steps_sampled": 6700170, "grad_time_ms": 9025.619, "sample_time_ms": 17452.742, "update_time_ms": 8.233, "default": {"vf_explained_var": 0.9844088554382324, "vf_loss": 5.609619617462158, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 5.60584020614624, "kl": 0.015034412033855915, "policy_loss": -0.006990533322095871, "entropy": 1.0012524127960205}}, "time_this_iter_s": 26.08439350128174, "timesteps_since_restore": 6700170, "time_since_restore": 3988.5316009521484, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45567, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cddd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ced68>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdd30>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-04-26", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 49.98489497097787}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1359.8030790762962, "node_ip": "10.138.0.2", "timesteps_total": 6743152, "iterations_since_restore": 150, "episode_reward_mean": 1051.470834203192, "custom_metrics": {"cost1_min": 29.52962115974824, "cost1_max": 475.51311182573147, "cost1_mean": 358.22876263939185, "system_level_velocity_mean": 14.866160671799461, "cost2_max": -31.136760020846292, "outflow_rate_min": 325.2093327816105, "system_level_velocity_max": 20.302232404400424, "system_level_velocity_min": 11.187445426670024, "outflow_rate_max": 1344.9409111202126, "cost2_mean": -200.6583220999688, "outflow_rate_mean": 1100.5576558095051, "cost2_min": -251.31323561008455}, "training_iteration": 150, "episodes_total": 2235, "episode_len_mean": 651.09, "timestamp": 1557209092, "time_total_s": 4014.6106140613556, "pid": 31998, "info": {"num_steps_trained": 6743152, "load_time_ms": 13.261, "num_steps_sampled": 6743152, "grad_time_ms": 8863.891, "sample_time_ms": 17507.072, "update_time_ms": 8.367, "default": {"vf_explained_var": 0.9778461456298828, "vf_loss": 9.044657707214355, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 9.041111946105957, "kl": 0.014950130134820938, "policy_loss": -0.006739113945513964, "entropy": 1.0081325769424438}}, "time_this_iter_s": 26.079013109207153, "timesteps_since_restore": 6743152, "time_since_restore": 4014.6106140613556, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 42982, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf8d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf940>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-04-52", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 49.98489497097787}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1359.8030790762962, "node_ip": "10.138.0.2", "timesteps_total": 6788168, "iterations_since_restore": 151, "episode_reward_mean": 1046.8559435192803, "custom_metrics": {"cost1_min": 29.52962115974824, "cost1_max": 475.51311182573147, "cost1_mean": 356.9803703090043, "system_level_velocity_mean": 15.033235992744501, "cost2_max": -31.136760020846292, "outflow_rate_min": 325.2093327816105, "system_level_velocity_max": 20.302232404400424, "system_level_velocity_min": 12.31270111990114, "outflow_rate_max": 1344.9409111202126, "cost2_mean": -200.31194456832947, "outflow_rate_mean": 1100.2610228384242, "cost2_min": -251.31323561008455}, "training_iteration": 151, "episodes_total": 2249, "episode_len_mean": 642.59, "timestamp": 1557209119, "time_total_s": 4041.059556722641, "pid": 31998, "info": {"num_steps_trained": 6788168, "load_time_ms": 13.837, "num_steps_sampled": 6788168, "grad_time_ms": 8808.54, "sample_time_ms": 17361.801, "update_time_ms": 8.452, "default": {"vf_explained_var": 0.983053982257843, "vf_loss": 5.7419753074646, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 5.737281799316406, "kl": 0.014535561203956604, "policy_loss": -0.007798346225172281, "entropy": 0.9472272992134094}}, "time_this_iter_s": 26.4489426612854, "timesteps_since_restore": 6788168, "time_since_restore": 4041.059556722641, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45016, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865e10>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865588>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-05-19", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 49.98489497097787}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1359.8030790762962, "node_ip": "10.138.0.2", "timesteps_total": 6832037, "iterations_since_restore": 152, "episode_reward_mean": 1054.741844255974, "custom_metrics": {"cost1_min": 29.52962115974824, "cost1_max": 475.51311182573147, "cost1_mean": 360.19588886774443, "system_level_velocity_mean": 15.13574590779719, "cost2_max": -31.136760020846292, "outflow_rate_min": 325.2093327816105, "system_level_velocity_max": 20.302232404400424, "system_level_velocity_min": 12.262617721736564, "outflow_rate_max": 1344.9409111202126, "cost2_mean": -200.27477142678407, "outflow_rate_mean": 1105.7183931277257, "cost2_min": -251.31323561008455}, "training_iteration": 152, "episodes_total": 2265, "episode_len_mean": 642.72, "timestamp": 1557209144, "time_total_s": 4066.2963721752167, "pid": 31998, "info": {"num_steps_trained": 6832037, "load_time_ms": 13.981, "num_steps_sampled": 6832037, "grad_time_ms": 8709.945, "sample_time_ms": 17331.983, "update_time_ms": 8.578, "default": {"vf_explained_var": 0.9852345585823059, "vf_loss": 6.155883312225342, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 6.152392387390137, "kl": 0.013241734355688095, "policy_loss": -0.00631826464086771, "entropy": 1.024330496788025}}, "time_this_iter_s": 25.236815452575684, "timesteps_since_restore": 6832037, "time_since_restore": 4066.2963721752167, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43869, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ceb00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce3c8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b9a90>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-05-44", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 49.98489497097787}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1359.8030790762962, "node_ip": "10.138.0.2", "timesteps_total": 6876810, "iterations_since_restore": 153, "episode_reward_mean": 1054.2168227626755, "custom_metrics": {"cost1_min": 29.52962115974824, "cost1_max": 475.51311182573147, "cost1_mean": 361.92112644031914, "system_level_velocity_mean": 15.050339606147526, "cost2_max": -31.136760020846292, "outflow_rate_min": 325.8735011719416, "system_level_velocity_max": 20.302232404400424, "system_level_velocity_min": 11.943023642177264, "outflow_rate_max": 1344.9409111202126, "cost2_mean": -201.12825337670637, "outflow_rate_mean": 1108.6198528925877, "cost2_min": -251.31323561008455}, "training_iteration": 153, "episodes_total": 2283, "episode_len_mean": 648.22, "timestamp": 1557209170, "time_total_s": 4092.396292924881, "pid": 31998, "info": {"num_steps_trained": 6876810, "load_time_ms": 14.543, "num_steps_sampled": 6876810, "grad_time_ms": 8626.118, "sample_time_ms": 17382.537, "update_time_ms": 8.277, "default": {"vf_explained_var": 0.9781823754310608, "vf_loss": 8.076286315917969, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 8.07211971282959, "kl": 0.015106706880033016, "policy_loss": -0.007392630446702242, "entropy": 1.0482560396194458}}, "time_this_iter_s": 26.099920749664307, "timesteps_since_restore": 6876810, "time_since_restore": 4092.396292924881, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44773, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfeb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfa58>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-06-10", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 49.98489497097787}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1329.6752571344687, "node_ip": "10.138.0.2", "timesteps_total": 6921464, "iterations_since_restore": 154, "episode_reward_mean": 1053.6961889531979, "custom_metrics": {"cost1_min": 29.52962115974824, "cost1_max": 475.51311182573147, "cost1_mean": 362.26070740378526, "system_level_velocity_mean": 14.99462223284327, "cost2_max": -31.136760020846292, "outflow_rate_min": 325.8735011719416, "system_level_velocity_max": 20.302232404400424, "system_level_velocity_min": 11.928306718759385, "outflow_rate_max": 1290.483930445278, "cost2_mean": -201.5625117647214, "outflow_rate_mean": 1110.0115320505706, "cost2_min": -251.31323561008455}, "training_iteration": 154, "episodes_total": 2297, "episode_len_mean": 650.94, "timestamp": 1557209196, "time_total_s": 4118.298968553543, "pid": 31998, "info": {"num_steps_trained": 6921464, "load_time_ms": 14.839, "num_steps_sampled": 6921464, "grad_time_ms": 8616.982, "sample_time_ms": 17330.109, "update_time_ms": 7.994, "default": {"vf_explained_var": 0.9843735694885254, "vf_loss": 5.5570292472839355, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 5.55418586730957, "kl": 0.013470056466758251, "policy_loss": -0.005720250774174929, "entropy": 0.9939630627632141}}, "time_this_iter_s": 25.90267562866211, "timesteps_since_restore": 6921464, "time_since_restore": 4118.298968553543, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44654, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1358>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d14a8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-06-36", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 49.98489497097787}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1329.6752571344687, "node_ip": "10.138.0.2", "timesteps_total": 6966844, "iterations_since_restore": 155, "episode_reward_mean": 1063.5136090663168, "custom_metrics": {"cost1_min": 34.430672444392016, "cost1_max": 475.51311182573147, "cost1_mean": 365.149934368397, "system_level_velocity_mean": 14.909534028005094, "cost2_max": -32.1839434244655, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.786126294473455, "system_level_velocity_min": 11.928306718759385, "outflow_rate_max": 1290.483930445278, "cost2_mean": -202.09130319000369, "outflow_rate_mean": 1115.0175078193593, "cost2_min": -251.31323561008455}, "training_iteration": 155, "episodes_total": 2309, "episode_len_mean": 657.51, "timestamp": 1557209223, "time_total_s": 4145.320276260376, "pid": 31998, "info": {"num_steps_trained": 6966844, "load_time_ms": 15.282, "num_steps_sampled": 6966844, "grad_time_ms": 8564.73, "sample_time_ms": 17500.745, "update_time_ms": 7.686, "default": {"vf_explained_var": 0.9913883805274963, "vf_loss": 3.0386099815368652, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 3.035952091217041, "kl": 0.01377395074814558, "policy_loss": -0.005599679425358772, "entropy": 1.0077855587005615}}, "time_this_iter_s": 27.021307706832886, "timesteps_since_restore": 6966844, "time_since_restore": 4145.320276260376, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45380, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668654a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668655f8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668650f0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-07-03", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 59.47314773916722}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1306.5929563607867, "node_ip": "10.138.0.2", "timesteps_total": 7009810, "iterations_since_restore": 156, "episode_reward_mean": 1059.6084703704987, "custom_metrics": {"cost1_min": 34.430672444392016, "cost1_max": 464.8750725934623, "cost1_mean": 363.79597831642263, "system_level_velocity_mean": 14.771044712945717, "cost2_max": -32.1839434244655, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.502302459674087, "system_level_velocity_min": 11.928306718759385, "outflow_rate_max": 1290.483930445278, "cost2_mean": -202.796891888794, "outflow_rate_mean": 1111.7178319233394, "cost2_min": -239.31598033430035}, "training_iteration": 156, "episodes_total": 2328, "episode_len_mean": 660.13, "timestamp": 1557209249, "time_total_s": 4171.422658205032, "pid": 31998, "info": {"num_steps_trained": 7009810, "load_time_ms": 15.354, "num_steps_sampled": 7009810, "grad_time_ms": 8547.02, "sample_time_ms": 17429.508, "update_time_ms": 7.947, "default": {"vf_explained_var": 0.989150881767273, "vf_loss": 4.183509349822998, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 4.1784515380859375, "kl": 0.01532518770545721, "policy_loss": -0.008330235257744789, "entropy": 1.0159049034118652}}, "time_this_iter_s": 26.102381944656372, "timesteps_since_restore": 7009810, "time_since_restore": 4171.422658205032, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 42966, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ceb70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cea20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ceef0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-07-29", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 59.47314773916722}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1306.5929563607867, "node_ip": "10.138.0.2", "timesteps_total": 7054292, "iterations_since_restore": 157, "episode_reward_mean": 1070.035699741458, "custom_metrics": {"cost1_min": 34.430672444392016, "cost1_max": 464.8750725934623, "cost1_mean": 366.200037520747, "system_level_velocity_mean": 14.681859990776895, "cost2_max": -32.1839434244655, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.363582389612723, "system_level_velocity_min": 11.923595190052284, "outflow_rate_max": 1278.3474400454643, "cost2_mean": -203.47357012033436, "outflow_rate_mean": 1117.360143179791, "cost2_min": -239.31598033430035}, "training_iteration": 157, "episodes_total": 2341, "episode_len_mean": 665.89, "timestamp": 1557209275, "time_total_s": 4196.917067289352, "pid": 31998, "info": {"num_steps_trained": 7054292, "load_time_ms": 15.482, "num_steps_sampled": 7054292, "grad_time_ms": 8525.713, "sample_time_ms": 17332.866, "update_time_ms": 7.909, "default": {"vf_explained_var": 0.9925292730331421, "vf_loss": 2.8602688312530518, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 2.8556461334228516, "kl": 0.014084093272686005, "policy_loss": -0.007630733773112297, "entropy": 1.0258769989013672}}, "time_this_iter_s": 25.49440908432007, "timesteps_since_restore": 7054292, "time_since_restore": 4196.917067289352, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44482, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfa58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf400>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-07-55", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 59.47314773916722}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1306.5929563607867, "node_ip": "10.138.0.2", "timesteps_total": 7100267, "iterations_since_restore": 158, "episode_reward_mean": 1076.370460609875, "custom_metrics": {"cost1_min": 34.430672444392016, "cost1_max": 464.8750725934623, "cost1_mean": 368.22427644758466, "system_level_velocity_mean": 14.546327373625852, "cost2_max": -32.1839434244655, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.363582389612723, "system_level_velocity_min": 10.830858525620858, "outflow_rate_max": 1278.3474400454643, "cost2_mean": -203.58443774103796, "outflow_rate_mean": 1121.21585320993, "cost2_min": -250.18811175358178}, "training_iteration": 158, "episodes_total": 2355, "episode_len_mean": 674.39, "timestamp": 1557209302, "time_total_s": 4223.932478427887, "pid": 31998, "info": {"num_steps_trained": 7100267, "load_time_ms": 15.335, "num_steps_sampled": 7100267, "grad_time_ms": 8639.573, "sample_time_ms": 17388.331, "update_time_ms": 7.845, "default": {"vf_explained_var": 0.9913751482963562, "vf_loss": 3.309738874435425, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 3.305849075317383, "kl": 0.014856983907520771, "policy_loss": -0.007063055410981178, "entropy": 1.0286067724227905}}, "time_this_iter_s": 27.015411138534546, "timesteps_since_restore": 7100267, "time_since_restore": 4223.932478427887, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45975, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cef98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ceba8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce978>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-08-22", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 59.47314773916722}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1306.5929563607867, "node_ip": "10.138.0.2", "timesteps_total": 7145079, "iterations_since_restore": 159, "episode_reward_mean": 1080.0639797594317, "custom_metrics": {"cost1_min": 29.474692601315297, "cost1_max": 450.6825616053501, "cost1_mean": 369.73973894694007, "system_level_velocity_mean": 14.541209431347008, "cost2_max": -29.756166697832324, "outflow_rate_min": 326.2713828205716, "system_level_velocity_max": 20.117479419254778, "system_level_velocity_min": 10.830858525620858, "outflow_rate_max": 1278.0032712177644, "cost2_mean": -202.6142300316025, "outflow_rate_mean": 1122.8239308309503, "cost2_min": -250.18811175358178}, "training_iteration": 159, "episodes_total": 2373, "episode_len_mean": 678.14, "timestamp": 1557209329, "time_total_s": 4250.739008665085, "pid": 31998, "info": {"num_steps_trained": 7145079, "load_time_ms": 15.231, "num_steps_sampled": 7145079, "grad_time_ms": 8739.609, "sample_time_ms": 17365.055, "update_time_ms": 7.798, "default": {"vf_explained_var": 0.987628161907196, "vf_loss": 5.416636943817139, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 5.411221981048584, "kl": 0.015526913106441498, "policy_loss": -0.008731389418244362, "entropy": 1.0620146989822388}}, "time_this_iter_s": 26.806530237197876, "timesteps_since_restore": 7145079, "time_since_restore": 4250.739008665085, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44812, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668656d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865550>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865278>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-08-49", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 53.78395717628853}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1320.8233540243207, "node_ip": "10.138.0.2", "timesteps_total": 7191197, "iterations_since_restore": 160, "episode_reward_mean": 1095.2138699122318, "custom_metrics": {"cost1_min": 29.474692601315297, "cost1_max": 441.69154674975186, "cost1_mean": 374.17056025436233, "system_level_velocity_mean": 14.384213562679086, "cost2_max": -29.756166697832324, "outflow_rate_min": 326.2713828205716, "system_level_velocity_max": 20.117479419254778, "system_level_velocity_min": 10.830858525620858, "outflow_rate_max": 1276.5632867450397, "cost2_mean": -205.17703346784202, "outflow_rate_mean": 1135.2605495211824, "cost2_min": -250.18811175358178}, "training_iteration": 160, "episodes_total": 2385, "episode_len_mean": 690.12, "timestamp": 1557209355, "time_total_s": 4277.171298503876, "pid": 31998, "info": {"num_steps_trained": 7191197, "load_time_ms": 15.577, "num_steps_sampled": 7191197, "grad_time_ms": 8944.132, "sample_time_ms": 17195.688, "update_time_ms": 7.744, "default": {"vf_explained_var": 0.9917118549346924, "vf_loss": 3.136826276779175, "cur_kl_coeff": 0.21357420086860657, "cur_lr": 0.0005000000237487257, "total_loss": 3.1332828998565674, "kl": 0.015033349394798279, "policy_loss": -0.006754404865205288, "entropy": 1.0372684001922607}}, "time_this_iter_s": 26.432289838790894, "timesteps_since_restore": 7191197, "time_since_restore": 4277.171298503876, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 46118, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1198>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1400>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-09-15", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 53.78395717628853}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1320.8233540243207, "node_ip": "10.138.0.2", "timesteps_total": 7235449, "iterations_since_restore": 161, "episode_reward_mean": 1074.8460108937934, "custom_metrics": {"cost1_min": 29.474692601315297, "cost1_max": 441.69154674975186, "cost1_mean": 367.9737982125186, "system_level_velocity_mean": 14.54264841504007, "cost2_max": -29.756166697832324, "outflow_rate_min": 326.2713828205716, "system_level_velocity_max": 20.117479419254778, "system_level_velocity_min": 10.830858525620858, "outflow_rate_max": 1292.3315214894353, "cost2_mean": -200.77582105593012, "outflow_rate_mean": 1119.8722091272255, "cost2_min": -250.18811175358178}, "training_iteration": 161, "episodes_total": 2403, "episode_len_mean": 674.77, "timestamp": 1557209382, "time_total_s": 4303.515677928925, "pid": 31998, "info": {"num_steps_trained": 7235449, "load_time_ms": 15.609, "num_steps_sampled": 7235449, "grad_time_ms": 8932.557, "sample_time_ms": 17200.645, "update_time_ms": 7.434, "default": {"vf_explained_var": 0.9773932099342346, "vf_loss": 8.443015098571777, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 8.439202308654785, "kl": 0.01593540608882904, "policy_loss": -0.007216289639472961, "entropy": 1.0283262729644775}}, "time_this_iter_s": 26.344379425048828, "timesteps_since_restore": 7235449, "time_since_restore": 4303.515677928925, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44252, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4c88>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4d68>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-09-42", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 53.78395717628853}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1320.8233540243207, "node_ip": "10.138.0.2", "timesteps_total": 7279293, "iterations_since_restore": 162, "episode_reward_mean": 1075.6339426135044, "custom_metrics": {"cost1_min": 29.474692601315297, "cost1_max": 441.69154674975186, "cost1_mean": 367.7303320922163, "system_level_velocity_mean": 14.454285344140006, "cost2_max": -29.756166697832324, "outflow_rate_min": 326.2713828205716, "system_level_velocity_max": 20.117479419254778, "system_level_velocity_min": 10.031335696631999, "outflow_rate_max": 1292.3315214894353, "cost2_mean": -200.3384232022684, "outflow_rate_mean": 1117.0314273191393, "cost2_min": -250.18811175358178}, "training_iteration": 162, "episodes_total": 2419, "episode_len_mean": 678.08, "timestamp": 1557209408, "time_total_s": 4329.489217996597, "pid": 31998, "info": {"num_steps_trained": 7279293, "load_time_ms": 15.41, "num_steps_sampled": 7279293, "grad_time_ms": 9094.898, "sample_time_ms": 17112.974, "update_time_ms": 7.172, "default": {"vf_explained_var": 0.9924680590629578, "vf_loss": 3.03507661819458, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 3.0326428413391113, "kl": 0.013899763114750385, "policy_loss": -0.005402571987360716, "entropy": 1.0546950101852417}}, "time_this_iter_s": 25.97354006767273, "timesteps_since_restore": 7279293, "time_since_restore": 4329.489217996597, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43844, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d12b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7978>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-10-08", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 53.78395717628853}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1364.9980898376923, "node_ip": "10.138.0.2", "timesteps_total": 7323403, "iterations_since_restore": 163, "episode_reward_mean": 1062.5251666752085, "custom_metrics": {"cost1_min": 29.474692601315297, "cost1_max": 441.69154674975186, "cost1_mean": 365.9622439631764, "system_level_velocity_mean": 14.545817724229837, "cost2_max": -29.756166697832324, "outflow_rate_min": 326.2713828205716, "system_level_velocity_max": 20.117479419254778, "system_level_velocity_min": 10.031335696631999, "outflow_rate_max": 1300.5311760453965, "cost2_mean": -197.438675727724, "outflow_rate_mean": 1111.2298712895354, "cost2_min": -250.18811175358178}, "training_iteration": 163, "episodes_total": 2432, "episode_len_mean": 672.17, "timestamp": 1557209434, "time_total_s": 4355.881341218948, "pid": 31998, "info": {"num_steps_trained": 7323403, "load_time_ms": 15.286, "num_steps_sampled": 7323403, "grad_time_ms": 9221.329, "sample_time_ms": 17016.742, "update_time_ms": 7.296, "default": {"vf_explained_var": 0.9776176810264587, "vf_loss": 7.385034084320068, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 7.379879474639893, "kl": 0.015179461799561977, "policy_loss": -0.008396057412028313, "entropy": 1.0380605459213257}}, "time_this_iter_s": 26.392123222351074, "timesteps_since_restore": 7323403, "time_since_restore": 4355.881341218948, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44110, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668655f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668654e0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865278>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-10-34", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 53.78395717628853}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1364.9980898376923, "node_ip": "10.138.0.2", "timesteps_total": 7367044, "iterations_since_restore": 164, "episode_reward_mean": 1053.647177616732, "custom_metrics": {"cost1_min": 29.474692601315297, "cost1_max": 441.69154674975186, "cost1_mean": 365.1436914509214, "system_level_velocity_mean": 14.600151270225256, "cost2_max": -29.756166697832324, "outflow_rate_min": 326.2713828205716, "system_level_velocity_max": 20.117479419254778, "system_level_velocity_min": 10.031335696631999, "outflow_rate_max": 1300.5311760453965, "cost2_mean": -195.84504042051339, "outflow_rate_mean": 1109.979790351849, "cost2_min": -247.9638797517901}, "training_iteration": 164, "episodes_total": 2451, "episode_len_mean": 669.21, "timestamp": 1557209462, "time_total_s": 4383.295283079147, "pid": 31998, "info": {"num_steps_trained": 7367044, "load_time_ms": 14.621, "num_steps_sampled": 7367044, "grad_time_ms": 9193.672, "sample_time_ms": 17196.991, "update_time_ms": 7.326, "default": {"vf_explained_var": 0.9816523194313049, "vf_loss": 7.209637641906738, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 7.204441070556641, "kl": 0.015939861536026, "policy_loss": -0.008600343950092793, "entropy": 1.061654806137085}}, "time_this_iter_s": 27.413941860198975, "timesteps_since_restore": 7367044, "time_since_restore": 4383.295283079147, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43641, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668accc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668b4080>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac1d0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-11-02", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 53.78395717628853}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1364.9980898376923, "node_ip": "10.138.0.2", "timesteps_total": 7411965, "iterations_since_restore": 165, "episode_reward_mean": 1055.0796174770117, "custom_metrics": {"cost1_min": 74.16151522267882, "cost1_max": 441.69154674975186, "cost1_mean": 364.05843720885815, "system_level_velocity_mean": 14.494570467242982, "cost2_max": -51.49549114538753, "outflow_rate_min": 385.75400008268235, "system_level_velocity_max": 19.35263706512566, "system_level_velocity_min": 10.031335696631999, "outflow_rate_max": 1317.8670505903413, "cost2_mean": -196.6606442481711, "outflow_rate_mean": 1111.399759692153, "cost2_min": -247.9638797517901}, "training_iteration": 165, "episodes_total": 2466, "episode_len_mean": 670.74, "timestamp": 1557209489, "time_total_s": 4410.636069059372, "pid": 31998, "info": {"num_steps_trained": 7411965, "load_time_ms": 14.455, "num_steps_sampled": 7411965, "grad_time_ms": 9256.645, "sample_time_ms": 17164.895, "update_time_ms": 7.487, "default": {"vf_explained_var": 0.9868234395980835, "vf_loss": 4.9257683753967285, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 4.921667098999023, "kl": 0.01664266549050808, "policy_loss": -0.0076557607389986515, "entropy": 1.0884915590286255}}, "time_this_iter_s": 27.34078598022461, "timesteps_since_restore": 7411965, "time_since_restore": 4410.636069059372, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44921, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668654a8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668658d0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-11-29", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 175.25889675888607}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1364.9980898376923, "node_ip": "10.138.0.2", "timesteps_total": 7457389, "iterations_since_restore": 166, "episode_reward_mean": 1030.6762073353798, "custom_metrics": {"cost1_min": 29.089119261109484, "cost1_max": 435.59906007863765, "cost1_mean": 356.5069590100479, "system_level_velocity_mean": 14.566236967410726, "cost2_max": -26.027439826564592, "outflow_rate_min": 317.9670165501775, "system_level_velocity_max": 19.74268276493974, "system_level_velocity_min": 10.031335696631999, "outflow_rate_max": 1317.8670505903413, "cost2_mean": -193.31557266307922, "outflow_rate_mean": 1095.9291083312364, "cost2_min": -247.9638797517901}, "training_iteration": 166, "episodes_total": 2479, "episode_len_mean": 657.61, "timestamp": 1557209515, "time_total_s": 4436.741805076599, "pid": 31998, "info": {"num_steps_trained": 7457389, "load_time_ms": 14.296, "num_steps_sampled": 7457389, "grad_time_ms": 9186.016, "sample_time_ms": 17236.969, "update_time_ms": 7.383, "default": {"vf_explained_var": 0.9786809682846069, "vf_loss": 7.207147598266602, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 7.2014265060424805, "kl": 0.014315812848508358, "policy_loss": -0.008779510855674744, "entropy": 1.050539493560791}}, "time_this_iter_s": 26.105736017227173, "timesteps_since_restore": 7457389, "time_since_restore": 4436.741805076599, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45424, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf2b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfc50>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-11-55", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 52.35867388789881}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1364.9980898376923, "node_ip": "10.138.0.2", "timesteps_total": 7501201, "iterations_since_restore": 167, "episode_reward_mean": 1040.5605725016553, "custom_metrics": {"cost1_min": 29.089119261109484, "cost1_max": 460.05800202054905, "cost1_mean": 358.7025433157145, "system_level_velocity_mean": 14.49369535075664, "cost2_max": -26.027439826564592, "outflow_rate_min": 317.9670165501775, "system_level_velocity_max": 19.74268276493974, "system_level_velocity_min": 10.031335696631999, "outflow_rate_max": 1317.8670505903413, "cost2_mean": -194.64400746245983, "outflow_rate_mean": 1106.1315293098671, "cost2_min": -247.9638797517901}, "training_iteration": 167, "episodes_total": 2498, "episode_len_mean": 662.72, "timestamp": 1557209540, "time_total_s": 4461.977126598358, "pid": 31998, "info": {"num_steps_trained": 7501201, "load_time_ms": 13.83, "num_steps_sampled": 7501201, "grad_time_ms": 9077.343, "sample_time_ms": 17319.481, "update_time_ms": 7.117, "default": {"vf_explained_var": 0.9732192158699036, "vf_loss": 9.58697509765625, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 9.582926750183105, "kl": 0.01606982760131359, "policy_loss": -0.007479358930140734, "entropy": 1.0425325632095337}}, "time_this_iter_s": 25.235321521759033, "timesteps_since_restore": 7501201, "time_since_restore": 4461.977126598358, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43812, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf400>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1320>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-12-20", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 52.35867388789881}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1364.9980898376923, "node_ip": "10.138.0.2", "timesteps_total": 7545477, "iterations_since_restore": 168, "episode_reward_mean": 1040.3073826683567, "custom_metrics": {"cost1_min": 29.089119261109484, "cost1_max": 460.05800202054905, "cost1_mean": 356.79345829323944, "system_level_velocity_mean": 14.419052558874357, "cost2_max": -26.027439826564592, "outflow_rate_min": 317.9670165501775, "system_level_velocity_max": 19.74268276493974, "system_level_velocity_min": 10.031335696631999, "outflow_rate_max": 1317.8670505903413, "cost2_mean": -194.96954594532326, "outflow_rate_mean": 1103.8199087753687, "cost2_min": -247.9638797517901}, "training_iteration": 168, "episodes_total": 2512, "episode_len_mean": 662.72, "timestamp": 1557209567, "time_total_s": 4489.10117149353, "pid": 31998, "info": {"num_steps_trained": 7545477, "load_time_ms": 13.366, "num_steps_sampled": 7545477, "grad_time_ms": 8952.837, "sample_time_ms": 17456.037, "update_time_ms": 7.394, "default": {"vf_explained_var": 0.9862945079803467, "vf_loss": 4.625870227813721, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 4.622226238250732, "kl": 0.014672770164906979, "policy_loss": -0.00677777174860239, "entropy": 1.0574040412902832}}, "time_this_iter_s": 27.12404489517212, "timesteps_since_restore": 7545477, "time_since_restore": 4489.10117149353, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44276, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1b00>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1f98>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-12-47", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 52.35867388789881}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1336.2625002582286, "node_ip": "10.138.0.2", "timesteps_total": 7591845, "iterations_since_restore": 169, "episode_reward_mean": 1047.14219886153, "custom_metrics": {"cost1_min": 29.089119261109484, "cost1_max": 460.05800202054905, "cost1_mean": 358.125221069876, "system_level_velocity_mean": 14.410431489069284, "cost2_max": -26.027439826564592, "outflow_rate_min": 317.9670165501775, "system_level_velocity_max": 19.74268276493974, "system_level_velocity_min": 11.30340282797595, "outflow_rate_max": 1317.8670505903413, "cost2_mean": -196.53180021233788, "outflow_rate_mean": 1111.5284866063612, "cost2_min": -249.3459896686034}, "training_iteration": 169, "episodes_total": 2526, "episode_len_mean": 664.66, "timestamp": 1557209594, "time_total_s": 4515.510670900345, "pid": 31998, "info": {"num_steps_trained": 7591845, "load_time_ms": 13.547, "num_steps_sampled": 7591845, "grad_time_ms": 8882.799, "sample_time_ms": 17484.343, "update_time_ms": 7.484, "default": {"vf_explained_var": 0.9864662289619446, "vf_loss": 4.420767784118652, "cur_kl_coeff": 0.21357420086860657, "cur_lr": 0.0005000000237487257, "total_loss": 4.416943073272705, "kl": 0.014968371950089931, "policy_loss": -0.007021708879619837, "entropy": 1.0272984504699707}}, "time_this_iter_s": 26.409499406814575, "timesteps_since_restore": 7591845, "time_since_restore": 4515.510670900345, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 46368, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac198>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac9e8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-13-14", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 52.35867388789881}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1336.2625002582286, "node_ip": "10.138.0.2", "timesteps_total": 7636691, "iterations_since_restore": 170, "episode_reward_mean": 1054.1654688003973, "custom_metrics": {"cost1_min": 29.089119261109484, "cost1_max": 460.05800202054905, "cost1_mean": 357.6684862584113, "system_level_velocity_mean": 14.30229096025267, "cost2_max": -26.027439826564592, "outflow_rate_min": 317.9670165501775, "system_level_velocity_max": 19.74268276493974, "system_level_velocity_min": 10.234083424724359, "outflow_rate_max": 1317.8670505903413, "cost2_mean": -198.16499750076474, "outflow_rate_mean": 1113.2121720154146, "cost2_min": -249.3459896686034}, "training_iteration": 170, "episodes_total": 2540, "episode_len_mean": 667.62, "timestamp": 1557209620, "time_total_s": 4541.983785390854, "pid": 31998, "info": {"num_steps_trained": 7636691, "load_time_ms": 13.197, "num_steps_sampled": 7636691, "grad_time_ms": 8805.432, "sample_time_ms": 17565.799, "update_time_ms": 7.845, "default": {"vf_explained_var": 0.9909176826477051, "vf_loss": 3.1927649974823, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 3.189095973968506, "kl": 0.014197970740497112, "policy_loss": -0.006701342761516571, "entropy": 1.030360460281372}}, "time_this_iter_s": 26.473114490509033, "timesteps_since_restore": 7636691, "time_since_restore": 4541.983785390854, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44846, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668acda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac828>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-13-40", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 52.35867388789881}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1336.2625002582286, "node_ip": "10.138.0.2", "timesteps_total": 7680405, "iterations_since_restore": 171, "episode_reward_mean": 1061.8685461757198, "custom_metrics": {"cost1_min": 29.089119261109484, "cost1_max": 460.05800202054905, "cost1_mean": 358.0165572227168, "system_level_velocity_mean": 14.305153677403391, "cost2_max": -26.027439826564592, "outflow_rate_min": 317.9670165501775, "system_level_velocity_max": 19.74268276493974, "system_level_velocity_min": 10.234083424724359, "outflow_rate_max": 1317.8670505903413, "cost2_mean": -199.57944265756055, "outflow_rate_mean": 1117.0779328504757, "cost2_min": -249.3459896686034}, "training_iteration": 171, "episodes_total": 2556, "episode_len_mean": 667.62, "timestamp": 1557209646, "time_total_s": 4567.560405731201, "pid": 31998, "info": {"num_steps_trained": 7680405, "load_time_ms": 13.204, "num_steps_sampled": 7680405, "grad_time_ms": 8821.309, "sample_time_ms": 17470.267, "update_time_ms": 8.0, "default": {"vf_explained_var": 0.9904240369796753, "vf_loss": 3.492138147354126, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 3.486724376678467, "kl": 0.016049904748797417, "policy_loss": -0.008841781876981258, "entropy": 1.0442519187927246}}, "time_this_iter_s": 25.57662034034729, "timesteps_since_restore": 7680405, "time_since_restore": 4567.560405731201, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43714, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1208>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-14-06", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 52.35867388789881}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1331.3579459642344, "node_ip": "10.138.0.2", "timesteps_total": 7724992, "iterations_since_restore": 172, "episode_reward_mean": 1060.7166738606415, "custom_metrics": {"cost1_min": 29.089119261109484, "cost1_max": 460.05800202054905, "cost1_mean": 358.4897133282256, "system_level_velocity_mean": 14.330906477971341, "cost2_max": -26.911125876941192, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 19.74268276493974, "system_level_velocity_min": 10.234083424724359, "outflow_rate_max": 1291.3311360133034, "cost2_mean": -200.43368328786875, "outflow_rate_mean": 1117.2455461245452, "cost2_min": -249.3459896686034}, "training_iteration": 172, "episodes_total": 2572, "episode_len_mean": 667.71, "timestamp": 1557209673, "time_total_s": 4594.8471484184265, "pid": 31998, "info": {"num_steps_trained": 7724992, "load_time_ms": 13.286, "num_steps_sampled": 7724992, "grad_time_ms": 8834.813, "sample_time_ms": 17586.982, "update_time_ms": 8.262, "default": {"vf_explained_var": 0.9844852089881897, "vf_loss": 5.479007244110107, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 5.476938724517822, "kl": 0.01622910425066948, "policy_loss": -0.005534640979021788, "entropy": 1.0521190166473389}}, "time_this_iter_s": 27.286742687225342, "timesteps_since_restore": 7724992, "time_since_restore": 4594.8471484184265, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44587, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce9e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce470>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-14-33", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 52.86825980173755}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1374.1554471086476, "node_ip": "10.138.0.2", "timesteps_total": 7768108, "iterations_since_restore": 173, "episode_reward_mean": 1052.8417065913081, "custom_metrics": {"cost1_min": 29.18714324679913, "cost1_max": 428.86811452748987, "cost1_mean": 355.8570626558143, "system_level_velocity_mean": 14.250192334772226, "cost2_max": -29.320340054438844, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 19.727072228158203, "system_level_velocity_min": 10.234083424724359, "outflow_rate_max": 1291.3311360133034, "cost2_mean": -199.94052134590547, "outflow_rate_mean": 1110.937262496391, "cost2_min": -249.3459896686034}, "training_iteration": 173, "episodes_total": 2587, "episode_len_mean": 667.36, "timestamp": 1557209699, "time_total_s": 4620.777250528336, "pid": 31998, "info": {"num_steps_trained": 7768108, "load_time_ms": 13.343, "num_steps_sampled": 7768108, "grad_time_ms": 8766.008, "sample_time_ms": 17608.403, "update_time_ms": 8.313, "default": {"vf_explained_var": 0.9895206689834595, "vf_loss": 4.103330135345459, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 4.09831428527832, "kl": 0.013902664184570312, "policy_loss": -0.007985053583979607, "entropy": 1.0624717473983765}}, "time_this_iter_s": 25.930102109909058, "timesteps_since_restore": 7768108, "time_since_restore": 4620.777250528336, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43116, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd5f8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd8d0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-14-59", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 49.67713921079467}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1374.1554471086476, "node_ip": "10.138.0.2", "timesteps_total": 7813761, "iterations_since_restore": 174, "episode_reward_mean": 1067.6004619729024, "custom_metrics": {"cost1_min": 29.18714324679913, "cost1_max": 429.2725959945182, "cost1_mean": 359.2216934923602, "system_level_velocity_mean": 14.251910341951621, "cost2_max": -29.320340054438844, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 19.727072228158203, "system_level_velocity_min": 10.234083424724359, "outflow_rate_max": 1291.3311360133034, "cost2_mean": -202.45707731381574, "outflow_rate_mean": 1118.1743059990051, "cost2_min": -249.3459896686034}, "training_iteration": 174, "episodes_total": 2603, "episode_len_mean": 671.99, "timestamp": 1557209727, "time_total_s": 4648.308332204819, "pid": 31998, "info": {"num_steps_trained": 7813761, "load_time_ms": 14.212, "num_steps_sampled": 7813761, "grad_time_ms": 8911.205, "sample_time_ms": 17471.914, "update_time_ms": 8.461, "default": {"vf_explained_var": 0.9829025268554688, "vf_loss": 5.084489345550537, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 5.082179546356201, "kl": 0.012243187986314297, "policy_loss": -0.004924870561808348, "entropy": 1.0013777017593384}}, "time_this_iter_s": 27.531081676483154, "timesteps_since_restore": 7813761, "time_since_restore": 4648.308332204819, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45653, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668acf60>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac438>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-15-27", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 49.67713921079467}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1374.1554471086476, "node_ip": "10.138.0.2", "timesteps_total": 7859558, "iterations_since_restore": 175, "episode_reward_mean": 1042.100878501521, "custom_metrics": {"cost1_min": 29.18714324679913, "cost1_max": 429.2725959945182, "cost1_mean": 351.63404031330305, "system_level_velocity_mean": 14.380031214513433, "cost2_max": -27.340431387411417, "outflow_rate_min": 315.9082719236049, "system_level_velocity_max": 19.727072228158203, "system_level_velocity_min": 10.234083424724359, "outflow_rate_max": 1298.0165080274223, "cost2_mean": -198.48161940113718, "outflow_rate_mean": 1100.5770492577417, "cost2_min": -249.3459896686034}, "training_iteration": 175, "episodes_total": 2618, "episode_len_mean": 656.4, "timestamp": 1557209753, "time_total_s": 4674.753090143204, "pid": 31998, "info": {"num_steps_trained": 7859558, "load_time_ms": 14.26, "num_steps_sampled": 7859558, "grad_time_ms": 9047.102, "sample_time_ms": 17245.519, "update_time_ms": 8.417, "default": {"vf_explained_var": 0.9780027866363525, "vf_loss": 6.983089447021484, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 6.978956699371338, "kl": 0.01773727312684059, "policy_loss": -0.007920998148620129, "entropy": 1.0210413932800293}}, "time_this_iter_s": 26.44475793838501, "timesteps_since_restore": 7859558, "time_since_restore": 4674.753090143204, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45797, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668652b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865470>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-15-53", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 49.67713921079467}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1374.1554471086476, "node_ip": "10.138.0.2", "timesteps_total": 7902205, "iterations_since_restore": 176, "episode_reward_mean": 1036.5712777985473, "custom_metrics": {"cost1_min": 29.18714324679913, "cost1_max": 429.2725959945182, "cost1_mean": 348.4474155091479, "system_level_velocity_mean": 14.41604726289652, "cost2_max": -27.340431387411417, "outflow_rate_min": 315.9082719236049, "system_level_velocity_max": 19.727072228158203, "system_level_velocity_min": 11.972850198627338, "outflow_rate_max": 1298.0165080274223, "cost2_mean": -195.777154454804, "outflow_rate_mean": 1090.7977355246812, "cost2_min": -234.66422131708782}, "training_iteration": 176, "episodes_total": 2637, "episode_len_mean": 650.47, "timestamp": 1557209780, "time_total_s": 4701.4710557460785, "pid": 31998, "info": {"num_steps_trained": 7902205, "load_time_ms": 14.49, "num_steps_sampled": 7902205, "grad_time_ms": 9181.966, "sample_time_ms": 17170.82, "update_time_ms": 8.352, "default": {"vf_explained_var": 0.9887139201164246, "vf_loss": 4.72900390625, "cur_kl_coeff": 0.21357420086860657, "cur_lr": 0.0005000000237487257, "total_loss": 4.724797248840332, "kl": 0.014301391318440437, "policy_loss": -0.007261280436068773, "entropy": 1.0801455974578857}}, "time_this_iter_s": 26.717965602874756, "timesteps_since_restore": 7902205, "time_since_restore": 4701.4710557460785, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 42647, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cee48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce0b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce470>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-16-20", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 49.67713921079467}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1374.1554471086476, "node_ip": "10.138.0.2", "timesteps_total": 7947387, "iterations_since_restore": 177, "episode_reward_mean": 1037.3294052123713, "custom_metrics": {"cost1_min": 29.18714324679913, "cost1_max": 429.2725959945182, "cost1_mean": 348.63864123402317, "system_level_velocity_mean": 14.421767996644771, "cost2_max": -27.340431387411417, "outflow_rate_min": 315.9082719236049, "system_level_velocity_max": 19.727072228158203, "system_level_velocity_min": 11.972850198627338, "outflow_rate_max": 1298.0165080274223, "cost2_mean": -194.99743322092488, "outflow_rate_mean": 1086.8268655227287, "cost2_min": -234.66422131708782}, "training_iteration": 177, "episodes_total": 2648, "episode_len_mean": 650.47, "timestamp": 1557209807, "time_total_s": 4728.291100978851, "pid": 31998, "info": {"num_steps_trained": 7947387, "load_time_ms": 14.493, "num_steps_sampled": 7947387, "grad_time_ms": 9410.008, "sample_time_ms": 17102.702, "update_time_ms": 8.631, "default": {"vf_explained_var": 0.9872452020645142, "vf_loss": 3.973825693130493, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 3.969346523284912, "kl": 0.014062396250665188, "policy_loss": -0.007482546381652355, "entropy": 1.0157814025878906}}, "time_this_iter_s": 26.820045232772827, "timesteps_since_restore": 7947387, "time_since_restore": 4728.291100978851, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45182, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd8d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ced68>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd5f8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-16-47", "hostname": "flow-main", "episodes_this_iter": 11, "episode_reward_min": 49.67713921079467}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1388.1758228454457, "node_ip": "10.138.0.2", "timesteps_total": 7992079, "iterations_since_restore": 178, "episode_reward_mean": 1043.5516852100036, "custom_metrics": {"cost1_min": 29.18714324679913, "cost1_max": 429.2725959945182, "cost1_mean": 349.08342378742856, "system_level_velocity_mean": 14.405739746526836, "cost2_max": -27.340431387411417, "outflow_rate_min": 315.9082719236049, "system_level_velocity_max": 19.727072228158203, "system_level_velocity_min": 11.972850198627338, "outflow_rate_max": 1308.6281516756044, "cost2_mean": -194.19445893526762, "outflow_rate_mean": 1087.7360646483744, "cost2_min": -234.66422131708782}, "training_iteration": 178, "episodes_total": 2664, "episode_len_mean": 650.99, "timestamp": 1557209833, "time_total_s": 4754.62427687645, "pid": 31998, "info": {"num_steps_trained": 7992079, "load_time_ms": 14.749, "num_steps_sampled": 7992079, "grad_time_ms": 9517.358, "sample_time_ms": 16916.586, "update_time_ms": 8.492, "default": {"vf_explained_var": 0.9817549586296082, "vf_loss": 6.305385112762451, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 6.302310466766357, "kl": 0.012910272926092148, "policy_loss": -0.005831089802086353, "entropy": 1.0287020206451416}}, "time_this_iter_s": 26.333175897598267, "timesteps_since_restore": 7992079, "time_since_restore": 4754.62427687645, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44692, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ace48>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668acac8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-17-13", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 49.67713921079467}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1388.1758228454457, "node_ip": "10.138.0.2", "timesteps_total": 8035872, "iterations_since_restore": 179, "episode_reward_mean": 1065.5121142781725, "custom_metrics": {"cost1_min": 34.67457814013806, "cost1_max": 429.2725959945182, "cost1_mean": 353.6475592938248, "system_level_velocity_mean": 14.205419381033009, "cost2_max": -27.340431387411417, "outflow_rate_min": 315.9082719236049, "system_level_velocity_max": 18.93524164304007, "system_level_velocity_min": 11.972850198627338, "outflow_rate_max": 1308.6281516756044, "cost2_mean": -197.49547715322115, "outflow_rate_mean": 1099.9905720503662, "cost2_min": -238.21161669990292}, "training_iteration": 179, "episodes_total": 2682, "episode_len_mean": 663.51, "timestamp": 1557209859, "time_total_s": 4780.161942243576, "pid": 31998, "info": {"num_steps_trained": 8035872, "load_time_ms": 14.333, "num_steps_sampled": 8035872, "grad_time_ms": 9530.014, "sample_time_ms": 16819.747, "update_time_ms": 8.293, "default": {"vf_explained_var": 0.985013484954834, "vf_loss": 5.50216007232666, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 5.4974260330200195, "kl": 0.013105097226798534, "policy_loss": -0.007533604744821787, "entropy": 1.113582730293274}}, "time_this_iter_s": 25.537665367126465, "timesteps_since_restore": 8035872, "time_since_restore": 4780.161942243576, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43793, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668a7978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ceeb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce3c8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-17-39", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 63.642201220316636}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1388.1758228454457, "node_ip": "10.138.0.2", "timesteps_total": 8081301, "iterations_since_restore": 180, "episode_reward_mean": 1053.7026524093033, "custom_metrics": {"cost1_min": 29.194362554379346, "cost1_max": 429.2725959945182, "cost1_mean": 350.3154214353705, "system_level_velocity_mean": 14.276971522614605, "cost2_max": -26.045930440795363, "outflow_rate_min": 315.9082719236049, "system_level_velocity_max": 19.66715369734245, "system_level_velocity_min": 11.96340233419061, "outflow_rate_max": 1308.6281516756044, "cost2_mean": -193.75380509465475, "outflow_rate_mean": 1088.3357472843027, "cost2_min": -238.21161669990292}, "training_iteration": 180, "episodes_total": 2693, "episode_len_mean": 656.1, "timestamp": 1557209885, "time_total_s": 4806.630323886871, "pid": 31998, "info": {"num_steps_trained": 8081301, "load_time_ms": 14.353, "num_steps_sampled": 8081301, "grad_time_ms": 9626.998, "sample_time_ms": 16722.531, "update_time_ms": 7.868, "default": {"vf_explained_var": 0.9908806085586548, "vf_loss": 3.3118109703063965, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 3.307553291320801, "kl": 0.013007869943976402, "policy_loss": -0.007035349495708942, "entropy": 1.0799638032913208}}, "time_this_iter_s": 26.468381643295288, "timesteps_since_restore": 8081301, "time_since_restore": 4806.630323886871, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45429, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cee48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce470>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce5f8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-18-05", "hostname": "flow-main", "episodes_this_iter": 11, "episode_reward_min": 50.29741774011835}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1388.1758228454457, "node_ip": "10.138.0.2", "timesteps_total": 8125928, "iterations_since_restore": 181, "episode_reward_mean": 1063.600019149982, "custom_metrics": {"cost1_min": 29.194362554379346, "cost1_max": 424.574835683743, "cost1_mean": 353.77242961953584, "system_level_velocity_mean": 14.137913916481546, "cost2_max": -26.045930440795363, "outflow_rate_min": 325.77280635295926, "system_level_velocity_max": 19.905356550803678, "system_level_velocity_min": 11.298411342446478, "outflow_rate_max": 1308.6281516756044, "cost2_mean": -195.4585016606156, "outflow_rate_mean": 1095.3945796859955, "cost2_min": -238.21161669990292}, "training_iteration": 181, "episodes_total": 2710, "episode_len_mean": 666.95, "timestamp": 1557209912, "time_total_s": 4833.03728055954, "pid": 31998, "info": {"num_steps_trained": 8125928, "load_time_ms": 14.288, "num_steps_sampled": 8125928, "grad_time_ms": 9699.477, "sample_time_ms": 16737.338, "update_time_ms": 7.719, "default": {"vf_explained_var": 0.9851779341697693, "vf_loss": 5.304195404052734, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 5.30055046081543, "kl": 0.016025889664888382, "policy_loss": -0.007067319471389055, "entropy": 1.0722811222076416}}, "time_this_iter_s": 26.406956672668457, "timesteps_since_restore": 8125928, "time_since_restore": 4833.03728055954, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44627, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfe10>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd748>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-18-32", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 50.29741774011835}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1388.1758228454457, "node_ip": "10.138.0.2", "timesteps_total": 8169837, "iterations_since_restore": 182, "episode_reward_mean": 1072.7398753700256, "custom_metrics": {"cost1_min": 29.194362554379346, "cost1_max": 428.0645967383996, "cost1_mean": 360.1204929330629, "system_level_velocity_mean": 14.18632245545078, "cost2_max": -26.045930440795363, "outflow_rate_min": 326.2713828205716, "system_level_velocity_max": 19.905356550803678, "system_level_velocity_min": 11.298411342446478, "outflow_rate_max": 1327.713566577081, "cost2_mean": -196.36458603730273, "outflow_rate_mean": 1108.573685797414, "cost2_min": -238.21161669990292}, "training_iteration": 182, "episodes_total": 2725, "episode_len_mean": 674.7, "timestamp": 1557209937, "time_total_s": 4857.928830385208, "pid": 31998, "info": {"num_steps_trained": 8169837, "load_time_ms": 14.435, "num_steps_sampled": 8169837, "grad_time_ms": 9720.092, "sample_time_ms": 16477.434, "update_time_ms": 7.326, "default": {"vf_explained_var": 0.9898722767829895, "vf_loss": 3.766849994659424, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 3.7644460201263428, "kl": 0.012666570022702217, "policy_loss": -0.005109697114676237, "entropy": 1.0290058851242065}}, "time_this_iter_s": 24.891549825668335, "timesteps_since_restore": 8169837, "time_since_restore": 4857.928830385208, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43909, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac048>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac7f0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-18-57", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 50.29741774011835}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1388.1758228454457, "node_ip": "10.138.0.2", "timesteps_total": 8216226, "iterations_since_restore": 183, "episode_reward_mean": 1078.0539242777838, "custom_metrics": {"cost1_min": 29.194362554379346, "cost1_max": 428.0645967383996, "cost1_mean": 362.70684559910956, "system_level_velocity_mean": 14.242440142953798, "cost2_max": -26.045930440795363, "outflow_rate_min": 326.2713828205716, "system_level_velocity_max": 19.905356550803678, "system_level_velocity_min": 11.298411342446478, "outflow_rate_max": 1327.713566577081, "cost2_mean": -197.2318081566716, "outflow_rate_mean": 1114.7198988820235, "cost2_min": -238.21161669990292}, "training_iteration": 183, "episodes_total": 2739, "episode_len_mean": 675.83, "timestamp": 1557209963, "time_total_s": 4883.953478574753, "pid": 31998, "info": {"num_steps_trained": 8216226, "load_time_ms": 14.372, "num_steps_sampled": 8216226, "grad_time_ms": 9809.523, "sample_time_ms": 16396.405, "update_time_ms": 7.241, "default": {"vf_explained_var": 0.9892099499702454, "vf_loss": 3.805002212524414, "cur_kl_coeff": 0.21357420086860657, "cur_lr": 0.0005000000237487257, "total_loss": 3.802748918533325, "kl": 0.013881918042898178, "policy_loss": -0.005218059755861759, "entropy": 1.0580006837844849}}, "time_this_iter_s": 26.024648189544678, "timesteps_since_restore": 8216226, "time_since_restore": 4883.953478574753, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 46389, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd710>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-19-23", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 50.29741774011835}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1317.1838040944779, "node_ip": "10.138.0.2", "timesteps_total": 8260390, "iterations_since_restore": 184, "episode_reward_mean": 1069.0605164804642, "custom_metrics": {"cost1_min": 29.194362554379346, "cost1_max": 428.0645967383996, "cost1_mean": 359.2680415864224, "system_level_velocity_mean": 14.120061650131131, "cost2_max": -26.045930440795363, "outflow_rate_min": 326.2713828205716, "system_level_velocity_max": 19.905356550803678, "system_level_velocity_min": 11.298411342446478, "outflow_rate_max": 1327.713566577081, "cost2_mean": -197.5831419685463, "outflow_rate_mean": 1110.3279077829618, "cost2_min": -238.21161669990292}, "training_iteration": 184, "episodes_total": 2757, "episode_len_mean": 675.83, "timestamp": 1557209989, "time_total_s": 4910.446027994156, "pid": 31998, "info": {"num_steps_trained": 8260390, "load_time_ms": 13.977, "num_steps_sampled": 8260390, "grad_time_ms": 9746.626, "sample_time_ms": 16356.791, "update_time_ms": 7.245, "default": {"vf_explained_var": 0.9927862882614136, "vf_loss": 2.829805612564087, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 2.825469970703125, "kl": 0.017012406140565872, "policy_loss": -0.007969256490468979, "entropy": 1.0607020854949951}}, "time_this_iter_s": 26.492549419403076, "timesteps_since_restore": 8260390, "time_since_restore": 4910.446027994156, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44164, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668652e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cea90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cec88>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-19-49", "hostname": "flow-main", "episodes_this_iter": 18, "episode_reward_min": 50.29741774011835}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1320.9961185340214, "node_ip": "10.138.0.2", "timesteps_total": 8305775, "iterations_since_restore": 185, "episode_reward_mean": 1073.7583218304144, "custom_metrics": {"cost1_min": 29.194362554379346, "cost1_max": 428.0645967383996, "cost1_mean": 361.9340739077802, "system_level_velocity_mean": 14.088175209444815, "cost2_max": -26.045930440795363, "outflow_rate_min": 326.2713828205716, "system_level_velocity_max": 19.905356550803678, "system_level_velocity_min": 11.298411342446478, "outflow_rate_max": 1327.713566577081, "cost2_mean": -198.02637551332867, "outflow_rate_mean": 1117.7314856791113, "cost2_min": -238.21161669990292}, "training_iteration": 185, "episodes_total": 2770, "episode_len_mean": 680.87, "timestamp": 1557210015, "time_total_s": 4936.351548910141, "pid": 31998, "info": {"num_steps_trained": 8305775, "load_time_ms": 13.927, "num_steps_sampled": 8305775, "grad_time_ms": 9686.362, "sample_time_ms": 16365.893, "update_time_ms": 7.131, "default": {"vf_explained_var": 0.9876046776771545, "vf_loss": 4.290325164794922, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 4.289120674133301, "kl": 0.018746275454759598, "policy_loss": -0.005208538845181465, "entropy": 1.0408967733383179}}, "time_this_iter_s": 25.905520915985107, "timesteps_since_restore": 8305775, "time_since_restore": 4936.351548910141, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45385, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d1cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865128>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668d17f0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-20-15", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 50.29741774011835}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1381.1294141073208, "node_ip": "10.138.0.2", "timesteps_total": 8351352, "iterations_since_restore": 186, "episode_reward_mean": 1083.3615067333876, "custom_metrics": {"cost1_min": 29.194362554379346, "cost1_max": 428.0645967383996, "cost1_mean": 365.19224318465575, "system_level_velocity_mean": 14.208986188339857, "cost2_max": -26.045930440795363, "outflow_rate_min": 326.2713828205716, "system_level_velocity_max": 19.905356550803678, "system_level_velocity_min": 11.298411342446478, "outflow_rate_max": 1327.713566577081, "cost2_mean": -198.63341196636264, "outflow_rate_mean": 1126.4799966065962, "cost2_min": -236.3680127040233}, "training_iteration": 186, "episodes_total": 2782, "episode_len_mean": 680.87, "timestamp": 1557210041, "time_total_s": 4962.1722576618195, "pid": 31998, "info": {"num_steps_trained": 8351352, "load_time_ms": 13.772, "num_steps_sampled": 8351352, "grad_time_ms": 9687.91, "sample_time_ms": 16276.591, "update_time_ms": 6.948, "default": {"vf_explained_var": 0.9909327030181885, "vf_loss": 3.6071975231170654, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 3.6022894382476807, "kl": 0.01595982536673546, "policy_loss": -0.008317092433571815, "entropy": 1.1058599948883057}}, "time_this_iter_s": 25.820708751678467, "timesteps_since_restore": 8351352, "time_since_restore": 4962.1722576618195, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45577, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668651d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf6a0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865f28>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-20-41", "hostname": "flow-main", "episodes_this_iter": 12, "episode_reward_min": 50.29741774011835}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1381.1294141073208, "node_ip": "10.138.0.2", "timesteps_total": 8393473, "iterations_since_restore": 187, "episode_reward_mean": 1081.7240246389065, "custom_metrics": {"cost1_min": 29.42912689910068, "cost1_max": 454.84496381154884, "cost1_mean": 366.14315331936433, "system_level_velocity_mean": 14.189666211367337, "cost2_max": -28.415085178232758, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.01008915275042, "system_level_velocity_min": 11.72228593192669, "outflow_rate_max": 1346.682145102757, "cost2_mean": -199.17657157093186, "outflow_rate_mean": 1134.3003888874246, "cost2_min": -236.3680127040233}, "training_iteration": 187, "episodes_total": 2802, "episode_len_mean": 684.14, "timestamp": 1557210066, "time_total_s": 4987.298588275909, "pid": 31998, "info": {"num_steps_trained": 8393473, "load_time_ms": 13.883, "num_steps_sampled": 8393473, "grad_time_ms": 9574.37, "sample_time_ms": 16220.208, "update_time_ms": 6.563, "default": {"vf_explained_var": 0.9813567399978638, "vf_loss": 7.918270111083984, "cur_kl_coeff": 0.21357421576976776, "cur_lr": 0.0005000000237487257, "total_loss": 7.913593292236328, "kl": 0.015652291476726532, "policy_loss": -0.008018252439796925, "entropy": 1.0607637166976929}}, "time_this_iter_s": 25.126330614089966, "timesteps_since_restore": 8393473, "time_since_restore": 4987.298588275909, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 42121, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf5c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf198>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfd30>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-21-06", "hostname": "flow-main", "episodes_this_iter": 20, "episode_reward_min": 50.29013809575396}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1384.9041116921637, "node_ip": "10.138.0.2", "timesteps_total": 8439308, "iterations_since_restore": 188, "episode_reward_mean": 1095.6320689739316, "custom_metrics": {"cost1_min": 29.42912689910068, "cost1_max": 454.84496381154884, "cost1_mean": 369.722004646698, "system_level_velocity_mean": 14.327668653513228, "cost2_max": -28.415085178232758, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.01008915275042, "system_level_velocity_min": 11.72228593192669, "outflow_rate_max": 1346.682145102757, "cost2_mean": -199.37277603015474, "outflow_rate_mean": 1142.0885010500701, "cost2_min": -236.3680127040233}, "training_iteration": 188, "episodes_total": 2815, "episode_len_mean": 684.14, "timestamp": 1557210094, "time_total_s": 5014.640498161316, "pid": 31998, "info": {"num_steps_trained": 8439308, "load_time_ms": 13.931, "num_steps_sampled": 8439308, "grad_time_ms": 9577.336, "sample_time_ms": 16317.056, "update_time_ms": 6.477, "default": {"vf_explained_var": 0.9896393418312073, "vf_loss": 4.05844783782959, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 4.055688381195068, "kl": 0.015589237213134766, "policy_loss": -0.006089204456657171, "entropy": 1.0855079889297485}}, "time_this_iter_s": 27.341909885406494, "timesteps_since_restore": 8439308, "time_since_restore": 5014.640498161316, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45835, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cea20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfb70>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-21-34", "hostname": "flow-main", "episodes_this_iter": 13, "episode_reward_min": 50.29013809575396}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1384.9041116921637, "node_ip": "10.138.0.2", "timesteps_total": 8483864, "iterations_since_restore": 189, "episode_reward_mean": 1082.8123226083446, "custom_metrics": {"cost1_min": 29.42912689910068, "cost1_max": 460.4470963755965, "cost1_mean": 370.7375265719297, "system_level_velocity_mean": 14.394045775616242, "cost2_max": -28.415085178232758, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.01008915275042, "system_level_velocity_min": 11.599895638213454, "outflow_rate_max": 1346.682145102757, "cost2_mean": -197.1341209661033, "outflow_rate_mean": 1140.7229966634677, "cost2_min": -236.3680127040233}, "training_iteration": 189, "episodes_total": 2831, "episode_len_mean": 684.14, "timestamp": 1557210121, "time_total_s": 5041.657159090042, "pid": 31998, "info": {"num_steps_trained": 8483864, "load_time_ms": 13.864, "num_steps_sampled": 8483864, "grad_time_ms": 9631.577, "sample_time_ms": 16409.043, "update_time_ms": 6.789, "default": {"vf_explained_var": 0.9842944741249084, "vf_loss": 6.272736072540283, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 6.269741535186768, "kl": 0.017387820407748222, "policy_loss": -0.006707706488668919, "entropy": 1.0914485454559326}}, "time_this_iter_s": 27.016660928726196, "timesteps_since_restore": 8483864, "time_since_restore": 5041.657159090042, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44556, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668750f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875dd8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875208>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-22-01", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 50.29013809575396}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1384.9041116921637, "node_ip": "10.138.0.2", "timesteps_total": 8526829, "iterations_since_restore": 190, "episode_reward_mean": 1084.29814051148, "custom_metrics": {"cost1_min": 29.42912689910068, "cost1_max": 460.4470963755965, "cost1_mean": 373.7611864345297, "system_level_velocity_mean": 14.40365313978177, "cost2_max": -28.415085178232758, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.01008915275042, "system_level_velocity_min": 11.599895638213454, "outflow_rate_max": 1346.682145102757, "cost2_mean": -197.3850278604386, "outflow_rate_mean": 1145.9377824852322, "cost2_min": -236.3680127040233}, "training_iteration": 190, "episodes_total": 2845, "episode_len_mean": 688.94, "timestamp": 1557210149, "time_total_s": 5069.702396392822, "pid": 31998, "info": {"num_steps_trained": 8526829, "load_time_ms": 13.742, "num_steps_sampled": 8526829, "grad_time_ms": 9598.209, "sample_time_ms": 16599.942, "update_time_ms": 7.268, "default": {"vf_explained_var": 0.9920914769172668, "vf_loss": 3.310072422027588, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 3.305297374725342, "kl": 0.015463806688785553, "policy_loss": -0.00807687547057867, "entropy": 1.0608985424041748}}, "time_this_iter_s": 28.04523730278015, "timesteps_since_restore": 8526829, "time_since_restore": 5069.702396392822, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 42965, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66865e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668651d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668652e8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-22-29", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 50.29013809575396}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1384.9041116921637, "node_ip": "10.138.0.2", "timesteps_total": 8570924, "iterations_since_restore": 191, "episode_reward_mean": 1086.2584582412785, "custom_metrics": {"cost1_min": 29.42912689910068, "cost1_max": 460.4470963755965, "cost1_mean": 375.93521842184185, "system_level_velocity_mean": 14.504292723971185, "cost2_max": -28.415085178232758, "outflow_rate_min": 329.6337234057179, "system_level_velocity_max": 20.01008915275042, "system_level_velocity_min": 9.870498664629388, "outflow_rate_max": 1346.682145102757, "cost2_mean": -196.4235635456362, "outflow_rate_mean": 1147.3353646166252, "cost2_min": -236.3680127040233}, "training_iteration": 191, "episodes_total": 2862, "episode_len_mean": 688.94, "timestamp": 1557210175, "time_total_s": 5096.307268857956, "pid": 31998, "info": {"num_steps_trained": 8570924, "load_time_ms": 13.738, "num_steps_sampled": 8570924, "grad_time_ms": 9612.741, "sample_time_ms": 16603.448, "update_time_ms": 7.36, "default": {"vf_explained_var": 0.9903472065925598, "vf_loss": 3.8462181091308594, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 3.8418331146240234, "kl": 0.014766338281333447, "policy_loss": -0.0075387172400951385, "entropy": 1.0557433366775513}}, "time_this_iter_s": 26.604872465133667, "timesteps_since_restore": 8570924, "time_since_restore": 5096.307268857956, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44095, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac240>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac390>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-22-55", "hostname": "flow-main", "episodes_this_iter": 17, "episode_reward_min": 50.29013809575396}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1384.9041116921637, "node_ip": "10.138.0.2", "timesteps_total": 8615195, "iterations_since_restore": 192, "episode_reward_mean": 1051.8994686166939, "custom_metrics": {"cost1_min": 29.42912689910068, "cost1_max": 460.4470963755965, "cost1_mean": 366.34119879687137, "system_level_velocity_mean": 14.543001698395697, "cost2_max": -28.415085178232758, "outflow_rate_min": 326.79757566059465, "system_level_velocity_max": 20.01008915275042, "system_level_velocity_min": 9.870498664629388, "outflow_rate_max": 1346.682145102757, "cost2_mean": -192.75416378869707, "outflow_rate_mean": 1122.7939051324176, "cost2_min": -236.3680127040233}, "training_iteration": 192, "episodes_total": 2876, "episode_len_mean": 675.18, "timestamp": 1557210203, "time_total_s": 5123.902740716934, "pid": 31998, "info": {"num_steps_trained": 8615195, "load_time_ms": 13.667, "num_steps_sampled": 8615195, "grad_time_ms": 9630.449, "sample_time_ms": 16855.812, "update_time_ms": 7.743, "default": {"vf_explained_var": 0.9777469635009766, "vf_loss": 8.518131256103516, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 8.512998580932617, "kl": 0.015959233045578003, "policy_loss": -0.008540811017155647, "entropy": 1.0700849294662476}}, "time_this_iter_s": 27.59547185897827, "timesteps_since_restore": 8615195, "time_since_restore": 5123.902740716934, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44271, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bfb70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668bf128>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-23-23", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 50.29013809575396}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1384.9041116921637, "node_ip": "10.138.0.2", "timesteps_total": 8659932, "iterations_since_restore": 193, "episode_reward_mean": 1040.2619269301076, "custom_metrics": {"cost1_min": 29.42912689910068, "cost1_max": 466.9826311818545, "cost1_mean": 364.71298068452995, "system_level_velocity_mean": 14.504574851487176, "cost2_max": -28.415085178232758, "outflow_rate_min": 326.79757566059465, "system_level_velocity_max": 20.01008915275042, "system_level_velocity_min": 9.870498664629388, "outflow_rate_max": 1346.682145102757, "cost2_mean": -192.6843112945211, "outflow_rate_mean": 1119.631109591212, "cost2_min": -236.0199544855329}, "training_iteration": 193, "episodes_total": 2891, "episode_len_mean": 675.18, "timestamp": 1557210230, "time_total_s": 5150.675227642059, "pid": 31998, "info": {"num_steps_trained": 8659932, "load_time_ms": 13.667, "num_steps_sampled": 8659932, "grad_time_ms": 9627.154, "sample_time_ms": 16935.409, "update_time_ms": 8.034, "default": {"vf_explained_var": 0.9858095049858093, "vf_loss": 5.204624176025391, "cur_kl_coeff": 0.21357417106628418, "cur_lr": 0.0005000000237487257, "total_loss": 5.201895236968994, "kl": 0.01620129495859146, "policy_loss": -0.006189305335283279, "entropy": 1.020389437675476}}, "time_this_iter_s": 26.772486925125122, "timesteps_since_restore": 8659932, "time_since_restore": 5150.675227642059, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44737, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668759e8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-23-50", "hostname": "flow-main", "episodes_this_iter": 15, "episode_reward_min": 50.29013809575396}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1384.9041116921637, "node_ip": "10.138.0.2", "timesteps_total": 8703987, "iterations_since_restore": 194, "episode_reward_mean": 1053.1815823393924, "custom_metrics": {"cost1_min": 31.44352416340448, "cost1_max": 466.9826311818545, "cost1_mean": 368.01404609105674, "system_level_velocity_mean": 14.492358515983026, "cost2_max": -29.719465124938093, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.665077544179578, "system_level_velocity_min": 9.870498664629388, "outflow_rate_max": 1337.3237441576077, "cost2_mean": -194.99772583559857, "outflow_rate_mean": 1127.291296757164, "cost2_min": -236.0199544855329}, "training_iteration": 194, "episodes_total": 2907, "episode_len_mean": 679.74, "timestamp": 1557210256, "time_total_s": 5176.815419435501, "pid": 31998, "info": {"num_steps_trained": 8703987, "load_time_ms": 13.816, "num_steps_sampled": 8703987, "grad_time_ms": 9634.516, "sample_time_ms": 16891.528, "update_time_ms": 8.184, "default": {"vf_explained_var": 0.9856923818588257, "vf_loss": 5.4985432624816895, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 5.494592189788818, "kl": 0.01687229424715042, "policy_loss": -0.0075545101426541805, "entropy": 1.0193969011306763}}, "time_this_iter_s": 26.140191793441772, "timesteps_since_restore": 8703987, "time_since_restore": 5176.815419435501, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44055, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66875240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdda0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668755c0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-24-16", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 57.34798579448276}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1350.6417880871386, "node_ip": "10.138.0.2", "timesteps_total": 8749344, "iterations_since_restore": 195, "episode_reward_mean": 1049.7790453639657, "custom_metrics": {"cost1_min": 31.44352416340448, "cost1_max": 466.9826311818545, "cost1_mean": 365.78066451201573, "system_level_velocity_mean": 14.412722911960536, "cost2_max": -29.719465124938093, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.665077544179578, "system_level_velocity_min": 9.870498664629388, "outflow_rate_max": 1340.7338165270537, "cost2_mean": -195.48017519111158, "outflow_rate_mean": 1125.6562924927596, "cost2_min": -236.17316760796916}, "training_iteration": 195, "episodes_total": 2921, "episode_len_mean": 679.74, "timestamp": 1557210283, "time_total_s": 5203.6812953948975, "pid": 31998, "info": {"num_steps_trained": 8749344, "load_time_ms": 13.717, "num_steps_sampled": 8749344, "grad_time_ms": 9691.188, "sample_time_ms": 16929.829, "update_time_ms": 8.194, "default": {"vf_explained_var": 0.9913412928581238, "vf_loss": 3.2609448432922363, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 3.257744312286377, "kl": 0.015465360134840012, "policy_loss": -0.006504043471068144, "entropy": 1.0308268070220947}}, "time_this_iter_s": 26.865875959396362, "timesteps_since_restore": 8749344, "time_since_restore": 5203.6812953948975, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45357, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce4e0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ce128>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-24-43", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 57.34798579448276}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1350.6417880871386, "node_ip": "10.138.0.2", "timesteps_total": 8793481, "iterations_since_restore": 196, "episode_reward_mean": 1057.4995971743147, "custom_metrics": {"cost1_min": 31.44352416340448, "cost1_max": 466.9826311818545, "cost1_mean": 366.3586484765355, "system_level_velocity_mean": 14.437272175954321, "cost2_max": -29.719465124938093, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.665077544179578, "system_level_velocity_min": 9.870498664629388, "outflow_rate_max": 1346.9874988207282, "cost2_mean": -196.17929277704854, "outflow_rate_mean": 1129.5903105083532, "cost2_min": -236.17316760796916}, "training_iteration": 196, "episodes_total": 2935, "episode_len_mean": 679.74, "timestamp": 1557210313, "time_total_s": 5233.37308216095, "pid": 31998, "info": {"num_steps_trained": 8793481, "load_time_ms": 13.44, "num_steps_sampled": 8793481, "grad_time_ms": 10018.412, "sample_time_ms": 16976.342, "update_time_ms": 8.383, "default": {"vf_explained_var": 0.992706835269928, "vf_loss": 3.104987144470215, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 3.1027677059173584, "kl": 0.01507146842777729, "policy_loss": -0.005438421852886677, "entropy": 1.0148885250091553}}, "time_this_iter_s": 29.691786766052246, "timesteps_since_restore": 8793481, "time_since_restore": 5233.37308216095, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 44137, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66ad9710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66ad9b00>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66ad9ba8>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-25-13", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 57.34798579448276}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1451.6574499906703, "node_ip": "10.138.0.2", "timesteps_total": 8837191, "iterations_since_restore": 197, "episode_reward_mean": 1067.8183756590506, "custom_metrics": {"cost1_min": 31.44352416340448, "cost1_max": 466.9826311818545, "cost1_mean": 369.19564151022024, "system_level_velocity_mean": 14.538616065339923, "cost2_max": -29.719465124938093, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.665077544179578, "system_level_velocity_min": 9.870498664629388, "outflow_rate_max": 1385.5258172036224, "cost2_mean": -196.9567774253077, "outflow_rate_mean": 1141.2364179596157, "cost2_min": -236.17316760796916}, "training_iteration": 197, "episodes_total": 2951, "episode_len_mean": 679.74, "timestamp": 1557210357, "time_total_s": 5277.861660242081, "pid": 31998, "info": {"num_steps_trained": 8837191, "load_time_ms": 14.079, "num_steps_sampled": 8837191, "grad_time_ms": 10397.833, "sample_time_ms": 18530.769, "update_time_ms": 9.001, "default": {"vf_explained_var": 0.9881822466850281, "vf_loss": 4.798052787780762, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 4.793452262878418, "kl": 0.015983888879418373, "policy_loss": -0.008014122024178505, "entropy": 1.0612319707870483}}, "time_this_iter_s": 44.48857808113098, "timesteps_since_restore": 8837191, "time_since_restore": 5277.861660242081, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 43710, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cd358>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668cdda0>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-25-57", "hostname": "flow-main", "episodes_this_iter": 16, "episode_reward_min": 57.34798579448276}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1451.6574499906703, "node_ip": "10.138.0.2", "timesteps_total": 8878298, "iterations_since_restore": 198, "episode_reward_mean": 1049.4393109357327, "custom_metrics": {"cost1_min": 31.44352416340448, "cost1_max": 466.9826311818545, "cost1_mean": 365.74216161770556, "system_level_velocity_mean": 14.691586993292798, "cost2_max": -29.719465124938093, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.665077544179578, "system_level_velocity_min": 11.248391222713035, "outflow_rate_max": 1385.5258172036224, "cost2_mean": -194.27062514379898, "outflow_rate_mean": 1131.3663099924488, "cost2_min": -236.17316760796916}, "training_iteration": 198, "episodes_total": 2970, "episode_len_mean": 669.95, "timestamp": 1557210382, "time_total_s": 5302.721230983734, "pid": 31998, "info": {"num_steps_trained": 8878298, "load_time_ms": 14.0, "num_steps_sampled": 8878298, "grad_time_ms": 10327.624, "sample_time_ms": 18353.074, "update_time_ms": 9.028, "default": {"vf_explained_var": 0.9855228066444397, "vf_loss": 7.882184982299805, "cur_kl_coeff": 0.21357418596744537, "cur_lr": 0.0005000000237487257, "total_loss": 7.87935209274292, "kl": 0.016075192019343376, "policy_loss": -0.006265796255320311, "entropy": 1.094828486442566}}, "time_this_iter_s": 24.859570741653442, "timesteps_since_restore": 8878298, "time_since_restore": 5302.721230983734, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 41107, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668acc18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac208>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668acb70>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-26-22", "hostname": "flow-main", "episodes_this_iter": 19, "episode_reward_min": 57.34798579448276}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": false, "episode_reward_max": 1451.6574499906703, "node_ip": "10.138.0.2", "timesteps_total": 8923529, "iterations_since_restore": 199, "episode_reward_mean": 1076.644078120346, "custom_metrics": {"cost1_min": 34.438218005067995, "cost1_max": 466.9826311818545, "cost1_mean": 378.088811679896, "system_level_velocity_mean": 14.777787079346734, "cost2_max": -30.749935652501776, "outflow_rate_min": 326.3279975793562, "system_level_velocity_max": 19.340071524718486, "system_level_velocity_min": 11.72450903169106, "outflow_rate_max": 1385.5258172036224, "cost2_mean": -196.50135603591255, "outflow_rate_mean": 1158.4311950287895, "cost2_min": -236.17316760796916}, "training_iteration": 199, "episodes_total": 2984, "episode_len_mean": 683.71, "timestamp": 1557210406, "time_total_s": 5326.67834353447, "pid": 31998, "info": {"num_steps_trained": 8923529, "load_time_ms": 13.952, "num_steps_sampled": 8923529, "grad_time_ms": 10401.485, "sample_time_ms": 17973.84, "update_time_ms": 8.788, "default": {"vf_explained_var": 0.9900397062301636, "vf_loss": 3.825139045715332, "cur_kl_coeff": 0.21357420086860657, "cur_lr": 0.0005000000237487257, "total_loss": 3.8221797943115234, "kl": 0.017746897414326668, "policy_loss": -0.0067489491775631905, "entropy": 1.1359257698059082}}, "time_this_iter_s": 23.957112550735474, "timesteps_since_restore": 8923529, "time_since_restore": 5326.67834353447, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 45231, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66ad9470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66ad9438>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b66ad9e48>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-26-46", "hostname": "flow-main", "episodes_this_iter": 14, "episode_reward_min": 57.34798579448276}
{"num_metric_batches_dropped": 0, "policy_reward_mean": {}, "done": true, "episode_reward_max": 1451.6574499906703, "node_ip": "10.138.0.2", "timesteps_total": 8970898, "iterations_since_restore": 200, "episode_reward_mean": 1077.0154948688498, "custom_metrics": {"cost1_min": 109.30830254768017, "cost1_max": 463.2335363518995, "cost1_mean": 376.93155351996495, "system_level_velocity_mean": 14.69461158160169, "cost2_max": -75.59341648717515, "outflow_rate_min": 408.02577056382, "system_level_velocity_max": 19.340071524718486, "system_level_velocity_min": 11.72450903169106, "outflow_rate_max": 1385.5258172036224, "cost2_mean": -197.53616644504098, "outflow_rate_mean": 1154.8608480247763, "cost2_min": -237.0783195847415}, "training_iteration": 200, "episodes_total": 2995, "episode_len_mean": 684.92, "timestamp": 1557210431, "time_total_s": 5351.570423841476, "pid": 31998, "info": {"num_steps_trained": 8970898, "load_time_ms": 13.851, "num_steps_sampled": 8970898, "grad_time_ms": 10560.291, "sample_time_ms": 17501.149, "update_time_ms": 8.428, "default": {"vf_explained_var": 0.9876437783241272, "vf_loss": 4.613696098327637, "cur_kl_coeff": 0.21357420086860657, "cur_lr": 0.0005000000237487257, "total_loss": 4.610279083251953, "kl": 0.016400638967752457, "policy_loss": -0.006920331157743931, "entropy": 1.105550765991211}}, "time_this_iter_s": 24.892080307006836, "timesteps_since_restore": 8970898, "time_since_restore": 5351.570423841476, "experiment_id": "70709c3a8fbe465b9f02c61445c65923", "timesteps_this_iter": 47369, "config": {"log_level": "INFO", "num_gpus": 0, "num_workers": 20, "num_gpus_per_worker": 0, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668accc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668ac898>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f6b668acb00>", "on_sample_end": null, "on_train_result": null}, "train_batch_size": 30000, "input_evaluation": null, "input": "sampler", "model": {"conv_filters": null, "custom_model": null, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "fcnet_activation": "tanh", "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "max_seq_len": 20, "squash_to_range": false, "dim": 84, "free_log_std": false, "grayscale": false, "framestack": true, "channel_major": false, "zero_mean": true, "custom_options": {}, "conv_activation": "relu"}, "lr": 0.0005, "use_gae": true, "straggler_mitigation": false, "optimizer": {}, "output": null, "monitor": false, "output_max_file_size": 67108864, "num_sgd_iter": 10, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "sgd_minibatch_size": 128, "compress_observations": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "num_cpus_per_worker": 1, "num_cpus_for_driver": 1, "vf_loss_coeff": 1.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "kl_coeff": 0.2, "collect_metrics_timeout": 180, "clip_param": 0.3, "simple_optimizer": false, "lambda": 0.97, "gamma": 0.99, "sample_batch_size": 200, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "clip_actions": false, "clip_rewards": null, "batch_mode": "truncate_episodes", "kl_target": 0.01, "synchronize_filters": true, "output_compress_columns": ["obs", "new_obs"], "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "entropy_coeff": 0.0, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "vf_share_layers": false, "preprocessor_pref": "deepmind", "lr_schedule": null, "observation_filter": "NoFilter", "num_envs_per_worker": 1}, "date": "2019-05-07_06-27-11", "hostname": "flow-main", "episodes_this_iter": 11, "episode_reward_min": 296.5437195552745}

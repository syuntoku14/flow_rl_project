{"timesteps_this_iter": 122918, "timestamp": 1556527290, "episode_len_mean": 700.0, "timesteps_since_restore": 122918, "time_since_restore": 43.3639018535614, "done": false, "custom_metrics": {"outflow_rate_min": 553.4287042475014, "outflow_rate_mean": 629.3195669885525, "cost2_mean": -40.86551096200544, "outflow_rate_max": 729.6386339296496, "system_level_velocity_mean": 7.993693385772869, "system_level_velocity_min": 5.668523394574718, "cost2_max": -32.997738314619795, "cost2_min": -53.2224653104188, "cost1_min": 142.79386142361375, "cost1_max": 255.00419985783154, "cost1_mean": 205.9364155597057, "system_level_velocity_max": 9.842550596042718}, "timesteps_total": 122918, "training_iteration": 1, "date": "2019-04-29_08-41-30", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871930b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871932b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871931d0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 1, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 409.31672473262023, "time_this_iter_s": 43.3639018535614, "info": {"grad_time_ms": 28208.148, "default": {"entropy": 1.4161001443862915, "kl": 0.0026557431556284428, "cur_lr": 0.0005000000237487257, "policy_loss": -0.001285561709664762, "vf_loss": 1.9605039358139038, "total_loss": 1.9597493410110474, "vf_explained_var": 0.8370975852012634, "cur_kl_coeff": 0.20000003278255463}, "num_steps_sampled": 122918, "num_steps_trained": 122918, "load_time_ms": 88.248, "update_time_ms": 449.004, "sample_time_ms": 14367.911}, "episode_reward_max": 497.91916490385034, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 348.99320086349826, "episodes_total": 14, "episodes_this_iter": 14, "time_total_s": 43.3639018535614, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 116487, "timestamp": 1556527330, "episode_len_mean": 700.0, "timesteps_since_restore": 239405, "time_since_restore": 84.12252974510193, "done": false, "custom_metrics": {"outflow_rate_min": 194.77384046383628, "outflow_rate_mean": 590.4578538351448, "cost2_mean": -53.254655866778265, "outflow_rate_max": 821.4689222222817, "system_level_velocity_mean": 7.402159407615845, "system_level_velocity_min": 2.610431381483487, "cost2_max": -25.977142218303385, "cost2_min": -81.1713865369475, "cost1_min": 66.55172970348227, "cost1_max": 255.00419985783154, "cost1_mean": 191.14066449702068, "system_level_velocity_max": 9.842550596042718}, "timesteps_total": 239405, "training_iteration": 2, "date": "2019-04-29_08-42-10", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d497f0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 2, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 474.3808811988497, "time_this_iter_s": 40.75862789154053, "info": {"grad_time_ms": 26687.475, "default": {"entropy": 1.4111038446426392, "kl": 0.007946904748678207, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0032317994628101587, "vf_loss": 1.8800885677337646, "total_loss": 1.8776514530181885, "vf_explained_var": 0.8842825889587402, "cur_kl_coeff": 0.10000001639127731}, "num_steps_sampled": 239405, "num_steps_trained": 239405, "load_time_ms": 52.227, "update_time_ms": 229.867, "sample_time_ms": 14860.529}, "episode_reward_max": 649.6451637196851, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 305.7766708402392, "episodes_total": 79, "episodes_this_iter": 65, "time_total_s": 84.12252974510193, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 114855, "timestamp": 1556527370, "episode_len_mean": 700.0, "timesteps_since_restore": 354260, "time_since_restore": 123.335280418396, "done": false, "custom_metrics": {"outflow_rate_min": 284.97860196689317, "outflow_rate_mean": 589.8180502119161, "cost2_mean": -49.49637844510777, "outflow_rate_max": 733.7233893236863, "system_level_velocity_mean": 7.429569970338912, "system_level_velocity_min": 2.77024331611301, "cost2_max": -25.977142218303385, "cost2_min": -81.84372270905284, "cost1_min": 71.65682178116964, "cost1_max": 241.50534929161108, "cost1_mean": 192.37842408105544, "system_level_velocity_max": 9.474114447491424}, "timesteps_total": 354260, "training_iteration": 3, "date": "2019-04-29_08-42-50", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b84a8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 3, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 485.4973625371469, "time_this_iter_s": 39.21275067329407, "info": {"grad_time_ms": 26053.439, "default": {"entropy": 1.3911747932434082, "kl": 0.012259969487786293, "cur_lr": 0.0005000000237487257, "policy_loss": -0.006990796886384487, "vf_loss": 2.385603904724121, "total_loss": 2.3798391819000244, "vf_explained_var": 0.9238409399986267, "cur_kl_coeff": 0.10000001639127731}, "num_steps_sampled": 354260, "num_steps_trained": 354260, "load_time_ms": 40.389, "update_time_ms": 156.79, "sample_time_ms": 14633.485}, "episode_reward_max": 617.0741466918984, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 305.7766708402392, "episodes_total": 136, "episodes_this_iter": 57, "time_total_s": 123.335280418396, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 121437, "timestamp": 1556527414, "episode_len_mean": 700.0, "timesteps_since_restore": 475697, "time_since_restore": 167.47118186950684, "done": false, "custom_metrics": {"outflow_rate_min": 217.52723518329225, "outflow_rate_mean": 576.8206598742017, "cost2_mean": -48.6273163700113, "outflow_rate_max": 772.0375657759906, "system_level_velocity_mean": 7.450470911622673, "system_level_velocity_min": 2.5941708320073036, "cost2_max": -29.755799443725646, "cost2_min": -101.56011524531783, "cost1_min": 67.0304833294279, "cost1_max": 262.3225482216129, "cost1_mean": 193.35237617125134, "system_level_velocity_max": 9.987980884391572}, "timesteps_total": 475697, "training_iteration": 4, "date": "2019-04-29_08-43-34", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d495c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49898>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d493c8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 4, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 519.0055954062431, "time_this_iter_s": 44.13590145111084, "info": {"grad_time_ms": 26281.964, "default": {"entropy": 1.377973198890686, "kl": 0.011390982195734978, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007245276588946581, "vf_loss": 3.5900042057037354, "total_loss": 3.583897829055786, "vf_explained_var": 0.9095413684844971, "cur_kl_coeff": 0.10000001639127731}, "num_steps_sampled": 475697, "num_steps_trained": 475697, "load_time_ms": 37.172, "update_time_ms": 120.335, "sample_time_ms": 15204.495}, "episode_reward_max": 741.2527065129374, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 351.3612459401887, "episodes_total": 196, "episodes_this_iter": 60, "time_total_s": 167.47118186950684, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 128084, "timestamp": 1556527460, "episode_len_mean": 693.29, "timesteps_since_restore": 603781, "time_since_restore": 213.4874472618103, "done": false, "custom_metrics": {"outflow_rate_min": 217.52723518329225, "outflow_rate_mean": 601.9799894711649, "cost2_mean": -63.96110607731115, "outflow_rate_max": 871.5694624557349, "system_level_velocity_mean": 7.6873448254568935, "system_level_velocity_min": 2.5941708320073036, "cost2_max": -18.05908097261459, "cost2_min": -140.91729036263237, "cost1_min": 19.20148685515402, "cost1_max": 277.1704282300723, "cost1_mean": 196.4065404784763, "system_level_velocity_max": 17.859975433805076}, "timesteps_total": 603781, "training_iteration": 5, "date": "2019-04-29_08-44-20", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b82e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8fd0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b87b8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 5, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 608.1134670382886, "time_this_iter_s": 46.01626539230347, "info": {"grad_time_ms": 26775.602, "default": {"entropy": 1.3767610788345337, "kl": 0.01152706053107977, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00676526827737689, "vf_loss": 4.415987968444824, "total_loss": 4.410375595092773, "vf_explained_var": 0.9252234101295471, "cur_kl_coeff": 0.10000001639127731}, "num_steps_sampled": 603781, "num_steps_trained": 603781, "load_time_ms": 35.554, "update_time_ms": 98.34, "sample_time_ms": 15561.766}, "episode_reward_max": 1047.4555703372482, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 41.83409718982586, "episodes_total": 246, "episodes_this_iter": 50, "time_total_s": 213.4874472618103, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 130912, "timestamp": 1556527506, "episode_len_mean": 693.29, "timesteps_since_restore": 734693, "time_since_restore": 259.17177414894104, "done": false, "custom_metrics": {"outflow_rate_min": 198.21261003131815, "outflow_rate_mean": 664.2186594722483, "cost2_mean": -80.45169784178788, "outflow_rate_max": 968.0627154739516, "system_level_velocity_mean": 8.10384983572158, "system_level_velocity_min": 2.5941708320073036, "cost2_max": -18.05908097261459, "cost2_min": -146.08128941020632, "cost1_min": 19.20148685515402, "cost1_max": 294.81314628059437, "cost1_mean": 208.82948372657972, "system_level_velocity_max": 17.859975433805076}, "timesteps_total": 734693, "training_iteration": 6, "date": "2019-04-29_08-45-06", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d497f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49f60>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49e80>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 6, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 696.7118288752124, "time_this_iter_s": 45.68432688713074, "info": {"grad_time_ms": 27165.216, "default": {"entropy": 1.389892339706421, "kl": 0.010178787633776665, "cur_lr": 0.0005000000237487257, "policy_loss": -0.006374899297952652, "vf_loss": 5.174860954284668, "total_loss": 5.169504165649414, "vf_explained_var": 0.929296612739563, "cur_kl_coeff": 0.10000000894069672}, "num_steps_sampled": 734693, "num_steps_trained": 734693, "load_time_ms": 34.021, "update_time_ms": 83.646, "sample_time_ms": 15681.125}, "episode_reward_max": 1160.4250788277336, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 41.83409718982586, "episodes_total": 279, "episodes_this_iter": 33, "time_total_s": 259.17177414894104, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 132119, "timestamp": 1556527553, "episode_len_mean": 693.2, "timesteps_since_restore": 866812, "time_since_restore": 306.65882992744446, "done": false, "custom_metrics": {"outflow_rate_min": 198.21261003131815, "outflow_rate_mean": 743.1319948785836, "cost2_mean": -103.02106652808179, "outflow_rate_max": 1044.7398599166763, "system_level_velocity_mean": 8.666270002119703, "system_level_velocity_min": 2.7728851063819553, "cost2_max": -14.993781046986694, "cost2_min": -148.4745443816929, "cost1_min": 13.126544700039105, "cost1_max": 320.8030059207672, "cost1_mean": 225.0725721595611, "system_level_velocity_max": 17.10710275055565}, "timesteps_total": 866812, "training_iteration": 7, "date": "2019-04-29_08-45-53", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d41630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8a20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8da0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 7, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 808.1549356493412, "time_this_iter_s": 47.48705577850342, "info": {"grad_time_ms": 27506.487, "default": {"entropy": 1.37909996509552, "kl": 0.013541687279939651, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007802086416631937, "vf_loss": 7.836179733276367, "total_loss": 7.8297319412231445, "vf_explained_var": 0.9100921154022217, "cur_kl_coeff": 0.10000000894069672}, "num_steps_sampled": 866812, "num_steps_trained": 866812, "load_time_ms": 32.97, "update_time_ms": 73.241, "sample_time_ms": 15960.983}, "episode_reward_max": 1273.5945743354068, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 26.642505763242266, "episodes_total": 333, "episodes_this_iter": 54, "time_total_s": 306.65882992744446, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 122998, "timestamp": 1556527597, "episode_len_mean": 693.2, "timesteps_since_restore": 989810, "time_since_restore": 350.4187717437744, "done": false, "custom_metrics": {"outflow_rate_min": 375.8379050978615, "outflow_rate_mean": 798.1430310291516, "cost2_mean": -114.50930054688186, "outflow_rate_max": 1044.7398599166763, "system_level_velocity_mean": 9.15713995897719, "system_level_velocity_min": 5.92430767018818, "cost2_max": -14.993781046986694, "cost2_min": -177.44542156125144, "cost1_min": 13.126544700039105, "cost1_max": 320.8030059207672, "cost1_mean": 238.82309332007432, "system_level_velocity_max": 17.10710275055565}, "timesteps_total": 989810, "training_iteration": 8, "date": "2019-04-29_08-46-37", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49c88>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49898>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 8, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 874.4601041701214, "time_this_iter_s": 43.759941816329956, "info": {"grad_time_ms": 27572.219, "default": {"entropy": 1.3844871520996094, "kl": 0.01566314324736595, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009331291541457176, "vf_loss": 7.117150783538818, "total_loss": 7.109385013580322, "vf_explained_var": 0.9114707708358765, "cur_kl_coeff": 0.10000001639127731}, "num_steps_sampled": 989810, "num_steps_trained": 989810, "load_time_ms": 32.3, "update_time_ms": 65.267, "sample_time_ms": 15900.172}, "episode_reward_max": 1273.5945743354068, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 26.642505763242266, "episodes_total": 380, "episodes_this_iter": 47, "time_total_s": 350.4187717437744, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 130275, "timestamp": 1556527640, "episode_len_mean": 700.0, "timesteps_since_restore": 1120085, "time_since_restore": 393.27564311027527, "done": false, "custom_metrics": {"outflow_rate_min": 515.3099433942286, "outflow_rate_mean": 847.6865242696049, "cost2_mean": -115.80466586403313, "outflow_rate_max": 1067.2948338453618, "system_level_velocity_mean": 9.553677644383146, "system_level_velocity_min": 4.925533508120321, "cost2_max": -35.42731879532487, "cost2_min": -177.44542156125144, "cost1_min": 127.38869018452829, "cost1_max": 321.2488010501208, "cost1_mean": 254.43866098041863, "system_level_velocity_max": 11.890402826372894}, "timesteps_total": 1120085, "training_iteration": 9, "date": "2019-04-29_08-47-20", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b29e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49ef0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 9, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 919.825403566679, "time_this_iter_s": 42.856871366500854, "info": {"grad_time_ms": 27482.257, "default": {"entropy": 1.3783260583877563, "kl": 0.012692896649241447, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007306787651032209, "vf_loss": 8.858248710632324, "total_loss": 8.852211952209473, "vf_explained_var": 0.899216890335083, "cur_kl_coeff": 0.10000001639127731}, "num_steps_sampled": 1120085, "num_steps_trained": 1120085, "load_time_ms": 31.789, "update_time_ms": 59.201, "sample_time_ms": 15889.63}, "episode_reward_max": 1251.470017707176, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 598.2577957302217, "episodes_total": 428, "episodes_this_iter": 48, "time_total_s": 393.27564311027527, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 126025, "timestamp": 1556527685, "episode_len_mean": 693.39, "timesteps_since_restore": 1246110, "time_since_restore": 437.7021253108978, "done": false, "custom_metrics": {"outflow_rate_min": 506.98643375399934, "outflow_rate_mean": 844.3236094494096, "cost2_mean": -111.02772557036707, "outflow_rate_max": 1067.2948338453618, "system_level_velocity_mean": 9.6638617615744, "system_level_velocity_min": 4.925533508120321, "cost2_max": -22.395047017121037, "cost2_min": -174.44193444476548, "cost1_min": 25.0503700383347, "cost1_max": 322.64592394825314, "cost1_mean": 252.5449990131071, "system_level_velocity_max": 18.036472083496054}, "timesteps_total": 1246110, "training_iteration": 10, "date": "2019-04-29_08-48-05", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49f60>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49cc0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 10, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 899.1034723626218, "time_this_iter_s": 44.42648220062256, "info": {"grad_time_ms": 27563.856, "default": {"entropy": 1.3757424354553223, "kl": 0.014451154507696629, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00861190166324377, "vf_loss": 8.391925811767578, "total_loss": 8.384759902954102, "vf_explained_var": 0.9053250551223755, "cur_kl_coeff": 0.10000000894069672}, "num_steps_sampled": 1246110, "num_steps_trained": 1246110, "load_time_ms": 31.403, "update_time_ms": 54.379, "sample_time_ms": 15886.828}, "episode_reward_max": 1251.470017707176, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 57.625088638604936, "episodes_total": 478, "episodes_this_iter": 50, "time_total_s": 437.7021253108978, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 124323, "timestamp": 1556527728, "episode_len_mean": 693.39, "timesteps_since_restore": 1370433, "time_since_restore": 480.61715364456177, "done": false, "custom_metrics": {"outflow_rate_min": 490.3797457543615, "outflow_rate_mean": 846.4303683932444, "cost2_mean": -111.65915829369844, "outflow_rate_max": 1083.284529700576, "system_level_velocity_mean": 9.764608439773042, "system_level_velocity_min": 5.755164455227991, "cost2_max": -22.395047017121037, "cost2_min": -176.57528940780213, "cost1_min": 25.0503700383347, "cost1_max": 330.31262854188327, "cost1_mean": 254.69674794741502, "system_level_velocity_max": 18.036472083496054}, "timesteps_total": 1370433, "training_iteration": 11, "date": "2019-04-29_08-48-48", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8a20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8518>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 11, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 898.7122162329365, "time_this_iter_s": 42.91502833366394, "info": {"grad_time_ms": 27521.532, "default": {"entropy": 1.3479692935943604, "kl": 0.017412545159459114, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010411107912659645, "vf_loss": 7.542879104614258, "total_loss": 7.534209251403809, "vf_explained_var": 0.9082310199737549, "cur_kl_coeff": 0.10000001639127731}, "num_steps_sampled": 1370433, "num_steps_trained": 1370433, "load_time_ms": 25.199, "update_time_ms": 10.776, "sample_time_ms": 15937.37}, "episode_reward_max": 1251.470017707176, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 57.625088638604936, "episodes_total": 515, "episodes_this_iter": 37, "time_total_s": 480.61715364456177, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 125595, "timestamp": 1556527772, "episode_len_mean": 700.0, "timesteps_since_restore": 1496028, "time_since_restore": 525.1855270862579, "done": false, "custom_metrics": {"outflow_rate_min": 490.3797457543615, "outflow_rate_mean": 874.1932808046274, "cost2_mean": -119.22161671645478, "outflow_rate_max": 1148.3536337871585, "system_level_velocity_mean": 9.89760614680599, "system_level_velocity_min": 4.641634034212231, "cost2_max": -36.57654759799664, "cost2_min": -177.9058688197846, "cost1_min": 116.38695470437821, "cost1_max": 354.84221738935884, "cost1_mean": 262.7919511475904, "system_level_velocity_max": 13.13171124803998}, "timesteps_total": 1496028, "training_iteration": 12, "date": "2019-04-29_08-49-32", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49438>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49898>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 12, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 941.6735771820792, "time_this_iter_s": 44.56837344169617, "info": {"grad_time_ms": 27818.186, "default": {"entropy": 1.3428605794906616, "kl": 0.015910590067505836, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009796694852411747, "vf_loss": 9.936891555786133, "total_loss": 9.928686141967773, "vf_explained_var": 0.8654875159263611, "cur_kl_coeff": 0.10000001639127731}, "num_steps_sampled": 1496028, "num_steps_trained": 1496028, "load_time_ms": 26.797, "update_time_ms": 10.9, "sample_time_ms": 16018.732}, "episode_reward_max": 1256.4339636210982, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 511.40942849165515, "episodes_total": 570, "episodes_this_iter": 55, "time_total_s": 525.1855270862579, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 120571, "timestamp": 1556527814, "episode_len_mean": 693.29, "timesteps_since_restore": 1616599, "time_since_restore": 567.3286037445068, "done": false, "custom_metrics": {"outflow_rate_min": 298.67828127936025, "outflow_rate_mean": 883.6803036956001, "cost2_mean": -120.3212933585661, "outflow_rate_max": 1148.3536337871585, "system_level_velocity_mean": 10.032479402429896, "system_level_velocity_min": 3.562104274676723, "cost2_max": -17.549610608746256, "cost2_min": -177.9058688197846, "cost1_min": 17.97660685290091, "cost1_max": 354.84221738935884, "cost1_mean": 262.4300579293387, "system_level_velocity_max": 17.75285795766133}, "timesteps_total": 1616599, "training_iteration": 13, "date": "2019-04-29_08-50-14", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b87b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8b70>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8c88>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 13, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 958.1169727848174, "time_this_iter_s": 42.1430766582489, "info": {"grad_time_ms": 28007.216, "default": {"entropy": 1.3557969331741333, "kl": 0.016913507133722305, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010676974430680275, "vf_loss": 9.574800491333008, "total_loss": 9.565815925598145, "vf_explained_var": 0.8659705519676208, "cur_kl_coeff": 0.10000002384185791}, "num_steps_sampled": 1616599, "num_steps_trained": 1616599, "load_time_ms": 28.196, "update_time_ms": 12.975, "sample_time_ms": 16117.406}, "episode_reward_max": 1256.4339636210982, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 48.86422971411731, "episodes_total": 621, "episodes_this_iter": 51, "time_total_s": 567.3286037445068, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 118486, "timestamp": 1556527857, "episode_len_mean": 693.29, "timesteps_since_restore": 1735085, "time_since_restore": 609.2869036197662, "done": false, "custom_metrics": {"outflow_rate_min": 298.67828127936025, "outflow_rate_mean": 888.2751111230843, "cost2_mean": -117.94059875018858, "outflow_rate_max": 1083.3085294085452, "system_level_velocity_mean": 10.127804824497261, "system_level_velocity_min": 3.562104274676723, "cost2_max": -17.549610608746256, "cost2_min": -171.12128233604494, "cost1_min": 17.97660685290091, "cost1_max": 340.9917895596433, "cost1_mean": 265.31247651844564, "system_level_velocity_max": 17.75285795766133}, "timesteps_total": 1735085, "training_iteration": 14, "date": "2019-04-29_08-50-57", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871f35c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d498d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49198>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 14, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 968.5073395052016, "time_this_iter_s": 41.9582998752594, "info": {"grad_time_ms": 27916.59, "default": {"entropy": 1.3376097679138184, "kl": 0.019940247759222984, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012069182470440865, "vf_loss": 10.41811466217041, "total_loss": 10.408041000366211, "vf_explained_var": 0.8364858031272888, "cur_kl_coeff": 0.10000001639127731}, "num_steps_sampled": 1735085, "num_steps_trained": 1735085, "load_time_ms": 27.857, "update_time_ms": 12.95, "sample_time_ms": 15988.507}, "episode_reward_max": 1239.6969674814404, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 48.86422971411731, "episodes_total": 674, "episodes_this_iter": 53, "time_total_s": 609.2869036197662, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 121618, "timestamp": 1556527901, "episode_len_mean": 700.0, "timesteps_since_restore": 1856703, "time_since_restore": 653.6873426437378, "done": false, "custom_metrics": {"outflow_rate_min": 642.4441146817861, "outflow_rate_mean": 916.5111773958107, "cost2_mean": -120.47484792367142, "outflow_rate_max": 1083.3085294085452, "system_level_velocity_mean": 10.387641543825525, "system_level_velocity_min": 7.677483731894761, "cost2_max": -54.56896118644481, "cost2_min": -175.94969760808152, "cost1_min": 203.86992197330608, "cost1_max": 340.9917895596433, "cost1_mean": 277.45553138503533, "system_level_velocity_max": 12.647567706624312}, "timesteps_total": 1856703, "training_iteration": 15, "date": "2019-04-29_08-51-41", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b85f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8fd0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 15, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1007.5965510133017, "time_this_iter_s": 44.40043902397156, "info": {"grad_time_ms": 27895.784, "default": {"entropy": 1.3429806232452393, "kl": 0.01964288391172886, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011346987448632717, "vf_loss": 10.146448135375977, "total_loss": 10.137065887451172, "vf_explained_var": 0.8021008372306824, "cur_kl_coeff": 0.10000001639127731}, "num_steps_sampled": 1856703, "num_steps_trained": 1856703, "load_time_ms": 27.81, "update_time_ms": 13.268, "sample_time_ms": 15847.593}, "episode_reward_max": 1294.573645832562, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 718.2602749772858, "episodes_total": 725, "episodes_this_iter": 51, "time_total_s": 653.6873426437378, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 121930, "timestamp": 1556527943, "episode_len_mean": 700.0, "timesteps_since_restore": 1978633, "time_since_restore": 695.6123099327087, "done": false, "custom_metrics": {"outflow_rate_min": 642.4441146817861, "outflow_rate_mean": 912.3719288819289, "cost2_mean": -118.14439877290992, "outflow_rate_max": 1080.6103832682786, "system_level_velocity_mean": 10.413258976652367, "system_level_velocity_min": 7.677483731894761, "cost2_max": -45.27076151670294, "cost2_min": -175.94969760808152, "cost1_min": 203.86992197330608, "cost1_max": 337.01351920323873, "cost1_mean": 277.4506485319038, "system_level_velocity_max": 12.585626310243432}, "timesteps_total": 1978633, "training_iteration": 16, "date": "2019-04-29_08-52-23", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49898>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49cc0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 16, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1003.7901455712496, "time_this_iter_s": 41.92496728897095, "info": {"grad_time_ms": 27658.557, "default": {"entropy": 1.3410037755966187, "kl": 0.01972227357327938, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011729849502444267, "vf_loss": 10.562029838562012, "total_loss": 10.55227279663086, "vf_explained_var": 0.8147314190864563, "cur_kl_coeff": 0.10000001639127731}, "num_steps_sampled": 1978633, "num_steps_trained": 1978633, "load_time_ms": 28.32, "update_time_ms": 13.304, "sample_time_ms": 15710.161}, "episode_reward_max": 1294.573645832562, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 718.2602749772858, "episodes_total": 764, "episodes_this_iter": 39, "time_total_s": 695.6123099327087, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 120119, "timestamp": 1556527985, "episode_len_mean": 693.3, "timesteps_since_restore": 2098752, "time_since_restore": 737.3712785243988, "done": false, "custom_metrics": {"outflow_rate_min": 477.162188311727, "outflow_rate_mean": 918.2858068543787, "cost2_mean": -119.67965612802476, "outflow_rate_max": 1117.9591898618376, "system_level_velocity_mean": 10.576635616699368, "system_level_velocity_min": 7.105910357935393, "cost2_max": -16.11412510389849, "cost2_min": -167.4967946884569, "cost1_min": 19.006099690059564, "cost1_max": 355.7768055467643, "cost1_mean": 276.8366958283778, "system_level_velocity_max": 17.992831090610878}, "timesteps_total": 2098752, "training_iteration": 17, "date": "2019-04-29_08-53-05", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b82e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8b70>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8e10>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 17, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1010.322633163052, "time_this_iter_s": 41.75896859169006, "info": {"grad_time_ms": 27287.717, "default": {"entropy": 1.3351503610610962, "kl": 0.020681286230683327, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011617718264460564, "vf_loss": 12.4659423828125, "total_loss": 12.456392288208008, "vf_explained_var": 0.7913235425949097, "cur_kl_coeff": 0.10000001639127731}, "num_steps_sampled": 2098752, "num_steps_trained": 2098752, "load_time_ms": 26.868, "update_time_ms": 13.321, "sample_time_ms": 15513.236}, "episode_reward_max": 1385.259974034708, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 50.045052789134786, "episodes_total": 820, "episodes_this_iter": 56, "time_total_s": 737.3712785243988, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 120857, "timestamp": 1556528027, "episode_len_mean": 693.3, "timesteps_since_restore": 2219609, "time_since_restore": 779.3605899810791, "done": false, "custom_metrics": {"outflow_rate_min": 477.162188311727, "outflow_rate_mean": 938.0702097733716, "cost2_mean": -121.7625706753951, "outflow_rate_max": 1117.9591898618376, "system_level_velocity_mean": 10.8048408193815, "system_level_velocity_min": 5.787198564456323, "cost2_max": -16.11412510389849, "cost2_min": -176.44948320927566, "cost1_min": 19.006099690059564, "cost1_max": 355.7768055467643, "cost1_mean": 283.3435791998417, "system_level_velocity_max": 17.992831090610878}, "timesteps_total": 2219609, "training_iteration": 18, "date": "2019-04-29_08-53-47", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d495c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49f98>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49160>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 18, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1031.8046639238878, "time_this_iter_s": 41.9893114566803, "info": {"grad_time_ms": 27137.988, "default": {"entropy": 1.3281660079956055, "kl": 0.01919303834438324, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012407593429088593, "vf_loss": 12.917264938354492, "total_loss": 12.907736778259277, "vf_explained_var": 0.7725902199745178, "cur_kl_coeff": 0.15000000596046448}, "num_steps_sampled": 2219609, "num_steps_trained": 2219609, "load_time_ms": 27.564, "update_time_ms": 13.485, "sample_time_ms": 15484.753}, "episode_reward_max": 1385.259974034708, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 50.045052789134786, "episodes_total": 873, "episodes_this_iter": 53, "time_total_s": 779.3605899810791, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 121015, "timestamp": 1556528069, "episode_len_mean": 700.0, "timesteps_since_restore": 2340624, "time_since_restore": 821.9317047595978, "done": false, "custom_metrics": {"outflow_rate_min": 570.1373414429461, "outflow_rate_mean": 936.2215544282611, "cost2_mean": -122.92117134232215, "outflow_rate_max": 1151.0370500087192, "system_level_velocity_mean": 10.648942290225524, "system_level_velocity_min": 5.33858500879543, "cost2_max": -49.87574960090289, "cost2_min": -176.44948320927566, "cost1_min": 138.47084144762047, "cost1_max": 358.3660652772053, "cost1_mean": 283.737768390047, "system_level_velocity_max": 13.339534606129082}, "timesteps_total": 2340624, "training_iteration": 19, "date": "2019-04-29_08-54-29", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b89e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8cc0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 19, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1038.8577511935864, "time_this_iter_s": 42.57111477851868, "info": {"grad_time_ms": 27144.279, "default": {"entropy": 1.348409652709961, "kl": 0.018503112718462944, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012174736708402634, "vf_loss": 11.759186744689941, "total_loss": 11.749787330627441, "vf_explained_var": 0.813791811466217, "cur_kl_coeff": 0.15000000596046448}, "num_steps_sampled": 2340624, "num_steps_trained": 2340624, "load_time_ms": 26.16, "update_time_ms": 13.836, "sample_time_ms": 15454.882}, "episode_reward_max": 1331.9948605887494, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 724.6943462034981, "episodes_total": 922, "episodes_this_iter": 49, "time_total_s": 821.9317047595978, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 122655, "timestamp": 1556528113, "episode_len_mean": 700.0, "timesteps_since_restore": 2463279, "time_since_restore": 865.394216299057, "done": false, "custom_metrics": {"outflow_rate_min": 570.1373414429461, "outflow_rate_mean": 931.5607084662828, "cost2_mean": -124.9690316795974, "outflow_rate_max": 1151.0370500087192, "system_level_velocity_mean": 10.505385274891458, "system_level_velocity_min": 5.33858500879543, "cost2_max": -58.26853877962218, "cost2_min": -171.76591066268153, "cost1_min": 138.47084144762047, "cost1_max": 358.3660652772053, "cost1_mean": 279.49417118547166, "system_level_velocity_max": 13.372856537621347}, "timesteps_total": 2463279, "training_iteration": 20, "date": "2019-04-29_08-55-13", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb860>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb438>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 20, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1034.7262300697853, "time_this_iter_s": 43.46251153945923, "info": {"grad_time_ms": 27042.562, "default": {"entropy": 1.3491034507751465, "kl": 0.017829587683081627, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011485782451927662, "vf_loss": 10.9296236038208, "total_loss": 10.920812606811523, "vf_explained_var": 0.8329672813415527, "cur_kl_coeff": 0.14999999105930328}, "num_steps_sampled": 2463279, "num_steps_trained": 2463279, "load_time_ms": 26.329, "update_time_ms": 13.747, "sample_time_ms": 15460.459}, "episode_reward_max": 1291.033533136502, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 724.6943462034981, "episodes_total": 970, "episodes_this_iter": 48, "time_total_s": 865.394216299057, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 125325, "timestamp": 1556528156, "episode_len_mean": 700.0, "timesteps_since_restore": 2588604, "time_since_restore": 908.0099213123322, "done": false, "custom_metrics": {"outflow_rate_min": 720.5392832377681, "outflow_rate_mean": 941.9245747910219, "cost2_mean": -125.8105832094438, "outflow_rate_max": 1144.2580326524292, "system_level_velocity_mean": 10.698700909194724, "system_level_velocity_min": 7.3978904372426015, "cost2_max": -64.5516179269268, "cost2_min": -171.17166806577816, "cost1_min": 194.55188492819298, "cost1_max": 396.4897910445558, "cost1_mean": 284.37591695323795, "system_level_velocity_max": 14.658863581911339}, "timesteps_total": 2588604, "training_iteration": 21, "date": "2019-04-29_08-55-56", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8da0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8cc0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 21, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1035.3726269323886, "time_this_iter_s": 42.61570501327515, "info": {"grad_time_ms": 27013.501, "default": {"entropy": 1.3617748022079468, "kl": 0.019406981766223907, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01310743484646082, "vf_loss": 11.563399314880371, "total_loss": 11.553203582763672, "vf_explained_var": 0.823957622051239, "cur_kl_coeff": 0.14999999105930328}, "num_steps_sampled": 2588604, "num_steps_trained": 2588604, "load_time_ms": 26.904, "update_time_ms": 13.45, "sample_time_ms": 15458.412}, "episode_reward_max": 1394.8730999684005, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 786.751168556468, "episodes_total": 1014, "episodes_this_iter": 44, "time_total_s": 908.0099213123322, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 121822, "timestamp": 1556528199, "episode_len_mean": 700.0, "timesteps_since_restore": 2710426, "time_since_restore": 951.0642559528351, "done": false, "custom_metrics": {"outflow_rate_min": 650.7238573389036, "outflow_rate_mean": 921.2423984193492, "cost2_mean": -124.97771892092089, "outflow_rate_max": 1144.2580326524292, "system_level_velocity_mean": 10.401722180477334, "system_level_velocity_min": 6.317099765421076, "cost2_max": -67.96550158396087, "cost2_min": -171.17166806577816, "cost1_min": 162.377341811626, "cost1_max": 396.4897910445558, "cost1_mean": 276.1008062018302, "system_level_velocity_max": 14.658863581911339}, "timesteps_total": 2710426, "training_iteration": 22, "date": "2019-04-29_08-56-39", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871f35c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49320>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 22, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1016.699378689844, "time_this_iter_s": 43.05433464050293, "info": {"grad_time_ms": 26915.814, "default": {"entropy": 1.355430006980896, "kl": 0.01977025531232357, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013390905223786831, "vf_loss": 12.394087791442871, "total_loss": 12.383663177490234, "vf_explained_var": 0.8231139779090881, "cur_kl_coeff": 0.14999999105930328}, "num_steps_sampled": 2710426, "num_steps_trained": 2710426, "load_time_ms": 24.929, "update_time_ms": 13.336, "sample_time_ms": 15406.207}, "episode_reward_max": 1394.8730999684005, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 772.485999061347, "episodes_total": 1068, "episodes_this_iter": 54, "time_total_s": 951.0642559528351, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 123888, "timestamp": 1556528244, "episode_len_mean": 700.0, "timesteps_since_restore": 2834314, "time_since_restore": 996.4482283592224, "done": false, "custom_metrics": {"outflow_rate_min": 650.7238573389036, "outflow_rate_mean": 919.5269462849112, "cost2_mean": -126.04142119930158, "outflow_rate_max": 1127.3743057101112, "system_level_velocity_mean": 10.495913787063419, "system_level_velocity_min": 6.317099765421076, "cost2_max": -47.84329558555502, "cost2_min": -173.01846776206668, "cost1_min": 162.377341811626, "cost1_max": 392.9168402513484, "cost1_mean": 278.81328303050964, "system_level_velocity_max": 14.531059024879422}, "timesteps_total": 2834314, "training_iteration": 23, "date": "2019-04-29_08-57-24", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b80f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b87b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8c88>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 23, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1030.3349427682258, "time_this_iter_s": 45.38397240638733, "info": {"grad_time_ms": 27017.119, "default": {"entropy": 1.3790966272354126, "kl": 0.018793731927871704, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012827455997467041, "vf_loss": 13.5114107131958, "total_loss": 13.501401901245117, "vf_explained_var": 0.8340370655059814, "cur_kl_coeff": 0.14999999105930328}, "num_steps_sampled": 2834314, "num_steps_trained": 2834314, "load_time_ms": 24.292, "update_time_ms": 11.876, "sample_time_ms": 15632.969}, "episode_reward_max": 1412.0572329140812, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 772.485999061347, "episodes_total": 1117, "episodes_this_iter": 49, "time_total_s": 996.4482283592224, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 121406, "timestamp": 1556528287, "episode_len_mean": 700.0, "timesteps_since_restore": 2955720, "time_since_restore": 1038.952625989914, "done": false, "custom_metrics": {"outflow_rate_min": 680.2776843342317, "outflow_rate_mean": 937.8702391587117, "cost2_mean": -126.61234202339715, "outflow_rate_max": 1172.0230086138226, "system_level_velocity_mean": 10.822029179981243, "system_level_velocity_min": 7.546728414833839, "cost2_max": -47.84329558555502, "cost2_min": -174.51837674992345, "cost1_min": 196.7722252304459, "cost1_max": 400.9226653983277, "cost1_mean": 287.6127504702259, "system_level_velocity_max": 15.046756673784644}, "timesteps_total": 2955720, "training_iteration": 24, "date": "2019-04-29_08-58-07", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb908>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bbc50>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 24, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1043.508167211861, "time_this_iter_s": 42.50439763069153, "info": {"grad_time_ms": 27089.45, "default": {"entropy": 1.35951566696167, "kl": 0.02002018317580223, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01337223220616579, "vf_loss": 11.94563102722168, "total_loss": 11.935261726379395, "vf_explained_var": 0.8319292664527893, "cur_kl_coeff": 0.14999999105930328}, "num_steps_sampled": 2955720, "num_steps_trained": 2955720, "load_time_ms": 23.225, "update_time_ms": 12.37, "sample_time_ms": 15617.933}, "episode_reward_max": 1412.0572329140812, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 810.2771652580038, "episodes_total": 1162, "episodes_this_iter": 45, "time_total_s": 1038.952625989914, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 122939, "timestamp": 1556528329, "episode_len_mean": 700.0, "timesteps_since_restore": 3078659, "time_since_restore": 1081.463937997818, "done": false, "custom_metrics": {"outflow_rate_min": 707.1819520515904, "outflow_rate_mean": 943.9594584420145, "cost2_mean": -124.31961138855027, "outflow_rate_max": 1220.4399217005357, "system_level_velocity_mean": 10.945225086644655, "system_level_velocity_min": 8.060132905379172, "cost2_max": -70.00503735825313, "cost2_min": -174.51837674992345, "cost1_min": 208.7245608771285, "cost1_max": 400.9226653983277, "cost1_mean": 290.6831174407182, "system_level_velocity_max": 15.046756673784644}, "timesteps_total": 3078659, "training_iteration": 25, "date": "2019-04-29_08-58-49", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b82b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8e10>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 25, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1043.9973416692937, "time_this_iter_s": 42.51131200790405, "info": {"grad_time_ms": 26905.697, "default": {"entropy": 1.3476364612579346, "kl": 0.01656593196094036, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012357419356703758, "vf_loss": 13.786932945251465, "total_loss": 13.778304100036621, "vf_explained_var": 0.8339009881019592, "cur_kl_coeff": 0.22499996423721313}, "num_steps_sampled": 3078659, "num_steps_trained": 3078659, "load_time_ms": 22.975, "update_time_ms": 12.003, "sample_time_ms": 15611.991}, "episode_reward_max": 1461.0287207239567, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 810.2771652580038, "episodes_total": 1208, "episodes_this_iter": 46, "time_total_s": 1081.463937997818, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 121867, "timestamp": 1556528371, "episode_len_mean": 700.0, "timesteps_since_restore": 3200526, "time_since_restore": 1122.8860776424408, "done": false, "custom_metrics": {"outflow_rate_min": 729.4151092301627, "outflow_rate_mean": 959.8105975093803, "cost2_mean": -124.0644818204888, "outflow_rate_max": 1220.4399217005357, "system_level_velocity_mean": 11.259433201876194, "system_level_velocity_min": 8.567531749204822, "cost2_max": -70.00503735825313, "cost2_min": -173.54048216779404, "cost1_min": 222.85242245994186, "cost1_max": 404.1078755679421, "cost1_mean": 298.6597312377087, "system_level_velocity_max": 14.992818328447465}, "timesteps_total": 3200526, "training_iteration": 26, "date": "2019-04-29_08-59-31", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d498d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d493c8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 26, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1063.3251275952427, "time_this_iter_s": 41.4221396446228, "info": {"grad_time_ms": 26729.01, "default": {"entropy": 1.3577696084976196, "kl": 0.01703580655157566, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012930786237120628, "vf_loss": 15.806815147399902, "total_loss": 15.797718048095703, "vf_explained_var": 0.8182276487350464, "cur_kl_coeff": 0.22499996423721313}, "num_steps_sampled": 3200526, "num_steps_trained": 3200526, "load_time_ms": 22.554, "update_time_ms": 12.383, "sample_time_ms": 15738.143}, "episode_reward_max": 1461.0287207239567, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 847.3480266430113, "episodes_total": 1260, "episodes_this_iter": 52, "time_total_s": 1122.8860776424408, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 121265, "timestamp": 1556528413, "episode_len_mean": 700.0, "timesteps_since_restore": 3321791, "time_since_restore": 1165.0151002407074, "done": false, "custom_metrics": {"outflow_rate_min": 707.1660792615244, "outflow_rate_mean": 968.835147133173, "cost2_mean": -127.79384581034297, "outflow_rate_max": 1213.7686154121195, "system_level_velocity_mean": 11.37043198419236, "system_level_velocity_min": 6.759650423397582, "cost2_max": -86.16154849622185, "cost2_min": -184.6887636920623, "cost1_min": 171.4982631593436, "cost1_max": 404.1078755679421, "cost1_mean": 301.15109739669003, "system_level_velocity_max": 14.992818328447465}, "timesteps_total": 3321791, "training_iteration": 27, "date": "2019-04-29_09-00-13", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b85c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b84e0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 27, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1071.0263120056957, "time_this_iter_s": 42.1290225982666, "info": {"grad_time_ms": 26779.756, "default": {"entropy": 1.3616197109222412, "kl": 0.018426010385155678, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014594913460314274, "vf_loss": 16.8721866607666, "total_loss": 16.861736297607422, "vf_explained_var": 0.7799414992332458, "cur_kl_coeff": 0.22499996423721313}, "num_steps_sampled": 3321791, "num_steps_trained": 3321791, "load_time_ms": 23.02, "update_time_ms": 12.327, "sample_time_ms": 15721.149}, "episode_reward_max": 1439.7318946668481, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 790.3486999491528, "episodes_total": 1315, "episodes_this_iter": 55, "time_total_s": 1165.0151002407074, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 118178, "timestamp": 1556528453, "episode_len_mean": 700.0, "timesteps_since_restore": 3439969, "time_since_restore": 1204.6062278747559, "done": false, "custom_metrics": {"outflow_rate_min": 690.1888590960076, "outflow_rate_mean": 960.5667239222345, "cost2_mean": -124.40949661541767, "outflow_rate_max": 1153.7314596352464, "system_level_velocity_mean": 11.257435090950851, "system_level_velocity_min": 6.759650423397582, "cost2_max": -68.46629291319749, "cost2_min": -184.6887636920623, "cost1_min": 171.4982631593436, "cost1_max": 392.1801739236112, "cost1_mean": 298.0078446138273, "system_level_velocity_max": 14.577803789580388}, "timesteps_total": 3439969, "training_iteration": 28, "date": "2019-04-29_09-00-53", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b82e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b80b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8550>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 28, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1062.9475646818253, "time_this_iter_s": 39.59112763404846, "info": {"grad_time_ms": 26564.999, "default": {"entropy": 1.3546903133392334, "kl": 0.017443692311644554, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014039050787687302, "vf_loss": 14.511380195617676, "total_loss": 14.501266479492188, "vf_explained_var": 0.831373393535614, "cur_kl_coeff": 0.22499996423721313}, "num_steps_sampled": 3439969, "num_steps_trained": 3439969, "load_time_ms": 21.709, "update_time_ms": 12.658, "sample_time_ms": 15697.014}, "episode_reward_max": 1326.559517381685, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 790.3486999491528, "episodes_total": 1365, "episodes_this_iter": 50, "time_total_s": 1204.6062278747559, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 119142, "timestamp": 1556528494, "episode_len_mean": 686.71, "timesteps_since_restore": 3559111, "time_since_restore": 1245.5498807430267, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 954.2282966566958, "cost2_mean": -117.09326328606515, "outflow_rate_max": 1178.5254551400083, "system_level_velocity_mean": 11.593615138017249, "system_level_velocity_min": 7.440812857633876, "cost2_max": -13.035194471728383, "cost2_min": -186.20329249240993, "cost1_min": 11.609785092045827, "cost1_max": 397.5079881172179, "cost1_mean": 298.5950898784498, "system_level_velocity_max": 17.829774790493115}, "timesteps_total": 3559111, "training_iteration": 29, "date": "2019-04-29_09-01-34", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b84a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8940>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8b38>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 29, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1041.903666044029, "time_this_iter_s": 40.943652868270874, "info": {"grad_time_ms": 26419.312, "default": {"entropy": 1.355587124824524, "kl": 0.01798136718571186, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013644827529788017, "vf_loss": 15.5482759475708, "total_loss": 15.538677215576172, "vf_explained_var": 0.7982876896858215, "cur_kl_coeff": 0.22499996423721313}, "num_steps_sampled": 3559111, "num_steps_trained": 3559111, "load_time_ms": 22.872, "update_time_ms": 12.355, "sample_time_ms": 15678.303}, "episode_reward_max": 1326.559517381685, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 28.532024530371388, "episodes_total": 1417, "episodes_this_iter": 52, "time_total_s": 1245.5498807430267, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 116727, "timestamp": 1556528536, "episode_len_mean": 679.9, "timesteps_since_restore": 3675838, "time_since_restore": 1287.6791679859161, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 948.5690061098767, "cost2_mean": -111.51596116589991, "outflow_rate_max": 1178.5254551400083, "system_level_velocity_mean": 11.83744296336825, "system_level_velocity_min": 8.732549426038492, "cost2_max": -13.035194471728383, "cost2_min": -186.20329249240993, "cost1_min": 11.609785092045827, "cost1_max": 420.2502407782566, "cost1_mean": 299.68858745988496, "system_level_velocity_max": 18.331897011598738}, "timesteps_total": 3675838, "training_iteration": 30, "date": "2019-04-29_09-02-16", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8278>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8a90>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 30, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1021.6746695921859, "time_this_iter_s": 42.129287242889404, "info": {"grad_time_ms": 26295.177, "default": {"entropy": 1.3530547618865967, "kl": 0.018941136077046394, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014638986438512802, "vf_loss": 17.429967880249023, "total_loss": 17.419591903686523, "vf_explained_var": 0.7997410893440247, "cur_kl_coeff": 0.22499997913837433}, "num_steps_sampled": 3675838, "num_steps_trained": 3675838, "load_time_ms": 21.494, "update_time_ms": 12.377, "sample_time_ms": 15669.781}, "episode_reward_max": 1406.3343964351402, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 28.532024530371388, "episodes_total": 1473, "episodes_this_iter": 56, "time_total_s": 1287.6791679859161, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 117415, "timestamp": 1556528576, "episode_len_mean": 693.41, "timesteps_since_restore": 3793253, "time_since_restore": 1327.6711428165436, "done": false, "custom_metrics": {"outflow_rate_min": 507.46363073572155, "outflow_rate_mean": 965.332704313974, "cost2_mean": -113.2559996511201, "outflow_rate_max": 1148.8524597483085, "system_level_velocity_mean": 11.84340033716473, "system_level_velocity_min": 7.194958756775155, "cost2_max": -22.711595296385152, "cost2_min": -168.3393501282491, "cost1_min": 26.546776371211667, "cost1_max": 420.2502407782566, "cost1_mean": 308.5306152145776, "system_level_velocity_max": 17.91243983021311}, "timesteps_total": 3793253, "training_iteration": 31, "date": "2019-04-29_09-02-56", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8160>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8470>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 31, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1040.5828936992993, "time_this_iter_s": 39.99197483062744, "info": {"grad_time_ms": 26010.026, "default": {"entropy": 1.353948950767517, "kl": 0.01805608719587326, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01388618815690279, "vf_loss": 16.64761734008789, "total_loss": 16.637794494628906, "vf_explained_var": 0.8144898414611816, "cur_kl_coeff": 0.22499997913837433}, "num_steps_sampled": 3793253, "num_steps_trained": 3793253, "load_time_ms": 19.648, "update_time_ms": 12.427, "sample_time_ms": 15692.919}, "episode_reward_max": 1406.3343964351402, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 65.8398044897939, "episodes_total": 1525, "episodes_this_iter": 52, "time_total_s": 1327.6711428165436, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 118932, "timestamp": 1556528616, "episode_len_mean": 700.0, "timesteps_since_restore": 3912185, "time_since_restore": 1367.213623046875, "done": false, "custom_metrics": {"outflow_rate_min": 709.503554096862, "outflow_rate_mean": 966.1105359165305, "cost2_mean": -112.55470195413794, "outflow_rate_max": 1137.9157076627596, "system_level_velocity_mean": 11.839884321352804, "system_level_velocity_min": 7.194958756775155, "cost2_max": -52.169240766233706, "cost2_min": -185.31793700957655, "cost1_min": 183.58770525818318, "cost1_max": 414.14824297148266, "cost1_mean": 312.7767714200997, "system_level_velocity_max": 15.445920704409696}, "timesteps_total": 3912185, "training_iteration": 32, "date": "2019-04-29_09-03-36", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d497f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49c88>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49cc0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 32, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1047.3122890509326, "time_this_iter_s": 39.54248023033142, "info": {"grad_time_ms": 25688.244, "default": {"entropy": 1.3547863960266113, "kl": 0.01944025605916977, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01363884937018156, "vf_loss": 17.06120491027832, "total_loss": 17.051939010620117, "vf_explained_var": 0.8141586780548096, "cur_kl_coeff": 0.22499996423721313}, "num_steps_sampled": 3912185, "num_steps_trained": 3912185, "load_time_ms": 19.89, "update_time_ms": 12.391, "sample_time_ms": 15662.547}, "episode_reward_max": 1344.3975423139145, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 806.9618408110434, "episodes_total": 1577, "episodes_this_iter": 52, "time_total_s": 1367.213623046875, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 115422, "timestamp": 1556528657, "episode_len_mean": 700.0, "timesteps_since_restore": 4027607, "time_since_restore": 1408.0831592082977, "done": false, "custom_metrics": {"outflow_rate_min": 725.6425699367593, "outflow_rate_mean": 961.2709732866248, "cost2_mean": -108.49743239005876, "outflow_rate_max": 1131.9280436459496, "system_level_velocity_mean": 11.913736698051924, "system_level_velocity_min": 7.516223015743368, "cost2_max": -52.91413718549731, "cost2_min": -162.6204581103447, "cost1_min": 189.05316286740745, "cost1_max": 414.14824297148266, "cost1_mean": 314.7333193902069, "system_level_velocity_max": 15.455879017002829}, "timesteps_total": 4027607, "training_iteration": 33, "date": "2019-04-29_09-04-17", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb438>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871bb898>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 33, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1047.9666364290197, "time_this_iter_s": 40.86953616142273, "info": {"grad_time_ms": 25429.111, "default": {"entropy": 1.3444547653198242, "kl": 0.019734110683202744, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01461956836283207, "vf_loss": 17.975191116333008, "total_loss": 17.96501350402832, "vf_explained_var": 0.8141545057296753, "cur_kl_coeff": 0.22499997913837433}, "num_steps_sampled": 4027607, "num_steps_trained": 4027607, "load_time_ms": 18.687, "update_time_ms": 11.864, "sample_time_ms": 15472.801}, "episode_reward_max": 1344.3975423139145, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 806.9618408110434, "episodes_total": 1629, "episodes_this_iter": 52, "time_total_s": 1408.0831592082977, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 117562, "timestamp": 1556528699, "episode_len_mean": 700.0, "timesteps_since_restore": 4145169, "time_since_restore": 1450.080976486206, "done": false, "custom_metrics": {"outflow_rate_min": 791.5493746062986, "outflow_rate_mean": 961.368121800323, "cost2_mean": -105.71586332972385, "outflow_rate_max": 1143.8152975563203, "system_level_velocity_mean": 11.887058034775263, "system_level_velocity_min": 8.67639602320973, "cost2_max": -52.91413718549731, "cost2_min": -162.6204581103447, "cost1_min": 227.727305984294, "cost1_max": 412.2160083031998, "cost1_mean": 314.1179651881507, "system_level_velocity_max": 15.455879017002829}, "timesteps_total": 4145169, "training_iteration": 34, "date": "2019-04-29_09-04-59", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8048>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8390>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 34, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1041.6581476098793, "time_this_iter_s": 41.997817277908325, "info": {"grad_time_ms": 25380.432, "default": {"entropy": 1.3569660186767578, "kl": 0.018715864047408104, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014315754175186157, "vf_loss": 17.69728660583496, "total_loss": 17.68718147277832, "vf_explained_var": 0.8238095641136169, "cur_kl_coeff": 0.22499999403953552}, "num_steps_sampled": 4145169, "num_steps_trained": 4145169, "load_time_ms": 19.401, "update_time_ms": 11.329, "sample_time_ms": 15469.734}, "episode_reward_max": 1307.6693585855487, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 808.9121784223058, "episodes_total": 1683, "episodes_this_iter": 54, "time_total_s": 1450.080976486206, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 117119, "timestamp": 1556528740, "episode_len_mean": 700.0, "timesteps_since_restore": 4262288, "time_since_restore": 1490.906673669815, "done": false, "custom_metrics": {"outflow_rate_min": 791.5493746062986, "outflow_rate_mean": 961.486362738631, "cost2_mean": -105.31326190101291, "outflow_rate_max": 1114.3139171201326, "system_level_velocity_mean": 11.901379083608981, "system_level_velocity_min": 8.67639602320973, "cost2_max": -41.56243538513323, "cost2_min": -166.0424056384572, "cost1_min": 227.960788611423, "cost1_max": 420.33254949408365, "cost1_mean": 314.5648613899424, "system_level_velocity_max": 15.761721509617782}, "timesteps_total": 4262288, "training_iteration": 35, "date": "2019-04-29_09-05-40", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54438>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d496a0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 35, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1038.0608137932022, "time_this_iter_s": 40.82569718360901, "info": {"grad_time_ms": 25238.762, "default": {"entropy": 1.3580703735351562, "kl": 0.01950191892683506, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014306863769888878, "vf_loss": 18.649255752563477, "total_loss": 18.63933563232422, "vf_explained_var": 0.8380488753318787, "cur_kl_coeff": 0.22499997913837433}, "num_steps_sampled": 4262288, "num_steps_trained": 4262288, "load_time_ms": 18.935, "update_time_ms": 11.33, "sample_time_ms": 15446.903}, "episode_reward_max": 1306.668132043145, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 755.4289089875806, "episodes_total": 1735, "episodes_this_iter": 52, "time_total_s": 1490.906673669815, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 117234, "timestamp": 1556528780, "episode_len_mean": 700.0, "timesteps_since_restore": 4379522, "time_since_restore": 1530.9619371891022, "done": false, "custom_metrics": {"outflow_rate_min": 798.1054838108677, "outflow_rate_mean": 968.1378584979299, "cost2_mean": -104.85512313879468, "outflow_rate_max": 1114.3139171201326, "system_level_velocity_mean": 12.123079042755979, "system_level_velocity_min": 8.82943429533912, "cost2_max": -37.15611653573001, "cost2_min": -167.37785485869594, "cost1_min": 227.960788611423, "cost1_max": 420.4503012440827, "cost1_mean": 320.019636235303, "system_level_velocity_max": 15.879609948921415}, "timesteps_total": 4379522, "training_iteration": 36, "date": "2019-04-29_09-06-20", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b80b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8f98>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 36, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1048.359726915946, "time_this_iter_s": 40.05526351928711, "info": {"grad_time_ms": 25201.756, "default": {"entropy": 1.3362977504730225, "kl": 0.0191623717546463, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013949977234005928, "vf_loss": 19.97808074951172, "total_loss": 19.968442916870117, "vf_explained_var": 0.805956244468689, "cur_kl_coeff": 0.22499996423721313}, "num_steps_sampled": 4379522, "num_steps_trained": 4379522, "load_time_ms": 18.256, "update_time_ms": 11.188, "sample_time_ms": 15350.424}, "episode_reward_max": 1308.6561939849428, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 755.4289089875806, "episodes_total": 1786, "episodes_this_iter": 51, "time_total_s": 1530.9619371891022, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 117269, "timestamp": 1556528821, "episode_len_mean": 700.0, "timesteps_since_restore": 4496791, "time_since_restore": 1572.3296344280243, "done": false, "custom_metrics": {"outflow_rate_min": 821.6778190514264, "outflow_rate_mean": 978.2314272385549, "cost2_mean": -110.08154520110863, "outflow_rate_max": 1210.9168973232252, "system_level_velocity_mean": 12.17013440697832, "system_level_velocity_min": 9.134846724191958, "cost2_max": -42.10116640559926, "cost2_min": -167.37785485869594, "cost1_min": 234.60302167121364, "cost1_max": 435.8122468422496, "cost1_mean": 321.374942988404, "system_level_velocity_max": 16.508260341297444}, "timesteps_total": 4496791, "training_iteration": 37, "date": "2019-04-29_09-07-01", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54e10>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54c18>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 37, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1068.9761138997462, "time_this_iter_s": 41.36769723892212, "info": {"grad_time_ms": 25107.717, "default": {"entropy": 1.345897912979126, "kl": 0.018795495852828026, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014491233043372631, "vf_loss": 19.4984073638916, "total_loss": 19.488143920898438, "vf_explained_var": 0.8258344531059265, "cur_kl_coeff": 0.22499997913837433}, "num_steps_sampled": 4496791, "num_steps_trained": 4496791, "load_time_ms": 19.101, "update_time_ms": 11.239, "sample_time_ms": 15367.42}, "episode_reward_max": 1491.3025067802657, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 781.6817078384834, "episodes_total": 1839, "episodes_this_iter": 53, "time_total_s": 1572.3296344280243, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 114540, "timestamp": 1556528860, "episode_len_mean": 700.0, "timesteps_since_restore": 4611331, "time_since_restore": 1610.8142988681793, "done": false, "custom_metrics": {"outflow_rate_min": 824.4478535151915, "outflow_rate_mean": 987.5389603830273, "cost2_mean": -114.4371006263144, "outflow_rate_max": 1210.9168973232252, "system_level_velocity_mean": 12.186163547607315, "system_level_velocity_min": 8.980684309248627, "cost2_max": -41.74168159532955, "cost2_min": -166.65585435621745, "cost1_min": 231.43963947103504, "cost1_max": 435.8122468422496, "cost1_mean": 321.7464164216823, "system_level_velocity_max": 16.508260341297444}, "timesteps_total": 4611331, "training_iteration": 38, "date": "2019-04-29_09-07-40", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8128>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8a90>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 38, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1076.9493695988751, "time_this_iter_s": 38.48466444015503, "info": {"grad_time_ms": 24952.846, "default": {"entropy": 1.3393688201904297, "kl": 0.019806338474154472, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015047679655253887, "vf_loss": 22.233999252319336, "total_loss": 22.223407745361328, "vf_explained_var": 0.8119717240333557, "cur_kl_coeff": 0.22499997913837433}, "num_steps_sampled": 4611331, "num_steps_trained": 4611331, "load_time_ms": 18.965, "update_time_ms": 11.204, "sample_time_ms": 15412.534}, "episode_reward_max": 1491.3025067802657, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 862.1604410155613, "episodes_total": 1894, "episodes_this_iter": 55, "time_total_s": 1610.8142988681793, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 113411, "timestamp": 1556528899, "episode_len_mean": 700.0, "timesteps_since_restore": 4724742, "time_since_restore": 1649.8972568511963, "done": false, "custom_metrics": {"outflow_rate_min": 824.4478535151915, "outflow_rate_mean": 1001.9967753676663, "cost2_mean": -108.13829503856357, "outflow_rate_max": 1138.5757666361724, "system_level_velocity_mean": 12.718400485853943, "system_level_velocity_min": 8.980684309248627, "cost2_max": -41.74168159532955, "cost2_min": -174.5586030591981, "cost1_min": 231.43963947103504, "cost1_max": 433.9277550684272, "cost1_mean": 335.4088503427513, "system_level_velocity_max": 16.411599547730393}, "timesteps_total": 4724742, "training_iteration": 39, "date": "2019-04-29_09-08-19", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54a20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54f98>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 39, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1085.7496884500245, "time_this_iter_s": 39.08295798301697, "info": {"grad_time_ms": 24819.027, "default": {"entropy": 1.324111819267273, "kl": 0.020569588989019394, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01566644012928009, "vf_loss": 23.1442813873291, "total_loss": 23.13324546813965, "vf_explained_var": 0.8007128834724426, "cur_kl_coeff": 0.22499997913837433}, "num_steps_sampled": 4724742, "num_steps_trained": 4724742, "load_time_ms": 18.444, "update_time_ms": 11.236, "sample_time_ms": 15361.532}, "episode_reward_max": 1357.74743931535, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 763.081867639573, "episodes_total": 1950, "episodes_this_iter": 56, "time_total_s": 1649.8972568511963, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 116316, "timestamp": 1556528941, "episode_len_mean": 693.3, "timesteps_since_restore": 4841058, "time_since_restore": 1692.329274892807, "done": false, "custom_metrics": {"outflow_rate_min": 466.9121252825086, "outflow_rate_mean": 998.4103642088775, "cost2_mean": -103.04983652432655, "outflow_rate_max": 1145.8333799216575, "system_level_velocity_mean": 12.965934508505235, "system_level_velocity_min": 9.65118989331111, "cost2_max": -19.027487058841725, "cost2_min": -174.5586030591981, "cost1_min": 19.174395028578715, "cost1_max": 436.25024482347123, "cost1_mean": 337.4814693944559, "system_level_velocity_max": 18.04756107113576}, "timesteps_total": 4841058, "training_iteration": 40, "date": "2019-04-29_09-09-01", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8550>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8908>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 40, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1080.7385083329596, "time_this_iter_s": 42.43201804161072, "info": {"grad_time_ms": 24833.938, "default": {"entropy": 1.3426684141159058, "kl": 0.01572803594172001, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013661987148225307, "vf_loss": 24.02741241455078, "total_loss": 24.019058227539062, "vf_explained_var": 0.7773770689964294, "cur_kl_coeff": 0.33750009536743164}, "num_steps_sampled": 4841058, "num_steps_trained": 4841058, "load_time_ms": 19.057, "update_time_ms": 11.291, "sample_time_ms": 15377.379}, "episode_reward_max": 1346.4051689068492, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 54.142669427363685, "episodes_total": 2004, "episodes_this_iter": 54, "time_total_s": 1692.329274892807, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 114983, "timestamp": 1556528982, "episode_len_mean": 679.84, "timesteps_since_restore": 4956041, "time_since_restore": 1733.4885067939758, "done": false, "custom_metrics": {"outflow_rate_min": 466.9121252825086, "outflow_rate_mean": 980.2921077701595, "cost2_mean": -107.34654748907207, "outflow_rate_max": 1145.8333799216575, "system_level_velocity_mean": 12.77322546422776, "system_level_velocity_min": 9.500046592624317, "cost2_max": -16.08961132542521, "cost2_min": -181.40668285713164, "cost1_min": 15.373954529225102, "cost1_max": 436.25024482347123, "cost1_mean": 323.59673976175895, "system_level_velocity_max": 18.053524143729025}, "timesteps_total": 4956041, "training_iteration": 41, "date": "2019-04-29_09-09-42", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54128>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54710>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 41, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1055.7507946557648, "time_this_iter_s": 41.15923190116882, "info": {"grad_time_ms": 24897.147, "default": {"entropy": 1.3645973205566406, "kl": 0.016610851511359215, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014504978433251381, "vf_loss": 21.901426315307617, "total_loss": 21.89253044128418, "vf_explained_var": 0.781644344329834, "cur_kl_coeff": 0.33750009536743164}, "num_steps_sampled": 4956041, "num_steps_trained": 4956041, "load_time_ms": 18.965, "update_time_ms": 11.31, "sample_time_ms": 15431.984}, "episode_reward_max": 1346.4051689068492, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 33.18051884602019, "episodes_total": 2061, "episodes_this_iter": 57, "time_total_s": 1733.4885067939758, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 116517, "timestamp": 1556529024, "episode_len_mean": 686.54, "timesteps_since_restore": 5072558, "time_since_restore": 1775.009732723236, "done": false, "custom_metrics": {"outflow_rate_min": 478.6715823005086, "outflow_rate_mean": 983.5006132711566, "cost2_mean": -114.2088571208763, "outflow_rate_max": 1176.8083433248707, "system_level_velocity_mean": 12.581251271408204, "system_level_velocity_min": 9.500046592624317, "cost2_max": -16.08961132542521, "cost2_min": -181.40668285713164, "cost1_min": 15.373954529225102, "cost1_max": 416.43313082006637, "cost1_mean": 323.1599456148607, "system_level_velocity_max": 18.053524143729025}, "timesteps_total": 5072558, "training_iteration": 42, "date": "2019-04-29_09-10-24", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8d30>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b85c0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 42, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1067.2173900355513, "time_this_iter_s": 41.521225929260254, "info": {"grad_time_ms": 25128.693, "default": {"entropy": 1.3431280851364136, "kl": 0.016604388132691383, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013738730922341347, "vf_loss": 23.260770797729492, "total_loss": 23.252635955810547, "vf_explained_var": 0.7735017538070679, "cur_kl_coeff": 0.33750006556510925}, "num_steps_sampled": 5072558, "num_steps_trained": 5072558, "load_time_ms": 19.905, "update_time_ms": 11.46, "sample_time_ms": 15399.069}, "episode_reward_max": 1280.9134594084285, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 33.18051884602019, "episodes_total": 2110, "episodes_this_iter": 49, "time_total_s": 1775.009732723236, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 116184, "timestamp": 1556529066, "episode_len_mean": 700.0, "timesteps_since_restore": 5188742, "time_since_restore": 1817.2031285762787, "done": false, "custom_metrics": {"outflow_rate_min": 794.8982868807498, "outflow_rate_mean": 997.1462095682953, "cost2_mean": -114.68850177220584, "outflow_rate_max": 1176.8083433248707, "system_level_velocity_mean": 12.592219466209128, "system_level_velocity_min": 7.904474734839104, "cost2_max": -44.4829163856288, "cost2_min": -169.89352458955716, "cost1_min": 208.55633415396215, "cost1_max": 440.7125111908124, "cost1_mean": 332.46151487075736, "system_level_velocity_max": 16.744449668250017}, "timesteps_total": 5188742, "training_iteration": 43, "date": "2019-04-29_09-11-06", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54e10>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d544a8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 43, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1100.171805456419, "time_this_iter_s": 42.1933958530426, "info": {"grad_time_ms": 25233.42, "default": {"entropy": 1.3599655628204346, "kl": 0.016565648838877678, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014772497117519379, "vf_loss": 24.426956176757812, "total_loss": 24.41777229309082, "vf_explained_var": 0.7750892639160156, "cur_kl_coeff": 0.33750006556510925}, "num_steps_sampled": 5188742, "num_steps_trained": 5188742, "load_time_ms": 21.623, "update_time_ms": 11.283, "sample_time_ms": 15424.221}, "episode_reward_max": 1363.1956367330133, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 849.1017663314071, "episodes_total": 2167, "episodes_this_iter": 57, "time_total_s": 1817.2031285762787, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 115180, "timestamp": 1556529106, "episode_len_mean": 693.26, "timesteps_since_restore": 5303922, "time_since_restore": 1856.9031105041504, "done": false, "custom_metrics": {"outflow_rate_min": 487.611115026176, "outflow_rate_mean": 993.0043866083026, "cost2_mean": -108.46290529837852, "outflow_rate_max": 1153.9959456485983, "system_level_velocity_mean": 12.853917705441324, "system_level_velocity_min": 7.603120581152656, "cost2_max": -17.805950526769127, "cost2_min": -160.5336733317087, "cost1_min": 16.797964603527213, "cost1_max": 433.1731397953472, "cost1_mean": 333.9907298813564, "system_level_velocity_max": 18.810778000041356}, "timesteps_total": 5303922, "training_iteration": 44, "date": "2019-04-29_09-11-46", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d419e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8b00>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8048>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 44, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1088.867707352031, "time_this_iter_s": 39.699981927871704, "info": {"grad_time_ms": 25053.923, "default": {"entropy": 1.3745183944702148, "kl": 0.01644046977162361, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013865655288100243, "vf_loss": 24.13638687133789, "total_loss": 24.128068923950195, "vf_explained_var": 0.8199837803840637, "cur_kl_coeff": 0.33750003576278687}, "num_steps_sampled": 5303922, "num_steps_trained": 5303922, "load_time_ms": 22.259, "update_time_ms": 11.324, "sample_time_ms": 15372.804}, "episode_reward_max": 1363.1956367330133, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 35.695619465527585, "episodes_total": 2218, "episodes_this_iter": 51, "time_total_s": 1856.9031105041504, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 114836, "timestamp": 1556529149, "episode_len_mean": 686.44, "timesteps_since_restore": 5418758, "time_since_restore": 1900.201877117157, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 997.5160326626619, "cost2_mean": -100.86547066141584, "outflow_rate_max": 1172.0561101234648, "system_level_velocity_mean": 13.207456712118157, "system_level_velocity_min": 7.603120581152656, "cost2_max": -13.455149112365694, "cost2_min": -159.05881091157084, "cost1_min": 11.647719067356096, "cost1_max": 436.582485025523, "cost1_mean": 339.4424751823173, "system_level_velocity_max": 18.810778000041356}, "timesteps_total": 5418758, "training_iteration": 45, "date": "2019-04-29_09-12-29", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54128>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54c88>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 45, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1081.5257328397304, "time_this_iter_s": 43.29876661300659, "info": {"grad_time_ms": 25219.493, "default": {"entropy": 1.3669662475585938, "kl": 0.016600726172327995, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015369262546300888, "vf_loss": 24.67633628845215, "total_loss": 24.66657066345215, "vf_explained_var": 0.809999942779541, "cur_kl_coeff": 0.33750006556510925}, "num_steps_sampled": 5418758, "num_steps_trained": 5418758, "load_time_ms": 21.715, "update_time_ms": 11.527, "sample_time_ms": 15452.58}, "episode_reward_max": 1390.2472222578563, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 28.56227096712715, "episodes_total": 2275, "episodes_this_iter": 57, "time_total_s": 1900.201877117157, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 115634, "timestamp": 1556529189, "episode_len_mean": 693.18, "timesteps_since_restore": 5534392, "time_since_restore": 1939.7587792873383, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 990.4077095885793, "cost2_mean": -103.49269182359095, "outflow_rate_max": 1172.0561101234648, "system_level_velocity_mean": 12.897419499447745, "system_level_velocity_min": 9.798391709635936, "cost2_max": -13.455149112365694, "cost2_min": -178.4189645424467, "cost1_min": 11.647719067356096, "cost1_max": 442.2220492253301, "cost1_mean": 336.5007488328197, "system_level_velocity_max": 16.795693154352126}, "timesteps_total": 5534392, "training_iteration": 46, "date": "2019-04-29_09-13-09", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8320>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b82e8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 46, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1082.0253324208359, "time_this_iter_s": 39.556902170181274, "info": {"grad_time_ms": 25124.135, "default": {"entropy": 1.3614201545715332, "kl": 0.016994863748550415, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015221383422613144, "vf_loss": 25.852373123168945, "total_loss": 25.8428897857666, "vf_explained_var": 0.8059245347976685, "cur_kl_coeff": 0.33750009536743164}, "num_steps_sampled": 5534392, "num_steps_trained": 5534392, "load_time_ms": 22.021, "update_time_ms": 11.339, "sample_time_ms": 15498.195}, "episode_reward_max": 1390.2472222578563, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 28.56227096712715, "episodes_total": 2331, "episodes_this_iter": 56, "time_total_s": 1939.7587792873383, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 114075, "timestamp": 1556529229, "episode_len_mean": 693.29, "timesteps_since_restore": 5648467, "time_since_restore": 1979.9132215976715, "done": false, "custom_metrics": {"outflow_rate_min": 468.9538625175205, "outflow_rate_mean": 987.4921702442251, "cost2_mean": -105.01385929832055, "outflow_rate_max": 1171.5903025679734, "system_level_velocity_mean": 12.802373284469217, "system_level_velocity_min": 9.396079555285928, "cost2_max": -19.830857480732057, "cost2_min": -178.4189645424467, "cost1_min": 19.206597488064176, "cost1_max": 450.7424598060859, "cost1_mean": 333.5625690971942, "system_level_velocity_max": 17.731302853473068}, "timesteps_total": 5648467, "training_iteration": 47, "date": "2019-04-29_09-13-49", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54c88>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54e10>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 47, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1079.507985010878, "time_this_iter_s": 40.15444231033325, "info": {"grad_time_ms": 25031.474, "default": {"entropy": 1.3850990533828735, "kl": 0.016738278791308403, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015777211636304855, "vf_loss": 25.388513565063477, "total_loss": 25.378387451171875, "vf_explained_var": 0.8078054189682007, "cur_kl_coeff": 0.33750006556510925}, "num_steps_sampled": 5648467, "num_steps_trained": 5648467, "load_time_ms": 22.232, "update_time_ms": 11.499, "sample_time_ms": 15470.946}, "episode_reward_max": 1341.7653999408974, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 45.49501012049947, "episodes_total": 2388, "episodes_this_iter": 57, "time_total_s": 1979.9132215976715, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 114080, "timestamp": 1556529268, "episode_len_mean": 693.29, "timesteps_since_restore": 5762547, "time_since_restore": 2018.9383661746979, "done": false, "custom_metrics": {"outflow_rate_min": 468.9538625175205, "outflow_rate_mean": 999.4341993309207, "cost2_mean": -107.17041744038646, "outflow_rate_max": 1173.408945522437, "system_level_velocity_mean": 12.935128246682673, "system_level_velocity_min": 9.396079555285928, "cost2_max": -19.830857480732057, "cost2_min": -165.73514237513302, "cost1_min": 19.206597488064176, "cost1_max": 436.350576378082, "cost1_mean": 336.9860289172526, "system_level_velocity_max": 17.731302853473068}, "timesteps_total": 5762547, "training_iteration": 48, "date": "2019-04-29_09-14-28", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b85c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b88d0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 48, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1083.3389619994073, "time_this_iter_s": 39.02514457702637, "info": {"grad_time_ms": 25112.818, "default": {"entropy": 1.3667504787445068, "kl": 0.016906751319766045, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015384840779006481, "vf_loss": 26.854820251464844, "total_loss": 26.845142364501953, "vf_explained_var": 0.8143543004989624, "cur_kl_coeff": 0.33750006556510925}, "num_steps_sampled": 5762547, "num_steps_trained": 5762547, "load_time_ms": 21.712, "update_time_ms": 11.103, "sample_time_ms": 15444.434}, "episode_reward_max": 1341.7653999408974, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 45.49501012049947, "episodes_total": 2442, "episodes_this_iter": 54, "time_total_s": 2018.9383661746979, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 114258, "timestamp": 1556529307, "episode_len_mean": 700.0, "timesteps_since_restore": 5876805, "time_since_restore": 2057.865842819214, "done": false, "custom_metrics": {"outflow_rate_min": 805.3063381575228, "outflow_rate_mean": 1008.3406140959893, "cost2_mean": -100.44948812043287, "outflow_rate_max": 1173.408945522437, "system_level_velocity_mean": 13.302079342933409, "system_level_velocity_min": 8.539439109272656, "cost2_max": -40.847915603821804, "cost2_min": -154.91115228632935, "cost1_min": 219.13198182603702, "cost1_max": 440.4807054234891, "cost1_mean": 350.9193622155157, "system_level_velocity_max": 16.781257920087643}, "timesteps_total": 5876805, "training_iteration": 49, "date": "2019-04-29_09-15-07", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54f98>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54e10>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 49, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1102.1396487283441, "time_this_iter_s": 38.92747664451599, "info": {"grad_time_ms": 25048.384, "default": {"entropy": 1.3589811325073242, "kl": 0.016906863078475, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015071955509483814, "vf_loss": 27.409866333007812, "total_loss": 27.40049934387207, "vf_explained_var": 0.7734495401382446, "cur_kl_coeff": 0.33750006556510925}, "num_steps_sampled": 5876805, "num_steps_trained": 5876805, "load_time_ms": 22.326, "update_time_ms": 11.006, "sample_time_ms": 15492.469}, "episode_reward_max": 1319.3846767433604, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 864.3189961873394, "episodes_total": 2499, "episodes_this_iter": 57, "time_total_s": 2057.865842819214, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 115105, "timestamp": 1556529347, "episode_len_mean": 700.0, "timesteps_since_restore": 5991910, "time_since_restore": 2097.503247499466, "done": false, "custom_metrics": {"outflow_rate_min": 805.3063381575228, "outflow_rate_mean": 1007.6116233533374, "cost2_mean": -98.31405952150506, "outflow_rate_max": 1194.6292057084293, "system_level_velocity_mean": 13.266183570291735, "system_level_velocity_min": 8.539439109272656, "cost2_max": -40.847915603821804, "cost2_min": -159.05272809220213, "cost1_min": 219.13198182603702, "cost1_max": 441.8534858184016, "cost1_mean": 350.435450794438, "system_level_velocity_max": 16.909645682747588}, "timesteps_total": 5991910, "training_iteration": 50, "date": "2019-04-29_09-15-47", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8550>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8278>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 50, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1108.3155353924028, "time_this_iter_s": 39.637404680252075, "info": {"grad_time_ms": 24773.841, "default": {"entropy": 1.3725820779800415, "kl": 0.01635935716331005, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014959674328565598, "vf_loss": 29.373519897460938, "total_loss": 29.36408042907715, "vf_explained_var": 0.794579029083252, "cur_kl_coeff": 0.33750003576278687}, "num_steps_sampled": 5991910, "num_steps_trained": 5991910, "load_time_ms": 21.558, "update_time_ms": 11.077, "sample_time_ms": 15487.123}, "episode_reward_max": 1388.72529690621, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 864.3189961873394, "episodes_total": 2558, "episodes_this_iter": 59, "time_total_s": 2097.503247499466, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 116022, "timestamp": 1556529388, "episode_len_mean": 679.72, "timesteps_since_restore": 6107932, "time_since_restore": 2138.455859899521, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 990.871195244074, "cost2_mean": -100.75100385985354, "outflow_rate_max": 1194.6292057084293, "system_level_velocity_mean": 13.136837755428735, "system_level_velocity_min": 9.675749290713552, "cost2_max": -12.766918704045198, "cost2_min": -168.58573528960494, "cost1_min": 11.620936721546107, "cost1_max": 441.8534858184016, "cost1_mean": 333.6097319553459, "system_level_velocity_max": 18.30063642806593}, "timesteps_total": 6107932, "training_iteration": 51, "date": "2019-04-29_09-16-28", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8668>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8198>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 51, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1067.1371208698627, "time_this_iter_s": 40.95261240005493, "info": {"grad_time_ms": 24799.084, "default": {"entropy": 1.4018982648849487, "kl": 0.016734816133975983, "cur_lr": 0.0005000000237487257, "policy_loss": -0.013197056949138641, "vf_loss": 25.651382446289062, "total_loss": 25.64383316040039, "vf_explained_var": 0.8171821236610413, "cur_kl_coeff": 0.33750009536743164}, "num_steps_sampled": 6107932, "num_steps_trained": 6107932, "load_time_ms": 22.785, "update_time_ms": 11.037, "sample_time_ms": 15440.995}, "episode_reward_max": 1388.72529690621, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 23.104775153203356, "episodes_total": 2609, "episodes_this_iter": 51, "time_total_s": 2138.455859899521, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 113785, "timestamp": 1556529426, "episode_len_mean": 679.72, "timesteps_since_restore": 6221717, "time_since_restore": 2175.8624305725098, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 985.6514116592018, "cost2_mean": -96.20571520323381, "outflow_rate_max": 1158.970722781773, "system_level_velocity_mean": 13.328829533319743, "system_level_velocity_min": 9.52067014149699, "cost2_max": -12.766918704045198, "cost2_min": -168.58573528960494, "cost1_min": 11.620936721546107, "cost1_max": 434.40055051961247, "cost1_mean": 338.1531611791745, "system_level_velocity_max": 18.30063642806593}, "timesteps_total": 6221717, "training_iteration": 52, "date": "2019-04-29_09-17-06", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54ba8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54f98>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 52, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1061.8758363285672, "time_this_iter_s": 37.40657067298889, "info": {"grad_time_ms": 24407.496, "default": {"entropy": 1.3717079162597656, "kl": 0.016975481063127518, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015392688103020191, "vf_loss": 27.60503387451172, "total_loss": 27.595373153686523, "vf_explained_var": 0.8049620985984802, "cur_kl_coeff": 0.33750009536743164}, "num_steps_sampled": 6221717, "num_steps_trained": 6221717, "load_time_ms": 22.809, "update_time_ms": 10.917, "sample_time_ms": 15419.801}, "episode_reward_max": 1279.0514525033661, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 23.104775153203356, "episodes_total": 2665, "episodes_this_iter": 56, "time_total_s": 2175.8624305725098, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 113331, "timestamp": 1556529466, "episode_len_mean": 700.0, "timesteps_since_restore": 6335048, "time_since_restore": 2215.9730927944183, "done": false, "custom_metrics": {"outflow_rate_min": 810.4361430665588, "outflow_rate_mean": 1001.3138541169815, "cost2_mean": -97.34844276789946, "outflow_rate_max": 1148.7808295498453, "system_level_velocity_mean": 13.316670505421872, "system_level_velocity_min": 9.797486744372462, "cost2_max": -42.952446509272555, "cost2_min": -162.04073724654612, "cost1_min": 250.07170139904224, "cost1_max": 435.9516627264706, "cost1_mean": 350.68166592068735, "system_level_velocity_max": 16.69390016560699}, "timesteps_total": 6335048, "training_iteration": 53, "date": "2019-04-29_09-17-46", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b84a8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b81d0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 53, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1095.9718090087563, "time_this_iter_s": 40.11066222190857, "info": {"grad_time_ms": 24206.167, "default": {"entropy": 1.3951221704483032, "kl": 0.01746659353375435, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015568905510008335, "vf_loss": 25.26234245300293, "total_loss": 25.252670288085938, "vf_explained_var": 0.823870062828064, "cur_kl_coeff": 0.33750006556510925}, "num_steps_sampled": 6335048, "num_steps_trained": 6335048, "load_time_ms": 22.676, "update_time_ms": 11.038, "sample_time_ms": 15411.929}, "episode_reward_max": 1294.6437052870187, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 854.3501891863165, "episodes_total": 2721, "episodes_this_iter": 56, "time_total_s": 2215.9730927944183, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 110692, "timestamp": 1556529505, "episode_len_mean": 700.0, "timesteps_since_restore": 6445740, "time_since_restore": 2254.924290418625, "done": false, "custom_metrics": {"outflow_rate_min": 834.7952075101514, "outflow_rate_mean": 996.58182406241, "cost2_mean": -92.31877930790864, "outflow_rate_max": 1161.588926928896, "system_level_velocity_mean": 13.359415257978682, "system_level_velocity_min": 8.368522456743467, "cost2_max": -34.21629022938743, "cost2_min": -149.21558705996875, "cost1_min": 213.49437350587024, "cost1_max": 445.2036408706173, "cost1_mean": 351.46954632199953, "system_level_velocity_max": 17.031800885682298}, "timesteps_total": 6445740, "training_iteration": 54, "date": "2019-04-29_09-18-25", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49668>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49cc0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 54, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1085.9810092099024, "time_this_iter_s": 38.95119762420654, "info": {"grad_time_ms": 24122.911, "default": {"entropy": 1.3796056509017944, "kl": 0.01727018691599369, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015751158818602562, "vf_loss": 28.705663681030273, "total_loss": 28.695741653442383, "vf_explained_var": 0.7788920998573303, "cur_kl_coeff": 0.33750003576278687}, "num_steps_sampled": 6445740, "num_steps_trained": 6445740, "load_time_ms": 21.451, "update_time_ms": 11.043, "sample_time_ms": 15421.482}, "episode_reward_max": 1343.7643116930572, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 828.8811310825562, "episodes_total": 2778, "episodes_this_iter": 57, "time_total_s": 2254.924290418625, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 110680, "timestamp": 1556529545, "episode_len_mean": 700.0, "timesteps_since_restore": 6556420, "time_since_restore": 2294.88006401062, "done": false, "custom_metrics": {"outflow_rate_min": 834.7952075101514, "outflow_rate_mean": 995.0616758153119, "cost2_mean": -87.86415530193155, "outflow_rate_max": 1168.6117621999238, "system_level_velocity_mean": 13.591634288512822, "system_level_velocity_min": 8.368522456743467, "cost2_max": -34.21629022938743, "cost2_min": -161.36958955835217, "cost1_min": 213.49437350587024, "cost1_max": 454.8739309982691, "cost1_mean": 356.75632114478685, "system_level_velocity_max": 17.387399432512893}, "timesteps_total": 6556420, "training_iteration": 55, "date": "2019-04-29_09-19-05", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b82b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8438>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 55, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1079.0938090195982, "time_this_iter_s": 39.95577359199524, "info": {"grad_time_ms": 23872.306, "default": {"entropy": 1.3934354782104492, "kl": 0.01689709722995758, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015532544814050198, "vf_loss": 28.570724487304688, "total_loss": 28.560895919799805, "vf_explained_var": 0.8014678955078125, "cur_kl_coeff": 0.33750003576278687}, "num_steps_sampled": 6556420, "num_steps_trained": 6556420, "load_time_ms": 21.397, "update_time_ms": 11.048, "sample_time_ms": 15338.449}, "episode_reward_max": 1294.438461150568, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 828.8811310825562, "episodes_total": 2837, "episodes_this_iter": 59, "time_total_s": 2294.88006401062, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 111125, "timestamp": 1556529581, "episode_len_mean": 700.0, "timesteps_since_restore": 6667545, "time_since_restore": 2331.5133023262024, "done": false, "custom_metrics": {"outflow_rate_min": 762.2254232013544, "outflow_rate_mean": 988.1287020035508, "cost2_mean": -80.3807305927967, "outflow_rate_max": 1182.784778181364, "system_level_velocity_mean": 13.785913624065085, "system_level_velocity_min": 7.977209111657256, "cost2_max": -34.63910754317547, "cost2_min": -161.36958955835217, "cost1_min": 210.5852608387563, "cost1_max": 446.53458572972545, "cost1_mean": 361.82642903464694, "system_level_velocity_max": 17.002163232114338}, "timesteps_total": 6667545, "training_iteration": 56, "date": "2019-04-29_09-19-41", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49f60>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49e10>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 56, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1071.0479108739714, "time_this_iter_s": 36.633238315582275, "info": {"grad_time_ms": 23629.708, "default": {"entropy": 1.3860914707183838, "kl": 0.017372453585267067, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015162553638219833, "vf_loss": 31.48052406311035, "total_loss": 31.471227645874023, "vf_explained_var": 0.7633662819862366, "cur_kl_coeff": 0.33750003576278687}, "num_steps_sampled": 6667545, "num_steps_trained": 6667545, "load_time_ms": 21.427, "update_time_ms": 11.008, "sample_time_ms": 15290.077}, "episode_reward_max": 1342.4322975118941, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 793.8718383071724, "episodes_total": 2898, "episodes_this_iter": 61, "time_total_s": 2331.5133023262024, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 112601, "timestamp": 1556529620, "episode_len_mean": 700.0, "timesteps_since_restore": 6780146, "time_since_restore": 2370.29291844368, "done": false, "custom_metrics": {"outflow_rate_min": 762.2254232013544, "outflow_rate_mean": 991.0620443620378, "cost2_mean": -83.59839631646908, "outflow_rate_max": 1182.784778181364, "system_level_velocity_mean": 13.79412611383794, "system_level_velocity_min": 7.977209111657256, "cost2_max": -33.856770526873674, "cost2_min": -154.8351219979391, "cost1_min": 210.5852608387563, "cost1_max": 446.53458572972545, "cost1_mean": 362.53000482043205, "system_level_velocity_max": 17.002163232114338}, "timesteps_total": 6780146, "training_iteration": 57, "date": "2019-04-29_09-20-20", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b80f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d419e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49ef0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 57, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1086.670822804755, "time_this_iter_s": 38.77961611747742, "info": {"grad_time_ms": 23577.704, "default": {"entropy": 1.3834515810012817, "kl": 0.017837129533290863, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015842249616980553, "vf_loss": 30.00667953491211, "total_loss": 29.996856689453125, "vf_explained_var": 0.7830154299736023, "cur_kl_coeff": 0.33750003576278687}, "num_steps_sampled": 6780146, "num_steps_trained": 6780146, "load_time_ms": 21.265, "update_time_ms": 10.691, "sample_time_ms": 15206.706}, "episode_reward_max": 1342.4322975118941, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 821.2802458992287, "episodes_total": 2952, "episodes_this_iter": 54, "time_total_s": 2370.29291844368, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 113150, "timestamp": 1556529661, "episode_len_mean": 686.47, "timesteps_since_restore": 6893296, "time_since_restore": 2410.805737018585, "done": false, "custom_metrics": {"outflow_rate_min": 450.9267471876343, "outflow_rate_mean": 983.6305575984447, "cost2_mean": -89.21186972593146, "outflow_rate_max": 1151.1516837412323, "system_level_velocity_mean": 13.62178990874469, "system_level_velocity_min": 9.529575967024453, "cost2_max": -14.614849790799129, "cost2_min": -154.8351219979391, "cost1_min": 12.391436419549514, "cost1_max": 443.5547067708374, "cost1_mean": 348.62857937551837, "system_level_velocity_max": 18.32097910967658}, "timesteps_total": 6893296, "training_iteration": 58, "date": "2019-04-29_09-21-01", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b83c8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8c50>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 58, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1065.977473869999, "time_this_iter_s": 40.512818574905396, "info": {"grad_time_ms": 23683.831, "default": {"entropy": 1.3962035179138184, "kl": 0.018064556643366814, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015863191336393356, "vf_loss": 31.721933364868164, "total_loss": 31.712167739868164, "vf_explained_var": 0.7864301800727844, "cur_kl_coeff": 0.33750009536743164}, "num_steps_sampled": 6893296, "num_steps_trained": 6893296, "load_time_ms": 21.259, "update_time_ms": 11.092, "sample_time_ms": 15246.691}, "episode_reward_max": 1280.744283534668, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 27.109215684074563, "episodes_total": 3014, "episodes_this_iter": 62, "time_total_s": 2410.805737018585, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 112042, "timestamp": 1556529699, "episode_len_mean": 668.5, "timesteps_since_restore": 7005338, "time_since_restore": 2448.855869293213, "done": false, "custom_metrics": {"outflow_rate_min": 450.9267471876343, "outflow_rate_mean": 976.7229211718673, "cost2_mean": -88.12205388529331, "outflow_rate_max": 1141.8667048944144, "system_level_velocity_mean": 13.756247469243158, "system_level_velocity_min": 9.356524860861768, "cost2_max": -13.834005253751993, "cost2_min": -155.2402601982077, "cost1_min": 11.762922153621574, "cost1_max": 439.07098169688373, "cost1_mean": 340.9108320258779, "system_level_velocity_max": 18.5085477379561}, "timesteps_total": 7005338, "training_iteration": 59, "date": "2019-04-29_09-21-39", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b29e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54c50>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54748>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 59, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1036.9402982391016, "time_this_iter_s": 38.050132274627686, "info": {"grad_time_ms": 23587.619, "default": {"entropy": 1.4101381301879883, "kl": 0.01764334924519062, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01737343892455101, "vf_loss": 28.51186752319336, "total_loss": 28.500450134277344, "vf_explained_var": 0.7914834022521973, "cur_kl_coeff": 0.33750006556510925}, "num_steps_sampled": 7005338, "num_steps_trained": 7005338, "load_time_ms": 21.013, "update_time_ms": 11.12, "sample_time_ms": 15253.989}, "episode_reward_max": 1304.7131042972449, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 23.138431181034882, "episodes_total": 3072, "episodes_this_iter": 58, "time_total_s": 2448.855869293213, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 112504, "timestamp": 1556529740, "episode_len_mean": 681.96, "timesteps_since_restore": 7117842, "time_since_restore": 2489.906624317169, "done": false, "custom_metrics": {"outflow_rate_min": 455.34447721462936, "outflow_rate_mean": 984.3389085016688, "cost2_mean": -89.57360330408216, "outflow_rate_max": 1141.8667048944144, "system_level_velocity_mean": 13.558453549106982, "system_level_velocity_min": 9.356524860861768, "cost2_max": -13.834005253751993, "cost2_min": -149.46137063333975, "cost1_min": 11.762922153621574, "cost1_max": 448.5750830571661, "cost1_mean": 343.9037604329145, "system_level_velocity_max": 18.95585655575906}, "timesteps_total": 7117842, "training_iteration": 60, "date": "2019-04-29_09-22-20", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54da0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d419e8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 60, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1048.2347414483675, "time_this_iter_s": 41.0507550239563, "info": {"grad_time_ms": 23756.649, "default": {"entropy": 1.4147779941558838, "kl": 0.017031613737344742, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015652013942599297, "vf_loss": 28.754940032958984, "total_loss": 28.74503517150879, "vf_explained_var": 0.799426257610321, "cur_kl_coeff": 0.33750003576278687}, "num_steps_sampled": 7117842, "num_steps_trained": 7117842, "load_time_ms": 22.17, "update_time_ms": 11.079, "sample_time_ms": 15224.893}, "episode_reward_max": 1304.7131042972449, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 23.138431181034882, "episodes_total": 3132, "episodes_this_iter": 60, "time_total_s": 2489.906624317169, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 112222, "timestamp": 1556529781, "episode_len_mean": 693.26, "timesteps_since_restore": 7230064, "time_since_restore": 2530.7582397460938, "done": false, "custom_metrics": {"outflow_rate_min": 489.7762375340705, "outflow_rate_mean": 989.1380327501256, "cost2_mean": -91.33981404571352, "outflow_rate_max": 1137.7887563727904, "system_level_velocity_mean": 13.510573887580978, "system_level_velocity_min": 8.224769458381076, "cost2_max": -14.900591491695003, "cost2_min": -155.06831727972173, "cost1_min": 16.60399812187024, "cost1_max": 448.5750830571661, "cost1_mean": 349.1465237648357, "system_level_velocity_max": 18.95585655575906}, "timesteps_total": 7230064, "training_iteration": 61, "date": "2019-04-29_09-23-01", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d543c8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d542b0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 61, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1066.5916009232078, "time_this_iter_s": 40.85161542892456, "info": {"grad_time_ms": 23724.775, "default": {"entropy": 1.4154402017593384, "kl": 0.017321713268756866, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015538248233497143, "vf_loss": 29.7379150390625, "total_loss": 29.728221893310547, "vf_explained_var": 0.8003458976745605, "cur_kl_coeff": 0.33750006556510925}, "num_steps_sampled": 7230064, "num_steps_trained": 7230064, "load_time_ms": 21.182, "update_time_ms": 11.152, "sample_time_ms": 15247.532}, "episode_reward_max": 1280.6614904153957, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 41.45367425975335, "episodes_total": 3187, "episodes_this_iter": 55, "time_total_s": 2530.7582397460938, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 113079, "timestamp": 1556529822, "episode_len_mean": 700.0, "timesteps_since_restore": 7343143, "time_since_restore": 2571.9944701194763, "done": false, "custom_metrics": {"outflow_rate_min": 847.5331222526222, "outflow_rate_mean": 987.9348743478866, "cost2_mean": -89.4283847810134, "outflow_rate_max": 1136.1416907409337, "system_level_velocity_mean": 13.44715979471343, "system_level_velocity_min": 9.865936139241056, "cost2_max": -34.96710727057952, "cost2_min": -155.06831727972173, "cost1_min": 252.95320513642483, "cost1_max": 437.705180737305, "cost1_mean": 352.24362041121253, "system_level_velocity_max": 16.837143763628493}, "timesteps_total": 7343143, "training_iteration": 62, "date": "2019-04-29_09-23-42", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54cc0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 62, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1067.721120702962, "time_this_iter_s": 41.23623037338257, "info": {"grad_time_ms": 24044.04, "default": {"entropy": 1.4149532318115234, "kl": 0.0172816663980484, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01596035808324814, "vf_loss": 30.668563842773438, "total_loss": 30.658435821533203, "vf_explained_var": 0.8019831776618958, "cur_kl_coeff": 0.33750009536743164}, "num_steps_sampled": 7343143, "num_steps_trained": 7343143, "load_time_ms": 20.308, "update_time_ms": 11.361, "sample_time_ms": 15312.631}, "episode_reward_max": 1283.2114912482027, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 825.6759981483659, "episodes_total": 3246, "episodes_this_iter": 59, "time_total_s": 2571.9944701194763, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 113217, "timestamp": 1556529862, "episode_len_mean": 693.25, "timesteps_since_restore": 7456360, "time_since_restore": 2611.9319694042206, "done": false, "custom_metrics": {"outflow_rate_min": 465.1419302094698, "outflow_rate_mean": 989.8250927482541, "cost2_mean": -87.5681117823047, "outflow_rate_max": 1190.7447012743153, "system_level_velocity_mean": 13.761415876202014, "system_level_velocity_min": 9.876437644593011, "cost2_max": -18.131011757887418, "cost2_min": -139.7542911537909, "cost1_min": 16.763169887279542, "cost1_max": 445.66224567182155, "cost1_mean": 356.35708672250263, "system_level_velocity_max": 17.849620124837426}, "timesteps_total": 7456360, "training_iteration": 63, "date": "2019-04-29_09-24-22", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54748>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d549b0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 63, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1069.3787955312907, "time_this_iter_s": 39.93749928474426, "info": {"grad_time_ms": 24065.848, "default": {"entropy": 1.4269245862960815, "kl": 0.017514431849122047, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015795091167092323, "vf_loss": 30.47813606262207, "total_loss": 30.468250274658203, "vf_explained_var": 0.8050552010536194, "cur_kl_coeff": 0.33750006556510925}, "num_steps_sampled": 7456360, "num_steps_trained": 7456360, "load_time_ms": 18.789, "update_time_ms": 11.259, "sample_time_ms": 15276.709}, "episode_reward_max": 1329.6299182571145, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 43.34804235602857, "episodes_total": 3298, "episodes_this_iter": 52, "time_total_s": 2611.9319694042206, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 113115, "timestamp": 1556529903, "episode_len_mean": 700.0, "timesteps_since_restore": 7569475, "time_since_restore": 2652.6923384666443, "done": false, "custom_metrics": {"outflow_rate_min": 812.9898075934565, "outflow_rate_mean": 987.3007265099945, "cost2_mean": -88.66435627456077, "outflow_rate_max": 1132.7299728109263, "system_level_velocity_mean": 13.562975775541425, "system_level_velocity_min": 8.882567306612872, "cost2_max": -34.28584328353262, "cost2_min": -151.08681092515022, "cost1_min": 228.3362740220432, "cost1_max": 446.44550869200896, "cost1_mean": 355.5450886071824, "system_level_velocity_max": 17.217143562310603}, "timesteps_total": 7569475, "training_iteration": 64, "date": "2019-04-29_09-25-03", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54160>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54f28>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 64, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1070.2941770279785, "time_this_iter_s": 40.760369062423706, "info": {"grad_time_ms": 24183.789, "default": {"entropy": 1.4408432245254517, "kl": 0.01727091148495674, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015825161710381508, "vf_loss": 30.45733070373535, "total_loss": 30.44733428955078, "vf_explained_var": 0.8045018315315247, "cur_kl_coeff": 0.33750009536743164}, "num_steps_sampled": 7569475, "num_steps_trained": 7569475, "load_time_ms": 19.88, "update_time_ms": 11.353, "sample_time_ms": 15339.633}, "episode_reward_max": 1307.1089411523346, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 839.4044196152632, "episodes_total": 3355, "episodes_this_iter": 57, "time_total_s": 2652.6923384666443, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 111849, "timestamp": 1556529943, "episode_len_mean": 686.68, "timesteps_since_restore": 7681324, "time_since_restore": 2692.65048289299, "done": false, "custom_metrics": {"outflow_rate_min": 476.10320957347216, "outflow_rate_mean": 978.9883377254141, "cost2_mean": -87.81954903633292, "outflow_rate_max": 1223.12824549865, "system_level_velocity_mean": 13.638049771620146, "system_level_velocity_min": 8.882567306612872, "cost2_max": -19.02389171209729, "cost2_min": -153.2029172698689, "cost1_min": 17.64173096890951, "cost1_max": 446.44550869200896, "cost1_mean": 347.69407547594056, "system_level_velocity_max": 18.978561947862794}, "timesteps_total": 7681324, "training_iteration": 65, "date": "2019-04-29_09-25-43", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d543c8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54ba8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 65, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1044.3046106922354, "time_this_iter_s": 39.958144426345825, "info": {"grad_time_ms": 24141.177, "default": {"entropy": 1.4096671342849731, "kl": 0.018826160579919815, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01645478792488575, "vf_loss": 30.470497131347656, "total_loss": 30.460397720336914, "vf_explained_var": 0.8103469014167786, "cur_kl_coeff": 0.33750003576278687}, "num_steps_sampled": 7681324, "num_steps_trained": 7681324, "load_time_ms": 20.652, "update_time_ms": 11.217, "sample_time_ms": 15381.472}, "episode_reward_max": 1378.9815589642712, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 37.847964031667125, "episodes_total": 3416, "episodes_this_iter": 61, "time_total_s": 2692.65048289299, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 112608, "timestamp": 1556529981, "episode_len_mean": 673.16, "timesteps_since_restore": 7793932, "time_since_restore": 2730.596169233322, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 966.8811731106874, "cost2_mean": -82.8425411054833, "outflow_rate_max": 1223.12824549865, "system_level_velocity_mean": 13.883650551827593, "system_level_velocity_min": 9.78718659720374, "cost2_max": -13.29030409365919, "cost2_min": -153.2029172698689, "cost1_min": 11.661955984749852, "cost1_max": 445.52203158434736, "cost1_mean": 345.17161645512164, "system_level_velocity_max": 18.978561947862794}, "timesteps_total": 7793932, "training_iteration": 66, "date": "2019-04-29_09-26-21", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54940>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54240>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 66, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1024.691124596033, "time_this_iter_s": 37.94568634033203, "info": {"grad_time_ms": 24271.563, "default": {"entropy": 1.437803030014038, "kl": 0.01778797060251236, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015381771139800549, "vf_loss": 29.936019897460938, "total_loss": 29.9266414642334, "vf_explained_var": 0.8290058970451355, "cur_kl_coeff": 0.33750003576278687}, "num_steps_sampled": 7793932, "num_steps_trained": 7793932, "load_time_ms": 20.599, "update_time_ms": 11.758, "sample_time_ms": 15381.003}, "episode_reward_max": 1378.9815589642712, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 28.626979221368135, "episodes_total": 3471, "episodes_this_iter": 55, "time_total_s": 2730.596169233322, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 111081, "timestamp": 1556530021, "episode_len_mean": 686.71, "timesteps_since_restore": 7905013, "time_since_restore": 2770.218700647354, "done": false, "custom_metrics": {"outflow_rate_min": 487.7014067219132, "outflow_rate_mean": 975.0514013261251, "cost2_mean": -82.53441715583718, "outflow_rate_max": 1229.830401222926, "system_level_velocity_mean": 13.900707627818615, "system_level_velocity_min": 10.233595744717123, "cost2_max": -18.652133979272577, "cost2_min": -158.48591471193816, "cost1_min": 19.943075316005242, "cost1_max": 454.5555902435848, "cost1_mean": 354.33319592259096, "system_level_velocity_max": 18.348945153256626}, "timesteps_total": 7905013, "training_iteration": 67, "date": "2019-04-29_09-27-01", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54a90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54c18>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 67, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1035.1846110495171, "time_this_iter_s": 39.62253141403198, "info": {"grad_time_ms": 24261.007, "default": {"entropy": 1.4148499965667725, "kl": 0.01757807284593582, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01539834775030613, "vf_loss": 35.19059371948242, "total_loss": 35.18113327026367, "vf_explained_var": 0.7921628355979919, "cur_kl_coeff": 0.33750006556510925}, "num_steps_sampled": 7905013, "num_steps_trained": 7905013, "load_time_ms": 20.804, "update_time_ms": 11.868, "sample_time_ms": 15473.31}, "episode_reward_max": 1380.4636342717204, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 46.85258470491168, "episodes_total": 3533, "episodes_this_iter": 62, "time_total_s": 2770.218700647354, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 113188, "timestamp": 1556530060, "episode_len_mean": 693.41, "timesteps_since_restore": 8018201, "time_since_restore": 2809.464755296707, "done": false, "custom_metrics": {"outflow_rate_min": 503.27816435610924, "outflow_rate_mean": 986.2971256242672, "cost2_mean": -87.1169082665393, "outflow_rate_max": 1229.830401222926, "system_level_velocity_mean": 13.852513282986525, "system_level_velocity_min": 9.35276533746962, "cost2_max": -18.652133979272577, "cost2_min": -141.4111060969519, "cost1_min": 26.932055975376283, "cost1_max": 454.5555902435848, "cost1_mean": 357.7153381727811, "system_level_velocity_max": 18.348945153256626}, "timesteps_total": 8018201, "training_iteration": 68, "date": "2019-04-29_09-27-40", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54940>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54cc0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 68, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1060.1009401316662, "time_this_iter_s": 39.24605464935303, "info": {"grad_time_ms": 24214.167, "default": {"entropy": 1.4381663799285889, "kl": 0.01870548166334629, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015969667583703995, "vf_loss": 31.050251007080078, "total_loss": 31.04059600830078, "vf_explained_var": 0.8230128884315491, "cur_kl_coeff": 0.33750006556510925}, "num_steps_sampled": 8018201, "num_steps_trained": 8018201, "load_time_ms": 21.004, "update_time_ms": 11.779, "sample_time_ms": 15392.278}, "episode_reward_max": 1380.4636342717204, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 65.77880789406403, "episodes_total": 3590, "episodes_this_iter": 57, "time_total_s": 2809.464755296707, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 112939, "timestamp": 1556530098, "episode_len_mean": 700.0, "timesteps_since_restore": 8131140, "time_since_restore": 2847.555358171463, "done": false, "custom_metrics": {"outflow_rate_min": 783.313711886297, "outflow_rate_mean": 976.8453190112018, "cost2_mean": -89.64139002328308, "outflow_rate_max": 1160.6718324505564, "system_level_velocity_mean": 13.437729992734269, "system_level_velocity_min": 9.532373009453025, "cost2_max": -39.35634266905216, "cost2_min": -151.19033543617843, "cost1_min": 236.56256267754665, "cost1_max": 448.6444851764636, "cost1_mean": 351.1755874778155, "system_level_velocity_max": 17.294178387985966}, "timesteps_total": 8131140, "training_iteration": 69, "date": "2019-04-29_09-28-18", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54b70>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54860>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 69, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1053.3642542838459, "time_this_iter_s": 38.09060287475586, "info": {"grad_time_ms": 24180.548, "default": {"entropy": 1.4620157480239868, "kl": 0.017415262758731842, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01586257666349411, "vf_loss": 34.51545333862305, "total_loss": 34.50546646118164, "vf_explained_var": 0.7944762110710144, "cur_kl_coeff": 0.33750006556510925}, "num_steps_sampled": 8131140, "num_steps_trained": 8131140, "load_time_ms": 21.014, "update_time_ms": 11.933, "sample_time_ms": 15431.668}, "episode_reward_max": 1218.6470494199389, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 883.1412898539812, "episodes_total": 3651, "episodes_this_iter": 61, "time_total_s": 2847.555358171463, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 112846, "timestamp": 1556530138, "episode_len_mean": 700.0, "timesteps_since_restore": 8243986, "time_since_restore": 2887.2639043331146, "done": false, "custom_metrics": {"outflow_rate_min": 808.902262583709, "outflow_rate_mean": 975.824457339706, "cost2_mean": -91.59292629548389, "outflow_rate_max": 1135.5210483071362, "system_level_velocity_mean": 13.469737731308935, "system_level_velocity_min": 9.631539623689298, "cost2_max": -39.35634266905216, "cost2_min": -151.19033543617843, "cost1_min": 246.49564527731533, "cost1_max": 448.6444851764636, "cost1_mean": 352.83602040125015, "system_level_velocity_max": 17.294178387985966}, "timesteps_total": 8243986, "training_iteration": 70, "date": "2019-04-29_09-28-58", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d540b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d495c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa187180f98>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 70, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1067.5793941363686, "time_this_iter_s": 39.70854616165161, "info": {"grad_time_ms": 24084.538, "default": {"entropy": 1.4564197063446045, "kl": 0.018097087740898132, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01506374217569828, "vf_loss": 33.141990661621094, "total_loss": 33.133033752441406, "vf_explained_var": 0.7928367257118225, "cur_kl_coeff": 0.33750006556510925}, "num_steps_sampled": 8243986, "num_steps_trained": 8243986, "load_time_ms": 19.896, "update_time_ms": 12.306, "sample_time_ms": 15396.13}, "episode_reward_max": 1250.1724991248807, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 883.1412898539812, "episodes_total": 3709, "episodes_this_iter": 58, "time_total_s": 2887.2639043331146, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 110799, "timestamp": 1556530178, "episode_len_mean": 700.0, "timesteps_since_restore": 8354785, "time_since_restore": 2926.7590506076813, "done": false, "custom_metrics": {"outflow_rate_min": 802.1557564455927, "outflow_rate_mean": 968.8083149496921, "cost2_mean": -91.23653235552058, "outflow_rate_max": 1135.5210483071362, "system_level_velocity_mean": 13.358911583339687, "system_level_velocity_min": 9.631539623689298, "cost2_max": -38.90284384037729, "cost2_min": -144.86871069204702, "cost1_min": 246.49564527731533, "cost1_max": 439.04070923636095, "cost1_mean": 350.155574975725, "system_level_velocity_max": 16.65395889941155}, "timesteps_total": 8354785, "training_iteration": 71, "date": "2019-04-29_09-29-38", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d548d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54f60>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 71, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1055.930565388796, "time_this_iter_s": 39.49514627456665, "info": {"grad_time_ms": 23954.098, "default": {"entropy": 1.4564075469970703, "kl": 0.018704131245613098, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016876839101314545, "vf_loss": 33.31367111206055, "total_loss": 33.303104400634766, "vf_explained_var": 0.7926939725875854, "cur_kl_coeff": 0.33750006556510925}, "num_steps_sampled": 8354785, "num_steps_trained": 8354785, "load_time_ms": 20.922, "update_time_ms": 12.287, "sample_time_ms": 15388.039}, "episode_reward_max": 1270.3756190086099, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 853.369005579996, "episodes_total": 3768, "episodes_this_iter": 59, "time_total_s": 2926.7590506076813, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 110500, "timestamp": 1556530217, "episode_len_mean": 700.0, "timesteps_since_restore": 8465285, "time_since_restore": 2965.710354089737, "done": false, "custom_metrics": {"outflow_rate_min": 787.3897238912709, "outflow_rate_mean": 980.8076279639489, "cost2_mean": -87.190938525912, "outflow_rate_max": 1188.253392530695, "system_level_velocity_mean": 13.756658467316374, "system_level_velocity_min": 10.130593330075103, "cost2_max": -30.31961824673545, "cost2_min": -147.0551477739453, "cost1_min": 260.20095451244856, "cost1_max": 460.130514155731, "cost1_mean": 360.73514525430636, "system_level_velocity_max": 17.967941722515434}, "timesteps_total": 8465285, "training_iteration": 72, "date": "2019-04-29_09-30-17", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49a58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49b00>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 72, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1055.33524525887, "time_this_iter_s": 38.951303482055664, "info": {"grad_time_ms": 23761.608, "default": {"entropy": 1.4409786462783813, "kl": 0.01896943338215351, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016716694459319115, "vf_loss": 33.429161071777344, "total_loss": 33.418846130371094, "vf_explained_var": 0.7735259532928467, "cur_kl_coeff": 0.33750009536743164}, "num_steps_sampled": 8465285, "num_steps_trained": 8465285, "load_time_ms": 20.687, "update_time_ms": 12.203, "sample_time_ms": 15353.419}, "episode_reward_max": 1270.3756190086099, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 807.7773883912047, "episodes_total": 3827, "episodes_this_iter": 59, "time_total_s": 2965.710354089737, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 111687, "timestamp": 1556530256, "episode_len_mean": 700.0, "timesteps_since_restore": 8576972, "time_since_restore": 3005.3365535736084, "done": false, "custom_metrics": {"outflow_rate_min": 787.3897238912709, "outflow_rate_mean": 986.7184272640152, "cost2_mean": -87.75805852539419, "outflow_rate_max": 1188.253392530695, "system_level_velocity_mean": 13.837679620250675, "system_level_velocity_min": 9.361659771448497, "cost2_max": -30.31961824673545, "cost2_min": -159.17137474257962, "cost1_min": 241.5623567340511, "cost1_max": 460.130514155731, "cost1_mean": 361.99781941285835, "system_level_velocity_max": 17.967941722515434}, "timesteps_total": 8576972, "training_iteration": 73, "date": "2019-04-29_09-30-56", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d545f8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54ba8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 73, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1060.9161456806364, "time_this_iter_s": 39.62619948387146, "info": {"grad_time_ms": 23732.698, "default": {"entropy": 1.4420212507247925, "kl": 0.018989887088537216, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016444455832242966, "vf_loss": 34.94997024536133, "total_loss": 34.93993377685547, "vf_explained_var": 0.7836951017379761, "cur_kl_coeff": 0.33750006556510925}, "num_steps_sampled": 8576972, "num_steps_trained": 8576972, "load_time_ms": 20.596, "update_time_ms": 12.312, "sample_time_ms": 15351.451}, "episode_reward_max": 1328.6811419436563, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 807.7773883912047, "episodes_total": 3889, "episodes_this_iter": 62, "time_total_s": 3005.3365535736084, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 112989, "timestamp": 1556530297, "episode_len_mean": 693.18, "timesteps_since_restore": 8689961, "time_since_restore": 3045.7833671569824, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 969.3322108160054, "cost2_mean": -84.43741066357515, "outflow_rate_max": 1141.8230889633749, "system_level_velocity_mean": 13.694763497293932, "system_level_velocity_min": 9.361659771448497, "cost2_max": -13.317029718594764, "cost2_min": -159.17137474257962, "cost1_min": 11.604354823630494, "cost1_max": 446.6467204460817, "cost1_mean": 354.32605172828266, "system_level_velocity_max": 17.357617937870312}, "timesteps_total": 8689961, "training_iteration": 74, "date": "2019-04-29_09-31-37", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49e10>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49160>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 74, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1044.232299868261, "time_this_iter_s": 40.44681358337402, "info": {"grad_time_ms": 23716.813, "default": {"entropy": 1.4546700716018677, "kl": 0.018688056617975235, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01785285212099552, "vf_loss": 32.673988342285156, "total_loss": 32.662445068359375, "vf_explained_var": 0.7882893085479736, "cur_kl_coeff": 0.33750006556510925}, "num_steps_sampled": 8689961, "num_steps_trained": 8689961, "load_time_ms": 20.631, "update_time_ms": 12.144, "sample_time_ms": 15335.716}, "episode_reward_max": 1304.3314094574664, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 28.476445044592403, "episodes_total": 3945, "episodes_this_iter": 56, "time_total_s": 3045.7833671569824, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 111203, "timestamp": 1556530337, "episode_len_mean": 680.13, "timesteps_since_restore": 8801164, "time_since_restore": 3085.5963339805603, "done": false, "custom_metrics": {"outflow_rate_min": 461.5110052641438, "outflow_rate_mean": 964.2842665684063, "cost2_mean": -86.01679974093837, "outflow_rate_max": 1166.7761834195467, "system_level_velocity_mean": 13.74328093896482, "system_level_velocity_min": 9.861460236907696, "cost2_max": -15.995912278916514, "cost2_min": -137.67694774146818, "cost1_min": 17.09152663319507, "cost1_max": 446.6467204460817, "cost1_mean": 347.16669465171435, "system_level_velocity_max": 18.148565345322456}, "timesteps_total": 8801164, "training_iteration": 75, "date": "2019-04-29_09-32-17", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d547f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d543c8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d548d0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 75, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1038.3127839751003, "time_this_iter_s": 39.81296682357788, "info": {"grad_time_ms": 23733.732, "default": {"entropy": 1.4512522220611572, "kl": 0.019187642261385918, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01744186133146286, "vf_loss": 34.58399200439453, "total_loss": 34.57302474975586, "vf_explained_var": 0.794156551361084, "cur_kl_coeff": 0.33750003576278687}, "num_steps_sampled": 8801164, "num_steps_trained": 8801164, "load_time_ms": 20.634, "update_time_ms": 12.208, "sample_time_ms": 15304.034}, "episode_reward_max": 1277.5751677299252, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 45.76162863588487, "episodes_total": 4006, "episodes_this_iter": 61, "time_total_s": 3085.5963339805603, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 112909, "timestamp": 1556530377, "episode_len_mean": 693.44, "timesteps_since_restore": 8914073, "time_since_restore": 3125.737471342087, "done": false, "custom_metrics": {"outflow_rate_min": 532.6990253830464, "outflow_rate_mean": 976.4842486834006, "cost2_mean": -84.83172535751976, "outflow_rate_max": 1166.7761834195467, "system_level_velocity_mean": 13.692438369804265, "system_level_velocity_min": 8.908448217802107, "cost2_max": -21.899192524950976, "cost2_min": -142.38025627895655, "cost1_min": 28.421478974219617, "cost1_max": 440.4558702188251, "cost1_mean": 354.77880331144405, "system_level_velocity_max": 18.148565345322456}, "timesteps_total": 8914073, "training_iteration": 76, "date": "2019-04-29_09-32-57", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8470>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8828>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 76, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1063.0352856548775, "time_this_iter_s": 40.14113736152649, "info": {"grad_time_ms": 23945.641, "default": {"entropy": 1.4659100770950317, "kl": 0.01843801699578762, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016324637457728386, "vf_loss": 33.66613006591797, "total_loss": 33.65602493286133, "vf_explained_var": 0.8006627559661865, "cur_kl_coeff": 0.33750006556510925}, "num_steps_sampled": 8914073, "num_steps_trained": 8914073, "load_time_ms": 20.728, "update_time_ms": 11.724, "sample_time_ms": 15308.136}, "episode_reward_max": 1277.5751677299252, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 61.89893040241313, "episodes_total": 4064, "episodes_this_iter": 58, "time_total_s": 3125.737471342087, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 111002, "timestamp": 1556530417, "episode_len_mean": 693.38, "timesteps_since_restore": 9025075, "time_since_restore": 3165.8645100593567, "done": false, "custom_metrics": {"outflow_rate_min": 521.2883730226536, "outflow_rate_mean": 977.7466169772994, "cost2_mean": -84.0168185046912, "outflow_rate_max": 1100.6651468077225, "system_level_velocity_mean": 13.753439354491013, "system_level_velocity_min": 9.848536704036881, "cost2_max": -22.438576158514866, "cost2_min": -155.71165743257913, "cost1_min": 24.852555605543174, "cost1_max": 436.83471052790264, "cost1_mean": 357.0240827137539, "system_level_velocity_max": 18.594998334310375}, "timesteps_total": 9025075, "training_iteration": 77, "date": "2019-04-29_09-33-37", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d542e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54588>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 77, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1067.3368842982518, "time_this_iter_s": 40.1270387172699, "info": {"grad_time_ms": 23964.081, "default": {"entropy": 1.4702931642532349, "kl": 0.018032321706414223, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015461898408830166, "vf_loss": 36.53107833862305, "total_loss": 36.52170181274414, "vf_explained_var": 0.7956317663192749, "cur_kl_coeff": 0.33750006556510925}, "num_steps_sampled": 9025075, "num_steps_trained": 9025075, "load_time_ms": 20.35, "update_time_ms": 12.011, "sample_time_ms": 15342.656}, "episode_reward_max": 1298.92832547038, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 52.27901283643204, "episodes_total": 4124, "episodes_this_iter": 60, "time_total_s": 3165.8645100593567, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 110455, "timestamp": 1556530457, "episode_len_mean": 693.38, "timesteps_since_restore": 9135530, "time_since_restore": 3205.3141136169434, "done": false, "custom_metrics": {"outflow_rate_min": 521.2883730226536, "outflow_rate_mean": 970.8847874583486, "cost2_mean": -81.6677430836811, "outflow_rate_max": 1121.8656384229237, "system_level_velocity_mean": 13.814732151941154, "system_level_velocity_min": 9.72591960717407, "cost2_max": -22.438576158514866, "cost2_min": -155.71165743257913, "cost1_min": 24.852555605543174, "cost1_max": 451.0450757306372, "cost1_mean": 358.077519444354, "system_level_velocity_max": 18.594998334310375}, "timesteps_total": 9135530, "training_iteration": 78, "date": "2019-04-29_09-34-17", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b82e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8278>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8550>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 78, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1050.4089551610873, "time_this_iter_s": 39.44960355758667, "info": {"grad_time_ms": 23938.686, "default": {"entropy": 1.4705395698547363, "kl": 0.018465176224708557, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016726920381188393, "vf_loss": 38.820003509521484, "total_loss": 38.80950927734375, "vf_explained_var": 0.7753215432167053, "cur_kl_coeff": 0.33750006556510925}, "num_steps_sampled": 9135530, "num_steps_trained": 9135530, "load_time_ms": 20.088, "update_time_ms": 11.773, "sample_time_ms": 15390.223}, "episode_reward_max": 1318.7268565454085, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 52.27901283643204, "episodes_total": 4184, "episodes_this_iter": 60, "time_total_s": 3205.3141136169434, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 111466, "timestamp": 1556530496, "episode_len_mean": 693.4, "timesteps_since_restore": 9246996, "time_since_restore": 3244.9519934654236, "done": false, "custom_metrics": {"outflow_rate_min": 513.6167988435081, "outflow_rate_mean": 973.7630458393191, "cost2_mean": -83.56104559404423, "outflow_rate_max": 1126.3996313148682, "system_level_velocity_mean": 13.771289863621472, "system_level_velocity_min": 9.72591960717407, "cost2_max": -21.237933066096787, "cost2_min": -154.26372819096093, "cost1_min": 26.020183062793087, "cost1_max": 437.35134842087666, "cost1_mean": 356.4807330598603, "system_level_velocity_max": 18.565739945173977}, "timesteps_total": 9246996, "training_iteration": 79, "date": "2019-04-29_09-34-56", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49780>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8128>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 79, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1051.5427407915276, "time_this_iter_s": 39.637879848480225, "info": {"grad_time_ms": 24161.53, "default": {"entropy": 1.4705406427383423, "kl": 0.020200854167342186, "cur_lr": 0.0005000000237487257, "policy_loss": -0.018233289942145348, "vf_loss": 33.681026458740234, "total_loss": 33.669612884521484, "vf_explained_var": 0.7894072532653809, "cur_kl_coeff": 0.33750006556510925}, "num_steps_sampled": 9246996, "num_steps_trained": 9246996, "load_time_ms": 20.267, "update_time_ms": 11.628, "sample_time_ms": 15321.989}, "episode_reward_max": 1330.518458638921, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 56.637847871399686, "episodes_total": 4239, "episodes_this_iter": 55, "time_total_s": 3244.9519934654236, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 109469, "timestamp": 1556530537, "episode_len_mean": 700.0, "timesteps_since_restore": 9356465, "time_since_restore": 3285.458883047104, "done": false, "custom_metrics": {"outflow_rate_min": 791.636739765533, "outflow_rate_mean": 973.8104513409152, "cost2_mean": -84.94211884588607, "outflow_rate_max": 1126.3996313148682, "system_level_velocity_mean": 13.602014114675967, "system_level_velocity_min": 9.654520339085778, "cost2_max": -36.318098770544694, "cost2_min": -154.26372819096093, "cost1_min": 245.20320227323873, "cost1_max": 441.1672537138412, "cost1_mean": 356.9325188121435, "system_level_velocity_max": 16.796204515244202}, "timesteps_total": 9356465, "training_iteration": 80, "date": "2019-04-29_09-35-37", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b83c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54358>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d549e8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 80, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1057.48588024953, "time_this_iter_s": 40.5068895816803, "info": {"grad_time_ms": 24198.444, "default": {"entropy": 1.4810562133789062, "kl": 0.013835299760103226, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0151562774553895, "vf_loss": 38.47283172607422, "total_loss": 38.46467590332031, "vf_explained_var": 0.7350037693977356, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 9356465, "num_steps_trained": 9356465, "load_time_ms": 21.328, "update_time_ms": 11.419, "sample_time_ms": 15362.198}, "episode_reward_max": 1290.7752030845013, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 870.7641271810944, "episodes_total": 4303, "episodes_this_iter": 64, "time_total_s": 3285.458883047104, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 110556, "timestamp": 1556530576, "episode_len_mean": 700.0, "timesteps_since_restore": 9467021, "time_since_restore": 3324.8347928524017, "done": false, "custom_metrics": {"outflow_rate_min": 822.8922359422693, "outflow_rate_mean": 978.9816312102906, "cost2_mean": -80.4000492424161, "outflow_rate_max": 1119.359189479175, "system_level_velocity_mean": 13.830691164219388, "system_level_velocity_min": 9.687148531810196, "cost2_max": -37.73879523847833, "cost2_min": -137.26807150244716, "cost1_min": 251.80257820902614, "cost1_max": 441.1672537138412, "cost1_mean": 363.45095473533627, "system_level_velocity_max": 16.80633474775047}, "timesteps_total": 9467021, "training_iteration": 81, "date": "2019-04-29_09-36-16", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54588>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 81, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1065.7875043302952, "time_this_iter_s": 39.37590980529785, "info": {"grad_time_ms": 24174.3, "default": {"entropy": 1.4732766151428223, "kl": 0.013996378518640995, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014559628441929817, "vf_loss": 38.900718688964844, "total_loss": 38.89324188232422, "vf_explained_var": 0.7381820678710938, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 9467021, "num_steps_trained": 9467021, "load_time_ms": 21.258, "update_time_ms": 11.42, "sample_time_ms": 15376.88}, "episode_reward_max": 1300.1911256978003, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 866.7537453891085, "episodes_total": 4361, "episodes_this_iter": 58, "time_total_s": 3324.8347928524017, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 109524, "timestamp": 1556530616, "episode_len_mean": 686.52, "timesteps_since_restore": 9576545, "time_since_restore": 3364.6635451316833, "done": false, "custom_metrics": {"outflow_rate_min": 467.61656692706583, "outflow_rate_mean": 980.3897683802613, "cost2_mean": -80.26962465464062, "outflow_rate_max": 1180.1059013099793, "system_level_velocity_mean": 14.211153359482033, "system_level_velocity_min": 10.220711303294962, "cost2_max": -14.275752253247765, "cost2_min": -143.77092244564838, "cost1_min": 12.450714264540885, "cost1_max": 440.26127037383935, "cost1_mean": 364.4049053187793, "system_level_velocity_max": 18.16219931886161}, "timesteps_total": 9576545, "training_iteration": 82, "date": "2019-04-29_09-36-56", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8550>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b83c8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 82, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1061.717757105881, "time_this_iter_s": 39.828752279281616, "info": {"grad_time_ms": 24238.295, "default": {"entropy": 1.4440131187438965, "kl": 0.014301067218184471, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015202103182673454, "vf_loss": 38.6328125, "total_loss": 38.624855041503906, "vf_explained_var": 0.7259203195571899, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 9576545, "num_steps_trained": 9576545, "load_time_ms": 21.476, "update_time_ms": 11.358, "sample_time_ms": 15398.414}, "episode_reward_max": 1308.3167554439178, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 27.499952645171458, "episodes_total": 4423, "episodes_this_iter": 62, "time_total_s": 3364.6635451316833, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 110153, "timestamp": 1556530656, "episode_len_mean": 686.51, "timesteps_since_restore": 9686698, "time_since_restore": 3404.0283472537994, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 969.015895828625, "cost2_mean": -77.68182651585781, "outflow_rate_max": 1170.2908364690534, "system_level_velocity_mean": 14.078262017025622, "system_level_velocity_min": 9.424163035212619, "cost2_max": -13.515845632980897, "cost2_min": -155.5248969322728, "cost1_min": 11.618529654045858, "cost1_max": 441.16584689366096, "cost1_mean": 360.3198933915155, "system_level_velocity_max": 18.16219931886161}, "timesteps_total": 9686698, "training_iteration": 83, "date": "2019-04-29_09-37-36", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54940>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54780>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 83, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1044.8390006143723, "time_this_iter_s": 39.36480212211609, "info": {"grad_time_ms": 24255.238, "default": {"entropy": 1.4807515144348145, "kl": 0.014255199581384659, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015322720631957054, "vf_loss": 37.0230827331543, "total_loss": 37.014976501464844, "vf_explained_var": 0.7837954759597778, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 9686698, "num_steps_trained": 9686698, "load_time_ms": 22.869, "update_time_ms": 11.392, "sample_time_ms": 15351.544}, "episode_reward_max": 1270.7925582358878, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 25.08373785951931, "episodes_total": 4480, "episodes_this_iter": 57, "time_total_s": 3404.0283472537994, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 110298, "timestamp": 1556530697, "episode_len_mean": 693.18, "timesteps_since_restore": 9796996, "time_since_restore": 3444.8700606822968, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 962.6525446743303, "cost2_mean": -77.22261681057809, "outflow_rate_max": 1112.9519557039314, "system_level_velocity_mean": 13.871415179899778, "system_level_velocity_min": 9.424163035212619, "cost2_max": -13.515845632980897, "cost2_min": -155.5248969322728, "cost1_min": 11.618529654045858, "cost1_max": 442.87310019165136, "cost1_mean": 359.62628372758974, "system_level_velocity_max": 17.08201573540386}, "timesteps_total": 9796996, "training_iteration": 84, "date": "2019-04-29_09-38-17", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b85c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8828>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 84, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1045.0002400680833, "time_this_iter_s": 40.841713428497314, "info": {"grad_time_ms": 24307.052, "default": {"entropy": 1.4933528900146484, "kl": 0.015081123448908329, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014704421162605286, "vf_loss": 38.18376159667969, "total_loss": 38.176692962646484, "vf_explained_var": 0.7569805979728699, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 9796996, "num_steps_trained": 9796996, "load_time_ms": 22.592, "update_time_ms": 11.772, "sample_time_ms": 15339.617}, "episode_reward_max": 1284.0812475895132, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 25.08373785951931, "episodes_total": 4544, "episodes_this_iter": 64, "time_total_s": 3444.8700606822968, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 108961, "timestamp": 1556530734, "episode_len_mean": 693.38, "timesteps_since_restore": 9905957, "time_since_restore": 3482.5877299308777, "done": false, "custom_metrics": {"outflow_rate_min": 512.2467959575771, "outflow_rate_mean": 965.488739772836, "cost2_mean": -77.54268099029503, "outflow_rate_max": 1153.7198962781918, "system_level_velocity_mean": 13.989727638819108, "system_level_velocity_min": 9.68335411953438, "cost2_max": -17.317999978272997, "cost2_min": -145.75954266327471, "cost1_min": 25.692733256972282, "cost1_max": 442.87310019165136, "cost1_mean": 362.3762901743268, "system_level_velocity_max": 18.513178008585328}, "timesteps_total": 9905957, "training_iteration": 85, "date": "2019-04-29_09-38-54", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4ca58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4c208>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d4c160>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 85, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1046.7817259953865, "time_this_iter_s": 37.71766924858093, "info": {"grad_time_ms": 24126.373, "default": {"entropy": 1.4891005754470825, "kl": 0.01462259516119957, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014885970391333103, "vf_loss": 38.89173889160156, "total_loss": 38.88425827026367, "vf_explained_var": 0.72874516248703, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 9905957, "num_steps_trained": 9905957, "load_time_ms": 21.738, "update_time_ms": 11.709, "sample_time_ms": 15314.502}, "episode_reward_max": 1284.0812475895132, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 67.08638828061308, "episodes_total": 4604, "episodes_this_iter": 60, "time_total_s": 3482.5877299308777, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 109385, "timestamp": 1556530774, "episode_len_mean": 686.66, "timesteps_since_restore": 10015342, "time_since_restore": 3521.977107524872, "done": false, "custom_metrics": {"outflow_rate_min": 497.50056700217027, "outflow_rate_mean": 962.4853061608289, "cost2_mean": -78.40799251567257, "outflow_rate_max": 1197.3332336950646, "system_level_velocity_mean": 13.935213353193117, "system_level_velocity_min": 10.74419328666297, "cost2_max": -15.947446505309534, "cost2_min": -142.3184916243436, "cost1_min": 18.667941916168584, "cost1_max": 442.7470691675946, "cost1_mean": 355.8356098477359, "system_level_velocity_max": 18.513178008585328}, "timesteps_total": 10015342, "training_iteration": 86, "date": "2019-04-29_09-39-34", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54b70>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54160>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 86, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1033.2228431680926, "time_this_iter_s": 39.38937759399414, "info": {"grad_time_ms": 24022.865, "default": {"entropy": 1.5102910995483398, "kl": 0.014587463811039925, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015703165903687477, "vf_loss": 38.09518051147461, "total_loss": 38.08686065673828, "vf_explained_var": 0.7570897340774536, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 10015342, "num_steps_trained": 10015342, "load_time_ms": 21.642, "update_time_ms": 11.632, "sample_time_ms": 15346.104}, "episode_reward_max": 1220.844824986383, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 46.01619168603993, "episodes_total": 4667, "episodes_this_iter": 63, "time_total_s": 3521.977107524872, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 109254, "timestamp": 1556530814, "episode_len_mean": 686.67, "timesteps_since_restore": 10124596, "time_since_restore": 3561.988993406296, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 970.1514249006633, "cost2_mean": -75.31251775783427, "outflow_rate_max": 1197.3332336950646, "system_level_velocity_mean": 14.21494869200673, "system_level_velocity_min": 10.657516034258604, "cost2_max": -13.408576309302909, "cost2_min": -159.18405694143974, "cost1_min": 11.628233542285564, "cost1_max": 442.7470691675946, "cost1_mean": 364.23785067053745, "system_level_velocity_max": 18.055225347244978}, "timesteps_total": 10124596, "training_iteration": 87, "date": "2019-04-29_09-40-14", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d545c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54dd8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 87, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1041.1720020625926, "time_this_iter_s": 40.01188588142395, "info": {"grad_time_ms": 24033.236, "default": {"entropy": 1.4990915060043335, "kl": 0.01498616673052311, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016428783535957336, "vf_loss": 39.33536148071289, "total_loss": 39.32652282714844, "vf_explained_var": 0.7128271460533142, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 10124596, "num_steps_trained": 10124596, "load_time_ms": 21.645, "update_time_ms": 11.336, "sample_time_ms": 15324.155}, "episode_reward_max": 1336.50698014427, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 28.539647252031717, "episodes_total": 4728, "episodes_this_iter": 61, "time_total_s": 3561.988993406296, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 110862, "timestamp": 1556530852, "episode_len_mean": 693.18, "timesteps_since_restore": 10235458, "time_since_restore": 3600.2489805221558, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 964.9104551837844, "cost2_mean": -78.50147080506139, "outflow_rate_max": 1149.9460115901095, "system_level_velocity_mean": 13.98864695394046, "system_level_velocity_min": 10.087931179759133, "cost2_max": -13.408576309302909, "cost2_min": -172.040799104906, "cost1_min": 11.628233542285564, "cost1_max": 437.871619994329, "cost1_mean": 362.5485924173134, "system_level_velocity_max": 16.529238791317738}, "timesteps_total": 10235458, "training_iteration": 88, "date": "2019-04-29_09-40-52", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54e48>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d546a0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 88, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1046.1526544077935, "time_this_iter_s": 38.259987115859985, "info": {"grad_time_ms": 23977.468, "default": {"entropy": 1.5149489641189575, "kl": 0.013950498774647713, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015532509423792362, "vf_loss": 37.99729919433594, "total_loss": 37.98883056640625, "vf_explained_var": 0.7479441165924072, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 10235458, "num_steps_trained": 10235458, "load_time_ms": 21.843, "update_time_ms": 11.371, "sample_time_ms": 15260.583}, "episode_reward_max": 1336.50698014427, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 28.539647252031717, "episodes_total": 4787, "episodes_this_iter": 59, "time_total_s": 3600.2489805221558, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 110370, "timestamp": 1556530891, "episode_len_mean": 679.74, "timesteps_since_restore": 10345828, "time_since_restore": 3638.9783568382263, "done": false, "custom_metrics": {"outflow_rate_min": 420.39597999885626, "outflow_rate_mean": 946.0598446936259, "cost2_mean": -81.27533648558689, "outflow_rate_max": 1095.348875652544, "system_level_velocity_mean": 13.618924335053343, "system_level_velocity_min": 9.701412880155884, "cost2_max": -12.528224146392152, "cost2_min": -150.87603319896576, "cost1_min": 11.716709273959422, "cost1_max": 431.82821217277456, "cost1_mean": 343.7896528225981, "system_level_velocity_max": 18.781629688287243}, "timesteps_total": 10345828, "training_iteration": 89, "date": "2019-04-29_09-41-31", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d496a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49cc0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49160>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 89, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1024.4247465768601, "time_this_iter_s": 38.72937631607056, "info": {"grad_time_ms": 23880.41, "default": {"entropy": 1.5212243795394897, "kl": 0.014354239217936993, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016210375353693962, "vf_loss": 37.22749328613281, "total_loss": 37.21854782104492, "vf_explained_var": 0.76423579454422, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 10345828, "num_steps_trained": 10345828, "load_time_ms": 21.886, "update_time_ms": 11.366, "sample_time_ms": 15266.288}, "episode_reward_max": 1286.8240515261248, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 23.141472225896443, "episodes_total": 4850, "episodes_this_iter": 63, "time_total_s": 3638.9783568382263, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 108677, "timestamp": 1556530930, "episode_len_mean": 686.61, "timesteps_since_restore": 10454505, "time_since_restore": 3677.5140719413757, "done": false, "custom_metrics": {"outflow_rate_min": 481.955215425478, "outflow_rate_mean": 965.5851091509982, "cost2_mean": -77.52200390383356, "outflow_rate_max": 1252.2100140482503, "system_level_velocity_mean": 14.027949320105801, "system_level_velocity_min": 9.905673573267642, "cost2_max": -17.850670483869585, "cost2_min": -161.43253300895492, "cost1_min": 17.584817810702678, "cost1_max": 445.2297821913502, "cost1_mean": 358.344467392287, "system_level_velocity_max": 18.886174961714726}, "timesteps_total": 10454505, "training_iteration": 90, "date": "2019-04-29_09-42-10", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d546a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54e48>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54358>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 90, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1035.8194111432485, "time_this_iter_s": 38.535715103149414, "info": {"grad_time_ms": 23741.875, "default": {"entropy": 1.5263142585754395, "kl": 0.014413449913263321, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016089454293251038, "vf_loss": 40.77744674682617, "total_loss": 40.768653869628906, "vf_explained_var": 0.7056156396865845, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 10454505, "num_steps_trained": 10454505, "load_time_ms": 21.722, "update_time_ms": 11.38, "sample_time_ms": 15210.393}, "episode_reward_max": 1247.087848279883, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 38.016610707324595, "episodes_total": 4912, "episodes_this_iter": 62, "time_total_s": 3677.5140719413757, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 108384, "timestamp": 1556530969, "episode_len_mean": 693.34, "timesteps_since_restore": 10562889, "time_since_restore": 3716.8009557724, "done": false, "custom_metrics": {"outflow_rate_min": 488.58344346436036, "outflow_rate_mean": 962.8887789345563, "cost2_mean": -74.25039541204144, "outflow_rate_max": 1252.2100140482503, "system_level_velocity_mean": 14.079808972667841, "system_level_velocity_min": 10.871994151427893, "cost2_max": -18.594494314851715, "cost2_min": -145.9924970625258, "cost1_min": 22.097533121216625, "cost1_max": 434.54178442332454, "cost1_mean": 363.9883227565765, "system_level_velocity_max": 18.391318270656484}, "timesteps_total": 10562889, "training_iteration": 91, "date": "2019-04-29_09-42-49", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d542e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54668>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 91, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1033.4265826290655, "time_this_iter_s": 39.28688383102417, "info": {"grad_time_ms": 23740.058, "default": {"entropy": 1.5388041734695435, "kl": 0.01442665047943592, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015811588615179062, "vf_loss": 40.18656539916992, "total_loss": 40.178062438964844, "vf_explained_var": 0.691656231880188, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 10562889, "num_steps_trained": 10562889, "load_time_ms": 21.562, "update_time_ms": 11.442, "sample_time_ms": 15203.819}, "episode_reward_max": 1251.3594781977229, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 56.50439486411437, "episodes_total": 4976, "episodes_this_iter": 64, "time_total_s": 3716.8009557724, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 109232, "timestamp": 1556531010, "episode_len_mean": 696.57, "timesteps_since_restore": 10672121, "time_since_restore": 3757.4648761749268, "done": false, "custom_metrics": {"outflow_rate_min": 825.0704778495816, "outflow_rate_mean": 960.3063492742672, "cost2_mean": -73.07612880713874, "outflow_rate_max": 1137.4682317046793, "system_level_velocity_mean": 13.814097722345139, "system_level_velocity_min": 8.894319286619654, "cost2_max": -30.47676511260967, "cost2_min": -146.80394986914177, "cost1_min": 199.75740698394412, "cost1_max": 432.08462012135453, "cost1_mean": 359.8740905545769, "system_level_velocity_max": 16.7128184202942}, "timesteps_total": 10672121, "training_iteration": 92, "date": "2019-04-29_09-43-30", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b82e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8240>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8828>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 92, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1024.8542545294572, "time_this_iter_s": 40.663920402526855, "info": {"grad_time_ms": 23883.35, "default": {"entropy": 1.5629971027374268, "kl": 0.01401776447892189, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014933448284864426, "vf_loss": 37.08922576904297, "total_loss": 37.08138656616211, "vf_explained_var": 0.7128739953041077, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 10672121, "num_steps_trained": 10672121, "load_time_ms": 22.704, "update_time_ms": 11.356, "sample_time_ms": 15143.339}, "episode_reward_max": 1231.3998082165792, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 499.03240239772566, "episodes_total": 5036, "episodes_this_iter": 60, "time_total_s": 3757.4648761749268, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 107821, "timestamp": 1556531049, "episode_len_mean": 690.02, "timesteps_since_restore": 10779942, "time_since_restore": 3796.38388466835, "done": false, "custom_metrics": {"outflow_rate_min": 529.9467779046381, "outflow_rate_mean": 956.7691361070241, "cost2_mean": -71.09786301134972, "outflow_rate_max": 1111.5686039383284, "system_level_velocity_mean": 13.960277376487461, "system_level_velocity_min": 8.894319286619654, "cost2_max": -24.850062306855946, "cost2_min": -146.80394986914177, "cost1_min": 29.16658893561519, "cost1_max": 437.52833356193236, "cost1_mean": 359.263407617637, "system_level_velocity_max": 18.257700332105145}, "timesteps_total": 10779942, "training_iteration": 93, "date": "2019-04-29_09-44-09", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54eb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d542e8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 93, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1011.0483758415295, "time_this_iter_s": 38.91900849342346, "info": {"grad_time_ms": 23835.065, "default": {"entropy": 1.5483001470565796, "kl": 0.01358599029481411, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014970625750720501, "vf_loss": 37.275177001953125, "total_loss": 37.26708221435547, "vf_explained_var": 0.7146300077438354, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 10779942, "num_steps_trained": 10779942, "load_time_ms": 22.425, "update_time_ms": 11.271, "sample_time_ms": 15149.47}, "episode_reward_max": 1231.3998082165792, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 66.55046456836565, "episodes_total": 5098, "episodes_this_iter": 62, "time_total_s": 3796.38388466835, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 108577, "timestamp": 1556531088, "episode_len_mean": 680.84, "timesteps_since_restore": 10888519, "time_since_restore": 3835.9509358406067, "done": false, "custom_metrics": {"outflow_rate_min": 508.7592883338841, "outflow_rate_mean": 949.9231163432108, "cost2_mean": -66.60312177609434, "outflow_rate_max": 1107.0901727093071, "system_level_velocity_mean": 14.281693226629768, "system_level_velocity_min": 10.654451193040622, "cost2_max": -18.422496029636495, "cost2_min": -151.77893022035522, "cost1_min": 22.08778018143395, "cost1_max": 448.91504002260166, "cost1_mean": 359.54193893971075, "system_level_velocity_max": 18.257700332105145}, "timesteps_total": 10888519, "training_iteration": 94, "date": "2019-04-29_09-44-48", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8160>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b82e8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 94, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1005.1645663414757, "time_this_iter_s": 39.56705117225647, "info": {"grad_time_ms": 23707.723, "default": {"entropy": 1.5348095893859863, "kl": 0.014437521807849407, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015955112874507904, "vf_loss": 39.33061218261719, "total_loss": 39.32196044921875, "vf_explained_var": 0.6922211647033691, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 10888519, "num_steps_trained": 10888519, "load_time_ms": 21.461, "update_time_ms": 11.258, "sample_time_ms": 15150.029}, "episode_reward_max": 1210.937208309687, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 50.46243409566706, "episodes_total": 5161, "episodes_this_iter": 63, "time_total_s": 3835.9509358406067, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 108277, "timestamp": 1556531128, "episode_len_mean": 688.52, "timesteps_since_restore": 10996796, "time_since_restore": 3875.5145783424377, "done": false, "custom_metrics": {"outflow_rate_min": 508.7592883338841, "outflow_rate_mean": 956.7853168533234, "cost2_mean": -68.481864111613, "outflow_rate_max": 1107.0901727093071, "system_level_velocity_mean": 14.139521159232197, "system_level_velocity_min": 10.636125846453904, "cost2_max": -18.422496029636495, "cost2_min": -141.90430582581402, "cost1_min": 22.08778018143395, "cost1_max": 448.91504002260166, "cost1_mean": 361.2508055959332, "system_level_velocity_max": 18.231280302599302}, "timesteps_total": 10996796, "training_iteration": 95, "date": "2019-04-29_09-45-28", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d496a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49c50>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49b38>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 95, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1010.7894606977575, "time_this_iter_s": 39.563642501831055, "info": {"grad_time_ms": 23857.364, "default": {"entropy": 1.5652092695236206, "kl": 0.014438407495617867, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016027409583330154, "vf_loss": 40.9383430480957, "total_loss": 40.929622650146484, "vf_explained_var": 0.7037773728370667, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 10996796, "num_steps_trained": 10996796, "load_time_ms": 22.404, "update_time_ms": 11.352, "sample_time_ms": 15182.19}, "episode_reward_max": 1210.937208309687, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 50.46243409566706, "episodes_total": 5226, "episodes_this_iter": 65, "time_total_s": 3875.5145783424377, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 108687, "timestamp": 1556531168, "episode_len_mean": 695.19, "timesteps_since_restore": 11105483, "time_since_restore": 3915.396852493286, "done": false, "custom_metrics": {"outflow_rate_min": 798.6154527137695, "outflow_rate_mean": 960.5302883415487, "cost2_mean": -70.63664723075883, "outflow_rate_max": 1094.5800485288264, "system_level_velocity_mean": 14.044277577984744, "system_level_velocity_min": 9.153881501120885, "cost2_max": -30.736447692087697, "cost2_min": -134.37850170201477, "cost1_min": 141.7236398295758, "cost1_max": 440.69570907295747, "cost1_mean": 364.71761746255174, "system_level_velocity_max": 17.795322159883806}, "timesteps_total": 11105483, "training_iteration": 96, "date": "2019-04-29_09-46-08", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b88d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8ba8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8128>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 96, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1024.6614288410121, "time_this_iter_s": 39.88227415084839, "info": {"grad_time_ms": 23907.613, "default": {"entropy": 1.5398240089416504, "kl": 0.014690329320728779, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015563683584332466, "vf_loss": 36.02489471435547, "total_loss": 36.01676940917969, "vf_explained_var": 0.7177644371986389, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 11105483, "num_steps_trained": 11105483, "load_time_ms": 22.653, "update_time_ms": 11.36, "sample_time_ms": 15179.09}, "episode_reward_max": 1267.6005668619698, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 313.0862868536162, "episodes_total": 5286, "episodes_this_iter": 60, "time_total_s": 3915.396852493286, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 108510, "timestamp": 1556531208, "episode_len_mean": 693.39, "timesteps_since_restore": 11213993, "time_since_restore": 3955.3291623592377, "done": false, "custom_metrics": {"outflow_rate_min": 510.50531379214914, "outflow_rate_mean": 955.2735511896601, "cost2_mean": -68.5960408210574, "outflow_rate_max": 1095.2167343976503, "system_level_velocity_mean": 14.110744186867052, "system_level_velocity_min": 8.520365995168724, "cost2_max": -16.734715651240023, "cost2_min": -132.79883312022707, "cost1_min": 26.014891697438706, "cost1_max": 442.5842277776461, "cost1_mean": 364.7658055637001, "system_level_velocity_max": 18.03893105759704}, "timesteps_total": 11213993, "training_iteration": 97, "date": "2019-04-29_09-46-48", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54e80>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54828>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 97, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1029.0420915955472, "time_this_iter_s": 39.93230986595154, "info": {"grad_time_ms": 23892.293, "default": {"entropy": 1.5698332786560059, "kl": 0.014576861634850502, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015622886829078197, "vf_loss": 36.95431137084961, "total_loss": 36.946067810058594, "vf_explained_var": 0.7265017032623291, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 11213993, "num_steps_trained": 11213993, "load_time_ms": 21.786, "update_time_ms": 11.427, "sample_time_ms": 15186.05}, "episode_reward_max": 1267.6005668619698, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 65.88276693356126, "episodes_total": 5349, "episodes_this_iter": 63, "time_total_s": 3955.3291623592377, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 108500, "timestamp": 1556531247, "episode_len_mean": 693.39, "timesteps_since_restore": 11322493, "time_since_restore": 3994.324298143387, "done": false, "custom_metrics": {"outflow_rate_min": 510.50531379214914, "outflow_rate_mean": 954.413914802935, "cost2_mean": -67.80296626541549, "outflow_rate_max": 1106.4303695869362, "system_level_velocity_mean": 14.07772741247617, "system_level_velocity_min": 8.520365995168724, "cost2_max": -16.734715651240023, "cost2_min": -132.79883312022707, "cost1_min": 26.014891697438706, "cost1_max": 446.7699814090268, "cost1_mean": 363.8797128156833, "system_level_velocity_max": 18.03893105759704}, "timesteps_total": 11322493, "training_iteration": 98, "date": "2019-04-29_09-47-27", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d540b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54358>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d546a0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 98, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1030.3144454153692, "time_this_iter_s": 38.99513578414917, "info": {"grad_time_ms": 23841.925, "default": {"entropy": 1.568044900894165, "kl": 0.013875876553356647, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015333139337599277, "vf_loss": 41.10593032836914, "total_loss": 41.097618103027344, "vf_explained_var": 0.6984553337097168, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 11322493, "num_steps_trained": 11322493, "load_time_ms": 20.772, "update_time_ms": 11.457, "sample_time_ms": 15310.5}, "episode_reward_max": 1240.709363632918, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 65.88276693356126, "episodes_total": 5411, "episodes_this_iter": 62, "time_total_s": 3994.324298143387, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 108040, "timestamp": 1556531287, "episode_len_mean": 700.0, "timesteps_since_restore": 11430533, "time_since_restore": 4034.2219457626343, "done": false, "custom_metrics": {"outflow_rate_min": 833.4266302311837, "outflow_rate_mean": 961.8676324385191, "cost2_mean": -71.5468363532279, "outflow_rate_max": 1111.2903082862683, "system_level_velocity_mean": 13.860676237366333, "system_level_velocity_min": 8.727114930748545, "cost2_max": -34.000115217695345, "cost2_min": -155.15976285198676, "cost1_min": 225.2270855123794, "cost1_max": 436.170638987245, "cost1_mean": 363.88944304274503, "system_level_velocity_max": 16.793918593010083}, "timesteps_total": 11430533, "training_iteration": 99, "date": "2019-04-29_09-48-07", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49cf8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49e10>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 99, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1046.0003130049095, "time_this_iter_s": 39.89764761924744, "info": {"grad_time_ms": 23938.7, "default": {"entropy": 1.5722086429595947, "kl": 0.015124516561627388, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016394073143601418, "vf_loss": 38.71364212036133, "total_loss": 38.704898834228516, "vf_explained_var": 0.7089456915855408, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 11430533, "num_steps_trained": 11430533, "load_time_ms": 20.501, "update_time_ms": 11.485, "sample_time_ms": 15329.024}, "episode_reward_max": 1240.4489130610912, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 877.2237476271587, "episodes_total": 5473, "episodes_this_iter": 62, "time_total_s": 4034.2219457626343, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 108331, "timestamp": 1556531327, "episode_len_mean": 700.0, "timesteps_since_restore": 11538864, "time_since_restore": 4074.5621240139008, "done": false, "custom_metrics": {"outflow_rate_min": 828.5150771374617, "outflow_rate_mean": 968.5477250516071, "cost2_mean": -71.65675699908746, "outflow_rate_max": 1111.2903082862683, "system_level_velocity_mean": 13.931653031673592, "system_level_velocity_min": 8.727114930748545, "cost2_max": -34.000115217695345, "cost2_min": -155.15976285198676, "cost1_min": 225.2270855123794, "cost1_max": 439.71258001684754, "cost1_mean": 365.33040257999716, "system_level_velocity_max": 17.09134989900817}, "timesteps_total": 11538864, "training_iteration": 100, "date": "2019-04-29_09-48-47", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54eb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54b70>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 100, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1045.479565275676, "time_this_iter_s": 40.34017825126648, "info": {"grad_time_ms": 24130.245, "default": {"entropy": 1.5796871185302734, "kl": 0.014406119473278522, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015852218493819237, "vf_loss": 37.8382682800293, "total_loss": 37.829708099365234, "vf_explained_var": 0.6962427496910095, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 11538864, "num_steps_trained": 11538864, "load_time_ms": 20.625, "update_time_ms": 11.345, "sample_time_ms": 15317.365}, "episode_reward_max": 1222.217069744188, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 874.5525939717924, "episodes_total": 5532, "episodes_this_iter": 59, "time_total_s": 4074.5621240139008, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 108757, "timestamp": 1556531367, "episode_len_mean": 700.0, "timesteps_since_restore": 11647621, "time_since_restore": 4114.163817882538, "done": false, "custom_metrics": {"outflow_rate_min": 828.5150771374617, "outflow_rate_mean": 967.1064479253234, "cost2_mean": -72.23914930613883, "outflow_rate_max": 1093.3169260159218, "system_level_velocity_mean": 13.848202728496728, "system_level_velocity_min": 9.366631572914853, "cost2_max": -35.03550049938701, "cost2_min": -152.9113580456182, "cost1_min": 240.66500729295993, "cost1_max": 432.4278518515756, "cost1_mean": 362.84436331077677, "system_level_velocity_max": 16.62533611434682}, "timesteps_total": 11647621, "training_iteration": 101, "date": "2019-04-29_09-49-27", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49c18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d495c0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 101, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1041.442531519971, "time_this_iter_s": 39.601693868637085, "info": {"grad_time_ms": 24150.765, "default": {"entropy": 1.6108611822128296, "kl": 0.014512928202748299, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016621259972453117, "vf_loss": 39.089664459228516, "total_loss": 39.080387115478516, "vf_explained_var": 0.7147678136825562, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 11647621, "num_steps_trained": 11647621, "load_time_ms": 20.622, "update_time_ms": 11.274, "sample_time_ms": 15326.33}, "episode_reward_max": 1264.497993780114, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 833.6234655726132, "episodes_total": 5594, "episodes_this_iter": 62, "time_total_s": 4114.163817882538, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 107662, "timestamp": 1556531407, "episode_len_mean": 693.3, "timesteps_since_restore": 11755283, "time_since_restore": 4154.216877937317, "done": false, "custom_metrics": {"outflow_rate_min": 473.79828785884354, "outflow_rate_mean": 954.5580302474694, "cost2_mean": -68.04172042864772, "outflow_rate_max": 1118.0345511696812, "system_level_velocity_mean": 13.863279670341008, "system_level_velocity_min": 9.990559495632736, "cost2_max": -17.596724696748343, "cost2_min": -137.48672476120697, "cost1_min": 19.554063985194848, "cost1_max": 440.4150529755832, "cost1_mean": 358.25359323679885, "system_level_velocity_max": 17.604706909799184}, "timesteps_total": 11755283, "training_iteration": 102, "date": "2019-04-29_09-50-07", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54ac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54908>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 102, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1014.7982827810249, "time_this_iter_s": 40.05306005477905, "info": {"grad_time_ms": 24030.654, "default": {"entropy": 1.6090400218963623, "kl": 0.014664721675217152, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016107182949781418, "vf_loss": 41.24813461303711, "total_loss": 41.23945617675781, "vf_explained_var": 0.6860383749008179, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 11755283, "num_steps_trained": 11755283, "load_time_ms": 19.438, "update_time_ms": 11.466, "sample_time_ms": 15385.595}, "episode_reward_max": 1289.7800278075902, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 44.05243641688022, "episodes_total": 5657, "episodes_this_iter": 63, "time_total_s": 4154.216877937317, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 107991, "timestamp": 1556531447, "episode_len_mean": 686.67, "timesteps_since_restore": 11863274, "time_since_restore": 4193.896025419235, "done": false, "custom_metrics": {"outflow_rate_min": 487.95782668624, "outflow_rate_mean": 944.580645722114, "cost2_mean": -65.07641321455098, "outflow_rate_max": 1143.1783695231995, "system_level_velocity_mean": 14.010456073657453, "system_level_velocity_min": 10.43557698363632, "cost2_max": -16.106064606053323, "cost2_min": -137.48672476120697, "cost1_min": 18.670807687030287, "cost1_max": 440.4872076399608, "cost1_mean": 357.30143799351913, "system_level_velocity_max": 18.60580573584189}, "timesteps_total": 11863274, "training_iteration": 103, "date": "2019-04-29_09-50-47", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8b70>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8b38>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 103, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 995.0230959982578, "time_this_iter_s": 39.679147481918335, "info": {"grad_time_ms": 24120.446, "default": {"entropy": 1.6157876253128052, "kl": 0.014334292151033878, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016828523948788643, "vf_loss": 37.674468994140625, "total_loss": 37.66489791870117, "vf_explained_var": 0.6812218427658081, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 11863274, "num_steps_trained": 11863274, "load_time_ms": 18.659, "update_time_ms": 11.719, "sample_time_ms": 15372.679}, "episode_reward_max": 1289.7800278075902, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 48.8191505662724, "episodes_total": 5718, "episodes_this_iter": 61, "time_total_s": 4193.896025419235, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 109016, "timestamp": 1556531487, "episode_len_mean": 686.44, "timesteps_since_restore": 11972290, "time_since_restore": 4233.669280290604, "done": false, "custom_metrics": {"outflow_rate_min": 433.12568539996727, "outflow_rate_mean": 941.440670991463, "cost2_mean": -64.37111164824925, "outflow_rate_max": 1143.1783695231995, "system_level_velocity_mean": 14.094534740588422, "system_level_velocity_min": 9.984624186972129, "cost2_max": -9.995863009829112, "cost2_min": -128.5948479272131, "cost1_min": 9.684667024088073, "cost1_max": 444.7300078400947, "cost1_mean": 359.5976187314624, "system_level_velocity_max": 18.60580573584189}, "timesteps_total": 11972290, "training_iteration": 104, "date": "2019-04-29_09-51-27", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d548d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d547f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54ef0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 104, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1002.0487006233305, "time_this_iter_s": 39.77325487136841, "info": {"grad_time_ms": 24142.839, "default": {"entropy": 1.5968828201293945, "kl": 0.01479340624064207, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016419710591435432, "vf_loss": 36.25807571411133, "total_loss": 36.249141693115234, "vf_explained_var": 0.7176605463027954, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 11972290, "num_steps_trained": 11972290, "load_time_ms": 20.274, "update_time_ms": 11.485, "sample_time_ms": 15367.608}, "episode_reward_max": 1203.3814714485181, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 19.26177715868412, "episodes_total": 5779, "episodes_this_iter": 61, "time_total_s": 4233.669280290604, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 107173, "timestamp": 1556531523, "episode_len_mean": 700.0, "timesteps_since_restore": 12079463, "time_since_restore": 4270.249315977097, "done": false, "custom_metrics": {"outflow_rate_min": 841.0990434321278, "outflow_rate_mean": 954.7575387928424, "cost2_mean": -70.16051077262597, "outflow_rate_max": 1110.1438643416664, "system_level_velocity_mean": 13.861955760302585, "system_level_velocity_min": 9.959475589884473, "cost2_max": -27.205653284211024, "cost2_min": -128.5948479272131, "cost1_min": 257.2231597566243, "cost1_max": 444.7300078400947, "cost1_mean": 363.34805148891553, "system_level_velocity_max": 17.174905293944004}, "timesteps_total": 12079463, "training_iteration": 105, "date": "2019-04-29_09-52-03", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d496a0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49160>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 105, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1029.471878807291, "time_this_iter_s": 36.58003568649292, "info": {"grad_time_ms": 23870.737, "default": {"entropy": 1.6452922821044922, "kl": 0.014606344513595104, "cur_lr": 0.0005000000237487257, "policy_loss": -0.017280438914895058, "vf_loss": 37.4321403503418, "total_loss": 37.4222526550293, "vf_explained_var": 0.7258379459381104, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 12079463, "num_steps_trained": 12079463, "load_time_ms": 20.131, "update_time_ms": 11.476, "sample_time_ms": 15341.373}, "episode_reward_max": 1252.4777286786564, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 818.9480008650818, "episodes_total": 5840, "episodes_this_iter": 61, "time_total_s": 4270.249315977097, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 107188, "timestamp": 1556531561, "episode_len_mean": 693.16, "timesteps_since_restore": 12186651, "time_since_restore": 4307.996903657913, "done": false, "custom_metrics": {"outflow_rate_min": 440.29843071181995, "outflow_rate_mean": 948.672619534476, "cost2_mean": -67.10666565226404, "outflow_rate_max": 1110.1438643416664, "system_level_velocity_mean": 13.93882811921982, "system_level_velocity_min": 9.885380404892555, "cost2_max": -10.9552847881146, "cost2_min": -123.50334827599937, "cost1_min": 10.368365366185119, "cost1_max": 444.03089026086184, "cost1_mean": 360.4973273871833, "system_level_velocity_max": 17.174905293944004}, "timesteps_total": 12186651, "training_iteration": 106, "date": "2019-04-29_09-52-41", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54c18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54908>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 106, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1002.9722008972852, "time_this_iter_s": 37.74758768081665, "info": {"grad_time_ms": 23732.666, "default": {"entropy": 1.6373964548110962, "kl": 0.014928122982382774, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016005609184503555, "vf_loss": 37.81802749633789, "total_loss": 37.80957794189453, "vf_explained_var": 0.7156676054000854, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 12186651, "num_steps_trained": 12186651, "load_time_ms": 18.179, "update_time_ms": 11.575, "sample_time_ms": 15270.618}, "episode_reward_max": 1246.203366337468, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 24.827761883903715, "episodes_total": 5904, "episodes_this_iter": 64, "time_total_s": 4307.996903657913, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 107164, "timestamp": 1556531600, "episode_len_mean": 674.88, "timesteps_since_restore": 12293815, "time_since_restore": 4346.887278079987, "done": false, "custom_metrics": {"outflow_rate_min": 440.29843071181995, "outflow_rate_mean": 936.1490277724032, "cost2_mean": -64.05387176632384, "outflow_rate_max": 1116.8355666570926, "system_level_velocity_mean": 14.221523879114052, "system_level_velocity_min": 9.885380404892555, "cost2_max": -10.9552847881146, "cost2_min": -118.08332725006092, "cost1_min": 10.368365366185119, "cost1_max": 449.03860623539384, "cost1_mean": 354.7256817828169, "system_level_velocity_max": 18.101505611685837}, "timesteps_total": 12293815, "training_iteration": 107, "date": "2019-04-29_09-53-20", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d544a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49748>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d495c0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 107, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 974.1627277570561, "time_this_iter_s": 38.890374422073364, "info": {"grad_time_ms": 23725.909, "default": {"entropy": 1.6255122423171997, "kl": 0.015236619859933853, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016776252537965775, "vf_loss": 41.50667190551758, "total_loss": 41.49761199951172, "vf_explained_var": 0.6484010219573975, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 12293815, "num_steps_trained": 12293815, "load_time_ms": 18.403, "update_time_ms": 11.521, "sample_time_ms": 15172.778}, "episode_reward_max": 1219.2066968686308, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 24.827761883903715, "episodes_total": 5970, "episodes_this_iter": 66, "time_total_s": 4346.887278079987, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 107785, "timestamp": 1556531641, "episode_len_mean": 686.58, "timesteps_since_restore": 12401600, "time_since_restore": 4387.311211824417, "done": false, "custom_metrics": {"outflow_rate_min": 493.4100718231657, "outflow_rate_mean": 940.5655278922808, "cost2_mean": -63.75546057310757, "outflow_rate_max": 1116.8355666570926, "system_level_velocity_mean": 14.26555002111544, "system_level_velocity_min": 9.732956021787611, "cost2_max": -18.02438612503722, "cost2_min": -121.67931451239639, "cost1_min": 19.149335291075854, "cost1_max": 440.9193404915684, "cost1_mean": 363.8797949463749, "system_level_velocity_max": 18.101505611685837}, "timesteps_total": 12401600, "training_iteration": 108, "date": "2019-04-29_09-54-01", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54d68>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d540f0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 108, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 999.0459545094096, "time_this_iter_s": 40.42393374443054, "info": {"grad_time_ms": 23870.162, "default": {"entropy": 1.6176891326904297, "kl": 0.014921680092811584, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016264747828245163, "vf_loss": 38.90576934814453, "total_loss": 38.897056579589844, "vf_explained_var": 0.651958167552948, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 12401600, "num_steps_trained": 12401600, "load_time_ms": 20.215, "update_time_ms": 11.485, "sample_time_ms": 15171.278}, "episode_reward_max": 1276.8314903543412, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 44.17213011248841, "episodes_total": 6033, "episodes_this_iter": 63, "time_total_s": 4387.311211824417, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106888, "timestamp": 1556531677, "episode_len_mean": 693.34, "timesteps_since_restore": 12508488, "time_since_restore": 4423.960294485092, "done": false, "custom_metrics": {"outflow_rate_min": 490.1852037330182, "outflow_rate_mean": 939.2845939395847, "cost2_mean": -62.23634813230038, "outflow_rate_max": 1107.8996132651966, "system_level_velocity_mean": 14.221609196979903, "system_level_velocity_min": 9.732956021787611, "cost2_max": -22.31043917291995, "cost2_min": -122.40266121645959, "cost1_min": 22.709157543921876, "cost1_max": 439.119966471951, "cost1_mean": 366.9010424324598, "system_level_velocity_max": 17.87925519439966}, "timesteps_total": 12508488, "training_iteration": 109, "date": "2019-04-29_09-54-37", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54e10>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d542e8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 109, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1007.0988250468574, "time_this_iter_s": 36.64908266067505, "info": {"grad_time_ms": 23559.575, "default": {"entropy": 1.6366939544677734, "kl": 0.014145886525511742, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015781348571181297, "vf_loss": 36.20088577270508, "total_loss": 36.19226837158203, "vf_explained_var": 0.6609045267105103, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 12508488, "num_steps_trained": 12508488, "load_time_ms": 20.332, "update_time_ms": 11.336, "sample_time_ms": 15157.614}, "episode_reward_max": 1248.461784969781, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 57.670664968933174, "episodes_total": 6096, "episodes_this_iter": 63, "time_total_s": 4423.960294485092, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 108653, "timestamp": 1556531717, "episode_len_mean": 675.88, "timesteps_since_restore": 12617141, "time_since_restore": 4463.407839536667, "done": false, "custom_metrics": {"outflow_rate_min": 490.1852037330182, "outflow_rate_mean": 928.6478018965863, "cost2_mean": -61.13960245157087, "outflow_rate_max": 1102.5566853276523, "system_level_velocity_mean": 14.227390319406359, "system_level_velocity_min": 9.032851091359133, "cost2_max": -22.12113738402515, "cost2_min": -122.75223786710555, "cost1_min": 22.709157543921876, "cost1_max": 439.119966471951, "cost1_mean": 355.71882042511317, "system_level_velocity_max": 19.0541295392538}, "timesteps_total": 12617141, "training_iteration": 110, "date": "2019-04-29_09-55-17", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54898>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d549b0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 110, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 973.7101141344501, "time_this_iter_s": 39.44754505157471, "info": {"grad_time_ms": 23353.725, "default": {"entropy": 1.6487095355987549, "kl": 0.014169571921229362, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015623711980879307, "vf_loss": 41.70030975341797, "total_loss": 41.691856384277344, "vf_explained_var": 0.6786704659461975, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 12617141, "num_steps_trained": 12617141, "load_time_ms": 20.331, "update_time_ms": 11.31, "sample_time_ms": 15272.06}, "episode_reward_max": 1214.208777510283, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 55.0960770151022, "episodes_total": 6167, "episodes_this_iter": 71, "time_total_s": 4463.407839536667, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 107862, "timestamp": 1556531756, "episode_len_mean": 688.37, "timesteps_since_restore": 12725003, "time_since_restore": 4502.107528209686, "done": false, "custom_metrics": {"outflow_rate_min": 489.55449543327785, "outflow_rate_mean": 927.5216842842268, "cost2_mean": -64.63880121792451, "outflow_rate_max": 1082.9941394863222, "system_level_velocity_mean": 13.988785353689234, "system_level_velocity_min": 9.032851091359133, "cost2_max": -16.893588858662238, "cost2_min": -147.77982539772776, "cost1_min": 17.272405227875772, "cost1_max": 433.0303738261234, "cost1_mean": 357.80048870289494, "system_level_velocity_max": 18.733374818598353}, "timesteps_total": 12725003, "training_iteration": 111, "date": "2019-04-29_09-55-56", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b84a8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8358>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 111, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 974.6051818070816, "time_this_iter_s": 38.69968867301941, "info": {"grad_time_ms": 23358.341, "default": {"entropy": 1.6585679054260254, "kl": 0.014304920099675655, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015456955879926682, "vf_loss": 38.289791107177734, "total_loss": 38.28157424926758, "vf_explained_var": 0.6807234287261963, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 12725003, "num_steps_trained": 12725003, "load_time_ms": 20.7, "update_time_ms": 11.325, "sample_time_ms": 15177.5}, "episode_reward_max": 1184.3807989832717, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 33.62350241660397, "episodes_total": 6230, "episodes_this_iter": 63, "time_total_s": 4502.107528209686, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 107113, "timestamp": 1556531796, "episode_len_mean": 680.68, "timesteps_since_restore": 12832116, "time_since_restore": 4542.2624542713165, "done": false, "custom_metrics": {"outflow_rate_min": 487.611115026176, "outflow_rate_mean": 931.1601679200379, "cost2_mean": -63.99687814230973, "outflow_rate_max": 1135.5435672436379, "system_level_velocity_mean": 14.028430431616867, "system_level_velocity_min": 8.850774182863628, "cost2_max": -15.575361867653571, "cost2_min": -125.81365514178965, "cost1_min": 16.800536664241275, "cost1_max": 433.0303738261234, "cost1_mean": 353.674805096472, "system_level_velocity_max": 18.733374818598353}, "timesteps_total": 12832116, "training_iteration": 112, "date": "2019-04-29_09-56-36", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d545c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54550>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 112, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 978.5913898392566, "time_this_iter_s": 40.15492606163025, "info": {"grad_time_ms": 23240.756, "default": {"entropy": 1.633646011352539, "kl": 0.014649463817477226, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01626700535416603, "vf_loss": 35.9887580871582, "total_loss": 35.97990417480469, "vf_explained_var": 0.6543656587600708, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 12832116, "num_steps_trained": 12832116, "load_time_ms": 21.43, "update_time_ms": 11.13, "sample_time_ms": 15307.449}, "episode_reward_max": 1215.7857174284068, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 33.62350241660397, "episodes_total": 6295, "episodes_this_iter": 65, "time_total_s": 4542.2624542713165, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 108629, "timestamp": 1556531835, "episode_len_mean": 686.54, "timesteps_since_restore": 12940745, "time_since_restore": 4581.304753065109, "done": false, "custom_metrics": {"outflow_rate_min": 487.611115026176, "outflow_rate_mean": 935.9937576461728, "cost2_mean": -65.41228460867055, "outflow_rate_max": 1166.8993313248213, "system_level_velocity_mean": 13.930017713116985, "system_level_velocity_min": 8.850774182863628, "cost2_max": -15.575361867653571, "cost2_min": -125.78450709895355, "cost1_min": 16.800536664241275, "cost1_max": 446.6131345273386, "cost1_mean": 355.74620296871103, "system_level_velocity_max": 18.10286159051605}, "timesteps_total": 12940745, "training_iteration": 113, "date": "2019-04-29_09-57-15", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d496a0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49e10>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 113, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 998.1731072834206, "time_this_iter_s": 39.042298793792725, "info": {"grad_time_ms": 23108.172, "default": {"entropy": 1.658908724784851, "kl": 0.014450756832957268, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016965029761195183, "vf_loss": 39.77853775024414, "total_loss": 39.76888656616211, "vf_explained_var": 0.6320405006408691, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 12940745, "num_steps_trained": 12940745, "load_time_ms": 22.479, "update_time_ms": 10.961, "sample_time_ms": 15375.559}, "episode_reward_max": 1239.4653552717953, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 36.38814280268679, "episodes_total": 6356, "episodes_this_iter": 61, "time_total_s": 4581.304753065109, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 108697, "timestamp": 1556531874, "episode_len_mean": 694.84, "timesteps_since_restore": 13049442, "time_since_restore": 4619.92050242424, "done": false, "custom_metrics": {"outflow_rate_min": 777.7410813479484, "outflow_rate_mean": 938.265148218852, "cost2_mean": -65.34304300471469, "outflow_rate_max": 1166.8993313248213, "system_level_velocity_mean": 13.87280958396975, "system_level_velocity_min": 9.394399420543262, "cost2_max": -28.49491830669292, "cost2_min": -132.04205741595857, "cost1_min": 114.6167717330024, "cost1_max": 452.1044303861652, "cost1_mean": 359.3538039396914, "system_level_velocity_max": 17.631315028693734}, "timesteps_total": 13049442, "training_iteration": 114, "date": "2019-04-29_09-57-54", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54ac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54cf8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 114, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1002.3169477301337, "time_this_iter_s": 38.61574935913086, "info": {"grad_time_ms": 22999.977, "default": {"entropy": 1.6755977869033813, "kl": 0.014570452272891998, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0165803711861372, "vf_loss": 38.91450119018555, "total_loss": 38.905303955078125, "vf_explained_var": 0.6652688384056091, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 13049442, "num_steps_trained": 13049442, "load_time_ms": 21.825, "update_time_ms": 10.896, "sample_time_ms": 15371.516}, "episode_reward_max": 1239.4653552717953, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 248.74893503133882, "episodes_total": 6424, "episodes_this_iter": 68, "time_total_s": 4619.92050242424, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 107450, "timestamp": 1556531911, "episode_len_mean": 693.42, "timesteps_since_restore": 13156892, "time_since_restore": 4657.5641758441925, "done": false, "custom_metrics": {"outflow_rate_min": 511.41332843198114, "outflow_rate_mean": 934.5403426052688, "cost2_mean": -67.92048078787354, "outflow_rate_max": 1090.0631815939291, "system_level_velocity_mean": 13.72366341412593, "system_level_velocity_min": 9.049653353429035, "cost2_max": -16.2825160752182, "cost2_min": -132.1843171892505, "cost1_min": 27.575891924600437, "cost1_max": 452.1044303861652, "cost1_mean": 354.06496625009794, "system_level_velocity_max": 18.53336511380298}, "timesteps_total": 13156892, "training_iteration": 115, "date": "2019-04-29_09-58-31", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54d68>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54b00>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 115, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1004.5107578578933, "time_this_iter_s": 37.64367341995239, "info": {"grad_time_ms": 23129.276, "default": {"entropy": 1.6879158020019531, "kl": 0.014835634268820286, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016202211380004883, "vf_loss": 37.21460723876953, "total_loss": 37.20591735839844, "vf_explained_var": 0.7111058831214905, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 13156892, "num_steps_trained": 13156892, "load_time_ms": 21.928, "update_time_ms": 10.672, "sample_time_ms": 15350.56}, "episode_reward_max": 1226.0741099290985, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 71.6297324529954, "episodes_total": 6486, "episodes_this_iter": 62, "time_total_s": 4657.5641758441925, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 108125, "timestamp": 1556531951, "episode_len_mean": 679.76, "timesteps_since_restore": 13265017, "time_since_restore": 4697.274003267288, "done": false, "custom_metrics": {"outflow_rate_min": 433.12568539996727, "outflow_rate_mean": 939.3969466051243, "cost2_mean": -64.33053498364245, "outflow_rate_max": 1110.6943028457658, "system_level_velocity_mean": 14.324377659368524, "system_level_velocity_min": 9.049653353429035, "cost2_max": -9.942242395732423, "cost2_min": -132.1843171892505, "cost1_min": 9.75545543212583, "cost1_max": 437.2819188173513, "cost1_mean": 359.4770185021083, "system_level_velocity_max": 18.53336511380298}, "timesteps_total": 13265017, "training_iteration": 116, "date": "2019-04-29_09-59-11", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49c18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49748>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 116, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 986.5398360475476, "time_this_iter_s": 39.7098274230957, "info": {"grad_time_ms": 23244.752, "default": {"entropy": 1.6928303241729736, "kl": 0.01411865372210741, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0165039524435997, "vf_loss": 37.23283004760742, "total_loss": 37.223472595214844, "vf_explained_var": 0.6675502061843872, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 13265017, "num_steps_trained": 13265017, "load_time_ms": 24.115, "update_time_ms": 10.679, "sample_time_ms": 15429.011}, "episode_reward_max": 1267.182572174167, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 19.4118149961208, "episodes_total": 6548, "episodes_this_iter": 62, "time_total_s": 4697.274003267288, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 107523, "timestamp": 1556531991, "episode_len_mean": 700.0, "timesteps_since_restore": 13372540, "time_since_restore": 4736.911641597748, "done": false, "custom_metrics": {"outflow_rate_min": 780.0327176097909, "outflow_rate_mean": 935.474755758932, "cost2_mean": -67.52109154440224, "outflow_rate_max": 1143.3886379307228, "system_level_velocity_mean": 13.82371861484616, "system_level_velocity_min": 10.305088675916235, "cost2_max": -29.369575128795685, "cost2_min": -146.711228768965, "cost1_min": 266.69125337289336, "cost1_max": 443.4109316070921, "cost1_mean": 360.15650522558076, "system_level_velocity_max": 17.060905430980483}, "timesteps_total": 13372540, "training_iteration": 117, "date": "2019-04-29_09-59-51", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54d68>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 117, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 993.9996750543512, "time_this_iter_s": 39.637638330459595, "info": {"grad_time_ms": 23197.13, "default": {"entropy": 1.70039963722229, "kl": 0.014769606292247772, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016059771180152893, "vf_loss": 37.213809967041016, "total_loss": 37.205223083496094, "vf_explained_var": 0.666479766368866, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 13372540, "num_steps_trained": 13372540, "load_time_ms": 24.846, "update_time_ms": 10.659, "sample_time_ms": 15551.57}, "episode_reward_max": 1250.7760978111314, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 788.2387832200321, "episodes_total": 6612, "episodes_this_iter": 64, "time_total_s": 4736.911641597748, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 107679, "timestamp": 1556532030, "episode_len_mean": 693.33, "timesteps_since_restore": 13480219, "time_since_restore": 4775.635580539703, "done": false, "custom_metrics": {"outflow_rate_min": 504.027103115012, "outflow_rate_mean": 942.2762849274559, "cost2_mean": -68.93818552972975, "outflow_rate_max": 1166.6551165612088, "system_level_velocity_mean": 14.039735537505656, "system_level_velocity_min": 9.7109464570938, "cost2_max": -13.343687062001063, "cost2_min": -146.711228768965, "cost1_min": 21.653869747587894, "cost1_max": 443.7737189364145, "cost1_mean": 362.0631355972328, "system_level_velocity_max": 17.931339887266056}, "timesteps_total": 13480219, "training_iteration": 118, "date": "2019-04-29_10-00-30", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49eb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49a58>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 118, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1003.3996986460527, "time_this_iter_s": 38.723938941955566, "info": {"grad_time_ms": 23051.406, "default": {"entropy": 1.6704182624816895, "kl": 0.014267009682953358, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01633693277835846, "vf_loss": 36.277889251708984, "total_loss": 36.268775939941406, "vf_explained_var": 0.728405773639679, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 13480219, "num_steps_trained": 13480219, "load_time_ms": 24.996, "update_time_ms": 10.494, "sample_time_ms": 15526.626}, "episode_reward_max": 1250.7760978111314, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 57.54694908256125, "episodes_total": 6676, "episodes_this_iter": 64, "time_total_s": 4775.635580539703, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 108628, "timestamp": 1556532068, "episode_len_mean": 693.33, "timesteps_since_restore": 13588847, "time_since_restore": 4814.017793178558, "done": false, "custom_metrics": {"outflow_rate_min": 504.027103115012, "outflow_rate_mean": 926.6067107533137, "cost2_mean": -66.51372706378721, "outflow_rate_max": 1166.6551165612088, "system_level_velocity_mean": 14.050352737137901, "system_level_velocity_min": 10.19910957263263, "cost2_max": -13.343687062001063, "cost2_min": -135.22658690834194, "cost1_min": 21.653869747587894, "cost1_max": 443.7737189364145, "cost1_mean": 361.1321879712115, "system_level_velocity_max": 17.931339887266056}, "timesteps_total": 13588847, "training_iteration": 119, "date": "2019-04-29_10-01-08", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d542e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54438>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d543c8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 119, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 994.9836823927167, "time_this_iter_s": 38.38221263885498, "info": {"grad_time_ms": 23213.564, "default": {"entropy": 1.687081217765808, "kl": 0.01522807776927948, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016694743186235428, "vf_loss": 35.78671646118164, "total_loss": 35.77772903442383, "vf_explained_var": 0.7064705491065979, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 13588847, "num_steps_trained": 13588847, "load_time_ms": 23.871, "update_time_ms": 10.673, "sample_time_ms": 15537.51}, "episode_reward_max": 1284.074996230781, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 57.54694908256125, "episodes_total": 6739, "episodes_this_iter": 63, "time_total_s": 4814.017793178558, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 107233, "timestamp": 1556532106, "episode_len_mean": 693.53, "timesteps_since_restore": 13696080, "time_since_restore": 4852.413572072983, "done": false, "custom_metrics": {"outflow_rate_min": 552.6768201980651, "outflow_rate_mean": 935.5098770674807, "cost2_mean": -69.27079436426338, "outflow_rate_max": 1111.5591737779432, "system_level_velocity_mean": 13.964854493917546, "system_level_velocity_min": 10.19910957263263, "cost2_max": -22.556243640668374, "cost2_min": -122.77045207474286, "cost1_min": 34.67425884635183, "cost1_max": 432.6246509109952, "cost1_mean": 359.1863646952687, "system_level_velocity_max": 18.57887915746229}, "timesteps_total": 13696080, "training_iteration": 120, "date": "2019-04-29_10-01-46", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54470>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d540f0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 120, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 998.7729313252036, "time_this_iter_s": 38.39577889442444, "info": {"grad_time_ms": 23217.229, "default": {"entropy": 1.679716944694519, "kl": 0.015279125422239304, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016158659011125565, "vf_loss": 38.42946243286133, "total_loss": 38.42103958129883, "vf_explained_var": 0.6848345994949341, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 13696080, "num_steps_trained": 13696080, "load_time_ms": 22.813, "update_time_ms": 10.667, "sample_time_ms": 15430.164}, "episode_reward_max": 1230.6719792519812, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 73.42379747608143, "episodes_total": 6802, "episodes_this_iter": 63, "time_total_s": 4852.413572072983, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 107241, "timestamp": 1556532143, "episode_len_mean": 693.53, "timesteps_since_restore": 13803321, "time_since_restore": 4888.943586111069, "done": false, "custom_metrics": {"outflow_rate_min": 552.6768201980651, "outflow_rate_mean": 937.7706594585732, "cost2_mean": -68.86156589312776, "outflow_rate_max": 1111.5591737779432, "system_level_velocity_mean": 13.988469101387683, "system_level_velocity_min": 9.319440955102786, "cost2_max": -22.556243640668374, "cost2_min": -140.13925605230668, "cost1_min": 34.67425884635183, "cost1_max": 449.2866137399892, "cost1_mean": 359.3249224764167, "system_level_velocity_max": 18.57887915746229}, "timesteps_total": 13803321, "training_iteration": 121, "date": "2019-04-29_10-02-23", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8b38>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b84a8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 121, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 991.374182328803, "time_this_iter_s": 36.53001403808594, "info": {"grad_time_ms": 23006.115, "default": {"entropy": 1.6872905492782593, "kl": 0.015142161399126053, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015788044780492783, "vf_loss": 36.971492767333984, "total_loss": 36.963375091552734, "vf_explained_var": 0.7119079232215881, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 13803321, "num_steps_trained": 13803321, "load_time_ms": 21.513, "update_time_ms": 10.649, "sample_time_ms": 15425.438}, "episode_reward_max": 1274.53763889321, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 73.42379747608143, "episodes_total": 6863, "episodes_this_iter": 61, "time_total_s": 4888.943586111069, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 108674, "timestamp": 1556532182, "episode_len_mean": 700.0, "timesteps_since_restore": 13911995, "time_since_restore": 4927.4046626091, "done": false, "custom_metrics": {"outflow_rate_min": 720.2305513107577, "outflow_rate_mean": 943.7767213669454, "cost2_mean": -69.67929168138788, "outflow_rate_max": 1087.1431130087954, "system_level_velocity_mean": 14.101023285923898, "system_level_velocity_min": 9.319440955102786, "cost2_max": -31.440536602261403, "cost2_min": -140.13925605230668, "cost1_min": 242.1454788119368, "cost1_max": 448.40814171840816, "cost1_mean": 366.12027148021656, "system_level_velocity_max": 17.64290483485021}, "timesteps_total": 13911995, "training_iteration": 122, "date": "2019-04-29_10-03-02", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54c50>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54780>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 122, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 994.0931303144789, "time_this_iter_s": 38.461076498031616, "info": {"grad_time_ms": 22973.409, "default": {"entropy": 1.6777703762054443, "kl": 0.014741327613592148, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015085182152688503, "vf_loss": 38.917789459228516, "total_loss": 38.91017150878906, "vf_explained_var": 0.7037092447280884, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 13911995, "num_steps_trained": 13911995, "load_time_ms": 21.596, "update_time_ms": 10.754, "sample_time_ms": 15288.809}, "episode_reward_max": 1214.393428048859, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 733.0082097643239, "episodes_total": 6926, "episodes_this_iter": 63, "time_total_s": 4927.4046626091, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106214, "timestamp": 1556532219, "episode_len_mean": 695.75, "timesteps_since_restore": 14018209, "time_since_restore": 4965.077516317368, "done": false, "custom_metrics": {"outflow_rate_min": 720.2305513107577, "outflow_rate_mean": 942.2808705641919, "cost2_mean": -67.86717466723209, "outflow_rate_max": 1216.536559640095, "system_level_velocity_mean": 14.337702197316665, "system_level_velocity_min": 10.201874326290126, "cost2_max": -27.83859143096672, "cost2_min": -135.8253667128301, "cost1_min": 175.4298681349685, "cost1_max": 463.8649504518693, "cost1_mean": 370.05896853512996, "system_level_velocity_max": 17.952360358128555}, "timesteps_total": 14018209, "training_iteration": 123, "date": "2019-04-29_10-03-39", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8ac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8f28>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 123, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1002.8429232723523, "time_this_iter_s": 37.67285370826721, "info": {"grad_time_ms": 22878.405, "default": {"entropy": 1.7038116455078125, "kl": 0.015251530334353447, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01725018583238125, "vf_loss": 40.08531188964844, "total_loss": 40.07577896118164, "vf_explained_var": 0.7073484063148499, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 14018209, "num_steps_trained": 14018209, "load_time_ms": 21.025, "update_time_ms": 10.794, "sample_time_ms": 15247.152}, "episode_reward_max": 1306.4274125547452, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 453.56697626995907, "episodes_total": 6990, "episodes_this_iter": 64, "time_total_s": 4965.077516317368, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106862, "timestamp": 1556532259, "episode_len_mean": 688.98, "timesteps_since_restore": 14125071, "time_since_restore": 5004.344263553619, "done": false, "custom_metrics": {"outflow_rate_min": 480.93355929196133, "outflow_rate_mean": 933.1763499760965, "cost2_mean": -63.591971514267335, "outflow_rate_max": 1091.9080376012982, "system_level_velocity_mean": 14.432765550954597, "system_level_velocity_min": 10.022864045478519, "cost2_max": -16.201494281093666, "cost2_min": -141.74588786401267, "cost1_min": 15.14650001034806, "cost1_max": 440.62706022819145, "cost1_mean": 367.72407053155, "system_level_velocity_max": 17.68657790725494}, "timesteps_total": 14125071, "training_iteration": 124, "date": "2019-04-29_10-04-19", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d549b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b29e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d543c8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 124, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 990.0606792741223, "time_this_iter_s": 39.26674723625183, "info": {"grad_time_ms": 23007.292, "default": {"entropy": 1.7117624282836914, "kl": 0.015185643918812275, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016325127333402634, "vf_loss": 37.21772003173828, "total_loss": 37.20907974243164, "vf_explained_var": 0.7024609446525574, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 14125071, "num_steps_trained": 14125071, "load_time_ms": 20.343, "update_time_ms": 10.859, "sample_time_ms": 15181.946}, "episode_reward_max": 1306.4274125547452, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 34.73206314250539, "episodes_total": 7053, "episodes_this_iter": 63, "time_total_s": 5004.344263553619, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 107016, "timestamp": 1556532297, "episode_len_mean": 693.48, "timesteps_since_restore": 14232087, "time_since_restore": 5042.642241239548, "done": false, "custom_metrics": {"outflow_rate_min": 549.734399599166, "outflow_rate_mean": 927.8794542167016, "cost2_mean": -62.9491510992254, "outflow_rate_max": 1076.7444338929388, "system_level_velocity_mean": 14.207327834360681, "system_level_velocity_min": 8.004520055056139, "cost2_max": -23.763176740904797, "cost2_min": -122.50190302296363, "cost1_min": 31.08611839247029, "cost1_max": 445.37889623852925, "cost1_mean": 364.75793637428194, "system_level_velocity_max": 18.41667604806688}, "timesteps_total": 14232087, "training_iteration": 125, "date": "2019-04-29_10-04-57", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d208>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5da20>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 125, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 978.0423742573362, "time_this_iter_s": 38.297977685928345, "info": {"grad_time_ms": 23087.877, "default": {"entropy": 1.7117623090744019, "kl": 0.015143477357923985, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015819894149899483, "vf_loss": 39.261199951171875, "total_loss": 39.253047943115234, "vf_explained_var": 0.711988091468811, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 14232087, "num_steps_trained": 14232087, "load_time_ms": 20.384, "update_time_ms": 11.102, "sample_time_ms": 15164.591}, "episode_reward_max": 1247.7524488646027, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 74.72476736752131, "episodes_total": 7117, "episodes_this_iter": 64, "time_total_s": 5042.642241239548, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106957, "timestamp": 1556532336, "episode_len_mean": 687.57, "timesteps_since_restore": 14339044, "time_since_restore": 5081.626758813858, "done": false, "custom_metrics": {"outflow_rate_min": 496.6162766230939, "outflow_rate_mean": 930.4270182451846, "cost2_mean": -62.67610888947655, "outflow_rate_max": 1096.2060735412806, "system_level_velocity_mean": 14.453579877175537, "system_level_velocity_min": 8.004520055056139, "cost2_max": -18.294648190514025, "cost2_min": -127.87245352717552, "cost1_min": 22.339696921960147, "cost1_max": 454.74902749431857, "cost1_mean": 367.08544924681047, "system_level_velocity_max": 18.77745960140428}, "timesteps_total": 14339044, "training_iteration": 126, "date": "2019-04-29_10-05-36", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d543c8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54cf8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 126, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 986.1691213757374, "time_this_iter_s": 38.9845175743103, "info": {"grad_time_ms": 22969.694, "default": {"entropy": 1.6865475177764893, "kl": 0.01580316759645939, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015861736610531807, "vf_loss": 42.9965934753418, "total_loss": 42.98873519897461, "vf_explained_var": 0.6405260562896729, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 14339044, "num_steps_trained": 14339044, "load_time_ms": 19.68, "update_time_ms": 10.986, "sample_time_ms": 15208.805}, "episode_reward_max": 1217.8024130251245, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 57.33930862412204, "episodes_total": 7186, "episodes_this_iter": 69, "time_total_s": 5081.626758813858, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106654, "timestamp": 1556532375, "episode_len_mean": 692.32, "timesteps_since_restore": 14445698, "time_since_restore": 5120.843535661697, "done": false, "custom_metrics": {"outflow_rate_min": 711.2640057630359, "outflow_rate_mean": 940.1942995952189, "cost2_mean": -64.45851813846541, "outflow_rate_max": 1079.8869672252745, "system_level_velocity_mean": 14.604027177644914, "system_level_velocity_min": 10.878384879682113, "cost2_max": -28.775126206593537, "cost2_min": -161.05239329378514, "cost1_min": 79.91719528329259, "cost1_max": 440.9080685921295, "cost1_mean": 374.13439807608825, "system_level_velocity_max": 17.872605664724677}, "timesteps_total": 14445698, "training_iteration": 127, "date": "2019-04-29_10-06-15", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dda0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d898>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5df28>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 127, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1004.0996056025521, "time_this_iter_s": 39.216776847839355, "info": {"grad_time_ms": 22937.413, "default": {"entropy": 1.7110512256622314, "kl": 0.014936576597392559, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015432302840054035, "vf_loss": 39.37205123901367, "total_loss": 39.36418151855469, "vf_explained_var": 0.6735672950744629, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 14445698, "num_steps_trained": 14445698, "load_time_ms": 18.469, "update_time_ms": 11.121, "sample_time_ms": 15198.901}, "episode_reward_max": 1207.4877923761155, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 176.7435209574874, "episodes_total": 7250, "episodes_this_iter": 64, "time_total_s": 5120.843535661697, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106051, "timestamp": 1556532414, "episode_len_mean": 693.31, "timesteps_since_restore": 14551749, "time_since_restore": 5159.718198776245, "done": false, "custom_metrics": {"outflow_rate_min": 455.6453970479463, "outflow_rate_mean": 945.3800306141554, "cost2_mean": -64.765809210441, "outflow_rate_max": 1090.6581416077283, "system_level_velocity_mean": 14.721973900881919, "system_level_velocity_min": 10.878384879682113, "cost2_max": -20.336192466312436, "cost2_min": -161.05239329378514, "cost1_min": 20.220446615751978, "cost1_max": 436.99820600152026, "cost1_mean": 377.7470858661857, "system_level_velocity_max": 18.511908123046727}, "timesteps_total": 14551749, "training_iteration": 128, "date": "2019-04-29_10-06-54", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d547f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d546d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d549b0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 128, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1001.1221331776177, "time_this_iter_s": 38.87466311454773, "info": {"grad_time_ms": 23002.796, "default": {"entropy": 1.686725378036499, "kl": 0.015883512794971466, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016415392979979515, "vf_loss": 42.69877624511719, "total_loss": 42.690406799316406, "vf_explained_var": 0.5832765102386475, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 14551749, "num_steps_trained": 14551749, "load_time_ms": 18.28, "update_time_ms": 11.32, "sample_time_ms": 15148.854}, "episode_reward_max": 1252.671650696511, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 49.49962125388749, "episodes_total": 7316, "episodes_this_iter": 66, "time_total_s": 5159.718198776245, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106284, "timestamp": 1556532451, "episode_len_mean": 693.45, "timesteps_since_restore": 14658033, "time_since_restore": 5196.813556432724, "done": false, "custom_metrics": {"outflow_rate_min": 514.2046274489628, "outflow_rate_mean": 953.6794886281955, "cost2_mean": -65.16423389663629, "outflow_rate_max": 1090.6581416077283, "system_level_velocity_mean": 14.861635769551171, "system_level_velocity_min": 11.761799027840828, "cost2_max": -21.060107827005783, "cost2_min": -134.63734584080333, "cost1_min": 29.271340547058717, "cost1_max": 449.5558689108856, "cost1_mean": 381.98733233141456, "system_level_velocity_max": 18.07886177581695}, "timesteps_total": 14658033, "training_iteration": 129, "date": "2019-04-29_10-07-31", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5db70>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dd68>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 129, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1019.5937487972883, "time_this_iter_s": 37.09535765647888, "info": {"grad_time_ms": 22938.467, "default": {"entropy": 1.703160047531128, "kl": 0.015460853464901447, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016021987423300743, "vf_loss": 44.131126403808594, "total_loss": 44.12293243408203, "vf_explained_var": 0.5707522034645081, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 14658033, "num_steps_trained": 14658033, "load_time_ms": 19.507, "update_time_ms": 11.488, "sample_time_ms": 15086.191}, "episode_reward_max": 1252.671650696511, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 61.94523443417611, "episodes_total": 7381, "episodes_this_iter": 65, "time_total_s": 5196.813556432724, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105910, "timestamp": 1556532490, "episode_len_mean": 693.45, "timesteps_since_restore": 14763943, "time_since_restore": 5235.216419458389, "done": false, "custom_metrics": {"outflow_rate_min": 514.2046274489628, "outflow_rate_mean": 951.7446639668244, "cost2_mean": -67.57910559007115, "outflow_rate_max": 1121.4430864882293, "system_level_velocity_mean": 14.62624219358727, "system_level_velocity_min": 9.736438644587414, "cost2_max": -21.060107827005783, "cost2_min": -135.47591296951015, "cost1_min": 29.271340547058717, "cost1_max": 447.3581377020654, "cost1_mean": 376.3277025480348, "system_level_velocity_max": 18.07886177581695}, "timesteps_total": 14763943, "training_iteration": 130, "date": "2019-04-29_10-08-10", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d540f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d543c8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 130, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1005.612901030387, "time_this_iter_s": 38.40286302566528, "info": {"grad_time_ms": 22942.934, "default": {"entropy": 1.7223694324493408, "kl": 0.01474152971059084, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015250734984874725, "vf_loss": 41.07105255126953, "total_loss": 41.06326675415039, "vf_explained_var": 0.6412749290466309, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 14763943, "num_steps_trained": 14763943, "load_time_ms": 20.56, "update_time_ms": 11.863, "sample_time_ms": 15081.245}, "episode_reward_max": 1259.4966664287929, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 61.94523443417611, "episodes_total": 7446, "episodes_this_iter": 65, "time_total_s": 5235.216419458389, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 107475, "timestamp": 1556532529, "episode_len_mean": 687.42, "timesteps_since_restore": 14871418, "time_since_restore": 5274.006926059723, "done": false, "custom_metrics": {"outflow_rate_min": 514.5892325894465, "outflow_rate_mean": 948.9328686202715, "cost2_mean": -72.03468086275987, "outflow_rate_max": 1157.4057480617291, "system_level_velocity_mean": 14.598243319837895, "system_level_velocity_min": 10.46986088549481, "cost2_max": -17.373945128464303, "cost2_min": -151.46096403847991, "cost1_min": 23.712344609304168, "cost1_max": 452.8162556719658, "cost1_mean": 370.38556807767657, "system_level_velocity_max": 19.22247398596399}, "timesteps_total": 14871418, "training_iteration": 131, "date": "2019-04-29_10-08-49", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dc88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d898>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5de80>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 131, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 989.1995423053933, "time_this_iter_s": 38.79050660133362, "info": {"grad_time_ms": 23099.502, "default": {"entropy": 1.7379975318908691, "kl": 0.01561983022838831, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01740231178700924, "vf_loss": 41.75941467285156, "total_loss": 41.749916076660156, "vf_explained_var": 0.6816248297691345, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 14871418, "num_steps_trained": 14871418, "load_time_ms": 21.524, "update_time_ms": 12.14, "sample_time_ms": 15149.978}, "episode_reward_max": 1215.5136688413152, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 61.50757216172548, "episodes_total": 7511, "episodes_this_iter": 65, "time_total_s": 5274.006926059723, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 108134, "timestamp": 1556532571, "episode_len_mean": 686.72, "timesteps_since_restore": 14979552, "time_since_restore": 5316.035088062286, "done": false, "custom_metrics": {"outflow_rate_min": 514.5892325894465, "outflow_rate_mean": 941.6938209547474, "cost2_mean": -73.43056830525738, "outflow_rate_max": 1157.4057480617291, "system_level_velocity_mean": 14.430289729829507, "system_level_velocity_min": 10.46986088549481, "cost2_max": -17.373945128464303, "cost2_min": -151.46096403847991, "cost1_min": 23.712344609304168, "cost1_max": 452.8162556719658, "cost1_mean": 365.2922820182863, "system_level_velocity_max": 19.22247398596399}, "timesteps_total": 14979552, "training_iteration": 132, "date": "2019-04-29_10-09-31", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54160>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d546a0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 132, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 984.3544262228107, "time_this_iter_s": 42.02816200256348, "info": {"grad_time_ms": 23359.177, "default": {"entropy": 1.7268413305282593, "kl": 0.014878137037158012, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016225652769207954, "vf_loss": 42.65806579589844, "total_loss": 42.64937210083008, "vf_explained_var": 0.6888035535812378, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 14979552, "num_steps_trained": 14979552, "load_time_ms": 21.854, "update_time_ms": 12.295, "sample_time_ms": 15244.236}, "episode_reward_max": 1223.8670987697835, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 50.044012699725066, "episodes_total": 7575, "episodes_this_iter": 64, "time_total_s": 5316.035088062286, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 107285, "timestamp": 1556532610, "episode_len_mean": 693.37, "timesteps_since_restore": 15086837, "time_since_restore": 5355.2603397369385, "done": false, "custom_metrics": {"outflow_rate_min": 521.4247307854637, "outflow_rate_mean": 945.4678786590753, "cost2_mean": -77.42234819964239, "outflow_rate_max": 1136.5050040266437, "system_level_velocity_mean": 14.14150716218586, "system_level_velocity_min": 9.261669908071662, "cost2_max": -18.871855611034253, "cost2_min": -165.57777940595372, "cost1_min": 24.744497052361442, "cost1_max": 444.03726290723546, "cost1_mean": 362.6611210353399, "system_level_velocity_max": 18.38951303045932}, "timesteps_total": 15086837, "training_iteration": 133, "date": "2019-04-29_10-10-10", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d1d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d9b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5df28>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 133, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 998.1959344973789, "time_this_iter_s": 39.2252516746521, "info": {"grad_time_ms": 23486.269, "default": {"entropy": 1.728853702545166, "kl": 0.01565607078373432, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016931604593992233, "vf_loss": 44.09982681274414, "total_loss": 44.090824127197266, "vf_explained_var": 0.7017213106155396, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 15086837, "num_steps_trained": 15086837, "load_time_ms": 22.443, "update_time_ms": 12.625, "sample_time_ms": 15270.96}, "episode_reward_max": 1256.032248378152, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 59.54615333051795, "episodes_total": 7643, "episodes_this_iter": 68, "time_total_s": 5355.2603397369385, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 108008, "timestamp": 1556532650, "episode_len_mean": 693.19, "timesteps_since_restore": 15194845, "time_since_restore": 5394.726473808289, "done": false, "custom_metrics": {"outflow_rate_min": 467.7500288525429, "outflow_rate_mean": 949.8950655910676, "cost2_mean": -70.33562954555029, "outflow_rate_max": 1136.5050040266437, "system_level_velocity_mean": 14.500251040890424, "system_level_velocity_min": 10.085800979982222, "cost2_max": -14.115928448065151, "cost2_min": -146.3188832747886, "cost1_min": 12.39295233647294, "cost1_max": 444.03726290723546, "cost1_mean": 372.32656724407104, "system_level_velocity_max": 17.422882852472856}, "timesteps_total": 15194845, "training_iteration": 134, "date": "2019-04-29_10-10-50", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54550>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54940>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 134, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1002.4003678987601, "time_this_iter_s": 39.4661340713501, "info": {"grad_time_ms": 23400.798, "default": {"entropy": 1.7302460670471191, "kl": 0.015773653984069824, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0166415274143219, "vf_loss": 42.56502151489258, "total_loss": 42.55636215209961, "vf_explained_var": 0.6607298254966736, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 15194845, "num_steps_trained": 15194845, "load_time_ms": 23.385, "update_time_ms": 12.902, "sample_time_ms": 15375.026}, "episode_reward_max": 1256.032248378152, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 27.414542234404248, "episodes_total": 7710, "episodes_this_iter": 67, "time_total_s": 5394.726473808289, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105340, "timestamp": 1556532688, "episode_len_mean": 682.78, "timesteps_since_restore": 15300185, "time_since_restore": 5433.035867214203, "done": false, "custom_metrics": {"outflow_rate_min": 533.5544938034474, "outflow_rate_mean": 941.5431873957458, "cost2_mean": -69.35460642133235, "outflow_rate_max": 1149.2599026276082, "system_level_velocity_mean": 14.568858404510285, "system_level_velocity_min": 8.70513064348987, "cost2_max": -19.920822996316186, "cost2_min": -154.6939211289564, "cost1_min": 28.19612990358758, "cost1_max": 439.2420231543508, "cost1_mean": 366.52493426351134, "system_level_velocity_max": 18.973677546970844}, "timesteps_total": 15300185, "training_iteration": 135, "date": "2019-04-29_10-11-28", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dcf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dc88>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d9b0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 135, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 975.4020031931573, "time_this_iter_s": 38.30939340591431, "info": {"grad_time_ms": 23376.991, "default": {"entropy": 1.7241734266281128, "kl": 0.01526120025664568, "cur_lr": 0.0005000000237487257, "policy_loss": -0.017157699912786484, "vf_loss": 40.526145935058594, "total_loss": 40.51670837402344, "vf_explained_var": 0.6295356154441833, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 15300185, "num_steps_trained": 15300185, "load_time_ms": 23.382, "update_time_ms": 12.884, "sample_time_ms": 15401.357}, "episode_reward_max": 1197.8023640282001, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 63.62945303658288, "episodes_total": 7776, "episodes_this_iter": 66, "time_total_s": 5433.035867214203, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106368, "timestamp": 1556532726, "episode_len_mean": 687.48, "timesteps_since_restore": 15406553, "time_since_restore": 5470.630430221558, "done": false, "custom_metrics": {"outflow_rate_min": 533.5544938034474, "outflow_rate_mean": 967.329760509846, "cost2_mean": -71.80385165629752, "outflow_rate_max": 1158.3890642586982, "system_level_velocity_mean": 14.969910730693586, "system_level_velocity_min": 8.70513064348987, "cost2_max": -19.920822996316186, "cost2_min": -156.13298612664528, "cost1_min": 28.19612990358758, "cost1_max": 451.76583167077604, "cost1_mean": 378.8838574330454, "system_level_velocity_max": 18.973677546970844}, "timesteps_total": 15406553, "training_iteration": 136, "date": "2019-04-29_10-12-06", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54320>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54550>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 136, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 999.5471278054735, "time_this_iter_s": 37.594563007354736, "info": {"grad_time_ms": 23370.866, "default": {"entropy": 1.704557180404663, "kl": 0.015618900768458843, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015889428555965424, "vf_loss": 42.64651107788086, "total_loss": 42.638526916503906, "vf_explained_var": 0.6492592096328735, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 15406553, "num_steps_trained": 15406553, "load_time_ms": 22.6, "update_time_ms": 13.136, "sample_time_ms": 15268.918}, "episode_reward_max": 1201.8814334364638, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 63.62945303658288, "episodes_total": 7839, "episodes_this_iter": 63, "time_total_s": 5470.630430221558, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106548, "timestamp": 1556532765, "episode_len_mean": 700.0, "timesteps_since_restore": 15513101, "time_since_restore": 5509.47705578804, "done": false, "custom_metrics": {"outflow_rate_min": 815.9930733456185, "outflow_rate_mean": 976.7004258371478, "cost2_mean": -74.7525610281682, "outflow_rate_max": 1158.3890642586982, "system_level_velocity_mean": 14.970351678413603, "system_level_velocity_min": 10.675230256319448, "cost2_max": -29.01634962121767, "cost2_min": -157.2222272491315, "cost1_min": 276.26149669368965, "cost1_max": 452.7668130351407, "cost1_mean": 386.4562315193884, "system_level_velocity_max": 17.862888781537695}, "timesteps_total": 15513101, "training_iteration": 137, "date": "2019-04-29_10-12-45", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dc88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dba8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d198>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 137, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1020.6017299296817, "time_this_iter_s": 38.846625566482544, "info": {"grad_time_ms": 23346.181, "default": {"entropy": 1.7107760906219482, "kl": 0.01529575977474451, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016072392463684082, "vf_loss": 43.77164077758789, "total_loss": 43.76331329345703, "vf_explained_var": 0.6625469923019409, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 15513101, "num_steps_trained": 15513101, "load_time_ms": 23.778, "update_time_ms": 13.085, "sample_time_ms": 15255.861}, "episode_reward_max": 1202.5823878742563, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 776.9386948217722, "episodes_total": 7905, "episodes_this_iter": 66, "time_total_s": 5509.47705578804, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106513, "timestamp": 1556532803, "episode_len_mean": 700.0, "timesteps_since_restore": 15619614, "time_since_restore": 5547.900881052017, "done": false, "custom_metrics": {"outflow_rate_min": 815.9930733456185, "outflow_rate_mean": 968.3910422365193, "cost2_mean": -75.65839623686044, "outflow_rate_max": 1125.2068215060315, "system_level_velocity_mean": 14.732703002429632, "system_level_velocity_min": 11.037783636138219, "cost2_max": -28.68547600523988, "cost2_min": -157.2222272491315, "cost1_min": 283.27250681635803, "cost1_max": 452.8479052207326, "cost1_mean": 380.2579199045912, "system_level_velocity_max": 17.95229082385166}, "timesteps_total": 15619614, "training_iteration": 138, "date": "2019-04-29_10-13-23", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54780>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54940>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 138, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1011.6803547340434, "time_this_iter_s": 38.42382526397705, "info": {"grad_time_ms": 23222.339, "default": {"entropy": 1.734291672706604, "kl": 0.01589472033083439, "cur_lr": 0.0005000000237487257, "policy_loss": -0.017383243888616562, "vf_loss": 39.68259048461914, "total_loss": 39.673255920410156, "vf_explained_var": 0.6931321620941162, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 15619614, "num_steps_trained": 15619614, "load_time_ms": 23.301, "update_time_ms": 13.098, "sample_time_ms": 15334.685}, "episode_reward_max": 1268.9389162801012, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 723.5503530271865, "episodes_total": 7969, "episodes_this_iter": 64, "time_total_s": 5547.900881052017, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106581, "timestamp": 1556532840, "episode_len_mean": 693.87, "timesteps_since_restore": 15726195, "time_since_restore": 5584.336046218872, "done": false, "custom_metrics": {"outflow_rate_min": 712.5271148509528, "outflow_rate_mean": 963.3623209719332, "cost2_mean": -74.03410023428779, "outflow_rate_max": 1161.2921113081304, "system_level_velocity_mean": 14.68390836754854, "system_level_velocity_min": 7.371248806577588, "cost2_max": -32.963382559647734, "cost2_min": -149.59064385020753, "cost1_min": 179.3325258862082, "cost1_max": 452.8479052207326, "cost1_mean": 375.3609816491839, "system_level_velocity_max": 17.85727499368132}, "timesteps_total": 15726195, "training_iteration": 139, "date": "2019-04-29_10-14-00", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dc88>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5ddd8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 139, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1000.2796094006292, "time_this_iter_s": 36.43516516685486, "info": {"grad_time_ms": 23105.574, "default": {"entropy": 1.7592520713806152, "kl": 0.015237406827509403, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015962990000844002, "vf_loss": 40.77571105957031, "total_loss": 40.76746368408203, "vf_explained_var": 0.7031439542770386, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 15726195, "num_steps_trained": 15726195, "load_time_ms": 21.189, "update_time_ms": 12.964, "sample_time_ms": 15388.027}, "episode_reward_max": 1268.9389162801012, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 451.3291141148221, "episodes_total": 8031, "episodes_this_iter": 62, "time_total_s": 5584.336046218872, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106353, "timestamp": 1556532881, "episode_len_mean": 673.9, "timesteps_since_restore": 15832548, "time_since_restore": 5625.913744211197, "done": false, "custom_metrics": {"outflow_rate_min": 487.611115026176, "outflow_rate_mean": 948.4407349188212, "cost2_mean": -69.70189155035234, "outflow_rate_max": 1210.01499987044, "system_level_velocity_mean": 14.848200510345357, "system_level_velocity_min": 7.371248806577588, "cost2_max": -16.099661685789105, "cost2_min": -154.57312945150335, "cost1_min": 17.44246923083425, "cost1_max": 455.67325208369897, "cost1_mean": 366.76822229859323, "system_level_velocity_max": 18.825318286991262}, "timesteps_total": 15832548, "training_iteration": 140, "date": "2019-04-29_10-14-41", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b83c8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54358>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 140, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 968.0427483002167, "time_this_iter_s": 41.57769799232483, "info": {"grad_time_ms": 23285.11, "default": {"entropy": 1.7560425996780396, "kl": 0.01589628867805004, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016898971050977707, "vf_loss": 42.51822280883789, "total_loss": 42.509376525878906, "vf_explained_var": 0.6804139018058777, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 15832548, "num_steps_trained": 15832548, "load_time_ms": 20.903, "update_time_ms": 12.526, "sample_time_ms": 15527.273}, "episode_reward_max": 1235.0729318093365, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 44.016446977520516, "episodes_total": 8102, "episodes_this_iter": 71, "time_total_s": 5625.913744211197, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106788, "timestamp": 1556532920, "episode_len_mean": 700.0, "timesteps_since_restore": 15939336, "time_since_restore": 5664.8824870586395, "done": false, "custom_metrics": {"outflow_rate_min": 803.7549368266025, "outflow_rate_mean": 975.6392773393117, "cost2_mean": -74.02301962762816, "outflow_rate_max": 1210.01499987044, "system_level_velocity_mean": 14.926519854827925, "system_level_velocity_min": 9.792762465071037, "cost2_max": -35.22217210232992, "cost2_min": -171.4180956304669, "cost1_min": 258.07177734723945, "cost1_max": 463.72058249825864, "cost1_mean": 386.0247636126924, "system_level_velocity_max": 18.11247024243971}, "timesteps_total": 15939336, "training_iteration": 141, "date": "2019-04-29_10-15-20", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5de80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d0f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d978>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 141, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 1016.8885738716693, "time_this_iter_s": 38.96874284744263, "info": {"grad_time_ms": 23319.212, "default": {"entropy": 1.7607051134109497, "kl": 0.015988009050488472, "cur_lr": 0.0005000000237487257, "policy_loss": -0.017653239890933037, "vf_loss": 38.983497619628906, "total_loss": 38.97393798828125, "vf_explained_var": 0.6849086880683899, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 15939336, "num_steps_trained": 15939336, "load_time_ms": 20.785, "update_time_ms": 12.4, "sample_time_ms": 15512.339}, "episode_reward_max": 1220.0186249937344, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 773.9659381799205, "episodes_total": 8166, "episodes_this_iter": 64, "time_total_s": 5664.8824870586395, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106279, "timestamp": 1556532957, "episode_len_mean": 693.24, "timesteps_since_restore": 16045615, "time_since_restore": 5701.135944843292, "done": false, "custom_metrics": {"outflow_rate_min": 458.05392104146785, "outflow_rate_mean": 946.9225316573134, "cost2_mean": -72.98716453086062, "outflow_rate_max": 1173.3173582061333, "system_level_velocity_mean": 14.585119125362997, "system_level_velocity_min": 9.792762465071037, "cost2_max": -18.197942757983753, "cost2_min": -164.92207723162875, "cost1_min": 15.833076528634127, "cost1_max": 463.72058249825864, "cost1_mean": 372.92752394192723, "system_level_velocity_max": 18.11247024243971}, "timesteps_total": 16045615, "training_iteration": 142, "date": "2019-04-29_10-15-57", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54d68>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d544a8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 142, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 987.9197746315841, "time_this_iter_s": 36.25345778465271, "info": {"grad_time_ms": 22914.571, "default": {"entropy": 1.781404733657837, "kl": 0.015502193942666054, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016957448795437813, "vf_loss": 42.15755081176758, "total_loss": 42.14844512939453, "vf_explained_var": 0.6760546565055847, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 16045615, "num_steps_trained": 16045615, "load_time_ms": 19.489, "update_time_ms": 12.153, "sample_time_ms": 15344.064}, "episode_reward_max": 1220.0186249937344, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 37.62486817853919, "episodes_total": 8233, "episodes_this_iter": 67, "time_total_s": 5701.135944843292, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106151, "timestamp": 1556532994, "episode_len_mean": 692.22, "timesteps_since_restore": 16151766, "time_since_restore": 5738.749837636948, "done": false, "custom_metrics": {"outflow_rate_min": 508.7592883338841, "outflow_rate_mean": 924.4608177246205, "cost2_mean": -69.3143964298371, "outflow_rate_max": 1136.885013384222, "system_level_velocity_mean": 14.428905700811931, "system_level_velocity_min": 7.818317013231832, "cost2_max": -16.043209075128036, "cost2_min": -146.58210864832358, "cost1_min": 22.09403004304789, "cost1_max": 450.6223863599756, "cost1_mean": 367.17109303014234, "system_level_velocity_max": 18.278185801618484}, "timesteps_total": 16151766, "training_iteration": 143, "date": "2019-04-29_10-16-34", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5de10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d9b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5df28>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 143, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 957.1266669070922, "time_this_iter_s": 37.613892793655396, "info": {"grad_time_ms": 22715.596, "default": {"entropy": 1.8006130456924438, "kl": 0.015459127724170685, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016493720933794975, "vf_loss": 39.951114654541016, "total_loss": 39.94244384765625, "vf_explained_var": 0.7162841558456421, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 16151766, "num_steps_trained": 16151766, "load_time_ms": 18.192, "update_time_ms": 11.607, "sample_time_ms": 15384.752}, "episode_reward_max": 1196.233343239747, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 54.48413295487627, "episodes_total": 8301, "episodes_this_iter": 68, "time_total_s": 5738.749837636948, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105420, "timestamp": 1556533033, "episode_len_mean": 689.78, "timesteps_since_restore": 16257186, "time_since_restore": 5777.354278326035, "done": false, "custom_metrics": {"outflow_rate_min": 508.7592883338841, "outflow_rate_mean": 931.1863817985593, "cost2_mean": -70.32877359090949, "outflow_rate_max": 1121.1364333929148, "system_level_velocity_mean": 14.625610486230544, "system_level_velocity_min": 9.896234817970502, "cost2_max": -16.043209075128036, "cost2_min": -146.58210864832358, "cost1_min": 22.09403004304789, "cost1_max": 448.4867348626912, "cost1_mean": 370.2085621181154, "system_level_velocity_max": 18.278185801618484}, "timesteps_total": 16257186, "training_iteration": 144, "date": "2019-04-29_10-17-13", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b88d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8c50>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 144, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 951.4460171113849, "time_this_iter_s": 38.604440689086914, "info": {"grad_time_ms": 22653.25, "default": {"entropy": 1.8307304382324219, "kl": 0.015674393624067307, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01680462621152401, "vf_loss": 39.5770263671875, "total_loss": 39.56815719604492, "vf_explained_var": 0.7342026233673096, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 16257186, "num_steps_trained": 16257186, "load_time_ms": 18.151, "update_time_ms": 11.344, "sample_time_ms": 15361.11}, "episode_reward_max": 1222.5804130637168, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 54.48413295487627, "episodes_total": 8368, "episodes_this_iter": 67, "time_total_s": 5777.354278326035, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 106147, "timestamp": 1556533071, "episode_len_mean": 693.21, "timesteps_since_restore": 16363333, "time_since_restore": 5815.465662956238, "done": false, "custom_metrics": {"outflow_rate_min": 472.99230095463946, "outflow_rate_mean": 920.0849736573219, "cost2_mean": -65.76158418030856, "outflow_rate_max": 1144.4439234443516, "system_level_velocity_mean": 14.761244119535274, "system_level_velocity_min": 9.67498955695392, "cost2_max": -14.372643469415234, "cost2_min": -150.05709031929547, "cost1_min": 13.599596398644813, "cost1_max": 448.71616491513646, "cost1_mean": 374.5109051524346, "system_level_velocity_max": 17.5025673336275}, "timesteps_total": 16363333, "training_iteration": 145, "date": "2019-04-29_10-17-51", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5ddd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d9e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d908>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 145, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 932.9093223857683, "time_this_iter_s": 38.11138463020325, "info": {"grad_time_ms": 22565.726, "default": {"entropy": 1.7853856086730957, "kl": 0.01581057906150818, "cur_lr": 0.0005000000237487257, "policy_loss": -0.017025841400027275, "vf_loss": 39.60464859008789, "total_loss": 39.59562683105469, "vf_explained_var": 0.7030555009841919, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 16363333, "num_steps_trained": 16363333, "load_time_ms": 17.837, "update_time_ms": 11.5, "sample_time_ms": 15428.226}, "episode_reward_max": 1144.0336812569253, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 27.22373328673515, "episodes_total": 8438, "episodes_this_iter": 70, "time_total_s": 5815.465662956238, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104869, "timestamp": 1556533109, "episode_len_mean": 693.21, "timesteps_since_restore": 16468202, "time_since_restore": 5853.490504741669, "done": false, "custom_metrics": {"outflow_rate_min": 472.99230095463946, "outflow_rate_mean": 933.142256317455, "cost2_mean": -66.06931673073468, "outflow_rate_max": 1144.4439234443516, "system_level_velocity_mean": 14.938402397877852, "system_level_velocity_min": 10.57281225365397, "cost2_max": -14.372643469415234, "cost2_min": -156.31929366577157, "cost1_min": 13.599596398644813, "cost1_max": 452.71486585449384, "cost1_mean": 380.46772740775, "system_level_velocity_max": 17.61076677581246}, "timesteps_total": 16468202, "training_iteration": 146, "date": "2019-04-29_10-18-29", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d549b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54c50>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 146, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 952.0707791861998, "time_this_iter_s": 38.02484178543091, "info": {"grad_time_ms": 22521.26, "default": {"entropy": 1.7813454866409302, "kl": 0.015829656273126602, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01662413775920868, "vf_loss": 36.990501403808594, "total_loss": 36.98189163208008, "vf_explained_var": 0.7400230169296265, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 16468202, "num_steps_trained": 16468202, "load_time_ms": 17.93, "update_time_ms": 11.235, "sample_time_ms": 15516.135}, "episode_reward_max": 1217.6691689606853, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 27.22373328673515, "episodes_total": 8500, "episodes_this_iter": 62, "time_total_s": 5853.490504741669, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103686, "timestamp": 1556533147, "episode_len_mean": 686.69, "timesteps_since_restore": 16571888, "time_since_restore": 5891.307840824127, "done": false, "custom_metrics": {"outflow_rate_min": 460.89891816854913, "outflow_rate_mean": 941.7000302860542, "cost2_mean": -68.80735574266683, "outflow_rate_max": 1106.0563951990089, "system_level_velocity_mean": 15.092222228181392, "system_level_velocity_min": 8.661588527625144, "cost2_max": -20.36550081813987, "cost2_min": -157.4183307245712, "cost1_min": 18.811251665776187, "cost1_max": 451.29973468723557, "cost1_mean": 379.1948502266805, "system_level_velocity_max": 18.89970673011559}, "timesteps_total": 16571888, "training_iteration": 147, "date": "2019-04-29_10-19-07", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dfd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5df28>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dcf8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 147, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 961.7416442085961, "time_this_iter_s": 37.817336082458496, "info": {"grad_time_ms": 22427.628, "default": {"entropy": 1.8012804985046387, "kl": 0.015191871672868729, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01667996309697628, "vf_loss": 46.57795715332031, "total_loss": 46.568965911865234, "vf_explained_var": 0.6016157269477844, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 16571888, "num_steps_trained": 16571888, "load_time_ms": 17.687, "update_time_ms": 11.234, "sample_time_ms": 15508.269}, "episode_reward_max": 1196.4892691672005, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 41.50301995935028, "episodes_total": 8572, "episodes_this_iter": 72, "time_total_s": 5891.307840824127, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105015, "timestamp": 1556533187, "episode_len_mean": 673.82, "timesteps_since_restore": 16676903, "time_since_restore": 5930.888607740402, "done": false, "custom_metrics": {"outflow_rate_min": 460.89891816854913, "outflow_rate_mean": 920.146099899959, "cost2_mean": -66.9444683636605, "outflow_rate_max": 1120.065288176217, "system_level_velocity_mean": 14.94780790733465, "system_level_velocity_min": 8.637245099688048, "cost2_max": -17.732922070495956, "cost2_min": -157.4183307245712, "cost1_min": 17.38812177698274, "cost1_max": 451.29973468723557, "cost1_mean": 367.780404356696, "system_level_velocity_max": 18.95148683702315}, "timesteps_total": 16676903, "training_iteration": 148, "date": "2019-04-29_10-19-47", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54dd8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d547f0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 148, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 926.5638131702634, "time_this_iter_s": 39.580766916275024, "info": {"grad_time_ms": 22623.951, "default": {"entropy": 1.8280287981033325, "kl": 0.015539373271167278, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016340721398591995, "vf_loss": 43.49630355834961, "total_loss": 43.48782730102539, "vf_explained_var": 0.7048168778419495, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 16676903, "num_steps_trained": 16676903, "load_time_ms": 17.057, "update_time_ms": 11.621, "sample_time_ms": 15428.904}, "episode_reward_max": 1225.7183563605288, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 40.618112459471966, "episodes_total": 8644, "episodes_this_iter": 72, "time_total_s": 5930.888607740402, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104883, "timestamp": 1556533226, "episode_len_mean": 683.84, "timesteps_since_restore": 16781786, "time_since_restore": 5970.167728900909, "done": false, "custom_metrics": {"outflow_rate_min": 500.7637464254948, "outflow_rate_mean": 922.332305799632, "cost2_mean": -66.47014815064104, "outflow_rate_max": 1219.1396487514744, "system_level_velocity_mean": 14.942285784301323, "system_level_velocity_min": 8.637245099688048, "cost2_max": -18.01177103448815, "cost2_min": -144.8712749560242, "cost1_min": 19.3596581797926, "cost1_max": 456.53128306418705, "cost1_mean": 373.7819199949552, "system_level_velocity_max": 18.95148683702315}, "timesteps_total": 16781786, "training_iteration": 149, "date": "2019-04-29_10-20-26", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dcf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5de10>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5df28>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 149, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 932.5921885173276, "time_this_iter_s": 39.2791211605072, "info": {"grad_time_ms": 22846.88, "default": {"entropy": 1.8272167444229126, "kl": 0.0174636859446764, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01602247543632984, "vf_loss": 38.73039627075195, "total_loss": 38.72321319580078, "vf_explained_var": 0.7236693501472473, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 16781786, "num_steps_trained": 16781786, "load_time_ms": 18.923, "update_time_ms": 11.544, "sample_time_ms": 15486.619}, "episode_reward_max": 1225.7183563605288, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 40.78397903493111, "episodes_total": 8710, "episodes_this_iter": 66, "time_total_s": 5970.167728900909, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105601, "timestamp": 1556533264, "episode_len_mean": 689.89, "timesteps_since_restore": 16887387, "time_since_restore": 6008.17928647995, "done": false, "custom_metrics": {"outflow_rate_min": 506.29760091375095, "outflow_rate_mean": 936.2343788198892, "cost2_mean": -66.42070376756662, "outflow_rate_max": 1219.1396487514744, "system_level_velocity_mean": 15.040790180251802, "system_level_velocity_min": 9.058557144147604, "cost2_max": -18.718011312872278, "cost2_min": -152.9716380977566, "cost1_min": 20.45965480611512, "cost1_max": 462.8697903594732, "cost1_mean": 380.0907995269626, "system_level_velocity_max": 19.257156679196516}, "timesteps_total": 16887387, "training_iteration": 150, "date": "2019-04-29_10-21-04", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8da0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8390>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 150, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 945.4593639195707, "time_this_iter_s": 38.01155757904053, "info": {"grad_time_ms": 22528.808, "default": {"entropy": 1.8297922611236572, "kl": 0.014876602217555046, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016069792211055756, "vf_loss": 42.422176361083984, "total_loss": 42.41363525390625, "vf_explained_var": 0.689030110836029, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 16887387, "num_steps_trained": 16887387, "load_time_ms": 18.848, "update_time_ms": 11.578, "sample_time_ms": 15447.587}, "episode_reward_max": 1211.7497274689104, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 42.66034535749036, "episodes_total": 8780, "episodes_this_iter": 70, "time_total_s": 6008.17928647995, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103820, "timestamp": 1556533302, "episode_len_mean": 693.48, "timesteps_since_restore": 16991207, "time_since_restore": 6046.055107355118, "done": false, "custom_metrics": {"outflow_rate_min": 508.18562995565054, "outflow_rate_mean": 928.8973504971276, "cost2_mean": -66.40157592061384, "outflow_rate_max": 1121.5415614902, "system_level_velocity_mean": 14.85962960660681, "system_level_velocity_min": 9.60758908242699, "cost2_max": -28.308980518260828, "cost2_min": -152.9716380977566, "cost1_min": 31.454067758687263, "cost1_max": 453.4001868398012, "cost1_mean": 378.27984302894964, "system_level_velocity_max": 18.26424963544371}, "timesteps_total": 16991207, "training_iteration": 151, "date": "2019-04-29_10-21-42", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d540f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d546d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54550>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 151, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 948.207829268118, "time_this_iter_s": 37.87582087516785, "info": {"grad_time_ms": 22392.649, "default": {"entropy": 1.8452978134155273, "kl": 0.015486342832446098, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016886325553059578, "vf_loss": 39.84930419921875, "total_loss": 39.84025192260742, "vf_explained_var": 0.689572274684906, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 16991207, "num_steps_trained": 16991207, "load_time_ms": 18.843, "update_time_ms": 11.703, "sample_time_ms": 15475.318}, "episode_reward_max": 1236.5958155265014, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 75.1081177813523, "episodes_total": 8848, "episodes_this_iter": 68, "time_total_s": 6046.055107355118, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104859, "timestamp": 1556533343, "episode_len_mean": 686.67, "timesteps_since_restore": 17096066, "time_since_restore": 6086.807908535004, "done": false, "custom_metrics": {"outflow_rate_min": 459.24275550364274, "outflow_rate_mean": 900.357198516484, "cost2_mean": -61.65039050743183, "outflow_rate_max": 1094.826897951549, "system_level_velocity_mean": 14.937350609907876, "system_level_velocity_min": 7.6694895795510405, "cost2_max": -14.063090785472575, "cost2_min": -130.2815198337706, "cost1_min": 12.324054201897585, "cost1_max": 451.2511071190221, "cost1_mean": 375.22769651252594, "system_level_velocity_max": 18.26424963544371}, "timesteps_total": 17096066, "training_iteration": 152, "date": "2019-04-29_10-22-23", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5ddd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d160>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d7f0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 152, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 914.4240043968878, "time_this_iter_s": 40.752801179885864, "info": {"grad_time_ms": 22596.907, "default": {"entropy": 1.867175817489624, "kl": 0.015126839280128479, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015164399519562721, "vf_loss": 44.8245849609375, "total_loss": 44.81707763671875, "vf_explained_var": 0.6319913268089294, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 17096066, "num_steps_trained": 17096066, "load_time_ms": 19.876, "update_time_ms": 11.602, "sample_time_ms": 15718.866}, "episode_reward_max": 1241.3452512179724, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 24.373201934534613, "episodes_total": 8921, "episodes_this_iter": 73, "time_total_s": 6086.807908535004, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104301, "timestamp": 1556533382, "episode_len_mean": 683.43, "timesteps_since_restore": 17200367, "time_since_restore": 6125.925963163376, "done": false, "custom_metrics": {"outflow_rate_min": 459.24275550364274, "outflow_rate_mean": 900.6737889092084, "cost2_mean": -62.23423678654663, "outflow_rate_max": 1127.0036656280001, "system_level_velocity_mean": 14.809330944938997, "system_level_velocity_min": 9.428939458020263, "cost2_max": -14.063090785472575, "cost2_min": -130.2815198337706, "cost1_min": 12.324054201897585, "cost1_max": 448.196534751279, "cost1_mean": 369.4201556342018, "system_level_velocity_max": 18.01305486724323}, "timesteps_total": 17200367, "training_iteration": 153, "date": "2019-04-29_10-23-02", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b82e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8a20>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 153, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 895.3511375457218, "time_this_iter_s": 39.11805462837219, "info": {"grad_time_ms": 22759.433, "default": {"entropy": 1.8798909187316895, "kl": 0.015687592327594757, "cur_lr": 0.0005000000237487257, "policy_loss": -0.018112828955054283, "vf_loss": 40.921722412109375, "total_loss": 40.911556243896484, "vf_explained_var": 0.70208740234375, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 17200367, "num_steps_trained": 17200367, "load_time_ms": 20.952, "update_time_ms": 11.786, "sample_time_ms": 15705.45}, "episode_reward_max": 1146.3025451767041, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 24.373201934534613, "episodes_total": 8991, "episodes_this_iter": 70, "time_total_s": 6125.925963163376, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105931, "timestamp": 1556533421, "episode_len_mean": 674.14, "timesteps_since_restore": 17306298, "time_since_restore": 6164.870278596878, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 917.2690150482657, "cost2_mean": -60.77612406321097, "outflow_rate_max": 1172.8834144805242, "system_level_velocity_mean": 15.279627106214104, "system_level_velocity_min": 10.996713166777615, "cost2_max": -12.903315794266028, "cost2_min": -124.11868554292691, "cost1_min": 11.831286814670563, "cost1_max": 457.83714671571033, "cost1_mean": 374.30688373894844, "system_level_velocity_max": 18.928366841319864}, "timesteps_total": 17306298, "training_iteration": 154, "date": "2019-04-29_10-23-41", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d8d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5ddd8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d668>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 154, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 903.8276892603851, "time_this_iter_s": 38.9443154335022, "info": {"grad_time_ms": 22756.42, "default": {"entropy": 1.821407437324524, "kl": 0.015442588366568089, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01547279767692089, "vf_loss": 40.338558197021484, "total_loss": 40.330902099609375, "vf_explained_var": 0.7261546850204468, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 17306298, "num_steps_trained": 17306298, "load_time_ms": 20.534, "update_time_ms": 11.75, "sample_time_ms": 15742.542}, "episode_reward_max": 1231.7294466554163, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 31.90509175779773, "episodes_total": 9060, "episodes_this_iter": 69, "time_total_s": 6164.870278596878, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103518, "timestamp": 1556533458, "episode_len_mean": 686.58, "timesteps_since_restore": 17409816, "time_since_restore": 6202.019632577896, "done": false, "custom_metrics": {"outflow_rate_min": 469.4677556459584, "outflow_rate_mean": 915.6376147248264, "cost2_mean": -63.57755507862835, "outflow_rate_max": 1113.4426547702178, "system_level_velocity_mean": 15.085449644837238, "system_level_velocity_min": 8.17767075964872, "cost2_max": -14.576799034749513, "cost2_min": -164.24410887604915, "cost1_min": 18.94608510888713, "cost1_max": 445.3008758721015, "cost1_mean": 377.52083838257414, "system_level_velocity_max": 18.485627436819307}, "timesteps_total": 17409816, "training_iteration": 155, "date": "2019-04-29_10-24-18", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54c50>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54d30>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 155, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 928.7872156680692, "time_this_iter_s": 37.149353981018066, "info": {"grad_time_ms": 22752.624, "default": {"entropy": 1.7966680526733398, "kl": 0.016024688258767128, "cur_lr": 0.0005000000237487257, "policy_loss": -0.017109163105487823, "vf_loss": 41.794891357421875, "total_loss": 41.78589630126953, "vf_explained_var": 0.7082099318504333, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 17409816, "num_steps_trained": 17409816, "load_time_ms": 20.06, "update_time_ms": 11.531, "sample_time_ms": 15650.972}, "episode_reward_max": 1219.348328386574, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 49.168303291573444, "episodes_total": 9131, "episodes_this_iter": 71, "time_total_s": 6202.019632577896, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104948, "timestamp": 1556533498, "episode_len_mean": 690.46, "timesteps_since_restore": 17514764, "time_since_restore": 6241.464216470718, "done": false, "custom_metrics": {"outflow_rate_min": 532.0234920678538, "outflow_rate_mean": 919.0457504435587, "cost2_mean": -62.9241534629502, "outflow_rate_max": 1221.5029385637542, "system_level_velocity_mean": 15.259122722868696, "system_level_velocity_min": 11.029829800335593, "cost2_max": -22.817551651716148, "cost2_min": -149.0007333967775, "cost1_min": 32.65427259119597, "cost1_max": 456.4559261863543, "cost1_mean": 384.3345704453413, "system_level_velocity_max": 18.86214016085878}, "timesteps_total": 17514764, "training_iteration": 156, "date": "2019-04-29_10-24-58", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d8d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5da58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d470>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 156, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 923.4992606480517, "time_this_iter_s": 39.444583892822266, "info": {"grad_time_ms": 22911.081, "default": {"entropy": 1.8693031072616577, "kl": 0.01543617807328701, "cur_lr": 0.0005000000237487257, "policy_loss": -0.017211340367794037, "vf_loss": 39.35371780395508, "total_loss": 39.34431838989258, "vf_explained_var": 0.709419846534729, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 17514764, "num_steps_trained": 17514764, "load_time_ms": 20.982, "update_time_ms": 11.631, "sample_time_ms": 15635.269}, "episode_reward_max": 1173.4711499958833, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 74.29036468708047, "episodes_total": 9202, "episodes_this_iter": 71, "time_total_s": 6241.464216470718, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104229, "timestamp": 1556533537, "episode_len_mean": 670.67, "timesteps_since_restore": 17618993, "time_since_restore": 6280.414616107941, "done": false, "custom_metrics": {"outflow_rate_min": 459.36032418334645, "outflow_rate_mean": 890.7966517632564, "cost2_mean": -61.79689316434713, "outflow_rate_max": 1115.2423687997891, "system_level_velocity_mean": 15.114173698854149, "system_level_velocity_min": 9.824335837422531, "cost2_max": -13.999192648206002, "cost2_min": -152.03198845622452, "cost1_min": 11.742529127734436, "cost1_max": 459.63711959299354, "cost1_mean": 367.66861633384394, "system_level_velocity_max": 18.857073068485292}, "timesteps_total": 17618993, "training_iteration": 157, "date": "2019-04-29_10-25-37", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d6d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d5f8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dd68>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 157, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 884.1336456663204, "time_this_iter_s": 38.95039963722229, "info": {"grad_time_ms": 23065.841, "default": {"entropy": 1.8502854108810425, "kl": 0.0156354159116745, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01648961380124092, "vf_loss": 46.034610748291016, "total_loss": 46.02603530883789, "vf_explained_var": 0.6153967380523682, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 17618993, "num_steps_trained": 17618993, "load_time_ms": 21.38, "update_time_ms": 12.006, "sample_time_ms": 15593.411}, "episode_reward_max": 1187.2267031020808, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 24.570184867728184, "episodes_total": 9277, "episodes_this_iter": 75, "time_total_s": 6280.414616107941, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 105124, "timestamp": 1556533577, "episode_len_mean": 680.36, "timesteps_since_restore": 17724117, "time_since_restore": 6320.414281129837, "done": false, "custom_metrics": {"outflow_rate_min": 476.3643579359026, "outflow_rate_mean": 906.1233704343779, "cost2_mean": -65.17432722984944, "outflow_rate_max": 1095.751198966581, "system_level_velocity_mean": 15.108401054470617, "system_level_velocity_min": 9.827912688072045, "cost2_max": -18.118472307211505, "cost2_min": -143.64399241256496, "cost1_min": 22.45005680009761, "cost1_max": 446.62652873263875, "cost1_mean": 373.8497046331438, "system_level_velocity_max": 18.857073068485292}, "timesteps_total": 17724117, "training_iteration": 158, "date": "2019-04-29_10-26-17", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d7f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5de80>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dcf8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 158, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 904.659664573379, "time_this_iter_s": 39.99966502189636, "info": {"grad_time_ms": 23008.52, "default": {"entropy": 1.8464184999465942, "kl": 0.01467631384730339, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015580006875097752, "vf_loss": 43.590755462646484, "total_loss": 43.58260726928711, "vf_explained_var": 0.6415492296218872, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 17724117, "num_steps_trained": 17724117, "load_time_ms": 22.727, "update_time_ms": 11.511, "sample_time_ms": 15690.786}, "episode_reward_max": 1169.50391204703, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 54.18039883459437, "episodes_total": 9349, "episodes_this_iter": 72, "time_total_s": 6320.414281129837, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103556, "timestamp": 1556533616, "episode_len_mean": 686.88, "timesteps_since_restore": 17827673, "time_since_restore": 6359.0602169036865, "done": false, "custom_metrics": {"outflow_rate_min": 484.2550982048718, "outflow_rate_mean": 919.7367956711241, "cost2_mean": -66.21218351274925, "outflow_rate_max": 1126.7646617945777, "system_level_velocity_mean": 15.21153448465388, "system_level_velocity_min": 10.254036749908446, "cost2_max": -16.84308592487438, "cost2_min": -143.64399241256496, "cost1_min": 16.070170355991795, "cost1_max": 459.0196837299661, "cost1_mean": 382.08002913233986, "system_level_velocity_max": 18.071381483741714}, "timesteps_total": 17827673, "training_iteration": 159, "date": "2019-04-29_10-26-56", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5da20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dd68>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d6a0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 159, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 933.4461931989758, "time_this_iter_s": 38.64593577384949, "info": {"grad_time_ms": 23010.347, "default": {"entropy": 1.8601422309875488, "kl": 0.015651455149054527, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015694621950387955, "vf_loss": 44.6263427734375, "total_loss": 44.618568420410156, "vf_explained_var": 0.6497205495834351, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 17827673, "num_steps_trained": 17827673, "load_time_ms": 21.721, "update_time_ms": 11.738, "sample_time_ms": 15625.591}, "episode_reward_max": 1248.9956300294423, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 36.62034755078154, "episodes_total": 9418, "episodes_this_iter": 69, "time_total_s": 6359.0602169036865, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103871, "timestamp": 1556533654, "episode_len_mean": 693.38, "timesteps_since_restore": 17931544, "time_since_restore": 6397.485254049301, "done": false, "custom_metrics": {"outflow_rate_min": 520.6489906177208, "outflow_rate_mean": 923.3059430103723, "cost2_mean": -66.97629132116082, "outflow_rate_max": 1126.7646617945777, "system_level_velocity_mean": 15.245200434508295, "system_level_velocity_min": 9.837344142441143, "cost2_max": -19.331957894366422, "cost2_min": -140.27195737493253, "cost1_min": 25.222588204915226, "cost1_max": 459.0196837299661, "cost1_mean": 385.61087971921705, "system_level_velocity_max": 18.146707133327283}, "timesteps_total": 17931544, "training_iteration": 160, "date": "2019-04-29_10-27-34", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5da90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d048>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d5c0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 160, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 937.5851792197341, "time_this_iter_s": 38.425037145614624, "info": {"grad_time_ms": 23150.54, "default": {"entropy": 1.8742576837539673, "kl": 0.01671416126191616, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01707647182047367, "vf_loss": 41.69833755493164, "total_loss": 41.68972396850586, "vf_explained_var": 0.7206609845161438, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 17931544, "num_steps_trained": 17931544, "load_time_ms": 20.926, "update_time_ms": 11.734, "sample_time_ms": 15527.998}, "episode_reward_max": 1248.9956300294423, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 55.21120950968084, "episodes_total": 9488, "episodes_this_iter": 70, "time_total_s": 6397.485254049301, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103077, "timestamp": 1556533691, "episode_len_mean": 693.38, "timesteps_since_restore": 18034621, "time_since_restore": 6434.469731330872, "done": false, "custom_metrics": {"outflow_rate_min": 520.6489906177208, "outflow_rate_mean": 914.4372378761591, "cost2_mean": -63.07940371879326, "outflow_rate_max": 1111.1104552498682, "system_level_velocity_mean": 15.227757778542975, "system_level_velocity_min": 8.53615033148088, "cost2_max": -19.331957894366422, "cost2_min": -156.43283802869797, "cost1_min": 25.222588204915226, "cost1_max": 455.83597371623966, "cost1_mean": 384.592559680008, "system_level_velocity_max": 18.243361839475213}, "timesteps_total": 18034621, "training_iteration": 161, "date": "2019-04-29_10-28-11", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54cf8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54be0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 161, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 920.3372339961458, "time_this_iter_s": 36.984477281570435, "info": {"grad_time_ms": 23085.518, "default": {"entropy": 1.8768746852874756, "kl": 0.015574402175843716, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016112472862005234, "vf_loss": 45.403507232666016, "total_loss": 45.39527893066406, "vf_explained_var": 0.6241550445556641, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 18034621, "num_steps_trained": 18034621, "load_time_ms": 21.185, "update_time_ms": 11.491, "sample_time_ms": 15503.13}, "episode_reward_max": 1148.2590468178166, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 55.21120950968084, "episodes_total": 9558, "episodes_this_iter": 70, "time_total_s": 6434.469731330872, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104425, "timestamp": 1556533729, "episode_len_mean": 674.42, "timesteps_since_restore": 18139046, "time_since_restore": 6471.963302373886, "done": false, "custom_metrics": {"outflow_rate_min": 458.139626931503, "outflow_rate_mean": 905.8963605056114, "cost2_mean": -61.442433421386504, "outflow_rate_max": 1080.386212639599, "system_level_velocity_mean": 15.453063797237876, "system_level_velocity_min": 9.294691045752526, "cost2_max": -12.482001092185515, "cost2_min": -156.43283802869797, "cost1_min": 11.788653628104608, "cost1_max": 455.83597371623966, "cost1_mean": 377.91387239337996, "system_level_velocity_max": 18.243361839475213}, "timesteps_total": 18139046, "training_iteration": 162, "date": "2019-04-29_10-28-49", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5da58>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 162, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 912.4399901983063, "time_this_iter_s": 37.493571043014526, "info": {"grad_time_ms": 22926.897, "default": {"entropy": 1.8457581996917725, "kl": 0.015541477128863335, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016336429864168167, "vf_loss": 48.5244255065918, "total_loss": 48.515960693359375, "vf_explained_var": 0.6196913123130798, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 18139046, "num_steps_trained": 18139046, "load_time_ms": 20.166, "update_time_ms": 11.713, "sample_time_ms": 15337.143}, "episode_reward_max": 1191.4393543810859, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 30.917463372608406, "episodes_total": 9632, "episodes_this_iter": 74, "time_total_s": 6471.963302373886, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103993, "timestamp": 1556533767, "episode_len_mean": 694.81, "timesteps_since_restore": 18243039, "time_since_restore": 6510.328962564468, "done": false, "custom_metrics": {"outflow_rate_min": 734.9033386032486, "outflow_rate_mean": 921.1369445175619, "cost2_mean": -64.90095765131922, "outflow_rate_max": 1071.0918993969606, "system_level_velocity_mean": 15.144787014626196, "system_level_velocity_min": 9.851680322319865, "cost2_max": -31.701681889137344, "cost2_min": -151.09906985712783, "cost1_min": 118.32940757696988, "cost1_max": 453.37894206103556, "cost1_mean": 383.78789746312754, "system_level_velocity_max": 18.036225702408895}, "timesteps_total": 18243039, "training_iteration": 163, "date": "2019-04-29_10-29-27", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d0b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d208>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 163, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 926.7913057837683, "time_this_iter_s": 38.365660190582275, "info": {"grad_time_ms": 22898.31, "default": {"entropy": 1.9032117128372192, "kl": 0.014788603410124779, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01655270718038082, "vf_loss": 43.086448669433594, "total_loss": 43.07738494873047, "vf_explained_var": 0.6807383298873901, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 18243039, "num_steps_trained": 18243039, "load_time_ms": 20.352, "update_time_ms": 11.671, "sample_time_ms": 15289.774}, "episode_reward_max": 1195.5549123765925, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 276.9730537234506, "episodes_total": 9703, "episodes_this_iter": 71, "time_total_s": 6510.328962564468, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102985, "timestamp": 1556533807, "episode_len_mean": 681.97, "timesteps_since_restore": 18346024, "time_since_restore": 6550.323990821838, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 890.3706140095425, "cost2_mean": -59.468250032713094, "outflow_rate_max": 1073.3354321661168, "system_level_velocity_mean": 15.11501295134012, "system_level_velocity_min": 9.083854614729217, "cost2_max": -12.982520535716523, "cost2_min": -118.32572965343634, "cost1_min": 11.642728038022293, "cost1_max": 454.276041044986, "cost1_mean": 374.58908479688466, "system_level_velocity_max": 19.061493531105995}, "timesteps_total": 18346024, "training_iteration": 164, "date": "2019-04-29_10-30-07", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dc88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5da90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d898>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 164, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 885.1338981658314, "time_this_iter_s": 39.995028257369995, "info": {"grad_time_ms": 23002.147, "default": {"entropy": 1.9087445735931396, "kl": 0.015195352025330067, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016164129599928856, "vf_loss": 43.922874450683594, "total_loss": 43.91440200805664, "vf_explained_var": 0.6126541495323181, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 18346024, "num_steps_trained": 18346024, "load_time_ms": 20.73, "update_time_ms": 11.658, "sample_time_ms": 15293.106}, "episode_reward_max": 1148.4325746024497, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 28.614780338086874, "episodes_total": 9775, "episodes_this_iter": 72, "time_total_s": 6550.323990821838, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103621, "timestamp": 1556533845, "episode_len_mean": 683.21, "timesteps_since_restore": 18449645, "time_since_restore": 6588.365393400192, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 899.4258285813299, "cost2_mean": -59.37865586851497, "outflow_rate_max": 1133.15847683175, "system_level_velocity_mean": 15.26845402885898, "system_level_velocity_min": 9.083854614729217, "cost2_max": -12.982520535716523, "cost2_min": -125.27765066291539, "cost1_min": 11.642728038022293, "cost1_max": 458.3408927547499, "cost1_mean": 380.604939276671, "system_level_velocity_max": 19.061493531105995}, "timesteps_total": 18449645, "training_iteration": 165, "date": "2019-04-29_10-30-45", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d49c50>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8a20>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 165, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 900.6823593374132, "time_this_iter_s": 38.04140257835388, "info": {"grad_time_ms": 23066.926, "default": {"entropy": 1.9381434917449951, "kl": 0.014556747861206532, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016319183632731438, "vf_loss": 39.163394927978516, "total_loss": 39.15444564819336, "vf_explained_var": 0.6806580424308777, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 18449645, "num_steps_trained": 18449645, "load_time_ms": 20.496, "update_time_ms": 11.638, "sample_time_ms": 15318.84}, "episode_reward_max": 1282.9332914175168, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 28.614780338086874, "episodes_total": 9841, "episodes_this_iter": 66, "time_total_s": 6588.365393400192, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103185, "timestamp": 1556533883, "episode_len_mean": 694.93, "timesteps_since_restore": 18552830, "time_since_restore": 6625.5152933597565, "done": false, "custom_metrics": {"outflow_rate_min": 697.5821361340754, "outflow_rate_mean": 901.2164997371552, "cost2_mean": -62.04035049806188, "outflow_rate_max": 1125.4467388580422, "system_level_velocity_mean": 15.008378318369209, "system_level_velocity_min": 10.727447893743904, "cost2_max": -29.340176293961704, "cost2_min": -152.8407676288612, "cost1_min": 195.48227500137932, "cost1_max": 447.6683420723237, "cost1_mean": 382.13003889728856, "system_level_velocity_max": 17.899859057263736}, "timesteps_total": 18552830, "training_iteration": 166, "date": "2019-04-29_10-31-23", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d6d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d668>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 166, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 906.1436968075183, "time_this_iter_s": 37.14989995956421, "info": {"grad_time_ms": 22764.001, "default": {"entropy": 1.903866171836853, "kl": 0.015666356310248375, "cur_lr": 0.0005000000237487257, "policy_loss": -0.017225319519639015, "vf_loss": 49.02621078491211, "total_loss": 49.01691436767578, "vf_explained_var": 0.6412018537521362, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 18552830, "num_steps_trained": 18552830, "load_time_ms": 19.59, "update_time_ms": 11.849, "sample_time_ms": 15392.129}, "episode_reward_max": 1282.9332914175168, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 451.74262189217444, "episodes_total": 9919, "episodes_this_iter": 78, "time_total_s": 6625.5152933597565, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104396, "timestamp": 1556533921, "episode_len_mean": 700.0, "timesteps_since_restore": 18657226, "time_since_restore": 6663.544922828674, "done": false, "custom_metrics": {"outflow_rate_min": 730.0849213660115, "outflow_rate_mean": 908.4054489729069, "cost2_mean": -58.44081187874511, "outflow_rate_max": 1125.4467388580422, "system_level_velocity_mean": 15.400036019162247, "system_level_velocity_min": 11.072590270539642, "cost2_max": -26.78032666239937, "cost2_min": -140.50230405340585, "cost1_min": 288.61273140060337, "cost1_max": 458.41660321486575, "cost1_mean": 393.79131831350634, "system_level_velocity_max": 18.207288916049993}, "timesteps_total": 18657226, "training_iteration": 167, "date": "2019-04-29_10-32-01", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5de10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d540f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d470>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 167, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 908.2551439952354, "time_this_iter_s": 38.02962946891785, "info": {"grad_time_ms": 22638.847, "default": {"entropy": 1.9572185277938843, "kl": 0.014820546843111515, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01659754477441311, "vf_loss": 45.77685546875, "total_loss": 45.76776123046875, "vf_explained_var": 0.6879619359970093, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 18657226, "num_steps_trained": 18657226, "load_time_ms": 19.174, "update_time_ms": 11.632, "sample_time_ms": 15426.099}, "episode_reward_max": 1260.559374265895, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 636.9387944957538, "episodes_total": 9996, "episodes_this_iter": 77, "time_total_s": 6663.544922828674, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103646, "timestamp": 1556533959, "episode_len_mean": 693.39, "timesteps_since_restore": 18760872, "time_since_restore": 6701.429899454117, "done": false, "custom_metrics": {"outflow_rate_min": 517.4496275935827, "outflow_rate_mean": 878.5519146361272, "cost2_mean": -62.59302202920288, "outflow_rate_max": 1121.1703451950257, "system_level_velocity_mean": 14.938591810830582, "system_level_velocity_min": 9.833281581182968, "cost2_max": -21.906526484461565, "cost2_min": -178.88351009617256, "cost1_min": 26.413419465650488, "cost1_max": 457.539895492299, "cost1_mean": 376.7138226630696, "system_level_velocity_max": 18.39951375437109}, "timesteps_total": 18760872, "training_iteration": 168, "date": "2019-04-29_10-32-39", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d6d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d668>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 168, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 874.110439043454, "time_this_iter_s": 37.884976625442505, "info": {"grad_time_ms": 22545.178, "default": {"entropy": 1.9713658094406128, "kl": 0.015139463357627392, "cur_lr": 0.0005000000237487257, "policy_loss": -0.017525218427181244, "vf_loss": 39.1787109375, "total_loss": 39.168853759765625, "vf_explained_var": 0.770134687423706, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 18760872, "num_steps_trained": 18760872, "load_time_ms": 17.931, "update_time_ms": 11.608, "sample_time_ms": 15310.494}, "episode_reward_max": 1175.4457134238794, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 57.15731195917126, "episodes_total": 10063, "episodes_this_iter": 67, "time_total_s": 6701.429899454117, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104582, "timestamp": 1556533996, "episode_len_mean": 693.48, "timesteps_since_restore": 18865454, "time_since_restore": 6738.666229963303, "done": false, "custom_metrics": {"outflow_rate_min": 498.9136151198048, "outflow_rate_mean": 876.1521200636745, "cost2_mean": -58.88520703172962, "outflow_rate_max": 1132.7509085667114, "system_level_velocity_mean": 14.967666451495791, "system_level_velocity_min": 10.2574100347916, "cost2_max": -24.26107276493804, "cost2_min": -128.68324758476354, "cost1_min": 32.06816256797137, "cost1_max": 444.2594184151937, "cost1_mean": 377.2817952307843, "system_level_velocity_max": 18.603566540737212}, "timesteps_total": 18865454, "training_iteration": 169, "date": "2019-04-29_10-33-16", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d545c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d542e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54438>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 169, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 873.5562184487105, "time_this_iter_s": 37.23633050918579, "info": {"grad_time_ms": 22451.571, "default": {"entropy": 1.9547524452209473, "kl": 0.014536356553435326, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016494881361722946, "vf_loss": 40.05997085571289, "total_loss": 40.05083465576172, "vf_explained_var": 0.7330758571624756, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 18865454, "num_steps_trained": 18865454, "load_time_ms": 18.862, "update_time_ms": 11.459, "sample_time_ms": 15262.245}, "episode_reward_max": 1099.9584568209118, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 75.6389259491309, "episodes_total": 10130, "episodes_this_iter": 67, "time_total_s": 6738.666229963303, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104129, "timestamp": 1556534032, "episode_len_mean": 686.71, "timesteps_since_restore": 18969583, "time_since_restore": 6774.670176744461, "done": false, "custom_metrics": {"outflow_rate_min": 478.74083587680656, "outflow_rate_mean": 865.9281247665464, "cost2_mean": -58.07610453102293, "outflow_rate_max": 1039.6445235402387, "system_level_velocity_mean": 15.092396336698643, "system_level_velocity_min": 8.668801304516938, "cost2_max": -16.46151463757096, "cost2_min": -119.97246445211923, "cost1_min": 15.383103263906822, "cost1_max": 446.1331793709146, "cost1_mean": 375.95243113086855, "system_level_velocity_max": 18.603566540737212}, "timesteps_total": 18969583, "training_iteration": 170, "date": "2019-04-29_10-33-52", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54dd8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54748>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 170, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 861.3562212920895, "time_this_iter_s": 36.00394678115845, "info": {"grad_time_ms": 22239.371, "default": {"entropy": 1.9790681600570679, "kl": 0.015078827738761902, "cur_lr": 0.0005000000237487257, "policy_loss": -0.014183693565428257, "vf_loss": 42.727455139160156, "total_loss": 42.72091293334961, "vf_explained_var": 0.7407493591308594, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 18969583, "num_steps_trained": 18969583, "load_time_ms": 19.894, "update_time_ms": 11.601, "sample_time_ms": 15231.453}, "episode_reward_max": 1184.6012695375025, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 35.98780663280741, "episodes_total": 10200, "episodes_this_iter": 70, "time_total_s": 6774.670176744461, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102737, "timestamp": 1556534071, "episode_len_mean": 700.0, "timesteps_since_restore": 19072320, "time_since_restore": 6813.423993349075, "done": false, "custom_metrics": {"outflow_rate_min": 664.3013397695371, "outflow_rate_mean": 890.7978290267579, "cost2_mean": -60.510956617229475, "outflow_rate_max": 1108.5686320427446, "system_level_velocity_mean": 15.184253670130131, "system_level_velocity_min": 11.74584271483997, "cost2_max": -27.605476055924644, "cost2_min": -125.2007717089835, "cost1_min": 305.6940219446678, "cost1_max": 445.1941906314852, "cost1_mean": 388.1843197099254, "system_level_velocity_max": 17.763830452993652}, "timesteps_total": 19072320, "training_iteration": 171, "date": "2019-04-29_10-34-31", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5ddd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d208>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dac8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 171, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 894.6377778838875, "time_this_iter_s": 38.75381660461426, "info": {"grad_time_ms": 22403.126, "default": {"entropy": 1.982054352760315, "kl": 0.014744504354894161, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01634003221988678, "vf_loss": 42.76323699951172, "total_loss": 42.75436019897461, "vf_explained_var": 0.6724496483802795, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 19072320, "num_steps_trained": 19072320, "load_time_ms": 19.863, "update_time_ms": 11.479, "sample_time_ms": 15244.886}, "episode_reward_max": 1241.7877006903834, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 610.4585578447675, "episodes_total": 10279, "episodes_this_iter": 79, "time_total_s": 6813.423993349075, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103593, "timestamp": 1556534111, "episode_len_mean": 691.04, "timesteps_since_restore": 19175913, "time_since_restore": 6853.780565500259, "done": false, "custom_metrics": {"outflow_rate_min": 591.3686998218246, "outflow_rate_mean": 891.4522041522407, "cost2_mean": -61.46403367874168, "outflow_rate_max": 1148.8501678858547, "system_level_velocity_mean": 14.988522052561521, "system_level_velocity_min": 10.6988355508235, "cost2_max": -31.897111074807256, "cost2_min": -125.96257211257594, "cost1_min": 132.28247433555538, "cost1_max": 442.86465803618387, "cost1_mean": 379.63502847948837, "system_level_velocity_max": 17.466788698822633}, "timesteps_total": 19175913, "training_iteration": 172, "date": "2019-04-29_10-35-11", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa187180f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54dd8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54748>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 172, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 875.7921543000078, "time_this_iter_s": 40.35657215118408, "info": {"grad_time_ms": 22690.42, "default": {"entropy": 1.9853630065917969, "kl": 0.015320634469389915, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016075374558568, "vf_loss": 44.52190017700195, "total_loss": 44.51357650756836, "vf_explained_var": 0.679480791091919, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 19175913, "num_steps_trained": 19175913, "load_time_ms": 19.7, "update_time_ms": 11.433, "sample_time_ms": 15243.855}, "episode_reward_max": 1159.6389101750622, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 268.12574029847406, "episodes_total": 10350, "episodes_this_iter": 71, "time_total_s": 6853.780565500259, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103054, "timestamp": 1556534150, "episode_len_mean": 696.78, "timesteps_since_restore": 19278967, "time_since_restore": 6892.030552625656, "done": false, "custom_metrics": {"outflow_rate_min": 701.8281608127749, "outflow_rate_mean": 896.398914444309, "cost2_mean": -61.211445459468315, "outflow_rate_max": 1087.7045031603948, "system_level_velocity_mean": 15.21868611333647, "system_level_velocity_min": 10.923492511515626, "cost2_max": -29.099019113670714, "cost2_min": -141.2352720464348, "cost1_min": 223.35204335613489, "cost1_max": 459.2044698771962, "cost1_mean": 387.7438006015963, "system_level_velocity_max": 18.442689624410217}, "timesteps_total": 19278967, "training_iteration": 173, "date": "2019-04-29_10-35-50", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d9e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5db00>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d2e8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 173, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 896.3524512408571, "time_this_iter_s": 38.24998712539673, "info": {"grad_time_ms": 22681.006, "default": {"entropy": 1.969279408454895, "kl": 0.015062573365867138, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01613718830049038, "vf_loss": 42.022396087646484, "total_loss": 42.013877868652344, "vf_explained_var": 0.6375420689582825, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 19278967, "num_steps_trained": 19278967, "load_time_ms": 18.418, "update_time_ms": 11.504, "sample_time_ms": 15244.175}, "episode_reward_max": 1134.2312409203255, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 470.5444886258238, "episodes_total": 10420, "episodes_this_iter": 70, "time_total_s": 6892.030552625656, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102478, "timestamp": 1556534186, "episode_len_mean": 696.78, "timesteps_since_restore": 19381445, "time_since_restore": 6928.213599205017, "done": false, "custom_metrics": {"outflow_rate_min": 701.8281608127749, "outflow_rate_mean": 900.2355322777323, "cost2_mean": -63.79350354915093, "outflow_rate_max": 1089.2267831918082, "system_level_velocity_mean": 15.216458604420867, "system_level_velocity_min": 10.821528783428029, "cost2_max": -31.930282806906582, "cost2_min": -155.0325516207357, "cost1_min": 223.35204335613489, "cost1_max": 447.228556450513, "cost1_mean": 387.2362769903357, "system_level_velocity_max": 17.498165481236327}, "timesteps_total": 19381445, "training_iteration": 174, "date": "2019-04-29_10-36-26", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54908>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d546a0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 174, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 909.8363444004868, "time_this_iter_s": 36.18304657936096, "info": {"grad_time_ms": 22340.422, "default": {"entropy": 1.9623477458953857, "kl": 0.015495756641030312, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015970265492796898, "vf_loss": 43.32819366455078, "total_loss": 43.320068359375, "vf_explained_var": 0.6213595867156982, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 19381445, "num_steps_trained": 19381445, "load_time_ms": 17.139, "update_time_ms": 11.407, "sample_time_ms": 15203.993}, "episode_reward_max": 1252.3919091569471, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 470.5444886258238, "episodes_total": 10493, "episodes_this_iter": 73, "time_total_s": 6928.213599205017, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103113, "timestamp": 1556534224, "episode_len_mean": 700.0, "timesteps_since_restore": 19484558, "time_since_restore": 6966.694614887238, "done": false, "custom_metrics": {"outflow_rate_min": 634.3666669827911, "outflow_rate_mean": 904.0322182651353, "cost2_mean": -59.4891298480142, "outflow_rate_max": 1097.379579773644, "system_level_velocity_mean": 15.5262500821049, "system_level_velocity_min": 10.821528783428029, "cost2_max": -25.311693031165177, "cost2_min": -153.78722533732176, "cost1_min": 283.789310639112, "cost1_max": 456.4107299966108, "cost1_mean": 397.7299567723323, "system_level_velocity_max": 18.20734236524082}, "timesteps_total": 19484558, "training_iteration": 175, "date": "2019-04-29_10-37-04", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5dcf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63048>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa187180f98>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 175, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 910.0281299333964, "time_this_iter_s": 38.48101568222046, "info": {"grad_time_ms": 22330.422, "default": {"entropy": 1.976830244064331, "kl": 0.015512765385210514, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016778836026787758, "vf_loss": 43.61412048339844, "total_loss": 43.60519790649414, "vf_explained_var": 0.628518283367157, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 19484558, "num_steps_trained": 19484558, "load_time_ms": 18.082, "update_time_ms": 11.46, "sample_time_ms": 15256.457}, "episode_reward_max": 1187.0453196051444, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 615.5205602258145, "episodes_total": 10563, "episodes_this_iter": 70, "time_total_s": 6966.694614887238, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102011, "timestamp": 1556534263, "episode_len_mean": 690.0, "timesteps_since_restore": 19586569, "time_since_restore": 7004.836630582809, "done": false, "custom_metrics": {"outflow_rate_min": 488.7008557177233, "outflow_rate_mean": 891.529184714254, "cost2_mean": -60.24216957984854, "outflow_rate_max": 1097.379579773644, "system_level_velocity_mean": 15.623625053619229, "system_level_velocity_min": 10.25609830978556, "cost2_max": -23.480599237535948, "cost2_min": -172.32522427895103, "cost1_min": 26.73604278101996, "cost1_max": 456.4107299966108, "cost1_mean": 392.0317515026647, "system_level_velocity_max": 18.768152278931314}, "timesteps_total": 19586569, "training_iteration": 176, "date": "2019-04-29_10-37-43", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d5c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d6d8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 176, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 885.2481606159995, "time_this_iter_s": 38.1420156955719, "info": {"grad_time_ms": 22503.921, "default": {"entropy": 1.973099946975708, "kl": 0.014570482075214386, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016046997159719467, "vf_loss": 43.424930572509766, "total_loss": 43.416259765625, "vf_explained_var": 0.5954598188400269, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 19586569, "num_steps_trained": 19586569, "load_time_ms": 18.991, "update_time_ms": 11.269, "sample_time_ms": 15181.914}, "episode_reward_max": 1179.2285800717923, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 60.432351321641185, "episodes_total": 10641, "episodes_this_iter": 78, "time_total_s": 7004.836630582809, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103624, "timestamp": 1556534301, "episode_len_mean": 671.62, "timesteps_since_restore": 19690193, "time_since_restore": 7043.4675080776215, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 879.4608522827058, "cost2_mean": -60.99980116027346, "outflow_rate_max": 1077.9787864832465, "system_level_velocity_mean": 15.450773620699914, "system_level_velocity_min": 9.465362884887343, "cost2_max": -12.947656265787453, "cost2_min": -172.32522427895103, "cost1_min": 11.727769480534855, "cost1_max": 447.88697085058504, "cost1_mean": 376.97174171035533, "system_level_velocity_max": 18.345049340103657}, "timesteps_total": 19690193, "training_iteration": 177, "date": "2019-04-29_10-38-21", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63c88>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63358>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 177, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 861.997634830976, "time_this_iter_s": 38.63087749481201, "info": {"grad_time_ms": 22587.379, "default": {"entropy": 1.984322190284729, "kl": 0.015553489327430725, "cur_lr": 0.0005000000237487257, "policy_loss": -0.017222005873918533, "vf_loss": 47.83942413330078, "total_loss": 47.830074310302734, "vf_explained_var": 0.5674023628234863, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 19690193, "num_steps_trained": 19690193, "load_time_ms": 19.225, "update_time_ms": 11.144, "sample_time_ms": 15158.019}, "episode_reward_max": 1179.2285800717923, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 28.74121966411444, "episodes_total": 10718, "episodes_this_iter": 77, "time_total_s": 7043.4675080776215, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102376, "timestamp": 1556534340, "episode_len_mean": 679.26, "timesteps_since_restore": 19792569, "time_since_restore": 7081.780366182327, "done": false, "custom_metrics": {"outflow_rate_min": 467.7500288525429, "outflow_rate_mean": 883.4930451327303, "cost2_mean": -63.204427135650874, "outflow_rate_max": 1090.125236463875, "system_level_velocity_mean": 15.305452219159458, "system_level_velocity_min": 10.61014119489618, "cost2_max": -12.947656265787453, "cost2_min": -162.7419668787121, "cost1_min": 12.382827513930946, "cost1_max": 456.897698474701, "cost1_mean": 377.66344930389323, "system_level_velocity_max": 18.40960378989271}, "timesteps_total": 19792569, "training_iteration": 178, "date": "2019-04-29_10-39-00", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d1d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d358>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 178, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 878.3091959161956, "time_this_iter_s": 38.31285810470581, "info": {"grad_time_ms": 22553.537, "default": {"entropy": 1.9895789623260498, "kl": 0.014685333706438541, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015358234755694866, "vf_loss": 46.438899993896484, "total_loss": 46.43097686767578, "vf_explained_var": 0.5645559430122375, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 19792569, "num_steps_trained": 19792569, "load_time_ms": 19.974, "update_time_ms": 11.256, "sample_time_ms": 15232.164}, "episode_reward_max": 1175.394424253861, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 33.81425208156092, "episodes_total": 10792, "episodes_this_iter": 74, "time_total_s": 7081.780366182327, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102293, "timestamp": 1556534378, "episode_len_mean": 674.84, "timesteps_since_restore": 19894862, "time_since_restore": 7120.0324330329895, "done": false, "custom_metrics": {"outflow_rate_min": 489.846591981012, "outflow_rate_mean": 890.6623916465952, "cost2_mean": -59.084381977218484, "outflow_rate_max": 1231.204919841912, "system_level_velocity_mean": 15.878196895598704, "system_level_velocity_min": 11.641540035965546, "cost2_max": -18.109579915771356, "cost2_min": -162.7419668787121, "cost1_min": 19.628615661465574, "cost1_max": 466.7219949425654, "cost1_mean": 386.4124436280418, "system_level_velocity_max": 19.354271567534212}, "timesteps_total": 19894862, "training_iteration": 179, "date": "2019-04-29_10-39-38", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d639b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63198>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63e48>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 179, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 854.4393912571651, "time_this_iter_s": 38.25206685066223, "info": {"grad_time_ms": 22605.993, "default": {"entropy": 2.00189471244812, "kl": 0.01568196527659893, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016865767538547516, "vf_loss": 43.85652160644531, "total_loss": 43.847591400146484, "vf_explained_var": 0.6338129639625549, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 19894862, "num_steps_trained": 19894862, "load_time_ms": 19.254, "update_time_ms": 11.227, "sample_time_ms": 15282.888}, "episode_reward_max": 1128.0884703756756, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 46.45867328309745, "episodes_total": 10869, "episodes_this_iter": 77, "time_total_s": 7120.0324330329895, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102850, "timestamp": 1556534417, "episode_len_mean": 679.1, "timesteps_since_restore": 19997712, "time_since_restore": 7159.124042749405, "done": false, "custom_metrics": {"outflow_rate_min": 495.17696866167967, "outflow_rate_mean": 907.1766389596132, "cost2_mean": -61.025894244185835, "outflow_rate_max": 1231.204919841912, "system_level_velocity_mean": 15.832581760410669, "system_level_velocity_min": 9.974756850522795, "cost2_max": -18.58877552930457, "cost2_min": -143.43996439708695, "cost1_min": 27.77475968402434, "cost1_max": 466.7219949425654, "cost1_mean": 389.2010922499225, "system_level_velocity_max": 19.226328477793146}, "timesteps_total": 19997712, "training_iteration": 180, "date": "2019-04-29_10-40-17", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d6d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d080>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 180, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 879.3285376796237, "time_this_iter_s": 39.091609716415405, "info": {"grad_time_ms": 22858.593, "default": {"entropy": 1.9724242687225342, "kl": 0.016076643019914627, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016316939145326614, "vf_loss": 46.4531135559082, "total_loss": 46.4449348449707, "vf_explained_var": 0.6144882440567017, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 19997712, "num_steps_trained": 19997712, "load_time_ms": 19.156, "update_time_ms": 11.056, "sample_time_ms": 15337.668}, "episode_reward_max": 1078.8335804715045, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 73.28234147697468, "episodes_total": 10941, "episodes_this_iter": 72, "time_total_s": 7159.124042749405, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102405, "timestamp": 1556534455, "episode_len_mean": 681.8, "timesteps_since_restore": 20100117, "time_since_restore": 7197.30441737175, "done": false, "custom_metrics": {"outflow_rate_min": 495.17696866167967, "outflow_rate_mean": 910.1679795168436, "cost2_mean": -62.71821129662668, "outflow_rate_max": 1158.7432485943684, "system_level_velocity_mean": 15.65002655101822, "system_level_velocity_min": 9.773947941997433, "cost2_max": -18.58877552930457, "cost2_min": -153.69289661450173, "cost1_min": 27.77475968402434, "cost1_max": 452.54675270370944, "cost1_mean": 387.5056794788632, "system_level_velocity_max": 19.226328477793146}, "timesteps_total": 20100117, "training_iteration": 181, "date": "2019-04-29_10-40-55", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d633c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63400>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63da0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 181, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 894.9030488632469, "time_this_iter_s": 38.18037462234497, "info": {"grad_time_ms": 22765.329, "default": {"entropy": 1.972639799118042, "kl": 0.015368299558758736, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015610132366418839, "vf_loss": 49.115360260009766, "total_loss": 49.10752868652344, "vf_explained_var": 0.6198481321334839, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 20100117, "num_steps_trained": 20100117, "load_time_ms": 18.97, "update_time_ms": 11.363, "sample_time_ms": 15371.975}, "episode_reward_max": 1189.828097809944, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 73.28234147697468, "episodes_total": 11018, "episodes_this_iter": 77, "time_total_s": 7197.30441737175, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103517, "timestamp": 1556534494, "episode_len_mean": 687.79, "timesteps_since_restore": 20203634, "time_since_restore": 7236.035679578781, "done": false, "custom_metrics": {"outflow_rate_min": 511.0817760584208, "outflow_rate_mean": 915.8658109577135, "cost2_mean": -61.86361675070466, "outflow_rate_max": 1143.522976320033, "system_level_velocity_mean": 15.688092382471185, "system_level_velocity_min": 10.471708515635955, "cost2_max": -22.41881354470268, "cost2_min": -153.69289661450173, "cost1_min": 24.850369335222787, "cost1_max": 459.43528544898567, "cost1_mean": 392.3670401108021, "system_level_velocity_max": 18.306296988061096}, "timesteps_total": 20203634, "training_iteration": 182, "date": "2019-04-29_10-41-34", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54160>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54320>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 182, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 911.3145986815002, "time_this_iter_s": 38.73126220703125, "info": {"grad_time_ms": 22583.024, "default": {"entropy": 1.9756369590759277, "kl": 0.015181255526840687, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016303664073348045, "vf_loss": 44.466819763183594, "total_loss": 44.45820236206055, "vf_explained_var": 0.6516358852386475, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 20203634, "num_steps_trained": 20203634, "load_time_ms": 20.241, "update_time_ms": 11.367, "sample_time_ms": 15387.82}, "episode_reward_max": 1189.828097809944, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 62.149652892445445, "episodes_total": 11089, "episodes_this_iter": 71, "time_total_s": 7236.035679578781, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102082, "timestamp": 1556534531, "episode_len_mean": 693.37, "timesteps_since_restore": 20305716, "time_since_restore": 7272.394460678101, "done": false, "custom_metrics": {"outflow_rate_min": 511.0817760584208, "outflow_rate_mean": 912.0511188324683, "cost2_mean": -59.34696164601627, "outflow_rate_max": 1234.4364204484345, "system_level_velocity_mean": 15.696836773199827, "system_level_velocity_min": 10.471708515635955, "cost2_max": -22.41881354470268, "cost2_min": -146.68577037561144, "cost1_min": 24.850369335222787, "cost1_max": 473.99085046094945, "cost1_mean": 396.43676366841515, "system_level_velocity_max": 18.306296988061096}, "timesteps_total": 20305716, "training_iteration": 183, "date": "2019-04-29_10-42-11", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d633c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63748>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63358>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 183, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 918.2688275178822, "time_this_iter_s": 36.35878109931946, "info": {"grad_time_ms": 22370.338, "default": {"entropy": 1.9694663286209106, "kl": 0.014186812564730644, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015924224629998207, "vf_loss": 49.76395797729492, "total_loss": 49.755218505859375, "vf_explained_var": 0.4974503517150879, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 20305716, "num_steps_trained": 20305716, "load_time_ms": 21.103, "update_time_ms": 11.323, "sample_time_ms": 15407.098}, "episode_reward_max": 1144.2957061901982, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 62.149652892445445, "episodes_total": 11167, "episodes_this_iter": 78, "time_total_s": 7272.394460678101, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102170, "timestamp": 1556534568, "episode_len_mean": 693.2, "timesteps_since_restore": 20407886, "time_since_restore": 7309.734924077988, "done": false, "custom_metrics": {"outflow_rate_min": 470.5008371641972, "outflow_rate_mean": 915.5497230128972, "cost2_mean": -60.19816595865288, "outflow_rate_max": 1142.1244785285303, "system_level_velocity_mean": 15.799899786769595, "system_level_velocity_min": 9.999563235834724, "cost2_max": -12.841820150868783, "cost2_min": -154.5983495800621, "cost1_min": 12.939840201668382, "cost1_max": 457.4694382263139, "cost1_mean": 398.1516869963419, "system_level_velocity_max": 18.52867247983965}, "timesteps_total": 20407886, "training_iteration": 184, "date": "2019-04-29_10-42-48", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54c50>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54a20>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 184, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 911.7890972686545, "time_this_iter_s": 37.340463399887085, "info": {"grad_time_ms": 22499.13, "default": {"entropy": 1.979609489440918, "kl": 0.014700583182275295, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015125279314815998, "vf_loss": 44.490291595458984, "total_loss": 44.482608795166016, "vf_explained_var": 0.5685333013534546, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 20407886, "num_steps_trained": 20407886, "load_time_ms": 22.305, "update_time_ms": 11.422, "sample_time_ms": 15394.249}, "episode_reward_max": 1210.201835828782, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 26.047551358842018, "episodes_total": 11239, "episodes_this_iter": 72, "time_total_s": 7309.734924077988, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104591, "timestamp": 1556534607, "episode_len_mean": 695.6, "timesteps_since_restore": 20512477, "time_since_restore": 7349.219563245773, "done": false, "custom_metrics": {"outflow_rate_min": 709.359406557735, "outflow_rate_mean": 912.7148131133092, "cost2_mean": -59.35762130474981, "outflow_rate_max": 1150.7369371071225, "system_level_velocity_mean": 15.978934676002423, "system_level_velocity_min": 9.999563235834724, "cost2_max": -28.96625539263001, "cost2_min": -154.5983495800621, "cost1_min": 215.17217071616307, "cost1_max": 464.2585484038103, "cost1_mean": 403.2554058166923, "system_level_velocity_max": 18.889901195031754}, "timesteps_total": 20512477, "training_iteration": 185, "date": "2019-04-29_10-43-27", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d633c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d639b0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 185, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 915.2386613278236, "time_this_iter_s": 39.484639167785645, "info": {"grad_time_ms": 22584.354, "default": {"entropy": 1.966912865638733, "kl": 0.016140751540660858, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016007130965590477, "vf_loss": 50.56459426879883, "total_loss": 50.5567626953125, "vf_explained_var": 0.5748056173324585, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 20512477, "num_steps_trained": 20512477, "load_time_ms": 22.469, "update_time_ms": 11.346, "sample_time_ms": 15408.274}, "episode_reward_max": 1210.201835828782, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 426.8525222854237, "episodes_total": 11315, "episodes_this_iter": 76, "time_total_s": 7349.219563245773, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102642, "timestamp": 1556534645, "episode_len_mean": 682.67, "timesteps_since_restore": 20615119, "time_since_restore": 7387.155905723572, "done": false, "custom_metrics": {"outflow_rate_min": 449.342779117061, "outflow_rate_mean": 910.1110110247574, "cost2_mean": -62.7465651636558, "outflow_rate_max": 1149.955555281285, "system_level_velocity_mean": 15.7405559039577, "system_level_velocity_min": 10.240085506547361, "cost2_max": -8.655095591703251, "cost2_min": -155.94511472483956, "cost1_min": 9.718484012375603, "cost1_max": 458.0968642707689, "cost1_mean": 390.75427365396797, "system_level_velocity_max": 18.625989743505162}, "timesteps_total": 20615119, "training_iteration": 186, "date": "2019-04-29_10-44-05", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d547f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54c88>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 186, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 924.6741429366218, "time_this_iter_s": 37.93634247779846, "info": {"grad_time_ms": 22568.814, "default": {"entropy": 1.9618242979049683, "kl": 0.014920423738658428, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01679770089685917, "vf_loss": 51.1955451965332, "total_loss": 51.18630599975586, "vf_explained_var": 0.6124638915061951, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 20615119, "num_steps_trained": 20615119, "load_time_ms": 21.326, "update_time_ms": 11.499, "sample_time_ms": 15402.99}, "episode_reward_max": 1293.8860903585303, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 19.701014189607562, "episodes_total": 11391, "episodes_this_iter": 76, "time_total_s": 7387.155905723572, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 104014, "timestamp": 1556534684, "episode_len_mean": 689.56, "timesteps_since_restore": 20719133, "time_since_restore": 7425.2820019721985, "done": false, "custom_metrics": {"outflow_rate_min": 505.4939859094766, "outflow_rate_mean": 916.7490344044875, "cost2_mean": -63.80974887050409, "outflow_rate_max": 1112.1705332856995, "system_level_velocity_mean": 15.598656665779911, "system_level_velocity_min": 9.430460023090408, "cost2_max": -18.884977108546252, "cost2_min": -180.74651058125554, "cost1_min": 21.811062328600457, "cost1_max": 460.03637898241993, "cost1_mean": 390.7256854096365, "system_level_velocity_max": 19.081385004198818}, "timesteps_total": 20719133, "training_iteration": 187, "date": "2019-04-29_10-44-44", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d633c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d637f0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 187, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 919.1797921414274, "time_this_iter_s": 38.12609624862671, "info": {"grad_time_ms": 22503.242, "default": {"entropy": 2.00925612449646, "kl": 0.015828058123588562, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016292784363031387, "vf_loss": 50.07719802856445, "total_loss": 50.06891632080078, "vf_explained_var": 0.6678200960159302, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 20719133, "num_steps_trained": 20719133, "load_time_ms": 20.538, "update_time_ms": 11.408, "sample_time_ms": 15417.566}, "episode_reward_max": 1220.7722437627715, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 49.97526446268199, "episodes_total": 11461, "episodes_this_iter": 70, "time_total_s": 7425.2820019721985, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102646, "timestamp": 1556534723, "episode_len_mean": 700.0, "timesteps_since_restore": 20821779, "time_since_restore": 7464.387124300003, "done": false, "custom_metrics": {"outflow_rate_min": 778.4595832089917, "outflow_rate_mean": 923.2065744777009, "cost2_mean": -65.59821502488536, "outflow_rate_max": 1112.1705332856995, "system_level_velocity_mean": 15.447010233143867, "system_level_velocity_min": 9.430460023090408, "cost2_max": -33.843038061301165, "cost2_min": -156.46730049679212, "cost1_min": 246.543446400461, "cost1_max": 460.03637898241993, "cost1_mean": 394.1632502729963, "system_level_velocity_max": 18.65376048711299}, "timesteps_total": 20821779, "training_iteration": 188, "date": "2019-04-29_10-45-23", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa1871b8a90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54b00>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 188, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 928.1325451408389, "time_this_iter_s": 39.105122327804565, "info": {"grad_time_ms": 22558.412, "default": {"entropy": 2.0001418590545654, "kl": 0.015510874800384045, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01742863655090332, "vf_loss": 45.15737533569336, "total_loss": 45.14780044555664, "vf_explained_var": 0.5962045192718506, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 20821779, "num_steps_trained": 20821779, "load_time_ms": 20.402, "update_time_ms": 11.37, "sample_time_ms": 15442.878}, "episode_reward_max": 1220.7722437627715, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 703.0670026666874, "episodes_total": 11529, "episodes_this_iter": 68, "time_total_s": 7464.387124300003, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102565, "timestamp": 1556534761, "episode_len_mean": 686.53, "timesteps_since_restore": 20924344, "time_since_restore": 7502.432575941086, "done": false, "custom_metrics": {"outflow_rate_min": 450.4796346430239, "outflow_rate_mean": 925.8247834995993, "cost2_mean": -61.66214948154029, "outflow_rate_max": 1151.512167547295, "system_level_velocity_mean": 15.850599595859533, "system_level_velocity_min": 10.537316472920908, "cost2_max": -9.342051106504133, "cost2_min": -183.43656091002143, "cost1_min": 10.385809276667867, "cost1_max": 457.13700101523045, "cost1_mean": 396.3508634064124, "system_level_velocity_max": 18.436858139311248}, "timesteps_total": 20924344, "training_iteration": 189, "date": "2019-04-29_10-46-01", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d633c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63c18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63e80>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 189, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 913.4017839427053, "time_this_iter_s": 38.045451641082764, "info": {"grad_time_ms": 22484.284, "default": {"entropy": 1.9933825731277466, "kl": 0.014728386886417866, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016021259129047394, "vf_loss": 49.93694305419922, "total_loss": 49.92837905883789, "vf_explained_var": 0.5326232314109802, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 20924344, "num_steps_trained": 20924344, "load_time_ms": 20.344, "update_time_ms": 11.843, "sample_time_ms": 15496.159}, "episode_reward_max": 1192.9244024310312, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 21.008869532545194, "episodes_total": 11605, "episodes_this_iter": 76, "time_total_s": 7502.432575941086, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102092, "timestamp": 1556534798, "episode_len_mean": 662.33, "timesteps_since_restore": 21026436, "time_since_restore": 7539.0853061676025, "done": false, "custom_metrics": {"outflow_rate_min": 443.0250082967029, "outflow_rate_mean": 898.2840922416143, "cost2_mean": -54.05913998979157, "outflow_rate_max": 1110.921299053969, "system_level_velocity_mean": 16.103853060863795, "system_level_velocity_min": 10.031226318167054, "cost2_max": -9.342051106504133, "cost2_min": -164.80635286242946, "cost1_min": 10.385809276667867, "cost1_max": 458.94020186806875, "cost1_mean": 385.71048171103917, "system_level_velocity_max": 18.808827156356966}, "timesteps_total": 21026436, "training_iteration": 190, "date": "2019-04-29_10-46-38", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d549b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54780>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d545f8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 190, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 880.9656305834945, "time_this_iter_s": 36.652730226516724, "info": {"grad_time_ms": 22221.667, "default": {"entropy": 1.9921785593032837, "kl": 0.014500255696475506, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015413258224725723, "vf_loss": 50.90032958984375, "total_loss": 50.89226150512695, "vf_explained_var": 0.47162386775016785, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 21026436, "num_steps_trained": 21026436, "load_time_ms": 20.105, "update_time_ms": 11.842, "sample_time_ms": 15514.86}, "episode_reward_max": 1225.3026416882215, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 21.008869532545194, "episodes_total": 11687, "episodes_this_iter": 82, "time_total_s": 7539.0853061676025, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102609, "timestamp": 1556534837, "episode_len_mean": 695.95, "timesteps_since_restore": 21129045, "time_since_restore": 7577.896581172943, "done": false, "custom_metrics": {"outflow_rate_min": 736.4367142627572, "outflow_rate_mean": 929.0541678809666, "cost2_mean": -57.20763278342864, "outflow_rate_max": 1110.921299053969, "system_level_velocity_mean": 15.899217876295056, "system_level_velocity_min": 10.584962805961426, "cost2_max": -26.951445381979575, "cost2_min": -137.9259202420942, "cost1_min": 276.34718655752164, "cost1_max": 462.63668602363845, "cost1_mean": 402.35203300425036, "system_level_velocity_max": 18.37665780597697}, "timesteps_total": 21129045, "training_iteration": 191, "date": "2019-04-29_10-47-17", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d633c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63ac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63cf8>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 191, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 939.6261441493174, "time_this_iter_s": 38.811275005340576, "info": {"grad_time_ms": 22264.117, "default": {"entropy": 1.9931799173355103, "kl": 0.014688978902995586, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016207247972488403, "vf_loss": 48.11077117919922, "total_loss": 48.10200119018555, "vf_explained_var": 0.4919615685939789, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 21129045, "num_steps_trained": 21129045, "load_time_ms": 20.17, "update_time_ms": 11.741, "sample_time_ms": 15534.657}, "episode_reward_max": 1225.3026416882215, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 691.0457285321531, "episodes_total": 11761, "episodes_this_iter": 74, "time_total_s": 7577.896581172943, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102674, "timestamp": 1556534874, "episode_len_mean": 696.5, "timesteps_since_restore": 21231719, "time_since_restore": 7615.396572113037, "done": false, "custom_metrics": {"outflow_rate_min": 720.4311936200575, "outflow_rate_mean": 927.7701416358535, "cost2_mean": -57.52302041974303, "outflow_rate_max": 1120.324897891422, "system_level_velocity_mean": 15.78827522125643, "system_level_velocity_min": 10.584962805961426, "cost2_max": -28.067938703995164, "cost2_min": -116.67271074194329, "cost1_min": 179.52073545232656, "cost1_max": 460.90546150110254, "cost1_mean": 400.2870482025261, "system_level_velocity_max": 18.677591474182922}, "timesteps_total": 21231719, "training_iteration": 192, "date": "2019-04-29_10-47-54", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5d668>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d5def0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 192, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 930.4912307988853, "time_this_iter_s": 37.499990940093994, "info": {"grad_time_ms": 22147.577, "default": {"entropy": 2.0170907974243164, "kl": 0.015766680240631104, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016951585188508034, "vf_loss": 43.67567443847656, "total_loss": 43.66670608520508, "vf_explained_var": 0.45113059878349304, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 21231719, "num_steps_trained": 21231719, "load_time_ms": 19.975, "update_time_ms": 11.654, "sample_time_ms": 15529.056}, "episode_reward_max": 1216.1231668137066, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 373.8053321212871, "episodes_total": 11833, "episodes_this_iter": 72, "time_total_s": 7615.396572113037, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102442, "timestamp": 1556534913, "episode_len_mean": 692.89, "timesteps_since_restore": 21334161, "time_since_restore": 7653.775166988373, "done": false, "custom_metrics": {"outflow_rate_min": 686.6466976695532, "outflow_rate_mean": 928.6185070788819, "cost2_mean": -55.84454579185052, "outflow_rate_max": 1086.2969832278557, "system_level_velocity_mean": 15.919288978105353, "system_level_velocity_min": 12.007168204022689, "cost2_max": -24.7254057902075, "cost2_min": -116.34803688094556, "cost1_min": 136.63683704215939, "cost1_max": 456.4044367962031, "cost1_mean": 400.54928767506686, "system_level_velocity_max": 18.419577389634807}, "timesteps_total": 21334161, "training_iteration": 193, "date": "2019-04-29_10-48-33", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d633c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63f98>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63860>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 193, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 930.6869219331352, "time_this_iter_s": 38.37859487533569, "info": {"grad_time_ms": 22358.389, "default": {"entropy": 2.011531352996826, "kl": 0.01522793248295784, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01576583832502365, "vf_loss": 46.97893524169922, "total_loss": 46.97087478637695, "vf_explained_var": 0.44657379388809204, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 21334161, "num_steps_trained": 21334161, "load_time_ms": 19.96, "update_time_ms": 11.558, "sample_time_ms": 15520.283}, "episode_reward_max": 1185.5760461934594, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 263.62111121587526, "episodes_total": 11912, "episodes_this_iter": 79, "time_total_s": 7653.775166988373, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102812, "timestamp": 1556534951, "episode_len_mean": 668.35, "timesteps_since_restore": 21436973, "time_since_restore": 7692.009671211243, "done": false, "custom_metrics": {"outflow_rate_min": 457.774731123326, "outflow_rate_mean": 918.2053317253402, "cost2_mean": -54.58258205620462, "outflow_rate_max": 1090.5246154444214, "system_level_velocity_mean": 15.962548891478457, "system_level_velocity_min": 11.149228926006577, "cost2_max": -14.322814114200112, "cost2_min": -109.2036872659931, "cost1_min": 13.714338323536985, "cost1_max": 454.51333468821434, "cost1_mean": 387.8557932417562, "system_level_velocity_max": 18.73721758284975}, "timesteps_total": 21436973, "training_iteration": 194, "date": "2019-04-29_10-49-11", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63a20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63d68>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 194, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 907.5268521501757, "time_this_iter_s": 38.23450422286987, "info": {"grad_time_ms": 22416.14, "default": {"entropy": 2.015347957611084, "kl": 0.01567654311656952, "cur_lr": 0.0005000000237487257, "policy_loss": -0.015342448838055134, "vf_loss": 42.53913879394531, "total_loss": 42.53173828125, "vf_explained_var": 0.4595690667629242, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 21436973, "num_steps_trained": 21436973, "load_time_ms": 20.074, "update_time_ms": 11.596, "sample_time_ms": 15549.843}, "episode_reward_max": 1222.4859709380155, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 35.02934535894917, "episodes_total": 11985, "episodes_this_iter": 73, "time_total_s": 7692.009671211243, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102258, "timestamp": 1556534989, "episode_len_mean": 693.39, "timesteps_since_restore": 21539231, "time_since_restore": 7729.832174539566, "done": false, "custom_metrics": {"outflow_rate_min": 489.81382111880873, "outflow_rate_mean": 927.7642735050227, "cost2_mean": -58.38963320863717, "outflow_rate_max": 1100.9415411691987, "system_level_velocity_mean": 15.79287489213681, "system_level_velocity_min": 11.138498672412032, "cost2_max": -22.914232370187587, "cost2_min": -149.77076049102527, "cost1_min": 25.43663509094054, "cost1_max": 457.140366327596, "cost1_mean": 398.2884263153059, "system_level_velocity_max": 18.717500731258532}, "timesteps_total": 21539231, "training_iteration": 195, "date": "2019-04-29_10-49-49", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d637f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63c18>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 195, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 943.705071930374, "time_this_iter_s": 37.822503328323364, "info": {"grad_time_ms": 22311.635, "default": {"entropy": 2.025099277496338, "kl": 0.014493943192064762, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01492775697261095, "vf_loss": 51.00804901123047, "total_loss": 51.00046157836914, "vf_explained_var": 0.44843268394470215, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 21539231, "num_steps_trained": 21539231, "load_time_ms": 19.059, "update_time_ms": 11.768, "sample_time_ms": 15488.854}, "episode_reward_max": 1228.373787182494, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 65.61583447038133, "episodes_total": 12060, "episodes_this_iter": 75, "time_total_s": 7729.832174539566, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102632, "timestamp": 1556535028, "episode_len_mean": 692.71, "timesteps_since_restore": 21641863, "time_since_restore": 7769.018110275269, "done": false, "custom_metrics": {"outflow_rate_min": 464.2002765876701, "outflow_rate_mean": 931.71216613424, "cost2_mean": -59.809965695420445, "outflow_rate_max": 1103.9853515893392, "system_level_velocity_mean": 15.574530328907096, "system_level_velocity_min": 11.138498672412032, "cost2_max": -13.9057778093394, "cost2_min": -152.80326896223266, "cost1_min": 11.759269404899989, "cost1_max": 457.140366327596, "cost1_mean": 392.7612832627135, "system_level_velocity_max": 18.717500731258532}, "timesteps_total": 21641863, "training_iteration": 196, "date": "2019-04-29_10-50-28", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63f60>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63a90>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 196, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 936.715125651605, "time_this_iter_s": 39.185935735702515, "info": {"grad_time_ms": 22354.836, "default": {"entropy": 2.0403614044189453, "kl": 0.015058853663504124, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01639670692384243, "vf_loss": 43.7618408203125, "total_loss": 43.75306701660156, "vf_explained_var": 0.4851708710193634, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 21641863, "num_steps_trained": 21641863, "load_time_ms": 19.165, "update_time_ms": 11.548, "sample_time_ms": 15569.917}, "episode_reward_max": 1143.8259521621837, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 26.004441090008385, "episodes_total": 12133, "episodes_this_iter": 73, "time_total_s": 7769.018110275269, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103036, "timestamp": 1556535067, "episode_len_mean": 693.47, "timesteps_since_restore": 21744899, "time_since_restore": 7807.889592170715, "done": false, "custom_metrics": {"outflow_rate_min": 535.2284858995457, "outflow_rate_mean": 947.7823102280804, "cost2_mean": -62.08246841802359, "outflow_rate_max": 1113.9695699614638, "system_level_velocity_mean": 15.743253521605752, "system_level_velocity_min": 11.373867530409974, "cost2_max": -27.852087041389343, "cost2_min": -152.80326896223266, "cost1_min": 31.278535410167354, "cost1_max": 454.2291713808947, "cost1_mean": 397.9976849501444, "system_level_velocity_max": 18.955039937890607}, "timesteps_total": 21744899, "training_iteration": 197, "date": "2019-04-29_10-51-07", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d639b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63b38>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 197, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 955.2362232571021, "time_this_iter_s": 38.87148189544678, "info": {"grad_time_ms": 22388.367, "default": {"entropy": 2.038942337036133, "kl": 0.015375189483165741, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016367878764867783, "vf_loss": 44.855072021484375, "total_loss": 44.84648895263672, "vf_explained_var": 0.5255981087684631, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 21744899, "num_steps_trained": 21744899, "load_time_ms": 19.9, "update_time_ms": 11.678, "sample_time_ms": 15610.015}, "episode_reward_max": 1214.0880874503089, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 66.17007345220614, "episodes_total": 12202, "episodes_this_iter": 69, "time_total_s": 7807.889592170715, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 102364, "timestamp": 1556535104, "episode_len_mean": 682.14, "timesteps_since_restore": 21847263, "time_since_restore": 7845.364332914352, "done": false, "custom_metrics": {"outflow_rate_min": 535.2284858995457, "outflow_rate_mean": 922.7741100407591, "cost2_mean": -59.53295170942003, "outflow_rate_max": 1097.5448899450937, "system_level_velocity_mean": 15.737296064819727, "system_level_velocity_min": 10.158152064732587, "cost2_max": -25.416389104737863, "cost2_min": -159.3144649888623, "cost1_min": 29.3982665645347, "cost1_max": 456.8585558122528, "cost1_mean": 389.2706463330198, "system_level_velocity_max": 18.955039937890607}, "timesteps_total": 21847263, "training_iteration": 198, "date": "2019-04-29_10-51-44", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63a20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63470>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 198, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 918.2342466282629, "time_this_iter_s": 37.474740743637085, "info": {"grad_time_ms": 22255.177, "default": {"entropy": 2.0689353942871094, "kl": 0.015115750022232533, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01615092158317566, "vf_loss": 45.273841857910156, "total_loss": 45.265342712402344, "vf_explained_var": 0.4756198227405548, "cur_kl_coeff": 0.5062499642372131}, "num_steps_sampled": 21847263, "num_steps_trained": 21847263, "load_time_ms": 19.922, "update_time_ms": 11.743, "sample_time_ms": 15581.893}, "episode_reward_max": 1214.0880874503089, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 65.43339296395523, "episodes_total": 12277, "episodes_this_iter": 75, "time_total_s": 7845.364332914352, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103217, "timestamp": 1556535143, "episode_len_mean": 693.38, "timesteps_since_restore": 21950480, "time_since_restore": 7883.651991844177, "done": false, "custom_metrics": {"outflow_rate_min": 508.0519436229788, "outflow_rate_mean": 930.3454144654052, "cost2_mean": -61.75437697343986, "outflow_rate_max": 1225.892189013083, "system_level_velocity_mean": 15.553475089901877, "system_level_velocity_min": 10.158152064732587, "cost2_max": -19.841150929604893, "cost2_min": -159.3144649888623, "cost1_min": 26.023130905566273, "cost1_max": 460.75270692564936, "cost1_mean": 392.0400810370661, "system_level_velocity_max": 18.838461285630803}, "timesteps_total": 21950480, "training_iteration": 199, "date": "2019-04-29_10-52-23", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d63a58>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 199, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 929.8906511649981, "time_this_iter_s": 38.28765892982483, "info": {"grad_time_ms": 22297.187, "default": {"entropy": 2.0535192489624023, "kl": 0.016114136204123497, "cur_lr": 0.0005000000237487257, "policy_loss": -0.017176857218146324, "vf_loss": 48.11797332763672, "total_loss": 48.108951568603516, "vf_explained_var": 0.47045284509658813, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 21950480, "num_steps_trained": 21950480, "load_time_ms": 20.616, "update_time_ms": 11.114, "sample_time_ms": 15564.898}, "episode_reward_max": 1245.5508087502951, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 64.28697954596294, "episodes_total": 12352, "episodes_this_iter": 75, "time_total_s": 7883.651991844177, "num_metric_batches_dropped": 0}
{"timesteps_this_iter": 103538, "timestamp": 1556535180, "episode_len_mean": 681.66, "timesteps_since_restore": 22054018, "time_since_restore": 7920.981198549271, "done": true, "custom_metrics": {"outflow_rate_min": 498.0581987477479, "outflow_rate_mean": 922.8303054854567, "cost2_mean": -59.10135537205314, "outflow_rate_max": 1116.8943072501945, "system_level_velocity_mean": 15.60191356926793, "system_level_velocity_min": 10.170463584969829, "cost2_max": -19.127535675152625, "cost2_min": -125.71076229284719, "cost1_min": 22.121833717580728, "cost1_max": 456.520060058652, "cost1_mean": 385.7717568941618, "system_level_velocity_max": 18.66043723149922}, "timesteps_total": 22054018, "training_iteration": 200, "date": "2019-04-29_10-53-00", "config": {"clip_param": 0.3, "vf_share_layers": false, "num_workers": 60, "model": {"lstm_use_prev_action_reward": false, "max_seq_len": 20, "grayscale": false, "free_log_std": false, "framestack": true, "custom_options": {}, "dim": 84, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "use_lstm": false, "squash_to_range": false, "custom_model": null, "lstm_cell_size": 256}, "synchronize_filters": true, "num_cpus_for_driver": 1, "vf_clip_param": 1000000.0, "output_compress_columns": ["obs", "new_obs"], "use_gae": true, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "entropy_coeff": 0.0, "simple_optimizer": false, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0", "num_envs_per_worker": 1, "sample_batch_size": 200, "num_cpus_per_worker": 1, "lr": 0.0005, "log_level": "INFO", "clip_rewards": null, "sgd_minibatch_size": 128, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "sample_async": false, "optimizer": {}, "monitor": false, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "straggler_mitigation": false, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d54e48>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa186d549b0>"}, "lr_schedule": null, "lambda": 0.97, "clip_actions": false, "preprocessor_pref": "deepmind", "kl_coeff": 0.2, "train_batch_size": 90000, "horizon": 1500, "vf_loss_coeff": 1.0, "gamma": 0.99, "input": "sampler", "output_max_file_size": 67108864, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "batch_mode": "truncate_episodes", "num_gpus": 0, "compress_observations": false, "input_evaluation": null, "num_sgd_iter": 10, "observation_filter": "MeanStdFilter", "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true, "inter_op_parallelism_threads": 2}, "output": null, "collect_metrics_timeout": 180}, "iterations_since_restore": 200, "experiment_id": "9722479ff9bf4af0890c98cc4168f831", "episode_reward_mean": 930.0281294719249, "time_this_iter_s": 37.329206705093384, "info": {"grad_time_ms": 22363.377, "default": {"entropy": 2.042571544647217, "kl": 0.015644190832972527, "cur_lr": 0.0005000000237487257, "policy_loss": -0.016829008236527443, "vf_loss": 48.23889923095703, "total_loss": 48.229984283447266, "vf_explained_var": 0.4401485323905945, "cur_kl_coeff": 0.5062499046325684}, "num_steps_sampled": 22054018, "num_steps_trained": 22054018, "load_time_ms": 19.751, "update_time_ms": 11.354, "sample_time_ms": 15568.256}, "episode_reward_max": 1251.4052660416717, "policy_reward_mean": {}, "node_ip": "10.138.0.2", "pid": 20452, "hostname": "flow-main", "episode_reward_min": 47.41576623440353, "episodes_total": 12427, "episodes_this_iter": 75, "time_total_s": 7920.981198549271, "num_metric_batches_dropped": 0}
